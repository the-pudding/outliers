import{S as Sn,i as En,s as An,e as Nt,c as Gt,b as Me,g as ir,d as ht,l as da,M as R8,G as At,D as Dr,H as v1,I as eu,a as Jt,J as tu,K as iu,L as ru,q as Qi,o as nr,w as sn,x as jn,y as ln,B as cn,F as B2,k as vn,m as bn,N as Vf,v as nu,O as jf,P as Vl,Q as zr,R as Pr,T as O2,z as B8,A as O8,n as e3,p as t3,U as F2,t as M9,h as C9,C as F8,V as N2,r as $f}from"../chunks/index-818da099.js";import{w as Zf}from"../chunks/wordmark-0849a013.js";function G2(g,x,E){const I=g.slice();return I[5]=x[E],I}function U2(g){let x,E;return{c(){x=Nt("link"),this.h()},l(I){x=Gt(I,"LINK",{rel:!0,href:!0,as:!0,type:!0,crossorigin:!0}),this.h()},h(){Me(x,"rel","preload"),Me(x,"href",E=g[5]),Me(x,"as","font"),Me(x,"type","font/woff2"),Me(x,"crossorigin","")},m(I,k){ir(I,x,k)},p(I,k){k&16&&E!==(E=I[5])&&Me(x,"href",E)},d(I){I&&ht(x)}}}function qf(g){let x,E,I,k,L,F,o,Z,ae,te,N,K,fe,Te,Ce,ke,Qe,Ve,Oe,$e,xe,dt,We,gt,wt,He;document.title=x=g[0]+" - The Pudding";let Je=g[4],Ye=[];for(let qe=0;qe<Je.length;qe+=1)Ye[qe]=U2(G2(g,Je,qe));return{c(){E=Nt("meta"),I=Nt("meta"),k=Nt("meta"),L=Nt("meta"),F=Nt("meta"),o=Nt("meta"),Z=Nt("meta"),ae=Nt("meta"),te=Nt("meta"),N=Nt("meta"),fe=Nt("meta"),Te=Nt("meta"),Ce=Nt("meta"),ke=Nt("meta"),Qe=Nt("meta"),Ve=Nt("meta"),Oe=Nt("meta"),$e=Nt("meta"),xe=Nt("meta"),We=Nt("meta"),gt=Nt("link");for(let qe=0;qe<Ye.length;qe+=1)Ye[qe].c();He=da(),this.h()},l(qe){const Xe=R8('[data-svelte="svelte-e9ztej"]',document.head);E=Gt(Xe,"META",{name:!0,content:!0}),I=Gt(Xe,"META",{name:!0,content:!0}),k=Gt(Xe,"META",{name:!0,content:!0}),L=Gt(Xe,"META",{property:!0,content:!0}),F=Gt(Xe,"META",{property:!0,content:!0}),o=Gt(Xe,"META",{property:!0,content:!0}),Z=Gt(Xe,"META",{property:!0,content:!0}),ae=Gt(Xe,"META",{property:!0,content:!0}),te=Gt(Xe,"META",{property:!0,content:!0}),N=Gt(Xe,"META",{property:!0,content:!0}),fe=Gt(Xe,"META",{property:!0,content:!0}),Te=Gt(Xe,"META",{property:!0,content:!0}),Ce=Gt(Xe,"META",{property:!0,content:!0}),ke=Gt(Xe,"META",{name:!0,content:!0}),Qe=Gt(Xe,"META",{name:!0,content:!0}),Ve=Gt(Xe,"META",{name:!0,content:!0}),Oe=Gt(Xe,"META",{name:!0,content:!0}),$e=Gt(Xe,"META",{name:!0,content:!0}),xe=Gt(Xe,"META",{name:!0,content:!0}),We=Gt(Xe,"META",{name:!0,content:!0}),gt=Gt(Xe,"LINK",{rel:!0,href:!0});for(let ze=0;ze<Ye.length;ze+=1)Ye[ze].l(Xe);He=da(),Xe.forEach(ht),this.h()},h(){Me(E,"name","description"),Me(E,"content",g[1]),Me(I,"name","author"),Me(I,"content","The Pudding"),Me(k,"name","news_keywords"),Me(k,"content",g[3]),Me(L,"property","og:title"),Me(L,"content",g[0]),Me(F,"property","og:site_name"),Me(F,"content","The Pudding"),Me(o,"property","og:url"),Me(o,"content",g[2]),Me(Z,"property","og:description"),Me(Z,"content",g[1]),Me(ae,"property","og:type"),Me(ae,"content","article"),Me(te,"property","og:locale"),Me(te,"content","en_US"),Me(N,"property","og:image"),Me(N,"content",K=g[2]+"/assets/social-facebook.jpg"),Me(fe,"property","og:image:type"),Me(fe,"content","image/jpeg"),Me(Te,"property","og:image:width"),Me(Te,"content","1200"),Me(Ce,"property","og:image:height"),Me(Ce,"content","600"),Me(ke,"name","twitter:card"),Me(ke,"content","summary_large_image"),Me(Qe,"name","twitter:site"),Me(Qe,"content","https://pudding.cool"),Me(Ve,"name","twitter:creator"),Me(Ve,"content","@puddingviz"),Me(Oe,"name","twitter:title"),Me(Oe,"content",g[0]),Me($e,"name","twitter:description"),Me($e,"content",g[1]),Me(xe,"name","twitter:image:src"),Me(xe,"content",dt=g[2]+"/assets/social-twitter.jpg"),Me(We,"name","robots"),Me(We,"content","max-image-preview:large"),Me(gt,"rel","canonical"),Me(gt,"href",wt=g[2]+"/")},m(qe,Xe){At(document.head,E),At(document.head,I),At(document.head,k),At(document.head,L),At(document.head,F),At(document.head,o),At(document.head,Z),At(document.head,ae),At(document.head,te),At(document.head,N),At(document.head,fe),At(document.head,Te),At(document.head,Ce),At(document.head,ke),At(document.head,Qe),At(document.head,Ve),At(document.head,Oe),At(document.head,$e),At(document.head,xe),At(document.head,We),At(document.head,gt);for(let ze=0;ze<Ye.length;ze+=1)Ye[ze].m(document.head,null);At(document.head,He)},p(qe,[Xe]){if(Xe&1&&x!==(x=qe[0]+" - The Pudding")&&(document.title=x),Xe&2&&Me(E,"content",qe[1]),Xe&8&&Me(k,"content",qe[3]),Xe&1&&Me(L,"content",qe[0]),Xe&4&&Me(o,"content",qe[2]),Xe&2&&Me(Z,"content",qe[1]),Xe&4&&K!==(K=qe[2]+"/assets/social-facebook.jpg")&&Me(N,"content",K),Xe&1&&Me(Oe,"content",qe[0]),Xe&2&&Me($e,"content",qe[1]),Xe&4&&dt!==(dt=qe[2]+"/assets/social-twitter.jpg")&&Me(xe,"content",dt),Xe&4&&wt!==(wt=qe[2]+"/")&&Me(gt,"href",wt),Xe&16){Je=qe[4];let ze;for(ze=0;ze<Je.length;ze+=1){const St=G2(qe,Je,ze);Ye[ze]?Ye[ze].p(St,Xe):(Ye[ze]=U2(St),Ye[ze].c(),Ye[ze].m(He.parentNode,He))}for(;ze<Ye.length;ze+=1)Ye[ze].d(1);Ye.length=Je.length}},i:Dr,o:Dr,d(qe){ht(E),ht(I),ht(k),ht(L),ht(F),ht(o),ht(Z),ht(ae),ht(te),ht(N),ht(fe),ht(Te),ht(Ce),ht(ke),ht(Qe),ht(Ve),ht(Oe),ht($e),ht(xe),ht(We),ht(gt),v1(Ye,qe),ht(He)}}}function Wf(g,x,E){let{title:I="Title TK"}=x,{description:k="Description TK"}=x,{url:L="https://pudding.cool"}=x,{keywords:F=""}=x,{preloadFont:o=[]}=x;return g.$$set=Z=>{"title"in Z&&E(0,I=Z.title),"description"in Z&&E(1,k=Z.description),"url"in Z&&E(2,L=Z.url),"keywords"in Z&&E(3,F=Z.keywords),"preloadFont"in Z&&E(4,o=Z.preloadFont)},[I,k,L,F,o]}class Xf extends Sn{constructor(x){super(),En(this,x,Wf,qf,An,{title:0,description:1,url:2,keywords:3,preloadFont:4})}}const Jf="Outlier",Hf="Exploring upward mobility in America",Yf="Aaron Williams",Kf="https://pudding.cool",Qf="story",e_=[{block:"text",id:"default",text:"Upward mobility is broadly defined as children having a better standard of living than their parents. There\u2019s no single way to measure a \u201Cbetter standard of living,\u201D but a child\u2019s income compared to their parent\u2019s is often used."},{block:"text",text:"Here\u2019s how upward mobility worked in my life."},{block:"text",id:"gardena",text:"I was born in 1989 in the South Los Angeles suburb of Gardena, Calif. Despite our home being labeled in Gardena, it\u2019s actually an extension of West Compton that\u2019s served by the Gardena post office."},{block:"text",id:"sandel",text:"My mother, grandparents and I lived on a classic American culdesac with modest single-family houses and manicured lawns. It was one of those blocks occupied by the same families for generations where everyone raised each other\u2019s kids."},{block:"image"},{block:"text",id:"smog",text:`At the time, I knew two things to be true: almost everyone looked like me, and it was hard to breathe. Oil wells and smog hung about like nosy neighbors. Our house was right off the 110 freeway, about 30 minutes south of Downtown LA and near industrial facilities ranging from concrete to gas. \r
\r
\r
My proximity to lousy air quality made breathing a chore, and my asthma didn\u2019t help either. Hospital visits were typical back then.`},{block:"text",id:"playa-del-rey",text:"Once I entered first grade, I found reprieve from my neighborhood\u2019s air quality five days a week when I was bussed 15 miles northwest to the wealthy, seaside city of Playa Del Rey to attend a magnet elementary school."},{block:"image"},{block:"text",text:`The first thing I noticed was the air. Playa Del Rey\u2019s proximity to the Pacific Ocean made the environment crisp; cool. I breathed better. I could run more. I could focus.\r
\r
\r
The second thing I noticed was the lack of Black folk. The majority of Black kids came with me on the bus. I was 6 years old when I noticed this pattern\u2014this association between better quality of life and the lack of Black families nearby.`},{block:"text",id:"fremont",text:"First grade was the last year I would attend grade school in Southern California. My mother would soon move me to a new place where she hoped to bring me, and herself, new opportunities."},{block:"text",id:"transition",text:"We would migrate north in search of something better."}],t_=[{block:"subhead",text:"Migration"},{block:"text",text:`When my grandparents moved from the South to California in the 1940s, they were part of one of the largest migrations in American history. \r
\r
\r
The Great Migration, beautifully depicted in Isabel Wilkerson\u2019s The Warmth of Other Suns, is a story of holding the American Dream to its word. From 1910 to 1970, Black folk from across the American South would leave it in search of new opportunities, hoping that their fortunes would change and that of their progeny.`},{block:"text",text:`Key to this migration is the concept of upward mobility.\r
\r
\r
My mother understood this, too. She wanted opportunities for me that she didn\u2019t have growing up, just as my grandparents had done for her.`},{block:"map",type:"full-width"},{block:"text",text:`My family migrated out of farm country for better opportunities. Some went north to the Bay Area, settling primarily in Menlo Park and East Palo Alto. My mother\u2019s family was part of the cohort that went south to Los Angeles, settling primarily in LA\u2019s Crenshaw district and farther south in Compton.\r
\r
\r
A few decades later, it was her turn to do the same. My mother\u2019s job was closing its Los Angeles location and gave her two options: Either take a buyout or keep her job and relocate to the San Francisco office.\r
\r
\r
So, in the summer of 1996, when I was 7 years old, my mom moved us 373 miles north to Fremont, Calif. The city is on the east end of the Dumbarton Bridge, which connects Fremont to Menlo Park, making it an ideal location because we had family nearby. Or, at least, we did until the high cost of living forced them to move back to the Central Valley.`},{block:"image"},{block:"text",text:"We settled in a charming apartment in the Centerville District near the Fremont BART train station. Just up the street was a cornfield owned by a local family. Just east of us was the East Bay hillside. Cows grazed on the verdant grass while songbirds chirped. Drivers stopped for passing families of deer that wandered into the city streets."},{block:"image"},{block:"text",text:`It was there I noticed it again.\r
\r
\r
The air was crisp; cool. I could jump. I could sing. Except for this time, it wasn\u2019t just for the few hours I spent at school. It was every day.`},{block:"subhead",text:"Upward Mobility"},{block:"text",text:`In March of 2018, Raj Chetty, an economist at Harvard, and a team of researchers sought to estimate upward mobility across socioeconomic lines. Using anonymized census data and tax records of roughly 20 million Americans, he and his team predicted outcomes for children born between 1978 and 1983 to when they were in their 30s (around 2015). \r
\r
\r
They published much of this work via the Opportunity Insights nonprofit. Chetty et al.\u2019s work would be widely covered and was the source of powerful data visualizations from the New York Times.\r
\r
\r
Among Chetty\u2019s findings was the importance of geographical location. Research showed that outcomes for children could vary widely even when their neighborhoods were as little as a mile apart. Furthermore, the age at which someone moves has a profound impact on their future earnings but only up until a limit.\r
\r
\r
Let\u2019s return to Gardena to see these concepts in action.`},{block:"image"},{block:"text",text:"According to Opportunity Insights and U.S. census data, around 351 kids lived in my neighborhood in Gardena. It was about evenly split between Black (48%) and Hispanic (43%) kids."},{block:"image"},{block:"text",text:"Of the 171 Black kids in my neighborhood, almost half had parents who made over $74,000. I was one of them."},{block:"image"},{block:"text",text:"Black kids like me with parents in high-income percentiles from my neighborhood in Gardena are predicted to make $38,000 by 35 years old, placing them just above the median predicted income for Black kids across the U.S. with similar backgrounds ($32,000)."},{block:"image"},{block:"text",text:"But, Black boys from my neighborhood fare even better. Black boys whose parents are in the top 25% of earners are predicted to make $61,000, ranking about the highest predicted incomes for boys of any race."},{block:"image"},{block:"text",text:"These markers of high predicted income did not persist just east of our neighborhood."},{block:"image"},{block:"text",text:"The predicted income for Black boys with parents who made the same as my mother in the neighborhoods surrounding mine plummeted by more than 50%."},{block:"text",text:"So, what happened once we moved to Fremont?"},{block:"image"},{block:"text",text:`My Fremont neighborhood had roughly 1,200 kids. 4% (51) were Black. \r
\r
\r
And when it came to income, my predicted outcomes did improve. \r
\r
\r
There isn\u2019t sufficient data for Black boys whose parents made the same income as my mother in Fremont, but Black kids, in general, are predicted to have a household income of $49,000, an $11,000 increase from Gardena.`},{block:"image"},{block:"text",text:`Had my mother\u2019s job never terminated their LA location and offered to move us to the Bay Area, or had my family decided to stay in Compton instead of Gardena, I could\u2019ve had a different life.\r
\r
\r
The data I\u2019ve presented offers an interesting exercise in what could have been. And in many cases, I can point to instances in my life where this shift happens.`},{block:"subhead",text:"Conclusion"},{block:"text",text:`As an adult, I zigzagged across California, first attending college in San Francisco, and then working as a data journalist across the state. In 2015 I moved 3,000 miles east to work at the Washington Post. I was looking for better opportunities.\r
\r
\r
In the fall of 2021, my partner and I decided to move back to Los Angeles, returning to the area that has defined my family for almost a century.\r
\r
\r
As soon as I got a chance, I drove south to Gardena to see my old neighborhood. \r
\r
\r
I thought about the opportunities this neighborhood gave my family; gave me.\r
\r
\r
It now seems those opportunities dwindled.\r
\r
\r
In 1990, my Gardena neighborhood had a median household income of $81,000. In Fremont, the neighborhood we moved to had a similar median household income of $84,000.\r
\r
\r
And yet, according to 2012-2016 census estimates, the median household income in my Fremont neighborhood increased by 42% to $120,000. Over the same period, the median household income in my Gardena neighborhood decreased by 50% to $40,000.`},{block:"image"},{block:"text",text:`I can hypothesize about what changed. It could be because of the new Great Migration of Black folk from northern and western cities back to the South. It could be that Gardena\u2019s Hispanic population increased from 1990 to 2020 \u2014 a community that suffers many of the same racial injustices as Black communities. It could be because Fremont is next door to Silicon Valley and home to the most productive auto facility in the country. It could be because, according to Chetty\u2019s research, generational mobility for Americans dropped from 90% in the 1940s to 50% by the 1980s, meaning kids are more likely to make less than their parents.\r
\r
\r
All I know is that the \u201Cveil\u201D Du Bois described more than 100 years earlier, the same one I saw in the first grade, remains. \r
\r
\r
There\u2019s so much value in Black folk. Our art, culture and politics cannot be separated from what makes the United States what it is. And yet, our physical presence isn\u2019t valued in the same way. \r
\r
\r
Upward mobility is important because as Chetty et al.\u2019s research shows, your place of origin can wholly reshape your economic opportunities. \r
\r
\r
But, a place is more than the opportunity it provides. What makes a place is the people who live there.`}];var Vn={title:Jf,description:Hf,byline:Yf,url:Kf,keywords:Qf,slides:e_,blocks:t_};function i_(g){let x,E,I;const k=g[3].default,L=eu(k,g,g[2],null);return{c(){x=Nt("div"),L&&L.c(),this.h()},l(F){x=Gt(F,"DIV",{id:!0,class:!0});var o=Jt(x);L&&L.l(o),o.forEach(ht),this.h()},h(){Me(x,"id",g[0]),Me(x,"class",E=`block ${g[1]} w-full max-w-3xl mb-4 mx-auto`)},m(F,o){ir(F,x,o),L&&L.m(x,null),I=!0},p(F,[o]){L&&L.p&&(!I||o&4)&&tu(L,k,F,F[2],I?ru(k,F[2],o,null):iu(F[2]),null),(!I||o&1)&&Me(x,"id",F[0]),(!I||o&2&&E!==(E=`block ${F[1]} w-full max-w-3xl mb-4 mx-auto`))&&Me(x,"class",E)},i(F){I||(Qi(L,F),I=!0)},o(F){nr(L,F),I=!1},d(F){F&&ht(x),L&&L.d(F)}}}function r_(g,x,E){let{$$slots:I={},$$scope:k}=x,{id:L}=x,{type:F}=x;return g.$$set=o=>{"id"in o&&E(0,L=o.id),"type"in o&&E(1,F=o.type),"$$scope"in o&&E(2,k=o.$$scope)},[L,F,k,I]}class ou extends Sn{constructor(x){super(),En(this,x,r_,i_,An,{id:0,type:1})}}function V2(g,x,E){const I=g.slice();return I[3]=x[E],I[5]=E,I}function j2(g){let x,E=g[3]+"";return{c(){x=Nt("p"),this.h()},l(I){x=Gt(I,"P",{class:!0});var k=Jt(x);k.forEach(ht),this.h()},h(){Me(x,"class","mb-5 text-lg")},m(I,k){ir(I,x,k),x.innerHTML=E},p(I,k){k&2&&E!==(E=I[3]+"")&&(x.innerHTML=E)},d(I){I&&ht(x)}}}function n_(g){let x,E=g[1],I=[];for(let k=0;k<E.length;k+=1)I[k]=j2(V2(g,E,k));return{c(){for(let k=0;k<I.length;k+=1)I[k].c();x=da()},l(k){for(let L=0;L<I.length;L+=1)I[L].l(k);x=da()},m(k,L){for(let F=0;F<I.length;F+=1)I[F].m(k,L);ir(k,x,L)},p(k,L){if(L&2){E=k[1];let F;for(F=0;F<E.length;F+=1){const o=V2(k,E,F);I[F]?I[F].p(o,L):(I[F]=j2(o),I[F].c(),I[F].m(x.parentNode,x))}for(;F<I.length;F+=1)I[F].d(1);I.length=E.length}},d(k){v1(I,k),k&&ht(x)}}}function o_(g){let x,E;return x=new ou({props:{id:g[0],type:"text",$$slots:{default:[n_]},$$scope:{ctx:g}}}),{c(){sn(x.$$.fragment)},l(I){jn(x.$$.fragment,I)},m(I,k){ln(x,I,k),E=!0},p(I,[k]){const L={};k&1&&(L.id=I[0]),k&66&&(L.$$scope={dirty:k,ctx:I}),x.$set(L)},i(I){E||(Qi(x.$$.fragment,I),E=!0)},o(I){nr(x.$$.fragment,I),E=!1},d(I){cn(x,I)}}}function a_(g,x,E){let{id:I}=x,{text:k}=x,{grafs:L=k.split(`
`)}=x;return g.$$set=F=>{"id"in F&&E(0,I=F.id),"text"in F&&E(2,k=F.text),"grafs"in F&&E(1,L=F.grafs)},[I,L,k]}class jl extends Sn{constructor(x){super(),En(this,x,a_,o_,An,{id:0,text:2,grafs:1})}}function s_(g){let x;return{c(){x=Nt("h2"),this.h()},l(E){x=Gt(E,"H2",{class:!0});var I=Jt(x);I.forEach(ht),this.h()},h(){Me(x,"class","font-bold mt-6 mb-8 text-3xl")},m(E,I){ir(E,x,I),x.innerHTML=g[1]},p(E,I){I&2&&(x.innerHTML=E[1])},d(E){E&&ht(x)}}}function l_(g){let x,E;return x=new ou({props:{id:g[0],type:"subhead",$$slots:{default:[s_]},$$scope:{ctx:g}}}),{c(){sn(x.$$.fragment)},l(I){jn(x.$$.fragment,I)},m(I,k){ln(x,I,k),E=!0},p(I,[k]){const L={};k&1&&(L.id=I[0]),k&6&&(L.$$scope={dirty:k,ctx:I}),x.$set(L)},i(I){E||(Qi(x.$$.fragment,I),E=!0)},o(I){nr(x.$$.fragment,I),E=!1},d(I){cn(x,I)}}}function c_(g,x,E){let{id:I}=x,{text:k}=x;return g.$$set=L=>{"id"in L&&E(0,I=L.id),"text"in L&&E(1,k=L.text)},[I,k]}class u_ extends Sn{constructor(x){super(),En(this,x,c_,l_,An,{id:0,text:1})}}function h_(g){let x,E;return{c(){x=Nt("img"),this.h()},l(I){x=Gt(I,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){B2(x.src,E=g[1])||Me(x,"src",E),Me(x,"alt",g[2]),Me(x,"class","my-10")},m(I,k){ir(I,x,k)},p(I,k){k&2&&!B2(x.src,E=I[1])&&Me(x,"src",E),k&4&&Me(x,"alt",I[2])},d(I){I&&ht(x)}}}function p_(g){let x,E;return x=new ou({props:{id:g[0],type:"image",$$slots:{default:[h_]},$$scope:{ctx:g}}}),{c(){sn(x.$$.fragment)},l(I){jn(x.$$.fragment,I)},m(I,k){ln(x,I,k),E=!0},p(I,[k]){const L={};k&1&&(L.id=I[0]),k&14&&(L.$$scope={dirty:k,ctx:I}),x.$set(L)},i(I){E||(Qi(x.$$.fragment,I),E=!0)},o(I){nr(x.$$.fragment,I),E=!1},d(I){cn(x,I)}}}function d_(g,x,E){let{id:I}=x,{src:k="https://via.placeholder.com/800x300"}=x,{alt:L}=x;return g.$$set=F=>{"id"in F&&E(0,I=F.id),"src"in F&&E(1,k=F.src),"alt"in F&&E(2,L=F.alt)},[I,k,L]}class f_ extends Sn{constructor(x){super(),En(this,x,d_,p_,An,{id:0,src:1,alt:2})}}const __="FeatureCollection",m_=[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.235602,33.8673419991],[-118.235634,33.8678999991],[-118.236589,33.8678939991],[-118.236734,33.8678929991],[-118.237131,33.8678869991],[-118.237212,33.8678859991],[-118.237616,33.8678719991],[-118.237807,33.8678659991],[-118.2379,33.8678619991],[-118.238853,33.8678239991],[-118.24109,33.8677639991],[-118.241781,33.8677459991],[-118.24196,33.8677409991],[-118.242077,33.8677399991],[-118.242399,33.8698939991],[-118.244139,33.8701859991],[-118.248431,33.8700459991],[-118.24866,33.8700799991],[-118.248664,33.8703649991],[-118.248673,33.8709869991],[-118.248674,33.8710429991],[-118.248674,33.8713099991],[-118.248674,33.8716969991],[-118.248629,33.8718149991],[-118.248619,33.8718409991],[-118.248602,33.8721639991],[-118.248599,33.8722269991],[-118.248602,33.8728129991],[-118.248606,33.8732939991],[-118.248608,33.8735089991],[-118.248611,33.8739789991],[-118.248618,33.8745509991],[-118.248618,33.8746019991],[-118.248625,33.8750469991],[-118.248628,33.8754749991],[-118.248628,33.8755819991],[-118.248633,33.8763789991],[-118.248641,33.8776339991],[-118.248642,33.8788129991],[-118.247424,33.8789119991],[-118.247298,33.8804519991],[-118.248226,33.8804279991],[-118.24866,33.8804169991],[-118.248734,33.8804149991],[-118.248735,33.8805929991],[-118.248741,33.8817169991],[-118.253666,33.8817169991],[-118.253376,33.8801159991],[-118.259098,33.8799619991],[-118.259972,33.8800589991],[-118.260814,33.8801819991],[-118.261512,33.8801119991],[-118.261336,33.8811629991],[-118.261306,33.8813429991],[-118.261118,33.8814729991],[-118.258141,33.8839719991],[-118.25802,33.8839749991],[-118.257213,33.8840009991],[-118.257605,33.8862679991],[-118.258325,33.8862419991],[-118.258714,33.8862289991],[-118.259462,33.8862119991],[-118.259466,33.8861459991],[-118.259392,33.8858529991],[-118.259366,33.8857079991],[-118.259878,33.8856169991],[-118.259841,33.8852479991],[-118.260231,33.8852199991],[-118.261161,33.8852339991],[-118.261256,33.8856229991],[-118.261362991,33.8860910013],[-118.263106986,33.8860400024],[-118.263752986,33.8860210024],[-118.265231986,33.8859770026],[-118.265328986,33.8859770021],[-118.265393986,33.8859750023],[-118.267778986,33.8858880024],[-118.267977986,33.8858810023],[-118.268090986,33.8858760024],[-118.268972986,33.8858400024],[-118.269537986,33.8858170024],[-118.270762986,33.8857770024],[-118.271277986,33.8857610023],[-118.271807986,33.8857410024],[-118.272794986,33.8857060023],[-118.272845986,33.8857040036],[-118.273182987,33.885755001],[-118.273544986,33.8857350024],[-118.273746986,33.8857240026],[-118.275354986,33.8856860023],[-118.275842986,33.8856720025],[-118.275920986,33.8856710017],[-118.276253986,33.8856380028],[-118.277154986,33.8856080024],[-118.277769986,33.8855930025],[-118.278115986,33.8855890023],[-118.278380986,33.8855820024],[-118.279170986,33.8855700023],[-118.279561986,33.8855630024],[-118.279784986,33.8855590023],[-118.280161986,33.8855470024],[-118.280633986,33.8855350024],[-118.280995986,33.8855260024],[-118.281349986,33.8855180025],[-118.282077986,33.8855170016],[-118.282190986,33.8855050026],[-118.282592986,33.8854750025],[-118.282629986,33.8854730022],[-118.282710117,33.8854673358],[-118.282728986,33.8854660012],[-118.282724,33.8853389991],[-118.282617,33.8827609991],[-118.282616,33.8827319991],[-118.282579,33.8818399991],[-118.282546,33.8810469991],[-118.282536,33.8808169991],[-118.282508,33.8801469991],[-118.282488,33.8796489991],[-118.282478,33.8794059991],[-118.282442,33.8785429991],[-118.282433,33.8783309991],[-118.282409,33.8777439991],[-118.282377,33.8769879991],[-118.282344,33.8761879991],[-118.282316,33.8755149991],[-118.282303,33.8751989991],[-118.282284,33.8747309991],[-118.28228,33.8741269991],[-118.28222281,33.8739280612],[-118.28214,33.8736399991],[-118.282125,33.8732819991],[-118.282117,33.8730949991],[-118.282107,33.8728529991],[-118.282128,33.8728209991],[-118.282176228,33.8727472382],[-118.282247,33.8726389991],[-118.282192141,33.8726193439],[-118.28206,33.8725719991],[-118.281904,33.8726349991],[-118.281845,33.8726969991],[-118.281826,33.8726339991],[-118.281801,33.8725509991],[-118.281643,33.8720189991],[-118.281643,33.8719949991],[-118.281641,33.8717789991],[-118.281635,33.8711849991],[-118.281634,33.8711099991],[-118.281627,33.8702969991],[-118.281626816,33.8702777924],[-118.281618,33.8693569991],[-118.281618,33.8693309991],[-118.281613,33.8688959991],[-118.281606,33.8680739991],[-118.281605,33.8679779991],[-118.281599,33.8674019991],[-118.281596,33.8670439991],[-118.281593,33.8667789991],[-118.281589,33.8663659991],[-118.281588,33.8662549991],[-118.281583,33.8656999991],[-118.281576,33.8649689991],[-118.281567,33.8640519991],[-118.281556,33.8628769991],[-118.281555,33.8628019991],[-118.281605,33.8627801241],[-118.281635,33.8627669991],[-118.282176,33.8625279991],[-118.282348,33.8624579991],[-118.282921,33.8622359991],[-118.283262,33.8620929991],[-118.283428,33.8620189991],[-118.283853,33.8618299991],[-118.284058,33.8617379991],[-118.284258,33.8616489991],[-118.284766,33.8614219991],[-118.284901,33.8613619991],[-118.28516,33.8612469991],[-118.285363,33.8611559991],[-118.285334,33.8610139991],[-118.285314,33.8609159991],[-118.285136,33.8606839991],[-118.285140922,33.8606706756],[-118.285173098,33.860583586],[-118.285211,33.8604809991],[-118.285303,33.8605319991],[-118.285488,33.8606359991],[-118.285608418,33.8610228541],[-118.285615,33.8610439991],[-118.28594095,33.8608981997],[-118.286042,33.8608529991],[-118.286124,33.8608159991],[-118.287416,33.8602399991],[-118.287881,33.8600329991],[-118.289429,33.8591869991],[-118.289566,33.8591259991],[-118.289709,33.8590619991],[-118.290522649,33.8586991557],[-118.290523,33.8586989991],[-118.290522882,33.858579793],[-118.290522,33.8576929991],[-118.290521,33.8567959991],[-118.290521,33.8566539991],[-118.29052,33.8561289991],[-118.29052,33.8560899991],[-118.290519685,33.8557961562],[-118.290518444,33.8546371508],[-118.290518001,33.8542238376],[-118.290518,33.8542229991],[-118.290509479,33.8542229373],[-118.289829,33.8542179991],[-118.288935969,33.8542242364],[-118.288397,33.8542279991],[-118.288185,33.8542279991],[-118.287615,33.8542309991],[-118.28736,33.8542309991],[-118.287018,33.8542329991],[-118.286903,33.8542319991],[-118.285999,33.8542289991],[-118.285999112,33.8542249739],[-118.286001,33.8541569991],[-118.285268794,33.8541569991],[-118.285254,33.8541569991],[-118.285275,33.8522499991],[-118.286013711,33.8522480577],[-118.286036,33.8522479991],[-118.286035,33.8521499991],[-118.286029,33.8516609991],[-118.286025427,33.8514864997],[-118.286023,33.8513679991],[-118.286001,33.8503869991],[-118.286007,33.8501179991],[-118.286021,33.8494579991],[-118.286021,33.8493849991],[-118.286022,33.8492069991],[-118.286023,33.8483239991],[-118.286022,33.8473949991],[-118.286022,33.8471919991],[-118.286022,33.8469319991],[-118.286022,33.8468399991],[-118.286016995,33.8462530058],[-118.285572972,33.8462490055],[-118.285181972,33.8462530055],[-118.284966912,33.8462416431],[-118.28491699,33.8462390052],[-118.284990972,33.8458300055],[-118.285177972,33.8449980055],[-118.285237972,33.8447710055],[-118.285253972,33.8447090055],[-118.285270972,33.8446450055],[-118.285656972,33.8431760055],[-118.285878972,33.8423450055],[-118.285936972,33.8421280055],[-118.285938972,33.8420730055],[-118.286003972,33.8418760055],[-118.286305972,33.8406190055],[-118.286671972,33.8390940055],[-118.287054972,33.8376080055],[-118.287144972,33.8371360055],[-118.287202972,33.8359950055],[-118.287225972,33.8355320055],[-118.287229972,33.8354590055],[-118.287229972,33.8351950055],[-118.287230972,33.8343010055],[-118.287230972,33.8334070055],[-118.287231972,33.8324120055],[-118.287231972,33.8315960055],[-118.287225972,33.8304070055],[-118.287223972,33.8297700055],[-118.287237972,33.8285260055],[-118.287242972,33.8281230055],[-118.287244972,33.8279180055],[-118.287245972,33.8278150055],[-118.287236972,33.8269540055],[-118.287225972,33.8257970055],[-118.287226972,33.8256690055],[-118.287232972,33.8245270055],[-118.287230972,33.8245080055],[-118.287226972,33.8244510055],[-118.287227972,33.8243830055],[-118.287236972,33.8240560055],[-118.287243972,33.8238150055],[-118.287241972,33.8235040055],[-118.287239972,33.8230540055],[-118.287237972,33.8226190055],[-118.287234972,33.8221710055],[-118.287233972,33.8218180055],[-118.287228972,33.8215200055],[-118.287222972,33.8211580055],[-118.287193972,33.8194700055],[-118.287190972,33.8189570055],[-118.287181972,33.8173680055],[-118.287179972,33.8169730055],[-118.287176972,33.8167250055],[-118.287170972,33.8161540055],[-118.287164972,33.8155410055],[-118.287156972,33.8147990055],[-118.287189972,33.8124500055],[-118.287224972,33.8115320055],[-118.287243972,33.8110370055],[-118.287279972,33.8102480055],[-118.287327972,33.8098620055],[-118.287376972,33.8096010055],[-118.287453972,33.8091910055],[-118.287476972,33.8090940055],[-118.287507972,33.8089590055],[-118.287651972,33.8083290055],[-118.287683972,33.8081900055],[-118.288116972,33.8062230055],[-118.288275972,33.8055260055],[-118.288492972,33.8045800055],[-118.288565972,33.8042680055],[-118.288709972,33.8036590055],[-118.288841972,33.8029310055],[-118.288881972,33.8024600055],[-118.288874972,33.8019670055],[-118.288840972,33.8015190055],[-118.288766972,33.8010890055],[-118.288601972,33.8005460055],[-118.288375972,33.7999700055],[-118.288151972,33.7995580055],[-118.288099972,33.7994750055],[-118.287964972,33.7992590055],[-118.287651972,33.7987800055],[-118.287492972,33.7986060055],[-118.287026972,33.7981160055],[-118.286781972,33.7978590055],[-118.286736978,33.7978180025],[-118.286454,33.7978169991],[-118.286256,33.7978269991],[-118.285939055,33.7977813955],[-118.2857,33.7977469991],[-118.28293,33.7976309991],[-118.282938,33.7977069991],[-118.282989,33.7981699991],[-118.282991,33.7981859991],[-118.282994382,33.7982169991],[-118.282997,33.7982409991],[-118.282706,33.7982559991],[-118.280961,33.7983449991],[-118.279943,33.7983969991],[-118.278845,33.7984529991],[-118.277289,33.7985329991],[-118.276363,33.7985799991],[-118.275354,33.7986319991],[-118.275295,33.7986349991],[-118.275234,33.7986379991],[-118.275024,33.7986489991],[-118.274783,33.7986569991],[-118.27454,33.7986589991],[-118.274354,33.7986549991],[-118.274109,33.7986519991],[-118.273887029,33.7986568037],[-118.273878,33.7986569991],[-118.273592,33.7986719991],[-118.273204,33.7986909991],[-118.272613,33.7987209991],[-118.271386,33.7987839991],[-118.270437027,33.7988169991],[-118.270386392,33.7988187599],[-118.270322,33.7988209991],[-118.269411,33.7988509991],[-118.268501,33.7988969991],[-118.267592,33.7989439991],[-118.267441,33.7989809991],[-118.267295,33.7990169991],[-118.267283,33.7990199991],[-118.266551,33.7990569991],[-118.266343,33.7990679991],[-118.265883,33.7990619991],[-118.265871,33.7990619991],[-118.265432026,33.7990840512],[-118.265234,33.7990939991],[-118.264787242,33.7991169991],[-118.264593,33.7991269991],[-118.264503214,33.7991319324],[-118.264502,33.7991319991],[-118.264488,33.7994209991],[-118.264456,33.7999989991],[-118.264402,33.8009749991],[-118.26440423,33.8010126312],[-118.264507,33.8027469991],[-118.264544391,33.8035248252],[-118.264593,33.8045359991],[-118.264603,33.8046969991],[-118.264488949,33.8047005632],[-118.264411,33.8047029991],[-118.264028,33.8047059991],[-118.263977,33.8047029991],[-118.263966,33.8047019991],[-118.263721,33.8047079991],[-118.263361,33.8047049991],[-118.263143,33.8046869991],[-118.263091,33.8046779991],[-118.262785,33.8046239991],[-118.2627472,33.8046169991],[-118.262677,33.8046039991],[-118.262448,33.8045629991],[-118.262259,33.8045119991],[-118.26226,33.8046009991],[-118.262261,33.8046159991],[-118.262225172,33.8046169991],[-118.261222,33.8046449991],[-118.261168,33.8046439991],[-118.260936668,33.8046504156],[-118.260483,33.8046629991],[-118.260106,33.8046739991],[-118.260085,33.8046739991],[-118.259592,33.8046879991],[-118.25899689,33.80470451],[-118.258763,33.8047109991],[-118.257933,33.8047339991],[-118.256674,33.8047689991],[-118.256512,33.8047739991],[-118.256532665,33.8047169991],[-118.256764315,33.8040780437],[-118.257116,33.8031079991],[-118.257529,33.8019689991],[-118.258122873,33.8003306608],[-118.258445,33.7994419991],[-118.258395532,33.7994445206],[-118.256797,33.7995259991],[-118.256592,33.7995359991],[-118.254625,33.7996369991],[-118.254452,33.7996869991],[-118.254232,33.7996979991],[-118.252876,33.7997639991],[-118.247542955,33.8000395644],[-118.246025,33.8001179991],[-118.24599,33.8000729991],[-118.245971,33.8000479991],[-118.244196,33.8001329991],[-118.238872,33.8003859991],[-118.23839,33.8004369991],[-118.23788,33.8004619991],[-118.23751,33.8004799991],[-118.237482,33.8004809991],[-118.237446,33.8004419991],[-118.235406,33.7982589991],[-118.234812,33.7976249991],[-118.233678,33.7964159991],[-118.233659,33.7963879991],[-118.233616,33.7963849991],[-118.233608,33.7963379991],[-118.233548,33.7962769991],[-118.233477,33.7962019991],[-118.233228,33.7959359991],[-118.230493,33.7930189991],[-118.230261,33.7927719991],[-118.230189081,33.7929077968],[-118.2301,33.7930759991],[-118.229836,33.7935539991],[-118.229658,33.7940019991],[-118.22945,33.7943279991],[-118.229243,33.7946549991],[-118.22905,33.7949599991],[-118.228856,33.7952639991],[-118.228486758,33.7962593175],[-118.228337,33.7966629991],[-118.228278445,33.796962373],[-118.228195,33.7973889991],[-118.227988279,33.797941681],[-118.227181,33.8000999991],[-118.224568,33.8043359991],[-118.224432,33.8045859991],[-118.224313,33.8048419991],[-118.2243,33.8048729991],[-118.224286,33.8048889991],[-118.224255,33.8049679991],[-118.224249393,33.804981883],[-118.224213,33.8050719991],[-118.224186,33.8051409991],[-118.224099,33.8054059991],[-118.224093437,33.8054273752],[-118.224029,33.8056749991],[-118.223976,33.8059459991],[-118.22394,33.8062189991],[-118.223926,33.8064229991],[-118.224041475,33.8065705415],[-118.22528,33.8081529991],[-118.225373,33.8084579991],[-118.225387,33.8110079991],[-118.225390164,33.8110236257],[-118.225436,33.8112499991],[-118.225469,33.8114129991],[-118.225684,33.8124719991],[-118.226371,33.8158609991],[-118.227526,33.8215639991],[-118.227943,33.8235949991],[-118.228066,33.8241949991],[-118.228400732,33.824332875],[-118.228503,33.8243749991],[-118.228439,33.8245479991],[-118.228326707,33.8248510511],[-118.228117,33.8254169991],[-118.228041,33.8256229991],[-118.228109,33.8256269991],[-118.228077,33.8257099991],[-118.22796237,33.8260110431],[-118.227772,33.8265109991],[-118.227765,33.8265299991],[-118.227743,33.8265879991],[-118.227152,33.8281399991],[-118.227112,33.8282429991],[-118.227027,33.8284669991],[-118.227003,33.828530051],[-118.226662754,33.829423931],[-118.226622,33.8295309991],[-118.226611,33.8294849991],[-118.226036,33.8280169991],[-118.225918768,33.8277034632],[-118.225142,33.8256259991],[-118.225072,33.8254389991],[-118.22499,33.8252219991],[-118.224932,33.8250679991],[-118.224875,33.8249129991],[-118.224761,33.8246069991],[-118.224676,33.8243809991],[-118.2245985,33.8243809991],[-118.224576,33.8243809991],[-118.224576,33.8242879991],[-118.224165,33.8242889991],[-118.222297,33.8242919991],[-118.222297,33.8244879991],[-118.222296,33.8251469991],[-118.222296,33.8252479991],[-118.222283,33.8253479991],[-118.222283,33.8258139991],[-118.218885,33.8256819991],[-118.21747,33.8258989991],[-118.21592,33.8260589991],[-118.215762,33.8260749991],[-118.21578,33.8261309991],[-118.215834,33.8262799991],[-118.216083,33.8270509991],[-118.216286,33.8276899991],[-118.216389,33.8280319991],[-118.216477,33.8283249991],[-118.216781,33.8294289991],[-118.216846,33.8298089991],[-118.216875,33.8301519991],[-118.216876,33.8303599991],[-118.216881,33.8308459991],[-118.216881,33.8309589991],[-118.216881,33.8310809991],[-118.216882,33.8314769991],[-118.216847,33.8317149991],[-118.216831,33.8317629991],[-118.216661,33.8323639991],[-118.216601,33.8325289991],[-118.216655,33.8325519991],[-118.216453,33.8331259991],[-118.216411,33.8332339991],[-118.216136,33.8339489991],[-118.215968,33.8343839991],[-118.215509,33.8344139991],[-118.213191,33.8344209991],[-118.213074,33.8346429991],[-118.212658,33.8354599991],[-118.212452,33.8357629991],[-118.212204,33.8361119991],[-118.211842,33.8365909991],[-118.211798,33.8366359991],[-118.211455,33.8377039991],[-118.211262,33.8383069991],[-118.208252,33.8391839991],[-118.207353,33.8394199991],[-118.207332,33.8394189991],[-118.207302,33.8395269991],[-118.206755,33.8414649991],[-118.206322,33.8429999991],[-118.206251,33.8432659991],[-118.206185,33.8435109991],[-118.206177,33.8435399991],[-118.206135,33.8436949991],[-118.206094,33.8438509991],[-118.205784,33.8450059991],[-118.205671,33.8454949991],[-118.205661,33.8455499991],[-118.205585,33.8459569991],[-118.205518,33.8464219991],[-118.205496,33.8466229991],[-118.205744,33.8466239991],[-118.206032,33.8465659991],[-118.206791,33.8465679991],[-118.207118,33.8465679991],[-118.208606,33.8465539991],[-118.208824,33.8465549991],[-118.209028,33.8465559991],[-118.209233,33.8465559991],[-118.209638,33.8465579991],[-118.210118,33.8465579991],[-118.210241,33.8465579991],[-118.210309,33.8465579991],[-118.211697,33.8465579991],[-118.212409,33.8465569991],[-118.213861,33.8465539991],[-118.213889,33.8465539991],[-118.214473,33.8465519991],[-118.214641,33.8465519991],[-118.214837,33.8465509991],[-118.215458,33.8465549991],[-118.215878,33.8465579991],[-118.215925,33.8465589991],[-118.217168,33.8465709991],[-118.217335,33.8465729991],[-118.217769,33.8465609991],[-118.217867,33.8465589991],[-118.217977,33.8465559991],[-118.218366,33.8465449991],[-118.219959,33.8465699991],[-118.220211,33.8465719991],[-118.220345,33.8465719991],[-118.220399,33.8465719991],[-118.220554,33.8465729991],[-118.220605,33.8465729991],[-118.221188,33.8465739991],[-118.221277,33.8465749991],[-118.222664,33.8465759991],[-118.223767,33.8465809991],[-118.225173,33.8465859991],[-118.226172,33.8465789991],[-118.227297,33.8465789991],[-118.228405,33.8465679991],[-118.229813,33.8465689991],[-118.230186,33.8465709991],[-118.232189,33.8465809991],[-118.232902,33.8465839991],[-118.233629,33.8466059991],[-118.233891,33.8466359991],[-118.233884427,33.8467367858],[-118.233882,33.8467739991],[-118.233893,33.8474899991],[-118.233928,33.8478459991],[-118.233953,33.8480879991],[-118.234019263,33.8481895546],[-118.234045,33.8482289991],[-118.234073247,33.848703315],[-118.234093,33.8490349991],[-118.234106,33.8491829991],[-118.234196,33.8502179991],[-118.234228,33.8506509991],[-118.234314,33.8520379991],[-118.234324,33.8521379991],[-118.23439,33.8527629991],[-118.234398,33.8528549991],[-118.234434,33.8532929991],[-118.234459607,33.8535832148],[-118.234467,33.8536669991],[-118.234482,33.8538439991],[-118.234525308,33.8544137419],[-118.234527,33.8544359991],[-118.234583,33.8551719991],[-118.234595,33.8553329991],[-118.234614,33.8555529991],[-118.234644,33.8559259991],[-118.234667,33.8561039991],[-118.234710079,33.8566075333],[-118.234728,33.8568169991],[-118.234788,33.8574489991],[-118.234825267,33.8579599495],[-118.234826,33.8579699991],[-118.234833,33.8580929991],[-118.234842047,33.8581547516],[-118.234856,33.8582499991],[-118.234874,33.8584879991],[-118.234942,33.8592629991],[-118.235001,33.8598779991],[-118.235032,33.8602389991],[-118.235039,33.8604129991],[-118.235108,33.8609299991],[-118.235109,33.8609809991],[-118.235115,33.8610359991],[-118.235152,33.8615109991],[-118.235193,33.8619179991],[-118.235193547,33.8619258448],[-118.235232,33.8624769991],[-118.235258,33.8632329991],[-118.23535,33.8642839991],[-118.235364,33.8645729991],[-118.235434,33.8655779991],[-118.235488,33.8661339991],[-118.235519,33.8663179991],[-118.235598,33.8672659991],[-118.235599777,33.8672997651],[-118.235602,33.8673419991]]]},properties:{Name:"Carson",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.187027,33.9054849991],[-118.186816,33.9066619991],[-118.186775,33.9068929991],[-118.188785,33.9072079991],[-118.189315,33.9073399991],[-118.189446,33.9065059991],[-118.189516,33.9060609991],[-118.189712,33.9060849991],[-118.190195,33.9060999991],[-118.19019,33.9058189991],[-118.190756,33.9058719991],[-118.191868,33.9059769991],[-118.192885,33.9060719991],[-118.192992,33.9060809991],[-118.19359,33.9061329991],[-118.193753,33.9061469991],[-118.194731,33.9062319991],[-118.195792,33.9063309991],[-118.195739,33.9064639991],[-118.194988,33.9083039991],[-118.194913,33.9084849991],[-118.194329,33.9098949991],[-118.19391,33.9108849991],[-118.193891,33.9109329991],[-118.194269,33.9110409991],[-118.19445,33.9110899991],[-118.194632,33.9111379991],[-118.194876,33.9112029991],[-118.195038,33.9112479991],[-118.195122,33.9112719991],[-118.19615,33.9088339991],[-118.197149,33.9064679991],[-118.197694,33.9065229991],[-118.197894,33.9065439991],[-118.198486,33.9066009991],[-118.199219,33.9066679991],[-118.199485,33.9066249991],[-118.199947,33.9066729991],[-118.199979,33.9066769991],[-118.19878,33.9095789991],[-118.198387,33.9106789991],[-118.198631,33.9106799991],[-118.198726,33.9105609991],[-118.201862,33.9116639991],[-118.201928,33.9116769991],[-118.20204,33.9117009991],[-118.204768,33.9123629991],[-118.205827,33.9126219991],[-118.205996,33.9120349991],[-118.206262,33.9111049991],[-118.206408,33.9106189991],[-118.208945,33.9115009991],[-118.209034,33.9115329991],[-118.209552,33.9116969991],[-118.209582,33.9117059991],[-118.211106,33.9122379991],[-118.213839,33.9130609991],[-118.213922,33.9126029991],[-118.215665,33.9124259991],[-118.216797,33.9122269991],[-118.216921,33.9129459991],[-118.21695,33.9131129991],[-118.216969,33.9132489991],[-118.217227,33.9150099991],[-118.217386,33.9160169991],[-118.217437,33.9163269991],[-118.217522,33.9168209991],[-118.217738,33.9182549991],[-118.217801,33.9186249991],[-118.217863,33.9190429991],[-118.218051,33.9201969991],[-118.21809,33.9204289991],[-118.218171,33.9210489991],[-118.218184,33.9212299991],[-118.218184,33.9212379991],[-118.21866,33.9213139991],[-118.219625,33.9220869991],[-118.219959,33.9227509991],[-118.220006,33.9223179991],[-118.223971,33.9221919991],[-118.224093,33.9221999991],[-118.224287,33.9234179991],[-118.224608,33.9233139991],[-118.228827981,33.9227790019],[-118.228762972,33.9225140056],[-118.228597972,33.9218270056],[-118.228323972,33.9207300056],[-118.228033986,33.9198320007],[-118.224089986,33.9197990041],[-118.223957972,33.9189180056],[-118.223823972,33.9180160056],[-118.223689972,33.9171140056],[-118.223543972,33.9162080056],[-118.223392972,33.9153000056],[-118.223241972,33.9143880056],[-118.223183972,33.9140300056],[-118.223152972,33.9137530056],[-118.223097972,33.9134880056],[-118.222951972,33.9125850056],[-118.222807972,33.9115190056],[-118.222689972,33.9107880056],[-118.222668972,33.9106570056],[-118.222525972,33.9097570056],[-118.222370986,33.9088260027],[-118.222571986,33.9087880018],[-118.222618986,33.9087750015],[-118.222673985,33.9087510012],[-118.222710982,33.9087230075],[-118.222872993,33.9088330041],[-118.224812986,33.9090110007],[-118.225003986,33.9089820023],[-118.225035986,33.9089770017],[-118.225960986,33.9087370024],[-118.226521986,33.9085950024],[-118.227071986,33.9084550039],[-118.227346986,33.9084470014],[-118.227617986,33.9084030017],[-118.227496986,33.9081760022],[-118.228103979,33.9080150043],[-118.228269993,33.9082570008],[-118.228761986,33.9081460023],[-118.228646986,33.9079340021],[-118.229050986,33.9078260025],[-118.230165979,33.9075440042],[-118.230220986,33.9076170024],[-118.230370993,33.9078130008],[-118.230490986,33.9077860025],[-118.230656986,33.9077520021],[-118.230508986,33.9074630017],[-118.231030986,33.9072860047],[-118.231038986,33.9072860008],[-118.231624986,33.9071530019],[-118.232530986,33.9068860025],[-118.233518986,33.9066140024],[-118.234515986,33.9063430023],[-118.235875986,33.9059550043],[-118.235998986,33.9059540023],[-118.236103979,33.9059520018],[-118.236106986,33.9062950024],[-118.236109986,33.9070320024],[-118.236094986,33.9076910024],[-118.236104986,33.9084010024],[-118.236107986,33.9091210024],[-118.236108986,33.9097860024],[-118.236101986,33.9104610024],[-118.236105986,33.9111470024],[-118.236109986,33.9118410024],[-118.236101986,33.9125180024],[-118.236096986,33.9132320024],[-118.236096993,33.9137530032],[-118.237786979,33.9137530016],[-118.237806993,33.9144060032],[-118.238274986,33.9144050024],[-118.238401979,33.9144050016],[-118.238458993,33.9162290031],[-118.239055979,33.9162240017],[-118.238979986,33.9165150024],[-118.238981986,33.9171330024],[-118.238983993,33.9177100034],[-118.239132986,33.9177130024],[-118.240295986,33.9177340024],[-118.245256987,33.9178579997],[-118.245382986,33.9174620028],[-118.246203986,33.9173180036],[-118.249013986,33.9173320022],[-118.249895986,33.9173120024],[-118.249994986,33.9173100027],[-118.250047986,33.9173110024],[-118.250836986,33.9173240023],[-118.254184986,33.9173240022],[-118.254340986,33.9173210019],[-118.254456986,33.9173110008],[-118.254457972,33.9171990056],[-118.254398972,33.9165160056],[-118.254400972,33.9163700056],[-118.254411972,33.9151550056],[-118.254421972,33.9139680056],[-118.254437972,33.9134750056],[-118.254448972,33.9131600056],[-118.254455986,33.9129320038],[-118.254684986,33.9129240024],[-118.260530986,33.9127150026],[-118.260926986,33.9127159999],[-118.260880972,33.9096260056],[-118.260908972,33.9095860056],[-118.260913972,33.9092050056],[-118.260917972,33.9091450056],[-118.260909972,33.9086770056],[-118.260907972,33.9086100056],[-118.260922972,33.9082020056],[-118.260921972,33.9077640056],[-118.260919972,33.9073090056],[-118.260916972,33.9064270056],[-118.260907972,33.9059910056],[-118.260912986,33.905567004],[-118.261737986,33.9055630024],[-118.262060986,33.9055610023],[-118.262630986,33.9055490024],[-118.263507986,33.9055310002],[-118.263658986,33.9023480032],[-118.263365986,33.9023670022],[-118.263043986,33.9023810024],[-118.262038986,33.9024280019],[-118.261872986,33.9024250028],[-118.261209986,33.9024580024],[-118.260915986,33.9024730024],[-118.260792986,33.9024790023],[-118.260318986,33.9024990024],[-118.259335986,33.9025410025],[-118.259050986,33.9025570024],[-118.258586986,33.9025840022],[-118.258428986,33.9025900024],[-118.257739986,33.9026180025],[-118.257480986,33.9026340022],[-118.256513986,33.9026730024],[-118.256214986,33.9026850026],[-118.255672986,33.9027210021],[-118.255515986,33.9027260023],[-118.255036986,33.9027400026],[-118.254522986,33.9027690024],[-118.254178986,33.9027880022],[-118.253603986,33.9028070038],[-118.253584972,33.9027440056],[-118.253436972,33.9025070056],[-118.253403972,33.9024100056],[-118.253322972,33.9021580056],[-118.253197972,33.9017020056],[-118.253170972,33.9016090056],[-118.252885972,33.9003400056],[-118.252806972,33.9000080056],[-118.252476972,33.8986270056],[-118.252269986,33.8976850038],[-118.252615986,33.8976740027],[-118.252715986,33.8976749998],[-118.252504972,33.8967270056],[-118.252395986,33.8964270036],[-118.252505986,33.8964210024],[-118.254347986,33.8963280027],[-118.256356986,33.8963290009],[-118.258302979,33.8959290037],[-118.258387993,33.8962950031],[-118.259417986,33.896289],[-118.259304972,33.8959160056],[-118.259124986,33.8953940039],[-118.259479986,33.8953900001],[-118.259460972,33.8952970056],[-118.259425972,33.8951670056],[-118.259403986,33.8950860032],[-118.259608986,33.8950630024],[-118.259822984,33.8950389992],[-118.260095986,33.8948290026],[-118.260246987,33.8947270045],[-118.260222972,33.8946230056],[-118.260020972,33.8937570056],[-118.259669972,33.8922840056],[-118.259190972,33.8904740056],[-118.259189986,33.8902710027],[-118.260392986,33.8900610018],[-118.259899986,33.8868270031],[-118.260772986,33.8867220012],[-118.260709972,33.8862310056],[-118.260694986,33.8861100038],[-118.261362991,33.8860910013],[-118.261256,33.8856229991],[-118.261161,33.8852339991],[-118.260231,33.8852199991],[-118.259841,33.8852479991],[-118.259878,33.8856169991],[-118.259366,33.8857079991],[-118.259392,33.8858529991],[-118.259466,33.8861459991],[-118.259462,33.8862119991],[-118.258714,33.8862289991],[-118.258325,33.8862419991],[-118.257605,33.8862679991],[-118.257213,33.8840009991],[-118.25802,33.8839749991],[-118.258141,33.8839719991],[-118.261118,33.8814729991],[-118.261306,33.8813429991],[-118.261336,33.8811629991],[-118.261512,33.8801119991],[-118.260814,33.8801819991],[-118.259972,33.8800589991],[-118.259098,33.8799619991],[-118.253376,33.8801159991],[-118.253666,33.8817169991],[-118.248741,33.8817169991],[-118.248735,33.8805929991],[-118.248734,33.8804149991],[-118.24866,33.8804169991],[-118.248226,33.8804279991],[-118.247298,33.8804519991],[-118.247424,33.8789119991],[-118.248642,33.8788129991],[-118.248641,33.8776339991],[-118.248633,33.8763789991],[-118.248628,33.8755819991],[-118.248628,33.8754749991],[-118.248625,33.8750469991],[-118.248618,33.8746019991],[-118.248618,33.8745509991],[-118.248611,33.8739789991],[-118.248608,33.8735089991],[-118.248606,33.8732939991],[-118.248602,33.8728129991],[-118.248599,33.8722269991],[-118.248602,33.8721639991],[-118.248619,33.8718409991],[-118.248629,33.8718149991],[-118.248674,33.8716969991],[-118.248674,33.8713099991],[-118.248674,33.8710429991],[-118.248673,33.8709869991],[-118.248664,33.8703649991],[-118.24866,33.8700799991],[-118.248431,33.8700459991],[-118.244139,33.8701859991],[-118.242399,33.8698939991],[-118.242077,33.8677399991],[-118.24196,33.8677409991],[-118.241781,33.8677459991],[-118.24109,33.8677639991],[-118.238853,33.8678239991],[-118.2379,33.8678619991],[-118.237807,33.8678659991],[-118.237616,33.8678719991],[-118.237212,33.8678859991],[-118.237131,33.8678869991],[-118.236734,33.8678929991],[-118.236589,33.8678939991],[-118.235634,33.8678999991],[-118.235602,33.8673419991],[-118.23412,33.8674009991],[-118.234127,33.8666419991],[-118.232386,33.8666679991],[-118.232382657,33.8665463161],[-118.232376,33.8663039991],[-118.232372,33.8655659991],[-118.232228,33.8654429991],[-118.232104383,33.8653081223],[-118.231955079,33.8651452195],[-118.231712,33.8648799991],[-118.231492388,33.8648263795],[-118.230942,33.8646919991],[-118.23093607,33.8646118472],[-118.230847,33.8634079991],[-118.230530018,33.863335559],[-118.229438,33.8630859991],[-118.226996442,33.8631342733],[-118.226808,33.8631379991],[-118.226807377,33.8631396936],[-118.226384,33.8642909991],[-118.225784,33.8681519991],[-118.224408628,33.8681890819],[-118.223707,33.8682079991],[-118.223587582,33.8682182802],[-118.223556,33.8682209991],[-118.22352,33.8682289991],[-118.223495996,33.8682289991],[-118.22348,33.8682289991],[-118.219354,33.8682199991],[-118.218625,33.8681729991],[-118.218658,33.8692479991],[-118.216183,33.8693169991],[-118.215823,33.8693159991],[-118.215561,33.8693209991],[-118.21543,33.8693219991],[-118.2153,33.8693239991],[-118.215198,33.8693259991],[-118.215095,33.8693269991],[-118.215095,33.8693339991],[-118.215181,33.8699989991],[-118.215498,33.8716759991],[-118.215544,33.8718019991],[-118.215564,33.8718459991],[-118.215907448,33.872278447],[-118.216166,33.8726039991],[-118.215982637,33.8726951041],[-118.215689,33.8728409991],[-118.215534,33.8729179991],[-118.215458,33.8729529991],[-118.215156,33.8729429991],[-118.214263,33.8729119991],[-118.207092493,33.8731839804],[-118.207092,33.8731839991],[-118.207079,33.8730389991],[-118.207034,33.8728159991],[-118.206986,33.8726139991],[-118.20678,33.8719269991],[-118.206714422,33.8717080345],[-118.206662,33.8715329991],[-118.206321,33.8703429991],[-118.206233,33.8703489991],[-118.205777,33.8703819991],[-118.20574,33.8703849991],[-118.205666,33.8703899991],[-118.205603,33.8712159991],[-118.205603,33.8720159991],[-118.205703,33.8724159991],[-118.205803,33.8726159991],[-118.205895,33.8728939991],[-118.205862,33.8730619991],[-118.205803,33.8733019991],[-118.205599,33.8741339991],[-118.205607,33.8742859991],[-118.207155,33.8742689991],[-118.207155,33.8743939991],[-118.207157,33.8747169991],[-118.207925,33.8748029991],[-118.207963,33.8742649991],[-118.208016,33.8742649991],[-118.20824,33.8742639991],[-118.208236,33.8747849991],[-118.208238,33.8748249991],[-118.208566,33.8748569991],[-118.208488,33.8751799991],[-118.208495,33.8759779991],[-118.208494,33.8768149991],[-118.2085,33.8783249991],[-118.208513,33.8797759991],[-118.208616,33.8806609991],[-118.208664,33.8806599991],[-118.208898,33.8806529991],[-118.208897,33.8808269991],[-118.208896,33.8812919991],[-118.208741,33.8812929991],[-118.208673,33.8812969991],[-118.208079,33.8813059991],[-118.207199,33.8813119991],[-118.207172,33.8813119991],[-118.205206,33.8813199991],[-118.20485,33.8813219991],[-118.204201,33.8813729991],[-118.203675,33.8813799991],[-118.201585,33.8813899991],[-118.200557,33.8813959991],[-118.199447,33.8813989991],[-118.198322,33.8814009991],[-118.197752,33.8814029991],[-118.197246,33.8814059991],[-118.196421,33.8814149991],[-118.194902,33.8814309991],[-118.194549,33.8814349991],[-118.193606,33.8814419991],[-118.193344,33.8814419991],[-118.193083,33.8814409991],[-118.192387,33.8814369991],[-118.191953,33.8811409991],[-118.191884,33.8810939991],[-118.191626,33.8809169991],[-118.191552,33.8809399991],[-118.191479,33.8809639991],[-118.190069,33.8814119991],[-118.189327,33.8813689991],[-118.189123,33.8813599991],[-118.188816,33.8813459991],[-118.188368,33.8813249991],[-118.188046,33.8829979991],[-118.188041,33.8830439991],[-118.188023,33.8832289991],[-118.187987,33.8836029991],[-118.187901,33.8838059991],[-118.187629,33.8852299991],[-118.188096,33.8852249991],[-118.188207,33.8852239991],[-118.187907,33.8868669991],[-118.187545,33.8886989991],[-118.187478,33.8890659991],[-118.187454,33.8891889991],[-118.187395,33.8895279991],[-118.187302,33.8900679991],[-118.18713,33.8910699991],[-118.187082,33.8913519991],[-118.187036,33.8916139991],[-118.187033,33.8916329991],[-118.186971,33.8919919991],[-118.186897,33.8924199991],[-118.186462,33.8924089991],[-118.185774,33.8925119991],[-118.184299,33.8925189991],[-118.184169,33.8891369991],[-118.182402,33.8891059991],[-118.182252,33.8893309991],[-118.182047,33.8896559991],[-118.180961,33.8912189991],[-118.180836,33.8914149991],[-118.18071,33.8915709991],[-118.1806,33.8916239991],[-118.180075,33.8923459991],[-118.179962,33.8925369991],[-118.180049,33.8925399991],[-118.180518,33.8925419991],[-118.18159,33.8925449991],[-118.181631,33.8933569991],[-118.181634,33.8933949991],[-118.181687,33.8942649991],[-118.182356,33.8942519991],[-118.182315,33.8958569991],[-118.18231,33.8960339991],[-118.182306,33.8962119991],[-118.182478,33.8962109991],[-118.182807,33.8962079991],[-118.183821,33.8961909991],[-118.183962,33.8961929991],[-118.183959,33.8962489991],[-118.184643,33.8962459991],[-118.18496,33.8962459991],[-118.185351,33.8962389991],[-118.185623,33.8962359991],[-118.185896,33.8962339991],[-118.1861,33.8948579991],[-118.186394,33.8948609991],[-118.186864,33.8948669991],[-118.187077,33.8948689991],[-118.18765,33.8948659991],[-118.187823,33.8948699991],[-118.188125585,33.8948761916],[-118.188149176,33.8947196985],[-118.188251018,33.8947188219],[-118.188488279,33.8947167743],[-118.188855705,33.8947136118],[-118.189010262,33.8947076142],[-118.189464905,33.8947044059],[-118.189589987,33.8966094284],[-118.189592529,33.8966654349],[-118.189612131,33.8969620452],[-118.189626002,33.8971395523],[-118.189635997,33.8972706968],[-118.189646636,33.8974106913],[-118.18965695,33.8975475238],[-118.189667269,33.8976823243],[-118.189677911,33.8978204762],[-118.189688225,33.8979579416],[-118.189698539,33.898095187],[-118.189709504,33.8982374619],[-118.189719818,33.8983746524],[-118.189730459,33.89851341],[-118.189740775,33.8986502705],[-118.189751097,33.8987829272],[-118.189761412,33.8989194857],[-118.189771729,33.8990552743],[-118.189780754,33.8991750683],[-118.189789137,33.8992852722],[-118.189799779,33.8994238369],[-118.189812028,33.8995867501],[-118.18982202,33.8997197904],[-118.189832338,33.899855195],[-118.189842982,33.8999927707],[-118.189853295,33.9001307852],[-118.189863609,33.9002680856],[-118.189874253,33.9004052215],[-118.189883927,33.9005323259],[-118.189886504,33.9005675856],[-118.18985289,33.9005675457],[-118.189405363,33.9005690737],[-118.189360873,33.9005692401],[-118.189434334,33.9016407957],[-118.189050691,33.9016417002],[-118.188676,33.9016949991],[-118.188679053,33.9015337961],[-118.188581504,33.9015348475],[-118.18854031,33.9015353204],[-118.188420352,33.901536606],[-118.188423058,33.901947177],[-118.188936071,33.9019421631],[-118.188934965,33.9020111905],[-118.188933477,33.9021120936],[-118.188931635,33.9022269293],[-118.189096414,33.9022255873],[-118.189477713,33.9022224147],[-118.189523283,33.9028123154],[-118.188923055,33.9028175921],[-118.188757946,33.9028190434],[-118.188588552,33.9028205166],[-118.188428385,33.9028219183],[-118.188345995,33.9028224518],[-118.18826657,33.9028233449],[-118.18810179,33.9028247957],[-118.188103511,33.9031690625],[-118.187934117,33.9031702319],[-118.187851726,33.9031707921],[-118.187770984,33.9031713542],[-118.18760884,33.9031724776],[-118.187464173,33.9031734644],[-118.18745131,33.903173552],[-118.18744145,33.9031580134],[-118.187349361,33.903003843],[-118.18683,33.9029809991],[-118.186927,33.9031089991],[-118.187135,33.9032519991],[-118.187194,33.9032789991],[-118.187352,33.9033519991],[-118.187603,33.9034159991],[-118.187783492,33.9034452914],[-118.187771204,33.9034289486],[-118.187770271,33.9034282397],[-118.187773567,33.9033958114],[-118.188104664,33.9034594131],[-118.188927249,33.9034550138],[-118.188927702,33.9035601061],[-118.189055,33.9035589991],[-118.189071,33.9036719991],[-118.189080008,33.9037332536],[-118.189125833,33.9037330979],[-118.189646991,33.9037268745],[-118.189666509,33.904006862],[-118.189670366,33.904064079],[-118.189679058,33.9041872255],[-118.189687103,33.9043024297],[-118.189696111,33.9044330232],[-118.189705127,33.9045583689],[-118.189713818,33.9046820094],[-118.189722506,33.9048066948],[-118.189731199,33.9049284674],[-118.189732165,33.9049422078],[-118.189733127,33.9049583948],[-118.189741172,33.9050735161],[-118.189749545,33.9051896827],[-118.189758873,33.9053256622],[-118.189763061,33.9053835945],[-118.189768212,33.9054581529],[-118.189776506,33.9055781257],[-118.189650376,33.905565165],[-118.189638,33.9056349991],[-118.189628,33.9056929991],[-118.18961,33.9057489991],[-118.189404,33.9057079991],[-118.18905,33.9056719991],[-118.188617,33.9056289991],[-118.187794,33.9055459991],[-118.187597,33.9055259991],[-118.187027,33.9054849991]],[[-118.200462122,33.9064225472],[-118.200100623,33.9063894769],[-118.198385578,33.9062326325],[-118.198379005,33.9061479942],[-118.19804811,33.9061530368],[-118.198051658,33.9062020917],[-118.19771983,33.9061717666],[-118.196721373,33.9060804236],[-118.196379684,33.9060460693],[-118.196388277,33.9060256368],[-118.196070387,33.9059366811],[-118.196035886,33.9060177063],[-118.19477098,33.9059003837],[-118.194777247,33.9058855463],[-118.194791804,33.9058502797],[-118.194387761,33.9057351912],[-118.194437577,33.9056126962],[-118.194523218,33.9053891515],[-118.194524303,33.9053857006],[-118.194525337,33.9053822019],[-118.194528697,33.9053707832],[-118.19453182,33.9053593181],[-118.194533427,33.9053529006],[-118.194534702,33.9053478091],[-118.194537343,33.9053362591],[-118.194539741,33.9053246734],[-118.194541896,33.9053130539],[-118.194543808,33.9053014049],[-118.194545476,33.9052897303],[-118.194546899,33.9052780326],[-118.194548077,33.9052663163],[-118.194549009,33.9052545851],[-118.194549697,33.9052428417],[-118.194550138,33.9052310897],[-118.194550333,33.9052193336],[-118.194550029,33.905197081],[-118.194540652,33.9050531378],[-118.194535611,33.9049778002],[-118.194531321,33.9049136959],[-118.194529392,33.9048845376],[-118.194520386,33.9047479809],[-118.194511376,33.904614283],[-118.194502374,33.9044755005],[-118.194493366,33.9043404556],[-118.194483712,33.9041974677],[-118.194479208,33.9041303848],[-118.194474706,33.9040611039],[-118.194469881,33.9039896068],[-118.194541317,33.903987385],[-118.194685752,33.9039828927],[-118.194718709,33.9039818857],[-118.194813627,33.9039789448],[-118.194888442,33.9039766125],[-118.194885756,33.9039207095],[-118.194877583,33.9037505776],[-118.194847866,33.9033917452],[-118.194843073,33.9032993535],[-118.194836041,33.9031646409],[-118.194833528,33.9031146466],[-118.194829336,33.9030312467],[-118.194821661,33.9028875199],[-118.194815399,33.90288754],[-118.194395199,33.9028893281],[-118.194390742,33.9028289115],[-118.194384894,33.9027496471],[-118.194052045,33.902748356],[-118.194062352,33.9028949994],[-118.194072013,33.9030327379],[-118.194081352,33.9031666841],[-118.194091013,33.9033044784],[-118.194096805,33.9033904686],[-118.194125055,33.9038025302],[-118.194133828,33.9039277922],[-118.194143163,33.9040644313],[-118.194147995,33.9041323394],[-118.194152501,33.9041990374],[-118.194162485,33.9043408709],[-118.194171819,33.9044783899],[-118.194181154,33.9046143421],[-118.19419082,33.9047500476],[-118.19419983,33.9048830036],[-118.194202083,33.9049160641],[-118.194202405,33.9049210661],[-118.194203363,33.904939946],[-118.194203961,33.9049771264],[-118.194203583,33.9050073261],[-118.194203219,33.9050283195],[-118.194202524,33.9050505223],[-118.194202177,33.9050608543],[-118.194200484,33.9050887167],[-118.19419846,33.9051167987],[-118.194195442,33.9051491933],[-118.194193099,33.9051714214],[-118.194190761,33.9051903796],[-118.194190096,33.9051934016],[-118.19418676,33.9052189263],[-118.194181434,33.9052511814],[-118.194176112,33.9052806885],[-118.194171459,33.9053051678],[-118.19416681,33.9053265963],[-118.194162162,33.9053476128],[-118.194157517,33.9053663755],[-118.194151878,33.9053887377],[-118.194106184,33.9055199824],[-118.194083967,33.9055749018],[-118.194053419,33.9056501197],[-118.193980372,33.9058278321],[-118.193305924,33.9057659326],[-118.192914714,33.9057300045],[-118.192480199,33.9056901415],[-118.192428507,33.9056853793],[-118.191995105,33.9056455821],[-118.191791793,33.9056269324],[-118.191362433,33.9055875169],[-118.191311028,33.9055828124],[-118.190684251,33.9055252706],[-118.190684176,33.9055240826],[-118.190680309,33.9054417853],[-118.190676615,33.9053846781],[-118.190669165,33.9053069023],[-118.190660477,33.905180596],[-118.190652111,33.9050597858],[-118.190644706,33.9049556017],[-118.190643739,33.9049419434],[-118.190643104,33.9049282305],[-118.190633445,33.9047912058],[-118.190624432,33.9046632502],[-118.190616069,33.9045398013],[-118.190607378,33.9044161328],[-118.190598689,33.9042906785],[-118.190590323,33.9041695663],[-118.190582923,33.9040619744],[-118.190663594,33.9040610386],[-118.19077638,33.9040597301],[-118.191171523,33.9040594819],[-118.191291484,33.9040594034],[-118.191678718,33.9040591714],[-118.191674854,33.9040043454],[-118.191662756,33.9038290077],[-118.191646125,33.9035879711],[-118.191960131,33.90358765],[-118.19192933,33.9031756947],[-118.191925137,33.9031200164],[-118.191904829,33.9028459381],[-118.191892582,33.9026791504],[-118.191871946,33.9024046598],[-118.191867436,33.9023419464],[-118.19184272,33.9020098733],[-118.191830039,33.9018411146],[-118.191804245,33.9014973144],[-118.191802959,33.9014777472],[-118.191779104,33.9011570327],[-118.191766851,33.9009940918],[-118.191734616,33.9005607557],[-118.191922459,33.9005592443],[-118.192103054,33.9005578072],[-118.19221655,33.9005568945],[-118.192493839,33.9005546649],[-118.19276244,33.9005525021],[-118.192977354,33.9005507762],[-118.193059741,33.9005501024],[-118.19315663,33.900549336],[-118.193221551,33.9005488073],[-118.193556046,33.900546117],[-118.193590649,33.9005458279],[-118.19389779,33.9005437377],[-118.193887117,33.9004195994],[-118.193874824,33.9002795492],[-118.193862851,33.9001451051],[-118.193850882,33.9000070342],[-118.193838266,33.8998631909],[-118.194174405,33.8998607495],[-118.194161838,33.8996861022],[-118.194151841,33.8995516604],[-118.194138614,33.8993773414],[-118.194128942,33.8992464176],[-118.194118625,33.8991061227],[-118.194108629,33.8989715979],[-118.194099284,33.8988416914],[-118.194088641,33.8986990603],[-118.194082815,33.8986209871],[-118.194078322,33.8985607704],[-118.19407316,33.8984925328],[-118.194068005,33.8984215194],[-118.193733516,33.8984249252],[-118.193404632,33.8984282814],[-118.193072121,33.8984316876],[-118.19308244,33.8985695097],[-118.193092755,33.8987098047],[-118.19310242,33.8988441093],[-118.193112412,33.8989802821],[-118.193122406,33.899115823],[-118.193128214,33.8991907119],[-118.193132724,33.8992538102],[-118.193142715,33.8993906429],[-118.193154963,33.8995578425],[-118.193172048,33.8997896804],[-118.193184626,33.8999566883],[-118.193194936,33.9000996491],[-118.193200097,33.9001682997],[-118.193205255,33.9002373892],[-118.193215246,33.900375101],[-118.193215567,33.9003798281],[-118.19314801,33.9003801887],[-118.192752551,33.900382257],[-118.192487264,33.9003836509],[-118.192104327,33.9003856492],[-118.192037758,33.9003859834],[-118.191664049,33.9003879638],[-118.191673719,33.9005184208],[-118.191676944,33.9005612378],[-118.190197055,33.9005664938],[-118.190173541,33.9005665778],[-118.190170967,33.9005298368],[-118.190162281,33.9004031727],[-118.190152627,33.900264747],[-118.190143298,33.9001286296],[-118.190133974,33.8999905334],[-118.19012432,33.8998517769],[-118.19011499,33.8997167044],[-118.190105984,33.8995849562],[-118.190094404,33.8994154753],[-118.190085399,33.8992835901],[-118.190077681,33.8991698152],[-118.190069315,33.899049143],[-118.190060311,33.8989164328],[-118.190050655,33.8987789682],[-118.19004165,33.8986467539],[-118.190031997,33.8985083274],[-118.190022673,33.8983697912],[-118.190013346,33.898232547],[-118.190003695,33.8980930774],[-118.18999404,33.8979550908],[-118.189984715,33.8978171866],[-118.189975387,33.8976813163],[-118.189966063,33.8975431651],[-118.189956733,33.8974074597],[-118.189947082,33.8972679622],[-118.189937378,33.8971301154],[-118.18994332,33.8969573831],[-118.1899224,33.8966598094],[-118.18991722,33.8966047889],[-118.189901863,33.8963311282],[-118.18990298,33.8961316339],[-118.189884,33.8957899991],[-118.189878935,33.8956982782],[-118.189773382,33.8940346166],[-118.189762985,33.8938707409],[-118.18975753,33.893783762],[-118.189752074,33.8936964801],[-118.18974662,33.8936089233],[-118.189740837,33.8935205971],[-118.189735384,33.8934321613],[-118.189729925,33.8933471324],[-118.189713236,33.8930821546],[-118.189707454,33.8929936355],[-118.189701999,33.8929065465],[-118.189679711,33.8925664414],[-118.189627975,33.8924310228],[-118.189488184,33.8904337006],[-118.189487775,33.8904280316],[-118.189477916,33.890290965],[-118.189475011,33.8902542552],[-118.189474511,33.8902479345],[-118.189462754,33.8900829563],[-118.189462346,33.8900773702],[-118.189461596,33.8900671015],[-118.189450514,33.8899153553],[-118.18945017,33.8899106562],[-118.189437961,33.8897392427],[-118.189437615,33.8897345337],[-118.189424444,33.8895545456],[-118.189423446,33.8895393025],[-118.189423021,33.8895334812],[-118.189581148,33.8895317126],[-118.189649603,33.8895309287],[-118.189748539,33.8895297958],[-118.190197004,33.8895247229],[-118.190245771,33.8895241492],[-118.190466919,33.8895216489],[-118.190686657,33.8895191477],[-118.190844163,33.889517355],[-118.191275492,33.8895124504],[-118.191300535,33.8895121771],[-118.191326237,33.8895118776],[-118.191740927,33.8895066632],[-118.193104606,33.8894916728],[-118.193137501,33.8894912983],[-118.193961992,33.8894819219],[-118.193958777,33.8894377684],[-118.193951679,33.8893402803],[-118.19393944,33.8891680514],[-118.193950972,33.8891679273],[-118.194057729,33.889166761],[-118.194117044,33.889166113],[-118.194364507,33.8891629059],[-118.194522013,33.8891608641],[-118.194708515,33.8891584679],[-118.195013121,33.8891545496],[-118.195010803,33.8891242051],[-118.195000379,33.8889877506],[-118.194999111,33.888971171],[-118.194982076,33.8887556934],[-118.19726843,33.8887417145],[-118.197538955,33.8924904125],[-118.19753727,33.8924904306],[-118.197468154,33.8924911732],[-118.1974539,33.8924913263],[-118.197471129,33.8928466569],[-118.197563066,33.8928456335],[-118.197771983,33.8928433409],[-118.197996012,33.8928408649],[-118.198116882,33.8928395291],[-118.198116989,33.8928427942],[-118.198123436,33.8929337585],[-118.198131499,33.8930442354],[-118.198132463,33.8930592135],[-118.198139231,33.8931547949],[-118.198146965,33.8932654364],[-118.198147932,33.8932789026],[-118.198154698,33.8933763258],[-118.19816243,33.8934874892],[-118.198164367,33.8935127998],[-118.198170492,33.893598928],[-118.198174035,33.8936500167],[-118.198178223,33.8937107514],[-118.198179836,33.8937324618],[-118.198186284,33.8938228772],[-118.198194014,33.8939351396],[-118.198195305,33.8939521509],[-118.198202074,33.8940472113],[-118.198211741,33.8941860491],[-118.198221409,33.894323293],[-118.19822721,33.8944055732],[-118.198232046,33.8944729583],[-118.198236883,33.8945402614],[-118.19824139,33.894607509],[-118.19824268,33.8946254273],[-118.198246225,33.8946747571],[-118.198251062,33.8947420881],[-118.198255898,33.8948095002],[-118.198259115,33.8948593246],[-118.198260404,33.8948770508],[-118.19826524,33.8949447659],[-118.198270076,33.8950125629],[-118.19827298,33.8950515326],[-118.198274911,33.8950805259],[-118.198279747,33.8951486259],[-118.198284582,33.8952168629],[-118.19828845,33.8952712217],[-118.198289416,33.8952852099],[-118.198294251,33.8953536399],[-118.198299085,33.8954221798],[-118.19830392,33.8954909118],[-118.198308754,33.8955596708],[-118.198313588,33.8956285397],[-118.198317454,33.8956838055],[-118.198337435,33.8959680224],[-118.198346548,33.8960973993],[-118.198441,33.8960969991],[-118.198823,33.8961009991],[-118.198841684,33.8961306356],[-118.19896018,33.8961294291],[-118.198986894,33.896518642],[-118.198989795,33.8965598095],[-118.199013485,33.8968972306],[-118.199023155,33.8970345295],[-118.199031211,33.897150393],[-118.199047322,33.897382613],[-118.199070525,33.8977161043],[-118.199080194,33.8978539252],[-118.199103722,33.8981893947],[-118.199127245,33.898528904],[-118.199136919,33.8986637571],[-118.199160117,33.8989998863],[-118.199183643,33.8993376367],[-118.199191662,33.8994768848],[-118.199216935,33.8998208005],[-118.199234888,33.9000710687],[-118.199251976,33.900317331],[-118.199257197,33.9003925568],[-118.199599302,33.9003880798],[-118.199617652,33.9003878396],[-118.199784405,33.9003856612],[-118.19979408,33.9005213932],[-118.199796016,33.9005477486],[-118.199803748,33.9006608359],[-118.199806975,33.9007047237],[-118.199813418,33.9007986568],[-118.199817935,33.9008606558],[-118.199823412,33.9009409297],[-118.199828894,33.9010174109],[-118.199833089,33.9010746829],[-118.199834056,33.901088397],[-118.199839855,33.9011735621],[-118.199842757,33.9012144826],[-118.199850817,33.9013282572],[-118.199852753,33.9013550517],[-118.199861778,33.9014849853],[-118.19986242,33.9014957854],[-118.199871768,33.9016286051],[-118.199317096,33.9016531884],[-118.1993238,33.9017912802],[-118.199323891,33.9017932508],[-118.199330494,33.9019351715],[-118.199612121,33.9019251482],[-118.199892082,33.9019151843],[-118.199900464,33.902034235],[-118.199901435,33.9020461073],[-118.199910779,33.902181592],[-118.1999111,33.9021877759],[-118.199343578,33.9022070959],[-118.199350122,33.9023427151],[-118.199355079,33.9024514932],[-118.199369511,33.9027023298],[-118.199383689,33.9030124525],[-118.199283921,33.9030131794],[-118.199006821,33.9030151983],[-118.198822597,33.9030165318],[-118.198641339,33.9030178683],[-118.198458103,33.9030192023],[-118.198263993,33.9030206063],[-118.198264963,33.9030315166],[-118.19808766,33.9030329395],[-118.197920902,33.9030342637],[-118.197746235,33.903035661],[-118.197752233,33.9034090606],[-118.197768472,33.9034947596],[-118.197779926,33.9035552057],[-118.197803216,33.9036781157],[-118.197816173,33.9038203641],[-118.197828478,33.9039576661],[-118.197989305,33.9039562806],[-118.198427298,33.9039524862],[-118.198430516,33.9040009619],[-118.198563989,33.9039999578],[-118.198696804,33.903998952],[-118.198826982,33.9039979701],[-118.198963751,33.9039969412],[-118.199095576,33.9039959618],[-118.199263654,33.9039946924],[-118.199405696,33.9039936137],[-118.199551694,33.9039925112],[-118.199685168,33.9039915058],[-118.199693749,33.9039914421],[-118.199810731,33.903990573],[-118.199818142,33.9040980534],[-118.20030245,33.9040943873],[-118.20035752,33.9048971955],[-118.200391998,33.9053997895],[-118.200425189,33.9058840434],[-118.200462122,33.9064225472]],[[-118.20053195,33.888229205],[-118.200568027,33.8887220393],[-118.19912354,33.8887307414],[-118.199091351,33.8882533974],[-118.199064616,33.8882534486],[-118.198850476,33.8882538582],[-118.198841283,33.8882538763],[-118.198699236,33.8882541563],[-118.198552937,33.8882544325],[-118.198404662,33.8882547344],[-118.198170404,33.8882551919],[-118.197941133,33.8852012459],[-118.197928728,33.8850360112],[-118.197928377,33.8850313337],[-118.197303893,33.8850352718],[-118.19699,33.8831279991],[-118.197371,33.8831249991],[-118.197863,33.8830279991],[-118.197883,33.8830239991],[-118.197831,33.8825559991],[-118.197805,33.8823219991],[-118.19732,33.8824209991],[-118.197276,33.8818139991],[-118.197777,33.8817719991],[-118.19806,33.8817479991],[-118.198344,33.8817249991],[-118.199471,33.8817169991],[-118.200572,33.8817219991],[-118.201466882,33.8816264292],[-118.201516149,33.8816261331],[-118.201714825,33.8816249209],[-118.201915476,33.8816237113],[-118.202085486,33.881622688],[-118.202258132,33.8816216663],[-118.202430119,33.8816206167],[-118.202600788,33.8816195934],[-118.202773763,33.8816185443],[-118.202950363,33.8816174987],[-118.203117407,33.8816164979],[-118.203289065,33.8816154467],[-118.203461382,33.8816144239],[-118.203660716,33.8816132091],[-118.203871581,33.881611952],[-118.204300343,33.8816110979],[-118.205315774,33.885053781],[-118.205392144,33.8853211015],[-118.205536692,33.8858262489],[-118.205641579,33.8861940643],[-118.205691728,33.8863697125],[-118.20576548,33.8866269449],[-118.206125989,33.8878881155],[-118.206134241,33.8880110742],[-118.206118,33.8880829991],[-118.20602,33.8881119991],[-118.204052,33.8881159991],[-118.203046,33.8881169991],[-118.202067,33.8881149991],[-118.202048,33.8878359991],[-118.201944,33.8863149991],[-118.200926,33.8863239991],[-118.200429,33.8863289991],[-118.200434251,33.8863986551],[-118.20039839,33.8863986673],[-118.200405807,33.8865017787],[-118.200415168,33.8866266018],[-118.200424847,33.8867584868],[-118.200433233,33.8868747624],[-118.200442267,33.8869978263],[-118.2004513,33.887122264],[-118.20046001,33.8872416177],[-118.200468395,33.8873580863],[-118.200478076,33.8874898613],[-118.200487757,33.8876204274],[-118.200496464,33.887742172],[-118.200506463,33.8878802679],[-118.20053195,33.888229205]]]},properties:{Name:"Compton",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.31391298,33.9164520001],[-118.314247,33.9164499991],[-118.314618,33.9164509991],[-118.314988,33.9164529991],[-118.3153,33.9164559991],[-118.315613,33.9164579991],[-118.317114,33.9164609991],[-118.317441,33.9164599991],[-118.317778,33.9164539991],[-118.318449,33.9164579991],[-118.319133,33.9164579991],[-118.319724,33.9164629991],[-118.32023,33.9164649991],[-118.320422,33.9164659991],[-118.32104,33.9164629991],[-118.321248,33.9164659991],[-118.321899,33.9164609991],[-118.32295,33.9164669991],[-118.323747,33.9164629991],[-118.324392,33.9164669991],[-118.325063,33.9164699991],[-118.325683,33.9164539991],[-118.325747,33.9164529991],[-118.32582,33.9164509991],[-118.325886,33.9164499991],[-118.326319,33.9164479991],[-118.326501,33.9164459991],[-118.326504,33.9164049991],[-118.326484,33.9158899991],[-118.326498,33.9155159991],[-118.326503,33.9149899991],[-118.3265,33.9142659991],[-118.326504,33.9134689991],[-118.326502,33.9128639991],[-118.326502,33.9128199991],[-118.326689,33.9128299991],[-118.326688221,33.9128217903],[-118.326643,33.9123449991],[-118.326611,33.9115119991],[-118.326556,33.9107369991],[-118.326549,33.9099539991],[-118.326574711,33.9092004735],[-118.326575,33.9091919991],[-118.326512,33.9091969991],[-118.326491,33.9086239991],[-118.326494,33.9082939991],[-118.326509,33.9082249991],[-118.326504,33.9079229991],[-118.326509,33.9069029991],[-118.32651,33.9066489991],[-118.326504,33.9063159991],[-118.326508,33.9060139991],[-118.326501,33.9058179991],[-118.326513,33.9055739991],[-118.326506,33.9048259991],[-118.326503,33.9046329991],[-118.326502,33.9042829991],[-118.3265,33.9041969991],[-118.326505,33.9034489991],[-118.326502,33.9029649991],[-118.326489,33.9024319991],[-118.326486,33.9021849991],[-118.32649,33.9019689991],[-118.326492,33.9019319889],[-118.326491972,33.9019320056],[-118.326491972,33.9017660056],[-118.326490972,33.9016090056],[-118.326490972,33.9014580056],[-118.326488972,33.9008180056],[-118.326502972,33.9006710056],[-118.326502972,33.9004160056],[-118.326511972,33.9001450056],[-118.326506972,33.8998220056],[-118.326509972,33.8993160056],[-118.326511972,33.8990980056],[-118.326507972,33.8983010056],[-118.326514972,33.8979820056],[-118.326512972,33.8975720056],[-118.326509972,33.8970540056],[-118.326506972,33.8966750056],[-118.326506972,33.8966660056],[-118.326517972,33.8965430056],[-118.326510972,33.8963980056],[-118.326508972,33.8956720056],[-118.326507972,33.8953720056],[-118.326511972,33.8949740056],[-118.326510972,33.8946850056],[-118.326507972,33.8937990056],[-118.326510972,33.8910280056],[-118.326517972,33.8904610056],[-118.326515972,33.8900180056],[-118.326506972,33.8892010056],[-118.326514972,33.8886750056],[-118.326496972,33.8874730056],[-118.326497972,33.8874070056],[-118.326498972,33.8873530056],[-118.326504972,33.8856020056],[-118.326504972,33.8850520056],[-118.326541972,33.8839900056],[-118.326508972,33.8834350056],[-118.32649199,33.8829160006],[-118.326488,33.8828209991],[-118.32541,33.8831569991],[-118.32302,33.8839019991],[-118.322058,33.8842009991],[-118.321589,33.8843479991],[-118.319772,33.8849139991],[-118.317818,33.8855229991],[-118.314024,33.8868949991],[-118.313476,33.8870609991],[-118.313269,33.8837679991],[-118.313208,33.8819459991],[-118.313206,33.8811609991],[-118.313205,33.8801279991],[-118.313207,33.8791679991],[-118.313206,33.8783319991],[-118.313245,33.8773689991],[-118.313258,33.8770669991],[-118.313262,33.8769659991],[-118.313267,33.8768529991],[-118.313263,33.8767269991],[-118.31321,33.8750519991],[-118.313206,33.8749309991],[-118.313143,33.8735459991],[-118.313119,33.8730149991],[-118.311519,33.8730149991],[-118.311403,33.8730149991],[-118.311287,33.8730169991],[-118.310014,33.8730379991],[-118.309121,33.8730529991],[-118.30912,33.8729439991],[-118.309123,33.8728099991],[-118.309058,33.8728069991],[-118.309,33.8728059991],[-118.308931,33.8715849991],[-118.308917,33.8713399991],[-118.308912,33.8712449991],[-118.308915,33.8711479991],[-118.308933,33.8706469991],[-118.308942,33.8703749991],[-118.308948,33.8701989991],[-118.308979,33.8693289991],[-118.308983,33.8692079991],[-118.308908,33.8674859991],[-118.308912,33.8673249991],[-118.308953,33.8656909991],[-118.30885,33.8656909991],[-118.308589,33.8656909991],[-118.308053,33.8656919991],[-118.307509,33.8656919991],[-118.306974,33.8656929991],[-118.306444,33.8656929991],[-118.305916,33.8656929991],[-118.305388,33.8656939991],[-118.304803,33.8656939991],[-118.304065,33.8656949991],[-118.30358,33.8656949991],[-118.303344,33.8656949991],[-118.302561,33.8656959991],[-118.300713,33.8656969991],[-118.299969,33.8656979991],[-118.29976,33.8656979991],[-118.299414,33.8656979991],[-118.29937,33.8656979991],[-118.299319,33.8656979991],[-118.299314,33.8658219991],[-118.299234,33.8680459991],[-118.299191,33.8692239991],[-118.299143,33.8705309991],[-118.299031,33.8704969991],[-118.29903,33.8705239991],[-118.299028,33.8705829991],[-118.297357,33.8705989991],[-118.297004,33.8706029991],[-118.296005,33.8706129991],[-118.295264,33.8706199991],[-118.295028,33.8706219991],[-118.294349,33.8706279991],[-118.294357,33.8705219991],[-118.294359245,33.8704732825],[-118.294404,33.8695019991],[-118.294432,33.8683429991],[-118.294448,33.8680219991],[-118.294456,33.8677499991],[-118.29447,33.8670559991],[-118.294483,33.8668029991],[-118.29449,33.8666209991],[-118.294499,33.8664699991],[-118.294999,33.8664699991],[-118.296545,33.8664679991],[-118.297771,33.8664679991],[-118.297816,33.8664629991],[-118.297926,33.8664509991],[-118.298063,33.8664219991],[-118.298064,33.8662819991],[-118.298068,33.8655529991],[-118.298042,33.8655529991],[-118.298024,33.8655529991],[-118.297806,33.8655526376],[-118.295009,33.8655479991],[-118.294965,33.8655479991],[-118.294948,33.8655469991],[-118.292542,33.8655459991],[-118.29197,33.8655449991],[-118.291814,33.8655649991],[-118.291754,33.8655799991],[-118.291636,33.8656189991],[-118.29154,33.8656639991],[-118.29143,33.8657339991],[-118.290633699,33.8663257912],[-118.290624,33.8663329991],[-118.290648319,33.8669002001],[-118.290658,33.8671259991],[-118.290619331,33.8671426308],[-118.290565,33.8671659991],[-118.290671,33.8689379991],[-118.290763,33.8704909991],[-118.290792,33.8709789991],[-118.290793,33.8709969991],[-118.290799,33.8710949991],[-118.290804,33.8711869991],[-118.290816,33.8713879991],[-118.290817,33.8714019991],[-118.290893,33.8726759991],[-118.290894,33.8726959991],[-118.290902,33.8728719991],[-118.290906,33.8729609991],[-118.290967,33.8742349991],[-118.290977,33.8744409991],[-118.290995,33.8748169991],[-118.291009,33.8751259991],[-118.291036,33.8757209991],[-118.291049,33.8759969991],[-118.291061,33.8762669991],[-118.291073,33.8765289991],[-118.291084,33.8767609991],[-118.291101,33.8771509991],[-118.291111,33.8773929991],[-118.291123,33.8776889991],[-118.291133,33.8779349991],[-118.291136,33.8780119991],[-118.291182,33.8791419991],[-118.291208,33.8797779991],[-118.291246,33.8806829991],[-118.291256,33.8809329991],[-118.291264,33.8811299991],[-118.291283,33.8815919991],[-118.291308,33.8821969991],[-118.291309,33.8822179991],[-118.291314,33.8823409991],[-118.291238,33.8825009991],[-118.29132,33.8824979991],[-118.291331,33.8827479991],[-118.291363,33.8833059991],[-118.291391,33.8841459991],[-118.2914,33.8844329991],[-118.291432,33.8852159991],[-118.291582,33.8888429991],[-118.291726,33.8924779991],[-118.291778,33.8938049991],[-118.291788,33.8941209991],[-118.291771,33.8942019991],[-118.291689,33.8945879991],[-118.291684,33.8964489991],[-118.291682,33.8968779991],[-118.29168,33.8975919991],[-118.291678,33.8982929991],[-118.291676,33.8989739991],[-118.291674,33.8996999991],[-118.291667,33.9019119991],[-118.291663,33.9032709991],[-118.29166,33.9045949991],[-118.291659,33.9047849991],[-118.291646,33.9091609991],[-118.291644,33.9097739991],[-118.291667,33.9100719991],[-118.291714,33.9112769991],[-118.291735,33.9124509991],[-118.291744,33.9133549991],[-118.291707,33.9143609991],[-118.291714,33.9153929991],[-118.291710995,33.916436001],[-118.291804986,33.9164250032],[-118.292846986,33.9164250024],[-118.293864986,33.9164270024],[-118.294008986,33.9164270024],[-118.294301986,33.9164280024],[-118.295106986,33.9164310023],[-118.295718986,33.9164240025],[-118.296359986,33.9164260025],[-118.297010986,33.9164350023],[-118.298603986,33.9164320023],[-118.299221986,33.9164260025],[-118.299761986,33.9164270024],[-118.300362986,33.9164260026],[-118.300689986,33.9164340024],[-118.301017986,33.9164410022],[-118.301509986,33.9164420024],[-118.302309986,33.9164470023],[-118.303703986,33.9164460024],[-118.304527986,33.9164450024],[-118.304858986,33.9164440024],[-118.305257986,33.9164450026],[-118.305400986,33.9164490021],[-118.305743986,33.9164430026],[-118.306596986,33.9164530021],[-118.306738986,33.9164490026],[-118.307485986,33.9164520023],[-118.307806986,33.9164510023],[-118.308100986,33.9164480026],[-118.308394986,33.9164530021],[-118.308787986,33.9164410027],[-118.308996986,33.9164430023],[-118.309071986,33.9164430025],[-118.309147986,33.9164440024],[-118.309977986,33.9164580023],[-118.310132986,33.9164590023],[-118.312472986,33.9164480024],[-118.313715986,33.9164530023],[-118.31391298,33.9164520001]]]},properties:{Name:"Gardena",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.281206,33.9236149991],[-118.281805,33.9236119991],[-118.282406,33.9236149991],[-118.284706,33.9236149991],[-118.286806,33.9236149991],[-118.287906,33.9236149991],[-118.289006,33.9236149991],[-118.290106,33.9235149991],[-118.290706,33.9235149991],[-118.291306,33.9235149991],[-118.291306358,33.9235060398],[-118.291547536,33.923502086],[-118.291547563,33.9235020856],[-118.291582986,33.9233340024],[-118.291587986,33.9211220024],[-118.291591986,33.9200530024],[-118.291598986,33.9183760024],[-118.291601986,33.9175540024],[-118.291606982,33.9164220062],[-118.291710995,33.916436001],[-118.291714,33.9153929991],[-118.291707,33.9143609991],[-118.291744,33.9133549991],[-118.291735,33.9124509991],[-118.291714,33.9112769991],[-118.291667,33.9100719991],[-118.291644,33.9097739991],[-118.291646,33.9091609991],[-118.291659,33.9047849991],[-118.29166,33.9045949991],[-118.291663,33.9032709991],[-118.291667,33.9019119991],[-118.291674,33.8996999991],[-118.291676,33.8989739991],[-118.291678,33.8982929991],[-118.29168,33.8975919991],[-118.291682,33.8968779991],[-118.291684,33.8964489991],[-118.291689,33.8945879991],[-118.291771,33.8942019991],[-118.291788,33.8941209991],[-118.291778,33.8938049991],[-118.291726,33.8924779991],[-118.291582,33.8888429991],[-118.291432,33.8852159991],[-118.2914,33.8844329991],[-118.291391,33.8841459991],[-118.291363,33.8833059991],[-118.291331,33.8827479991],[-118.29132,33.8824979991],[-118.291238,33.8825009991],[-118.291314,33.8823409991],[-118.291309,33.8822179991],[-118.291308,33.8821969991],[-118.291283,33.8815919991],[-118.291264,33.8811299991],[-118.291256,33.8809329991],[-118.291246,33.8806829991],[-118.291208,33.8797779991],[-118.291182,33.8791419991],[-118.291136,33.8780119991],[-118.291133,33.8779349991],[-118.291123,33.8776889991],[-118.291111,33.8773929991],[-118.291101,33.8771509991],[-118.291084,33.8767609991],[-118.291073,33.8765289991],[-118.291061,33.8762669991],[-118.291049,33.8759969991],[-118.291036,33.8757209991],[-118.291009,33.8751259991],[-118.290995,33.8748169991],[-118.290977,33.8744409991],[-118.290967,33.8742349991],[-118.290906,33.8729609991],[-118.290902,33.8728719991],[-118.290894,33.8726959991],[-118.290893,33.8726759991],[-118.290817,33.8714019991],[-118.290816,33.8713879991],[-118.290804,33.8711869991],[-118.290799,33.8710949991],[-118.290793,33.8709969991],[-118.290792,33.8709789991],[-118.290763,33.8704909991],[-118.290671,33.8689379991],[-118.290565,33.8671659991],[-118.290619331,33.8671426308],[-118.290658,33.8671259991],[-118.290648319,33.8669002001],[-118.290624,33.8663329991],[-118.290633699,33.8663257912],[-118.29143,33.8657339991],[-118.29154,33.8656639991],[-118.291636,33.8656189991],[-118.291754,33.8655799991],[-118.291814,33.8655649991],[-118.29197,33.8655449991],[-118.292542,33.8655459991],[-118.294948,33.8655469991],[-118.294965,33.8655479991],[-118.295009,33.8655479991],[-118.297806,33.8655526376],[-118.298024,33.8655529991],[-118.298042,33.8655529991],[-118.298068,33.8655529991],[-118.298064,33.8662819991],[-118.298063,33.8664219991],[-118.297926,33.8664509991],[-118.297816,33.8664629991],[-118.297771,33.8664679991],[-118.296545,33.8664679991],[-118.294999,33.8664699991],[-118.294499,33.8664699991],[-118.29449,33.8666209991],[-118.294483,33.8668029991],[-118.29447,33.8670559991],[-118.294456,33.8677499991],[-118.294448,33.8680219991],[-118.294432,33.8683429991],[-118.294404,33.8695019991],[-118.294359245,33.8704732825],[-118.294357,33.8705219991],[-118.294349,33.8706279991],[-118.295028,33.8706219991],[-118.295264,33.8706199991],[-118.296005,33.8706129991],[-118.297004,33.8706029991],[-118.297357,33.8705989991],[-118.299028,33.8705829991],[-118.29903,33.8705239991],[-118.299031,33.8704969991],[-118.299143,33.8705309991],[-118.299191,33.8692239991],[-118.299234,33.8680459991],[-118.299314,33.8658219991],[-118.299319,33.8656979991],[-118.29937,33.8656979991],[-118.299414,33.8656979991],[-118.29976,33.8656979991],[-118.299969,33.8656979991],[-118.300713,33.8656969991],[-118.302561,33.8656959991],[-118.303344,33.8656949991],[-118.30358,33.8656949991],[-118.304065,33.8656949991],[-118.304803,33.8656939991],[-118.305388,33.8656939991],[-118.305916,33.8656929991],[-118.306444,33.8656929991],[-118.306974,33.8656929991],[-118.307509,33.8656919991],[-118.308053,33.8656919991],[-118.308589,33.8656909991],[-118.30885,33.8656909991],[-118.308892,33.8656079991],[-118.309148,33.8656079991],[-118.309148,33.8654409991],[-118.309148,33.8649829991],[-118.309148,33.8648049991],[-118.309148,33.8643089991],[-118.309148,33.8641389991],[-118.309148,33.8638399991],[-118.309148,33.8634449991],[-118.309149,33.8632559991],[-118.309149,33.8626479991],[-118.309149,33.8619779991],[-118.309149,33.8614569991],[-118.309149,33.8609969991],[-118.309149,33.8609499991],[-118.309149,33.8608609991],[-118.309149,33.8606269991],[-118.309149,33.8600429991],[-118.309149,33.8599519991],[-118.309149,33.8598519991],[-118.309149,33.8597589991],[-118.30915,33.8589019991],[-118.30915,33.8584589991],[-118.30915,33.8583479991],[-118.309279,33.8583479991],[-118.309361,33.8579529991],[-118.30938,33.8578399991],[-118.309401,33.8576679991],[-118.309412,33.8574389991],[-118.309403,33.8572069991],[-118.309399,33.8567569991],[-118.309379,33.8541989991],[-118.309358,33.8519459991],[-118.309324,33.8510389991],[-118.309318,33.8507659991],[-118.309307,33.8495139991],[-118.309292387,33.8476882556],[-118.30929,33.8473899991],[-118.309286,33.8468189991],[-118.309277,33.8456629991],[-118.309269,33.8447289991],[-118.309267338,33.8445347718],[-118.309264241,33.8441727427],[-118.309261,33.8437939991],[-118.309254,33.8428589991],[-118.309246,33.8418659991],[-118.309240741,33.8411981543],[-118.309238,33.8408499991],[-118.309237,33.8407589991],[-118.309232027,33.840158527],[-118.309217,33.8383439991],[-118.309211,33.8381719991],[-118.309216,33.8381099991],[-118.309212,33.8380379991],[-118.309211739,33.8380332173],[-118.309206,33.8379279122],[-118.309189,33.8376159991],[-118.309172,33.8373069991],[-118.309072,33.8354449991],[-118.30906,33.8344619991],[-118.309059,33.8344149991],[-118.309049,33.8335169991],[-118.309048,33.8334719991],[-118.309036,33.8324819991],[-118.309035,33.8324369991],[-118.309023,33.8314649991],[-118.30900935,33.8302725448],[-118.309009,33.8302419991],[-118.30900664,33.8302373148],[-118.308944,33.8301129991],[-118.308929,33.8290889991],[-118.308915,33.8279339991],[-118.308901,33.8267799991],[-118.308887,33.8256259991],[-118.308873,33.8244719991],[-118.308859,33.8233179991],[-118.308853,33.8228499991],[-118.308852,33.8227419991],[-118.308851,33.8226429991],[-118.308835,33.8213419991],[-118.308821,33.8201879991],[-118.308807,33.8190339991],[-118.308792,33.8169899991],[-118.30879235,33.8168775943],[-118.306928,33.8162419991],[-118.304505,33.8154159991],[-118.301505,33.8142159991],[-118.300693,33.8139339991],[-118.299205,33.8134159991],[-118.299205,33.8136264493],[-118.299257986,33.8136460023],[-118.299205,33.8151764712],[-118.299183986,33.8157840023],[-118.299142986,33.8169540023],[-118.299073986,33.8189250023],[-118.299064986,33.8189850023],[-118.299072986,33.8193120023],[-118.299082986,33.8197420023],[-118.299070986,33.8198630023],[-118.299069986,33.8202150023],[-118.299069986,33.8202790023],[-118.299070986,33.8210710023],[-118.299071278,33.821352051],[-118.299071984,33.8219890029],[-118.299063807,33.822051228],[-118.299042983,33.8222100031],[-118.299071986,33.8223000023],[-118.299083986,33.8223520023],[-118.299112983,33.8224710031],[-118.299117138,33.8224951655],[-118.299157983,33.8227320031],[-118.299180986,33.8230220023],[-118.299181986,33.8233120023],[-118.299181983,33.8236130031],[-118.299182854,33.8240066351],[-118.299183983,33.8245060031],[-118.299184986,33.8247410023],[-118.299184986,33.8248940023],[-118.299184986,33.8253190023],[-118.299184986,33.8256960023],[-118.299185986,33.8263150023],[-118.299187986,33.8271850023],[-118.299188986,33.8278390023],[-118.299188986,33.8281130023],[-118.299189986,33.8285810023],[-118.299189986,33.8288950023],[-118.299190986,33.8299040023],[-118.299190986,33.8300050023],[-118.299190986,33.8303190023],[-118.299191986,33.8315490023],[-118.299192986,33.8321190023],[-118.299192986,33.8325340023],[-118.299192986,33.8329970023],[-118.299193986,33.8337080023],[-118.299194986,33.8344120023],[-118.299195983,33.8351160031],[-118.299195972,33.8351611384],[-118.299195981,33.8355710034],[-118.299196889,33.8360754457],[-118.299196983,33.8361210031],[-118.299197983,33.8372940031],[-118.299198445,33.8375241018],[-118.299198983,33.8377810031],[-118.299198986,33.8381810023],[-118.299198986,33.8386760023],[-118.299199986,33.8388400023],[-118.299201986,33.8410230023],[-118.299202986,33.8415580023],[-118.299202986,33.8419510023],[-118.299197986,33.8420190023],[-118.299199986,33.8424440023],[-118.299201986,33.8432840023],[-118.299196986,33.8436540023],[-118.299195986,33.8448580023],[-118.299194983,33.8452400031],[-118.299193278,33.8453932888],[-118.299190983,33.8456020031],[-118.299194986,33.8458690023],[-118.299204844,33.8462160029],[-118.299204986,33.8462210023],[-118.299206975,33.8463190009],[-118.299098986,33.8463230023],[-118.298283986,33.8463490021],[-118.297511986,33.8463420024],[-118.296847986,33.8463430023],[-118.295994986,33.8463340024],[-118.294341986,33.8463430022],[-118.293055986,33.8463230026],[-118.291945986,33.8463410022],[-118.291726986,33.8463389999],[-118.291674986,33.8463200023],[-118.291582981,33.846219002],[-118.291349986,33.8462270032],[-118.291203986,33.8462500017],[-118.290944986,33.8462690017],[-118.290609986,33.8462640042],[-118.290522986,33.8462860007],[-118.290370986,33.8462880026],[-118.289656986,33.8463290017],[-118.288569986,33.8462860024],[-118.288057987,33.8462716167],[-118.288057845,33.8462716127],[-118.287786986,33.8462640035],[-118.287672361,33.8462803773],[-118.287443986,33.8463130008],[-118.287172712,33.8462917372],[-118.287172628,33.8462917306],[-118.286499988,33.8462390066],[-118.286427984,33.8462999979],[-118.286016995,33.8462530058],[-118.286022,33.8468399991],[-118.286022,33.8469319991],[-118.286022,33.8471919991],[-118.286022,33.8473949991],[-118.286023,33.8483239991],[-118.286022,33.8492069991],[-118.286021,33.8493849991],[-118.286021,33.8494579991],[-118.286007,33.8501179991],[-118.286001,33.8503869991],[-118.286023,33.8513679991],[-118.286025427,33.8514864997],[-118.286029,33.8516609991],[-118.286035,33.8521499991],[-118.286036,33.8522479991],[-118.286013711,33.8522480577],[-118.285275,33.8522499991],[-118.285254,33.8541569991],[-118.285268794,33.8541569991],[-118.286001,33.8541569991],[-118.285999112,33.8542249739],[-118.285999,33.8542289991],[-118.286903,33.8542319991],[-118.287018,33.8542329991],[-118.28736,33.8542309991],[-118.287615,33.8542309991],[-118.288185,33.8542279991],[-118.288397,33.8542279991],[-118.288935969,33.8542242364],[-118.289829,33.8542179991],[-118.290509479,33.8542229373],[-118.290518,33.8542229991],[-118.290518001,33.8542238376],[-118.290518444,33.8546371508],[-118.290519685,33.8557961562],[-118.29052,33.8560899991],[-118.29052,33.8561289991],[-118.290521,33.8566539991],[-118.290521,33.8567959991],[-118.290522,33.8576929991],[-118.290522882,33.858579793],[-118.290523,33.8586989991],[-118.290522649,33.8586991557],[-118.289709,33.8590619991],[-118.289566,33.8591259991],[-118.289429,33.8591869991],[-118.287881,33.8600329991],[-118.287416,33.8602399991],[-118.286124,33.8608159991],[-118.286042,33.8608529991],[-118.28594095,33.8608981997],[-118.285615,33.8610439991],[-118.285608418,33.8610228541],[-118.285488,33.8606359991],[-118.285303,33.8605319991],[-118.285211,33.8604809991],[-118.285173098,33.860583586],[-118.285140922,33.8606706756],[-118.285136,33.8606839991],[-118.285314,33.8609159991],[-118.285334,33.8610139991],[-118.285363,33.8611559991],[-118.28516,33.8612469991],[-118.284901,33.8613619991],[-118.284766,33.8614219991],[-118.284258,33.8616489991],[-118.284058,33.8617379991],[-118.283853,33.8618299991],[-118.283428,33.8620189991],[-118.283262,33.8620929991],[-118.282921,33.8622359991],[-118.282348,33.8624579991],[-118.282176,33.8625279991],[-118.281635,33.8627669991],[-118.281605,33.8627801241],[-118.281555,33.8628019991],[-118.281556,33.8628769991],[-118.281567,33.8640519991],[-118.281576,33.8649689991],[-118.281583,33.8656999991],[-118.281588,33.8662549991],[-118.281589,33.8663659991],[-118.281593,33.8667789991],[-118.281596,33.8670439991],[-118.281599,33.8674019991],[-118.281605,33.8679779991],[-118.281606,33.8680739991],[-118.281613,33.8688959991],[-118.281618,33.8693309991],[-118.281618,33.8693569991],[-118.281626816,33.8702777924],[-118.281627,33.8702969991],[-118.281634,33.8711099991],[-118.281635,33.8711849991],[-118.281641,33.8717789991],[-118.281643,33.8719949991],[-118.281643,33.8720189991],[-118.281801,33.8725509991],[-118.281826,33.8726339991],[-118.281845,33.8726969991],[-118.281904,33.8726349991],[-118.28206,33.8725719991],[-118.282192141,33.8726193439],[-118.282247,33.8726389991],[-118.282176228,33.8727472382],[-118.282128,33.8728209991],[-118.282107,33.8728529991],[-118.282117,33.8730949991],[-118.282125,33.8732819991],[-118.28214,33.8736399991],[-118.28222281,33.8739280612],[-118.28228,33.8741269991],[-118.282284,33.8747309991],[-118.282303,33.8751989991],[-118.282316,33.8755149991],[-118.282344,33.8761879991],[-118.282377,33.8769879991],[-118.282409,33.8777439991],[-118.282433,33.8783309991],[-118.282442,33.8785429991],[-118.282478,33.8794059991],[-118.282488,33.8796489991],[-118.282508,33.8801469991],[-118.282536,33.8808169991],[-118.282546,33.8810469991],[-118.282579,33.8818399991],[-118.282616,33.8827319991],[-118.282617,33.8827609991],[-118.282724,33.8853389991],[-118.282728986,33.8854660012],[-118.282730986,33.8855260024],[-118.282763986,33.8863240024],[-118.282782986,33.8867660024],[-118.282790986,33.8869620024],[-118.282818986,33.8876350024],[-118.282848986,33.8883530024],[-118.282878986,33.8890900024],[-118.282908986,33.8898230024],[-118.282937986,33.8905070024],[-118.282958986,33.8910210024],[-118.282973986,33.8913880024],[-118.282984986,33.8916490024],[-118.283028986,33.8927220024],[-118.283051986,33.8932700024],[-118.283055986,33.8933660024],[-118.283059986,33.8934710024],[-118.283084986,33.8940640024],[-118.283089986,33.8941960024],[-118.283112986,33.8947470024],[-118.283116986,33.8948420024],[-118.283140986,33.8954290024],[-118.283148986,33.8956110024],[-118.283203986,33.8969480024],[-118.283200977,33.8969850058],[-118.283167988,33.8969960036],[-118.283140985,33.8970140012],[-118.282267995,33.8973149989],[-118.282262986,33.8987180024],[-118.282257986,33.9004610024],[-118.282256986,33.9009840024],[-118.282254,33.9018999991],[-118.282242986,33.9055150024],[-118.282232986,33.9091760024],[-118.282230986,33.9103610024],[-118.282229986,33.9106230024],[-118.282228986,33.9108700024],[-118.282227986,33.9113750024],[-118.282224986,33.9122970024],[-118.282221986,33.9133270024],[-118.282220986,33.9137070024],[-118.282211983,33.9143590032],[-118.282199034,33.9153108847],[-118.282197983,33.9153890032],[-118.282183983,33.9164230032],[-118.282172763,33.9172538544],[-118.282167983,33.9176090032],[-118.282163986,33.9179060024],[-118.282162986,33.9180730024],[-118.282159983,33.9182310032],[-118.282157436,33.9184009495],[-118.282150981,33.9188340035],[-118.282145135,33.9192627865],[-118.282139983,33.9196420032],[-118.282138986,33.9197340024],[-118.282127986,33.9205320024],[-118.282120986,33.9210370024],[-118.282120986,33.9214410024],[-118.282108986,33.9219460024],[-118.282098986,33.9225090024],[-118.282087986,33.9230900024],[-118.282085975,33.9232010001],[-118.281988238,33.9232010024],[-118.281958983,33.9232010046],[-118.281935989,33.9230930003],[-118.281638986,33.9231000024],[-118.281565788,33.9231015936],[-118.281500986,33.9231030024],[-118.281448996,33.9231040047],[-118.281396978,33.9231989988],[-118.281265278,33.9231990013],[-118.281215,33.9235499991],[-118.281206,33.9236149991]]]},properties:{Name:"Harbor Gateway",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.42561,33.9655119991],[-118.425657,33.9655699991],[-118.42811,33.9686119991],[-118.43031,33.9720119991],[-118.432011,33.9746109991],[-118.432211,33.9749109991],[-118.432192494,33.9749223849],[-118.432278298,33.9750050624],[-118.433520986,33.9743010023],[-118.433564987,33.9742740028],[-118.433610986,33.9742510022],[-118.451300979,33.9642310078],[-118.451429986,33.9644230024],[-118.451457986,33.9644610024],[-118.451481986,33.9645010024],[-118.451605986,33.9646850024],[-118.451662266,33.9647686091],[-118.45183101,33.9646680101],[-118.452908978,33.9641299989],[-118.453278999,33.9639470141],[-118.453512672,33.9638230321],[-118.451817532,33.9645195088],[-118.451811,33.9645109991],[-118.453588274,33.9637829193],[-118.453950014,33.9635909882],[-118.45401499,33.9635460048],[-118.454087016,33.9635100182],[-118.454327979,33.9633760152],[-118.454619976,33.9632260181],[-118.455268999,33.9628859862],[-118.455712992,33.9626750118],[-118.456494018,33.9623289821],[-118.457719985,33.9617659802],[-118.457982142,33.9616485188],[-118.458626018,33.9613600254],[-118.458920014,33.9612480143],[-118.459340016,33.9610379868],[-118.459911015,33.9607739794],[-118.46032402,33.9605769997],[-118.460458023,33.9604849812],[-118.460434979,33.9604190057],[-118.460382737,33.9603765593],[-118.460371003,33.9603670249],[-118.460299544,33.9604060401],[-118.460251994,33.9604320008],[-118.460140983,33.9604919786],[-118.459483016,33.9607940246],[-118.459101999,33.9609850065],[-118.458489016,33.9612550117],[-118.45826293,33.9611878341],[-118.457873108,33.961072005],[-118.457618667,33.9609964023],[-118.457476023,33.9609540179],[-118.457395,33.960873995],[-118.45754195,33.9608207016],[-118.457613454,33.96079477],[-118.457621022,33.9607920253],[-118.457648012,33.9607659824],[-118.457660007,33.9607389924],[-118.457659008,33.9607219986],[-118.457656009,33.9606980075],[-118.457640015,33.9606700179],[-118.457593979,33.9606359779],[-118.457562991,33.960624982],[-118.45754961,33.960624982],[-118.457534002,33.960624982],[-118.457490018,33.9606259816],[-118.457460976,33.9606389768],[-118.457412994,33.9606730168],[-118.45736801,33.9607070042],[-118.457320975,33.9607239979],[-118.457276991,33.9607439905],[-118.457216014,33.9607679816],[-118.457125995,33.9607729798],[-118.457050023,33.9608130176],[-118.456991992,33.9608590005],[-118.456952228,33.9608846942],[-118.456927016,33.960900985],[-118.45673998,33.9610059987],[-118.456667007,33.9610029998],[-118.45656999,33.9610960179],[-118.456435987,33.961165992],[-118.456317978,33.961219025],[-118.456267997,33.9612350191],[-118.456213017,33.9612290213],[-118.456132994,33.961192982],[-118.456070018,33.9611519972],[-118.456006988,33.9610930191],[-118.455849994,33.9609850065],[-118.455606979,33.9608110183],[-118.455362017,33.9606289805],[-118.455090012,33.9604389983],[-118.454811011,33.9602340216],[-118.454503019,33.9599980038],[-118.454219019,33.9597679837],[-118.453851997,33.9594230063],[-118.453717995,33.95927101],[-118.45344699,33.9590090018],[-118.453278,33.9588120222],[-118.453075022,33.9585790033],[-118.452943019,33.9583399866],[-118.45279802,33.958089974],[-118.452600987,33.9577849817],[-118.452361024,33.9574050173],[-118.452218024,33.9571879924],[-118.45211401,33.9569940117],[-118.452090019,33.9569149883],[-118.452050981,33.9568139731],[-118.451992003,33.956682022],[-118.451941021,33.9566109957],[-118.451827011,33.9565380227],[-118.451743989,33.9564879886],[-118.451681012,33.9564390068],[-118.451589994,33.956317999],[-118.451573,33.9562940079],[-118.451460989,33.9561440108],[-118.451301995,33.9559359827],[-118.451247015,33.9558129756],[-118.450984008,33.9555580175],[-118.450826014,33.9553689822],[-118.450733995,33.9552489741],[-118.450560007,33.9549429822],[-118.450439999,33.9547010192],[-118.450285003,33.9544630022],[-118.450052984,33.9540789866],[-118.449917982,33.9538149791],[-118.44967302,33.9534100239],[-118.44955701,33.9532670243],[-118.449456994,33.9531270235],[-118.449315994,33.9529359891],[-118.449150003,33.9526990243],[-118.448966019,33.9524069746],[-118.448822019,33.952145019],[-118.448726002,33.9518980053],[-118.448622988,33.9516899771],[-118.448354982,33.9511820074],[-118.448142008,33.9507819978],[-118.448051989,33.9504590122],[-118.448020001,33.9503050166],[-118.447973018,33.9502359896],[-118.447875002,33.9501610174],[-118.447828019,33.9501029862],[-118.447584004,33.9496769862],[-118.447339989,33.9492309936],[-118.447136012,33.948862025],[-118.447037996,33.948774005],[-118.446964024,33.9486949817],[-118.446916988,33.9486260072],[-118.446885,33.9485409861],[-118.446830021,33.948428975],[-118.446750997,33.9482990231],[-118.446665976,33.9481610216],[-118.446617994,33.9480919946],[-118.446559016,33.9480310172],[-118.446496986,33.9479749853],[-118.446453002,33.947849979],[-118.446438008,33.9477490164],[-118.446382976,33.9476679938],[-118.446323998,33.9476150134],[-118.446273016,33.9475299923],[-118.446116022,33.9473140197],[-118.445998013,33.9471720197],[-118.445909993,33.9470440145],[-118.445796982,33.9468689741],[-118.445712014,33.9467069815],[-118.445599003,33.9465559848],[-118.445499987,33.9464149844],[-118.445404023,33.9462419959],[-118.445372982,33.946150977],[-118.44529501,33.9460450163],[-118.445231981,33.9459589955],[-118.445189997,33.9458309903],[-118.445112026,33.9456959877],[-118.44506499,33.9455759795],[-118.444977023,33.945402991],[-118.444848018,33.9451940158],[-118.444792986,33.9450600128],[-118.444738006,33.9449130147],[-118.444630993,33.9447309769],[-118.44447,33.9445030087],[-118.444358989,33.9443139735],[-118.44415901,33.9439420061],[-118.443982023,33.9435859801],[-118.443839024,33.9432529982],[-118.443590011,33.9427610226],[-118.443457007,33.9425320022],[-118.443304011,33.9422839889],[-118.443193,33.9420620185],[-118.443078989,33.9417970114],[-118.442991022,33.941594981],[-118.442908,33.9413950025],[-118.442840025,33.9412729951],[-118.442786992,33.9411829758],[-118.442690975,33.9410199836],[-118.442647991,33.940892978],[-118.442633996,33.9408070099],[-118.442606007,33.940723988],[-118.442588014,33.940689001],[-118.442546976,33.9406550136],[-118.442512989,33.940635021],[-118.442461008,33.9406149758],[-118.442409974,33.9406139761],[-118.442368989,33.9406109773],[-118.442282022,33.9406039798],[-118.442226989,33.9405909847],[-118.442189003,33.9405749906],[-118.442149018,33.9405440021],[-118.442070995,33.9404970195],[-118.442008018,33.9404529832],[-118.441924996,33.940367015],[-118.44157602,33.9398270046],[-118.441362994,33.9394749772],[-118.441192005,33.9391699849],[-118.441038009,33.9389300212],[-118.440936994,33.9387359878],[-118.440783998,33.9384429911],[-118.440635,33.9381729859],[-118.440572024,33.9381020122],[-118.440528987,33.9380169911],[-118.440428024,33.9377429874],[-118.44037899,33.9376229792],[-118.440289023,33.9374389948],[-118.440207001,33.9372460136],[-118.440111984,33.9370269895],[-118.439974982,33.9368360077],[-118.439909006,33.9367379914],[-118.439850975,33.9366780136],[-118.439828983,33.9365759988],[-118.439825984,33.9365300158],[-118.439806991,33.9364479936],[-118.43975601,33.9363199884],[-118.439703977,33.936205978],[-118.439639001,33.9360970184],[-118.439563976,33.9359360254],[-118.439494002,33.9357819772],[-118.439456016,33.9356770161],[-118.439418977,33.9355789998],[-118.439380991,33.9354280031],[-118.439353002,33.9353129931],[-118.439290025,33.9351569983],[-118.439170017,33.9349319764],[-118.439063004,33.9347130049],[-118.438990978,33.9345430153],[-118.438934999,33.9344320038],[-118.438887017,33.9343209923],[-118.438787001,33.9341320097],[-118.438747582,33.934031339],[-118.438703979,33.933919983],[-118.438645001,33.933804973],[-118.438588022,33.9336640252],[-118.438503001,33.9334839866],[-118.438398987,33.9332550188],[-118.438318017,33.9330879755],[-118.438257986,33.932976017],[-118.438239033,33.9329475743],[-118.438182015,33.9328620066],[-118.438115986,33.9327949788],[-118.438058008,33.9327180073],[-118.437966989,33.932600998],[-118.437908011,33.9325169765],[-118.437859976,33.9324220117],[-118.437808995,33.9323070017],[-118.437754015,33.9322189817],[-118.437718976,33.9321600036],[-118.437686988,33.932094975],[-118.437662996,33.9320240013],[-118.437628009,33.9319379806],[-118.437593022,33.9318440154],[-118.437549986,33.9317290054],[-118.437505002,33.9316639768],[-118.437451022,33.9315660131],[-118.43742298,33.9314939872],[-118.43739599,33.9314280116],[-118.437337012,33.9312730164],[-118.437266985,33.9311600057],[-118.437232998,33.9310699864],[-118.43717302,33.930912992],[-118.437118987,33.9307909845],[-118.437065007,33.9306499842],[-118.437008976,33.9304899908],[-118.436960993,33.9304020234],[-118.436919009,33.9303629852],[-118.436863977,33.9303220004],[-118.436782007,33.9302760175],[-118.436719977,33.9302059908],[-118.436654002,33.9300739871],[-118.436596023,33.9298860041],[-118.436565982,33.9298029822],[-118.436518,33.929693023],[-118.436381997,33.9293879781],[-118.436268987,33.9291400174],[-118.436172023,33.9288720114],[-118.436109993,33.9287560018],[-118.436080004,33.9286849755],[-118.436060011,33.9286339944],[-118.436023025,33.9285299803],[-118.43600398,33.9284720018],[-118.435909015,33.9282710236],[-118.435796004,33.9280320069],[-118.43575202,33.9279549828],[-118.435673997,33.9278089843],[-118.435608021,33.927699025],[-118.435571982,33.9276369954],[-118.435524999,33.9275790169],[-118.435493011,33.9275109894],[-118.435466021,33.927434018],[-118.435445976,33.927361992],[-118.435394995,33.927254979],[-118.435360008,33.9271880039],[-118.435324021,33.9271199764],[-118.435312025,33.9270520016],[-118.435268989,33.9269649812],[-118.435230003,33.9268940075],[-118.435178023,33.9268029886],[-118.435133986,33.9266929768],[-118.435111994,33.9266200038],[-118.435092245,33.9265425446],[-118.435087004,33.9265219875],[-118.435064012,33.9264550123],[-118.435018976,33.9263609945],[-118.434974992,33.926222993],[-118.434950002,33.9261109819],[-118.434910017,33.9260400082],[-118.434873977,33.9259669826],[-118.434784011,33.9257730019],[-118.434691992,33.9255730234],[-118.434632014,33.9253879867],[-118.434529,33.9251680155],[-118.434448977,33.9249939748],[-118.434388999,33.9248660222],[-118.434331021,33.9247079755],[-118.434220009,33.9244880044],[-118.434126991,33.9243350084],[-118.434050019,33.9242249966],[-118.434002984,33.9241189832],[-118.433965998,33.9240029736],[-118.433864983,33.9237919991],[-118.433773017,33.923634005],[-118.433626019,33.9233899902],[-118.433530002,33.923234995],[-118.433468025,33.9230790002],[-118.433386002,33.9229360005],[-118.433323026,33.9228379842],[-118.433252999,33.9227500168],[-118.433172976,33.9226370061],[-118.433066016,33.9224750135],[-118.432988992,33.9223590038],[-118.432903023,33.9222220019],[-118.432858987,33.9221339819],[-118.432819002,33.9220670068],[-118.432793012,33.9220089756],[-118.432744977,33.9219719893],[-118.432679001,33.9219210082],[-118.432624022,33.921865976],[-118.432597979,33.9217890045],[-118.432568989,33.9216889889],[-118.432517009,33.9215940241],[-118.43245098,33.9215329941],[-118.432399,33.92146302],[-118.432329026,33.9213500093],[-118.432287988,33.9212499937],[-118.432193023,33.9210760056],[-118.432115,33.920956997],[-118.432060313,33.9208715694],[-118.432034977,33.9208319907],[-118.431986811,33.9207340892],[-118.431972,33.9207039855],[-118.431896975,33.9205549881],[-118.43185699,33.9204289822],[-118.431784017,33.9202579929],[-118.431705993,33.9201119944],[-118.431606977,33.9199809903],[-118.431545,33.9198499862],[-118.431451982,33.9196610036],[-118.43137801,33.919499011],[-118.431299986,33.9193169732],[-118.431191354,33.919028302],[-118.431188974,33.9190219772],[-118.431136994,33.9188849753],[-118.430971003,33.9184960142],[-118.430806011,33.9180720134],[-118.430691001,33.9177980097],[-118.430621974,33.9176180238],[-118.430520768,33.9173873566],[-118.430507017,33.9173560156],[-118.430393006,33.9171419896],[-118.430360018,33.9170660178],[-118.43034267,33.917037285],[-118.430292991,33.9169550063],[-118.430222017,33.9168729841],[-118.430145992,33.9167820178],[-118.430136474,33.9167632071],[-118.429914,33.9167749991],[-118.429898,33.9167699991],[-118.429857998,33.916752324],[-118.429855,33.9167509991],[-118.429815,33.9167269991],[-118.429793,33.9167079991],[-118.429692,33.9165799991],[-118.429556,33.9164429991],[-118.429447,33.9163179991],[-118.427552,33.9163209991],[-118.422221,33.9163289991],[-118.422221,33.9177039991],[-118.42221,33.9178429991],[-118.422221,33.9179849991],[-118.422222,33.9188739991],[-118.422222,33.9199129991],[-118.422222,33.9199569991],[-118.422749,33.9199569991],[-118.423854,33.9199579991],[-118.424391,33.9199579991],[-118.424396,33.9217699991],[-118.426571,33.9217689991],[-118.426574,33.9235829991],[-118.42766,33.9235819991],[-118.427662,33.9250179991],[-118.427667,33.9272029991],[-118.428754,33.9272009991],[-118.428756,33.9279019991],[-118.42876375,33.9307269991],[-118.42891,33.9307119991],[-118.42971,33.9307119991],[-118.429677,33.9314589991],[-118.429736,33.9320999991],[-118.429944,33.9327149991],[-118.430182,33.9332819991],[-118.43391,33.9397119991],[-118.434456,33.9406199991],[-118.434633,33.9409029991],[-118.43521,33.9418119991],[-118.435465,33.9423189991],[-118.435628,33.9427129991],[-118.435792,33.9431809991],[-118.435925,33.9436609991],[-118.436014,33.9441169991],[-118.43603,33.9445609991],[-118.43601,33.9452119991],[-118.436057,33.9457869991],[-118.436157,33.9462849991],[-118.436341,33.9468669991],[-118.436541,33.9473659991],[-118.436808,33.9478089991],[-118.437731,33.9491569991],[-118.436991,33.9494949991],[-118.436695,33.9495899991],[-118.436384,33.9496589991],[-118.43605,33.9497229991],[-118.435693,33.9497699991],[-118.435368,33.9497979991],[-118.434623,33.9498079991],[-118.434251,33.9498249991],[-118.433894,33.9498599991],[-118.431347,33.9502419991],[-118.431797,33.9508569991],[-118.4312,33.9516049991],[-118.431059,33.9521929991],[-118.431009,33.9526489991],[-118.431119,33.9544089991],[-118.43121,33.9547999991],[-118.431453,33.9551549991],[-118.431882,33.9555219991],[-118.431404,33.9561949991],[-118.432557,33.9566449991],[-118.432971,33.9568549991],[-118.433223,33.9570489991],[-118.433436,33.9572649991],[-118.43401,33.9580119991],[-118.43316,33.9583439991],[-118.432967,33.9584499991],[-118.43281,33.9586119991],[-118.432721,33.9589119991],[-118.432713,33.9596959991],[-118.431026,33.9596959991],[-118.431071,33.9605119991],[-118.43071,33.9605119991],[-118.42851,33.9605119991],[-118.42831,33.9613119991],[-118.42821,33.9620119991],[-118.42851,33.9628119991],[-118.42901,33.9637119991],[-118.43121,33.9637119991],[-118.43231,33.9643119991],[-118.43271,33.9646119991],[-118.43441,33.9642119991],[-118.43571,33.9636119991],[-118.436288,33.9634229991],[-118.436558,33.9633089991],[-118.436837,33.9632489991],[-118.43758,33.9630489991],[-118.437859,33.9629959991],[-118.438062,33.9630729991],[-118.438148,33.9632609991],[-118.438305,33.9634509991],[-118.43811,33.9636119991],[-118.43261,33.9659119991],[-118.43011,33.9668119991],[-118.426958,33.9649079991],[-118.426796,33.9649569991],[-118.42531,33.9654119991],[-118.42561,33.9655119991]]]},properties:{Name:"Playa del Rey",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.30885,33.8656909991],[-118.308953,33.8656909991],[-118.308912,33.8673249991],[-118.308908,33.8674859991],[-118.308983,33.8692079991],[-118.308979,33.8693289991],[-118.308948,33.8701989991],[-118.308942,33.8703749991],[-118.308933,33.8706469991],[-118.308915,33.8711479991],[-118.308912,33.8712449991],[-118.308917,33.8713399991],[-118.308931,33.8715849991],[-118.309,33.8728059991],[-118.309058,33.8728069991],[-118.309123,33.8728099991],[-118.30912,33.8729439991],[-118.309121,33.8730529991],[-118.310014,33.8730379991],[-118.311287,33.8730169991],[-118.311403,33.8730149991],[-118.311519,33.8730149991],[-118.313119,33.8730149991],[-118.313143,33.8735459991],[-118.313206,33.8749309991],[-118.31321,33.8750519991],[-118.313263,33.8767269991],[-118.313267,33.8768529991],[-118.313262,33.8769659991],[-118.313258,33.8770669991],[-118.313245,33.8773689991],[-118.313206,33.8783319991],[-118.313207,33.8791679991],[-118.313205,33.8801279991],[-118.313206,33.8811609991],[-118.313208,33.8819459991],[-118.313269,33.8837679991],[-118.313476,33.8870609991],[-118.314024,33.8868949991],[-118.317818,33.8855229991],[-118.319772,33.8849139991],[-118.321589,33.8843479991],[-118.322058,33.8842009991],[-118.32302,33.8839019991],[-118.32541,33.8831569991],[-118.326488,33.8828209991],[-118.32649199,33.8829160006],[-118.327296986,33.8826230023],[-118.327869986,33.8824110026],[-118.328557986,33.8821800024],[-118.328688986,33.8821370021],[-118.328799986,33.8820950029],[-118.329442986,33.8819060023],[-118.330078986,33.8817100025],[-118.330966986,33.8814530024],[-118.331082986,33.8814210021],[-118.331152986,33.8813990024],[-118.331253986,33.8813680023],[-118.331351986,33.8813370024],[-118.331709986,33.8812260022],[-118.332131986,33.8810840025],[-118.332545986,33.8809550023],[-118.333232986,33.8807340024],[-118.334007986,33.8804830024],[-118.335155986,33.8801170023],[-118.335835986,33.8798900024],[-118.336219986,33.8797630024],[-118.336580986,33.8796440024],[-118.337241986,33.8794330024],[-118.338346986,33.8790790023],[-118.339022986,33.8788590023],[-118.339448986,33.8787140026],[-118.340526986,33.8783820021],[-118.340985986,33.8782230025],[-118.341308986,33.8781200022],[-118.342590986,33.8776800025],[-118.342828986,33.8776020025],[-118.343052986,33.8775320023],[-118.343729986,33.8773140027],[-118.343774981,33.8773020042],[-118.344247,33.8771609991],[-118.344616,33.8770429991],[-118.344935,33.8769439991],[-118.345181,33.8768689991],[-118.345681,33.8767119991],[-118.34725,33.8762149991],[-118.348287,33.8758769991],[-118.348815,33.8757099991],[-118.34986,33.8753759991],[-118.350712,33.8750979991],[-118.351257,33.8749169991],[-118.351748,33.8747429991],[-118.352067,33.8745989991],[-118.352348,33.8744279991],[-118.352346,33.8737959991],[-118.352345,33.8736139991],[-118.352345,33.8734949991],[-118.352345,33.8731989991],[-118.352342,33.8728999991],[-118.352341,33.8727719991],[-118.352333,33.8718939991],[-118.352362,33.8715279991],[-118.352385,33.8713419991],[-118.352424,33.8710299991],[-118.352437,33.8706499991],[-118.352457,33.8700719991],[-118.352458,33.8699319991],[-118.352462,33.8687889991],[-118.352463,33.8684779991],[-118.352463,33.8680629991],[-118.352462,33.8673739991],[-118.352461,33.8669719991],[-118.352461,33.8665029991],[-118.352461,33.8655259991],[-118.352644,33.8655479991],[-118.353409,33.8655459991],[-118.354364,33.8655429991],[-118.355208,33.8655449991],[-118.355561,33.8655459991],[-118.356577,33.8655439991],[-118.356874,33.8655539991],[-118.358762,33.8655469991],[-118.358832,33.8655449991],[-118.35883,33.8650119991],[-118.358823,33.8646009991],[-118.358783,33.8643409991],[-118.358714,33.8640129991],[-118.358647,33.8637759991],[-118.358548,33.8635319991],[-118.358417,33.8632649991],[-118.358325,33.8631229991],[-118.358144,33.8628379991],[-118.357963,33.8625989991],[-118.357765,33.8623709991],[-118.357558,33.8621609991],[-118.357155,33.8618529991],[-118.356739,33.8615509991],[-118.356475,33.8613559991],[-118.355997,33.8610009991],[-118.355754,33.8608149991],[-118.354582,33.8599409991],[-118.354109,33.8595809991],[-118.353221,33.8589049991],[-118.353196,33.8588859991],[-118.353065,33.8587859991],[-118.353163,33.8586869991],[-118.353326,33.8584469991],[-118.353419,33.8582759991],[-118.353485,33.8581549991],[-118.353495,33.8581299991],[-118.353714,33.8581509991],[-118.354075,33.8581849991],[-118.354421,33.8582169991],[-118.354953,33.8582249991],[-118.355402,33.8582309991],[-118.355593,33.8582339991],[-118.355832,33.8582379991],[-118.355864,33.8582339991],[-118.357625,33.8582329991],[-118.358568,33.8582319991],[-118.358854,33.8582879991],[-118.361369,33.8582829991],[-118.36343,33.8582789991],[-118.364897,33.8582769991],[-118.365412,33.8582759991],[-118.365458,33.8582759991],[-118.366127,33.8582749991],[-118.367145,33.8582739991],[-118.368701,33.8582719991],[-118.369656,33.8582699991],[-118.369867,33.8582699991],[-118.371833,33.8582639991],[-118.372797,33.8582619991],[-118.374835,33.8582559991],[-118.375398,33.8582559991],[-118.375373,33.8558989991],[-118.375555,33.8557849991],[-118.375718,33.8557109991],[-118.375893,33.8556539991],[-118.377692,33.8551429991],[-118.378219,33.8549929991],[-118.378166,33.8548229991],[-118.378163,33.8548069991],[-118.378,33.8540139991],[-118.377959,33.8538169991],[-118.377891,33.8534839991],[-118.377858,33.8534149991],[-118.377236,33.8491089991],[-118.377158,33.8486729991],[-118.377141,33.8485809991],[-118.376652,33.8458929991],[-118.376302,33.8444379991],[-118.376283,33.8443679991],[-118.375965,33.8426609991],[-118.375439,33.8398739991],[-118.375406,33.8389139991],[-118.375362,33.8387959991],[-118.374813,33.8373119991],[-118.374771,33.8372389991],[-118.374932,33.8361089991],[-118.374644,33.8349099991],[-118.374315,33.8331949991],[-118.373392,33.8301249991],[-118.372698,33.8275649991],[-118.374451,33.8275579991],[-118.374507,33.8273149991],[-118.374511,33.8268679991],[-118.37449,33.8265769991],[-118.374434,33.8258279991],[-118.374438,33.8247889991],[-118.374443,33.8237469991],[-118.374499,33.8227289991],[-118.374502,33.8226729991],[-118.374443,33.8216869991],[-118.374436,33.8213759991],[-118.374501,33.8196119991],[-118.374347,33.8163589991],[-118.374476,33.8156669991],[-118.374492,33.8155819991],[-118.374865,33.8156559991],[-118.374938,33.8156729991],[-118.375171,33.8157309991],[-118.375301,33.8157519991],[-118.37571,33.8158089991],[-118.376247,33.8158789991],[-118.376765,33.8159489991],[-118.376945,33.8159729991],[-118.377221,33.8160079991],[-118.377631,33.8160589991],[-118.377822,33.8160839991],[-118.378405,33.8161609991],[-118.378844,33.8162189991],[-118.379145,33.8162669991],[-118.379325,33.8163059991],[-118.379614,33.8163859991],[-118.379861,33.8164749991],[-118.379928,33.8165029991],[-118.380088,33.8165689991],[-118.380299,33.8166739991],[-118.380375,33.8167159991],[-118.380452,33.8167589991],[-118.380687,33.8169049991],[-118.380767,33.8169559991],[-118.381239,33.8172599991],[-118.381506,33.8174359991],[-118.381868,33.8176659991],[-118.382379,33.8179899991],[-118.382889,33.8183149991],[-118.383005,33.8183799991],[-118.383215,33.8184839991],[-118.383238,33.8184939991],[-118.383498,33.8186109991],[-118.383536,33.8186239991],[-118.383715,33.8186849991],[-118.384015,33.8187869991],[-118.3841,33.8188199991],[-118.384304,33.8189299991],[-118.384429,33.8190179991],[-118.384498,33.8189309991],[-118.384585,33.8188789991],[-118.384912,33.8188849991],[-118.384982,33.8188889991],[-118.385171,33.8189079991],[-118.38538,33.8189209991],[-118.385357,33.8188129991],[-118.385389,33.8186609991],[-118.385453,33.8182759991],[-118.385444,33.8180359991],[-118.384939,33.8175339991],[-118.385007,33.8174149991],[-118.385386,33.8171369991],[-118.386026,33.8164929991],[-118.385542,33.8160839991],[-118.385722,33.8159079991],[-118.3861,33.8155399991],[-118.38622,33.8154079991],[-118.386252,33.8153619991],[-118.38636,33.8151839991],[-118.386422,33.8150709991],[-118.386999,33.8148909991],[-118.387179,33.8148349991],[-118.387561,33.8148609991],[-118.387907,33.8146149991],[-118.388115,33.8149619991],[-118.388117,33.8152579991],[-118.388441,33.8150629991],[-118.388625,33.8153219991],[-118.388839,33.8150869991],[-118.388974,33.8149319991],[-118.389039,33.8148569991],[-118.389168,33.8149519991],[-118.389564,33.8151509991],[-118.389642,33.8151959991],[-118.389818,33.8152509991],[-118.390416,33.8154369991],[-118.391225,33.8154129991],[-118.391228885,33.8153866978],[-118.391592695,33.8153260628],[-118.39160701,33.8152640044],[-118.391651994,33.8149129766],[-118.391754008,33.8144150033],[-118.391827981,33.8141350017],[-118.391882014,33.8139800065],[-118.391905005,33.8138270106],[-118.391937993,33.8135929921],[-118.391999023,33.8133610254],[-118.392039008,33.8130830231],[-118.392107982,33.812759985],[-118.392195003,33.8124709868],[-118.392282023,33.8121430031],[-118.392346,33.8118180182],[-118.392378987,33.8115989941],[-118.392428022,33.8113019989],[-118.392474005,33.8110349926],[-118.392548977,33.8107240026],[-118.392610007,33.810401017],[-118.392663987,33.8101400084],[-118.392752007,33.8098789999],[-118.392786994,33.8096429821],[-118.392833977,33.8095260254],[-118.392881012,33.8093759758],[-118.392920997,33.8092480232],[-118.392928994,33.8091100217],[-118.392928994,33.8089880143],[-118.392951985,33.8088740039],[-118.392990024,33.808710012],[-118.393124974,33.8082049886],[-118.393151017,33.8080320001],[-118.393178007,33.807866009],[-118.393215993,33.8075400245],[-118.393228988,33.8074130189],[-118.393248981,33.8072910115],[-118.393276023,33.8071690041],[-118.393459008,33.8066970211],[-118.393580016,33.8061979955],[-118.393626999,33.8060420007],[-118.393686976,33.8059149951],[-118.393766999,33.8057989855],[-118.393826977,33.805641991],[-118.393889007,33.805480998],[-118.393941987,33.805320005],[-118.394029007,33.8051660095],[-118.39413702,33.8050270084],[-118.394250978,33.8048379731],[-118.394338998,33.8046599865],[-118.394432016,33.8044390157],[-118.394498991,33.8042609764],[-118.394637992,33.803977976],[-118.394727012,33.8038550216],[-118.394864014,33.8036689853],[-118.39498902,33.8035359819],[-118.395294762,33.8034263098],[-118.394861,33.8034469991],[-118.394777,33.8034619991],[-118.394719,33.8034829991],[-118.394694,33.8035029991],[-118.394645,33.8035169991],[-118.394479,33.8036679991],[-118.394446,33.8037089991],[-118.394446,33.8037289991],[-118.394427,33.8037499991],[-118.394363,33.8038179991],[-118.394346,33.8038539991],[-118.394321,33.8038819991],[-118.39428,33.8039569991],[-118.394255,33.8039839991],[-118.394221,33.8040449991],[-118.394196,33.8040719991],[-118.394146,33.8041899991],[-118.394113,33.8042379991],[-118.394104,33.8042649991],[-118.394091,33.8042859991],[-118.391907,33.8042149991],[-118.390528,33.8042109991],[-118.388901,33.8042149991],[-118.383109,33.8042139991],[-118.378138,33.8041179991],[-118.374417,33.8042129991],[-118.367565,33.8039979991],[-118.366475,33.8041259991],[-118.365267,33.8040309991],[-118.362289,33.8040769991],[-118.361049,33.8033989991],[-118.358272,33.8010519991],[-118.355372,33.7986929991],[-118.353038,33.7965579991],[-118.351974,33.7957819991],[-118.349404,33.7939009991],[-118.349284,33.7938129991],[-118.345657,33.7909519991],[-118.344441,33.7898809991],[-118.341922,33.7876509991],[-118.340491,33.7866349991],[-118.34048,33.7861329991],[-118.337892,33.7839619991],[-118.337601,33.7837099991],[-118.334815,33.7813419991],[-118.334171,33.7808179991],[-118.33415,33.7807999991],[-118.33272,33.7802169991],[-118.332587,33.7802269991],[-118.331095,33.7803369991],[-118.330005,33.7804169991],[-118.329993,33.7809739991],[-118.329965,33.7823689991],[-118.329948,33.7831659991],[-118.329905,33.7852159991],[-118.328005,33.7852159991],[-118.328005,33.7861159991],[-118.327817,33.7861279991],[-118.327903,33.7872869991],[-118.328194,33.7872639991],[-118.328904,33.7871949991],[-118.328854,33.7874199991],[-118.328726,33.7876629991],[-118.328729,33.7889969991],[-118.328721,33.7891249991],[-118.32818,33.7891709991],[-118.327809,33.7892389991],[-118.327851,33.7889339991],[-118.327726,33.7889229991],[-118.32695,33.7888429991],[-118.326872,33.7888499991],[-118.326166,33.7889099991],[-118.326229,33.7895459991],[-118.32665,33.7895449991],[-118.326761,33.7895459991],[-118.326789,33.7901209991],[-118.326805,33.7903159991],[-118.327744,33.7903179991],[-118.32819,33.7903029991],[-118.32775,33.7910009991],[-118.329095,33.7909529991],[-118.329108,33.7911729991],[-118.329133,33.7912769991],[-118.329192,33.7913919991],[-118.329315,33.7915979991],[-118.329367,33.7916829991],[-118.329475,33.7918739991],[-118.329498,33.7920139991],[-118.329505,33.7922909991],[-118.329505,33.7923419991],[-118.328011,33.7938879991],[-118.328048,33.7953489991],[-118.328076,33.7967879991],[-118.328321,33.7982399991],[-118.328318,33.7985899991],[-118.328315,33.7991469991],[-118.328318,33.7997699991],[-118.328312,33.8000329991],[-118.32831,33.8001179991],[-118.328301,33.8002129991],[-118.328283,33.8003849991],[-118.328242,33.8005839991],[-118.328189,33.8008749991],[-118.328175,33.8009719991],[-118.326121,33.8010859991],[-118.325983,33.8035029991],[-118.327924,33.8034149991],[-118.327923,33.8037749991],[-118.327923,33.8038589991],[-118.327928,33.8041129991],[-118.327949,33.8051259991],[-118.327948,33.8059039991],[-118.32794,33.8064089991],[-118.327938,33.8064819991],[-118.327941,33.8068489991],[-118.325336,33.8067959991],[-118.323555,33.8068369991],[-118.322962,33.8068369991],[-118.32235,33.8068649991],[-118.319919,33.8069219991],[-118.319916,33.8076609991],[-118.31836,33.8076529991],[-118.314491,33.8075159991],[-118.313522,33.8075169991],[-118.312664,33.8075299991],[-118.311705,33.8075159991],[-118.311706,33.8073209991],[-118.311705,33.8069259991],[-118.311705,33.8062759991],[-118.311705,33.8060679991],[-118.311712,33.8055659991],[-118.31172,33.8049099991],[-118.311726,33.8044939991],[-118.31173,33.8039899991],[-118.311733,33.8036849991],[-118.311734,33.8035279991],[-118.311737,33.8032479991],[-118.31173,33.8026399991],[-118.311729,33.8025039991],[-118.311739,33.8022509991],[-118.311771,33.8021319991],[-118.31098,33.8022119991],[-118.308905,33.8022167366],[-118.30879,33.8022169991],[-118.308793,33.8025829991],[-118.308799,33.8033299991],[-118.308805,33.8040839991],[-118.308805246,33.8041140277],[-118.308812,33.8049369991],[-118.308812846,33.8050473825],[-118.308818,33.8057199991],[-118.308823,33.8064209991],[-118.308829,33.8067949991],[-118.308856,33.8071079991],[-118.308871,33.8072129991],[-118.308913,33.8074419991],[-118.308955,33.8075949991],[-118.309021,33.8077669991],[-118.309082,33.8079239991],[-118.309165,33.8081829991],[-118.309228,33.8084499991],[-118.309269,33.8086359991],[-118.309296,33.8088049991],[-118.309217,33.8088169991],[-118.308924,33.8088639991],[-118.308847671,33.80888082],[-118.308443,33.8089699991],[-118.30841,33.8089709991],[-118.308348,33.8089909991],[-118.308254,33.8090139991],[-118.308127,33.8090449991],[-118.308163192,33.8091592352],[-118.30837,33.8098119991],[-118.308491,33.8102169991],[-118.308558,33.8104909991],[-118.308639,33.8108659991],[-118.308707,33.8112669991],[-118.308753,33.8116239991],[-118.308783,33.8119709991],[-118.308786,33.8120039991],[-118.308804,33.8123859991],[-118.308806,33.8127149991],[-118.308804,33.8134449991],[-118.308797,33.8153819991],[-118.30879235,33.8168775943],[-118.308792,33.8169899991],[-118.308807,33.8190339991],[-118.308821,33.8201879991],[-118.308835,33.8213419991],[-118.308851,33.8226429991],[-118.308852,33.8227419991],[-118.308853,33.8228499991],[-118.308859,33.8233179991],[-118.308873,33.8244719991],[-118.308887,33.8256259991],[-118.308901,33.8267799991],[-118.308915,33.8279339991],[-118.308929,33.8290889991],[-118.308944,33.8301129991],[-118.30900664,33.8302373148],[-118.309009,33.8302419991],[-118.30900935,33.8302725448],[-118.309023,33.8314649991],[-118.309035,33.8324369991],[-118.309036,33.8324819991],[-118.309048,33.8334719991],[-118.309049,33.8335169991],[-118.309059,33.8344149991],[-118.30906,33.8344619991],[-118.309072,33.8354449991],[-118.309172,33.8373069991],[-118.309189,33.8376159991],[-118.309206,33.8379279122],[-118.309211739,33.8380332173],[-118.309212,33.8380379991],[-118.309216,33.8381099991],[-118.309211,33.8381719991],[-118.309217,33.8383439991],[-118.309232027,33.840158527],[-118.309237,33.8407589991],[-118.309238,33.8408499991],[-118.309240741,33.8411981543],[-118.309246,33.8418659991],[-118.309254,33.8428589991],[-118.309261,33.8437939991],[-118.309264241,33.8441727427],[-118.309267338,33.8445347718],[-118.309269,33.8447289991],[-118.309277,33.8456629991],[-118.309286,33.8468189991],[-118.30929,33.8473899991],[-118.309292387,33.8476882556],[-118.309307,33.8495139991],[-118.309318,33.8507659991],[-118.309324,33.8510389991],[-118.309358,33.8519459991],[-118.309379,33.8541989991],[-118.309399,33.8567569991],[-118.309403,33.8572069991],[-118.309412,33.8574389991],[-118.309401,33.8576679991],[-118.30938,33.8578399991],[-118.309361,33.8579529991],[-118.309279,33.8583479991],[-118.30915,33.8583479991],[-118.30915,33.8584589991],[-118.30915,33.8589019991],[-118.309149,33.8597589991],[-118.309149,33.8598519991],[-118.309149,33.8599519991],[-118.309149,33.8600429991],[-118.309149,33.8606269991],[-118.309149,33.8608609991],[-118.309149,33.8609499991],[-118.309149,33.8609969991],[-118.309149,33.8614569991],[-118.309149,33.8619779991],[-118.309149,33.8626479991],[-118.309149,33.8632559991],[-118.309148,33.8634449991],[-118.309148,33.8638399991],[-118.309148,33.8641389991],[-118.309148,33.8643089991],[-118.309148,33.8648049991],[-118.309148,33.8649829991],[-118.309148,33.8654409991],[-118.309148,33.8656079991],[-118.308892,33.8656079991],[-118.30885,33.8656909991]]]},properties:{Name:"Torrance",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.290522986,33.8462860007],[-118.290609986,33.8462640042],[-118.290944986,33.8462690017],[-118.291203986,33.8462500017],[-118.291349986,33.8462270032],[-118.291582981,33.846219002],[-118.291674986,33.8463200023],[-118.291726986,33.8463389999],[-118.291945986,33.8463410022],[-118.293055986,33.8463230026],[-118.294341986,33.8463430022],[-118.295994986,33.8463340024],[-118.296847986,33.8463430023],[-118.297511986,33.8463420024],[-118.298283986,33.8463490021],[-118.299098986,33.8463230023],[-118.299206975,33.8463190009],[-118.299204986,33.8462210023],[-118.299204844,33.8462160029],[-118.299194986,33.8458690023],[-118.299190983,33.8456020031],[-118.299193278,33.8453932888],[-118.299194983,33.8452400031],[-118.299195986,33.8448580023],[-118.299196986,33.8436540023],[-118.299201986,33.8432840023],[-118.299199986,33.8424440023],[-118.299197986,33.8420190023],[-118.299202986,33.8419510023],[-118.299202986,33.8415580023],[-118.299201986,33.8410230023],[-118.299199986,33.8388400023],[-118.299198986,33.8386760023],[-118.299198986,33.8381810023],[-118.299198983,33.8377810031],[-118.299198445,33.8375241018],[-118.299197983,33.8372940031],[-118.299196983,33.8361210031],[-118.299196889,33.8360754457],[-118.299195981,33.8355710034],[-118.299195972,33.8351611384],[-118.299195983,33.8351160031],[-118.299194986,33.8344120023],[-118.299193986,33.8337080023],[-118.299192986,33.8329970023],[-118.299192986,33.8325340023],[-118.299192986,33.8321190023],[-118.299191986,33.8315490023],[-118.299190986,33.8303190023],[-118.299190986,33.8300050023],[-118.299190986,33.8299040023],[-118.299189986,33.8288950023],[-118.299189986,33.8285810023],[-118.299188986,33.8281130023],[-118.299188986,33.8278390023],[-118.299187986,33.8271850023],[-118.299185986,33.8263150023],[-118.299184986,33.8256960023],[-118.299184986,33.8253190023],[-118.299184986,33.8248940023],[-118.299184986,33.8247410023],[-118.299183983,33.8245060031],[-118.299182854,33.8240066351],[-118.299181983,33.8236130031],[-118.299181986,33.8233120023],[-118.299180986,33.8230220023],[-118.299157983,33.8227320031],[-118.299117138,33.8224951655],[-118.299112983,33.8224710031],[-118.299083986,33.8223520023],[-118.299071986,33.8223000023],[-118.299042983,33.8222100031],[-118.299063807,33.822051228],[-118.299071984,33.8219890029],[-118.299071278,33.821352051],[-118.299070986,33.8210710023],[-118.299069986,33.8202790023],[-118.299069986,33.8202150023],[-118.299070986,33.8198630023],[-118.299082986,33.8197420023],[-118.299072986,33.8193120023],[-118.299064986,33.8189850023],[-118.299073986,33.8189250023],[-118.299142986,33.8169540023],[-118.299183986,33.8157840023],[-118.299205,33.8151764712],[-118.299257986,33.8136460023],[-118.299205,33.8136264493],[-118.298490986,33.8133630023],[-118.298492986,33.8132410023],[-118.298493986,33.8131390023],[-118.298438986,33.8130910023],[-118.298339986,33.8130550023],[-118.298359986,33.8128700023],[-118.298493986,33.8104370023],[-118.298613983,33.8098430031],[-118.298651502,33.8093952171],[-118.298686981,33.8089720034],[-118.298690671,33.8087882497],[-118.298727983,33.8069350031],[-118.298795986,33.8062480023],[-118.298852986,33.8048820023],[-118.299003986,33.8036140023],[-118.299015997,33.8034000056],[-118.299113986,33.8034050021],[-118.299615975,33.8034179995],[-118.299634235,33.8029169991],[-118.299637977,33.8028140008],[-118.299405,33.8028069135],[-118.299144995,33.8027990038],[-118.299138986,33.8025450023],[-118.299136986,33.8024870023],[-118.299130986,33.8021770023],[-118.299132986,33.8017200023],[-118.299133986,33.8014120023],[-118.299136986,33.8003980023],[-118.299139986,33.7995240023],[-118.299141986,33.7990600023],[-118.299142986,33.7987350023],[-118.299145919,33.7978169991],[-118.299145978,33.7977959992],[-118.299096986,33.7977880023],[-118.299064986,33.7977830023],[-118.298924985,33.7977610033],[-118.297626986,33.7977640034],[-118.297455986,33.7977900012],[-118.295917986,33.7977850023],[-118.294919986,33.7977810023],[-118.294796986,33.7977810023],[-118.293711986,33.7977770023],[-118.293498467,33.7977763426],[-118.293498401,33.7977763424],[-118.292740986,33.7977740023],[-118.291769986,33.7977710023],[-118.290858986,33.7977670023],[-118.290814986,33.7977670023],[-118.290713986,33.7977670023],[-118.289860986,33.7977640023],[-118.288949986,33.7977610026],[-118.288926986,33.7977620027],[-118.288341986,33.7978180016],[-118.287021986,33.7978180023],[-118.286736978,33.7978180025],[-118.286781972,33.7978590055],[-118.287026972,33.7981160055],[-118.287492972,33.7986060055],[-118.287651972,33.7987800055],[-118.287964972,33.7992590055],[-118.288099972,33.7994750055],[-118.288151972,33.7995580055],[-118.288375972,33.7999700055],[-118.288601972,33.8005460055],[-118.288766972,33.8010890055],[-118.288840972,33.8015190055],[-118.288874972,33.8019670055],[-118.288881972,33.8024600055],[-118.288841972,33.8029310055],[-118.288709972,33.8036590055],[-118.288565972,33.8042680055],[-118.288492972,33.8045800055],[-118.288275972,33.8055260055],[-118.288116972,33.8062230055],[-118.287683972,33.8081900055],[-118.287651972,33.8083290055],[-118.287507972,33.8089590055],[-118.287476972,33.8090940055],[-118.287453972,33.8091910055],[-118.287376972,33.8096010055],[-118.287327972,33.8098620055],[-118.287279972,33.8102480055],[-118.287243972,33.8110370055],[-118.287224972,33.8115320055],[-118.287189972,33.8124500055],[-118.287156972,33.8147990055],[-118.287164972,33.8155410055],[-118.287170972,33.8161540055],[-118.287176972,33.8167250055],[-118.287179972,33.8169730055],[-118.287181972,33.8173680055],[-118.287190972,33.8189570055],[-118.287193972,33.8194700055],[-118.287222972,33.8211580055],[-118.287228972,33.8215200055],[-118.287233972,33.8218180055],[-118.287234972,33.8221710055],[-118.287237972,33.8226190055],[-118.287239972,33.8230540055],[-118.287241972,33.8235040055],[-118.287243972,33.8238150055],[-118.287236972,33.8240560055],[-118.287227972,33.8243830055],[-118.287226972,33.8244510055],[-118.287230972,33.8245080055],[-118.287232972,33.8245270055],[-118.287226972,33.8256690055],[-118.287225972,33.8257970055],[-118.287236972,33.8269540055],[-118.287245972,33.8278150055],[-118.287244972,33.8279180055],[-118.287242972,33.8281230055],[-118.287237972,33.8285260055],[-118.287223972,33.8297700055],[-118.287225972,33.8304070055],[-118.287231972,33.8315960055],[-118.287231972,33.8324120055],[-118.287230972,33.8334070055],[-118.287230972,33.8343010055],[-118.287229972,33.8351950055],[-118.287229972,33.8354590055],[-118.287225972,33.8355320055],[-118.287202972,33.8359950055],[-118.287144972,33.8371360055],[-118.287054972,33.8376080055],[-118.286671972,33.8390940055],[-118.286305972,33.8406190055],[-118.286003972,33.8418760055],[-118.285938972,33.8420730055],[-118.285936972,33.8421280055],[-118.285878972,33.8423450055],[-118.285656972,33.8431760055],[-118.285270972,33.8446450055],[-118.285253972,33.8447090055],[-118.285237972,33.8447710055],[-118.285177972,33.8449980055],[-118.284990972,33.8458300055],[-118.28491699,33.8462390052],[-118.284966912,33.8462416431],[-118.285181972,33.8462530055],[-118.285572972,33.8462490055],[-118.286016995,33.8462530058],[-118.286427984,33.8462999979],[-118.286499988,33.8462390066],[-118.287172628,33.8462917306],[-118.287172712,33.8462917372],[-118.287443986,33.8463130008],[-118.287672361,33.8462803773],[-118.287786986,33.8462640035],[-118.288057845,33.8462716127],[-118.288057987,33.8462716167],[-118.288569986,33.8462860024],[-118.289656986,33.8463290017],[-118.290370986,33.8462880027],[-118.290522986,33.8462860007]]]},properties:{Name:"West Carson",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.35828018,33.9830455168],[-118.358407986,33.9830450021],[-118.358461986,33.9830420032],[-118.358515986,33.983045002],[-118.360089986,33.9830390022],[-118.360143986,33.9830370029],[-118.360197986,33.9830390022],[-118.361205986,33.9830360022],[-118.361259986,33.983034004],[-118.361313986,33.9830360021],[-118.362374986,33.9830310025],[-118.363357986,33.9830290023],[-118.363411986,33.9830280027],[-118.363465986,33.9830290023],[-118.364485986,33.9830250024],[-118.365400986,33.9830220023],[-118.365452986,33.9830210025],[-118.365578986,33.9830190026],[-118.366213986,33.9830200024],[-118.366520986,33.9830190024],[-118.367535986,33.9830160024],[-118.368433986,33.9830130024],[-118.369259986,33.9830100024],[-118.370241986,33.9830070024],[-118.370424986,33.9830060025],[-118.370560986,33.9830060024],[-118.370750986,33.9830050024],[-118.371702989,33.9830019996],[-118.371698986,33.9825670024],[-118.371695982,33.9820370068],[-118.371804994,33.9820580027],[-118.371807,33.9819459991],[-118.371801995,33.9798470015],[-118.371806986,33.9780480024],[-118.371808983,33.9773180044],[-118.372864986,33.9772600024],[-118.374401986,33.9771770024],[-118.375643986,33.9771100024],[-118.376818986,33.9770460024],[-118.377011986,33.9770350022],[-118.377157986,33.9770220025],[-118.377183986,33.977020002],[-118.377353986,33.976997002],[-118.377393986,33.9769890025],[-118.377626986,33.9769440022],[-118.377957986,33.9768670024],[-118.378190986,33.9768130024],[-118.379201986,33.9765790024],[-118.379374986,33.9765390024],[-118.379807426,33.9764392846],[-118.379812986,33.9764380024],[-118.379970986,33.9764010028],[-118.380139986,33.9763710031],[-118.380340986,33.9763550031],[-118.380467986,33.9763570025],[-118.380513986,33.9763580027],[-118.381637986,33.9764240024],[-118.382728986,33.9764880024],[-118.383900986,33.9765570024],[-118.384575986,33.9765970024],[-118.385085986,33.9766270024],[-118.385247986,33.9766370028],[-118.385418986,33.9766580029],[-118.385535987,33.9766830032],[-118.385716986,33.9767610024],[-118.386111986,33.9769530024],[-118.386403983,33.9770900033],[-118.386551986,33.9771600024],[-118.386719,33.9767499991],[-118.386735,33.9767189991],[-118.391066,33.9786329991],[-118.392141309,33.9794179591],[-118.39244,33.9796359991],[-118.392628,33.9797439991],[-118.393049,33.9799419991],[-118.393063,33.9799169991],[-118.394658,33.9806659991],[-118.395909,33.9812529991],[-118.396819,33.9816799991],[-118.39765,33.9820699991],[-118.397635,33.9820929991],[-118.397569,33.9821899991],[-118.397817586,33.9824647232],[-118.39814,33.9823129991],[-118.39923,33.9827959991],[-118.401614,33.9822839991],[-118.403608,33.9789319991],[-118.404488,33.9772159991],[-118.404769,33.9769549991],[-118.405207,33.9768239991],[-118.407961,33.9762269991],[-118.409873,33.9758049991],[-118.41161,33.9752959991],[-118.413593,33.9745829991],[-118.41891,33.9723119991],[-118.42281,33.9699119991],[-118.42361,33.9669119991],[-118.42561,33.9655119991],[-118.42531,33.9654119991],[-118.426796,33.9649569991],[-118.426958,33.9649079991],[-118.43011,33.9668119991],[-118.43261,33.9659119991],[-118.43811,33.9636119991],[-118.438305,33.9634509991],[-118.438148,33.9632609991],[-118.438062,33.9630729991],[-118.437859,33.9629959991],[-118.43758,33.9630489991],[-118.436837,33.9632489991],[-118.436558,33.9633089991],[-118.436288,33.9634229991],[-118.43571,33.9636119991],[-118.43441,33.9642119991],[-118.43271,33.9646119991],[-118.43231,33.9643119991],[-118.43121,33.9637119991],[-118.42901,33.9637119991],[-118.42851,33.9628119991],[-118.42821,33.9620119991],[-118.42831,33.9613119991],[-118.42851,33.9605119991],[-118.43071,33.9605119991],[-118.431071,33.9605119991],[-118.431026,33.9596959991],[-118.432713,33.9596959991],[-118.432721,33.9589119991],[-118.43281,33.9586119991],[-118.432967,33.9584499991],[-118.43316,33.9583439991],[-118.43401,33.9580119991],[-118.433436,33.9572649991],[-118.433223,33.9570489991],[-118.432971,33.9568549991],[-118.432557,33.9566449991],[-118.431404,33.9561949991],[-118.431882,33.9555219991],[-118.431453,33.9551549991],[-118.43121,33.9547999991],[-118.431119,33.9544089991],[-118.431009,33.9526489991],[-118.431059,33.9521929991],[-118.4312,33.9516049991],[-118.431797,33.9508569991],[-118.431347,33.9502419991],[-118.433894,33.9498599991],[-118.434251,33.9498249991],[-118.434623,33.9498079991],[-118.435368,33.9497979991],[-118.435693,33.9497699991],[-118.43605,33.9497229991],[-118.436384,33.9496589991],[-118.436695,33.9495899991],[-118.436991,33.9494949991],[-118.437731,33.9491569991],[-118.436808,33.9478089991],[-118.436541,33.9473659991],[-118.436341,33.9468669991],[-118.436157,33.9462849991],[-118.436057,33.9457869991],[-118.43601,33.9452119991],[-118.43603,33.9445609991],[-118.436014,33.9441169991],[-118.435925,33.9436609991],[-118.435792,33.9431809991],[-118.435628,33.9427129991],[-118.435465,33.9423189991],[-118.43521,33.9418119991],[-118.434633,33.9409029991],[-118.434456,33.9406199991],[-118.43391,33.9397119991],[-118.430182,33.9332819991],[-118.429944,33.9327149991],[-118.429736,33.9320999991],[-118.429677,33.9314589991],[-118.42971,33.9307119991],[-118.42891,33.9307119991],[-118.42876375,33.9307269991],[-118.428764,33.9308179991],[-118.428775,33.9309699991],[-118.427233,33.9311709991],[-118.426549,33.9312659991],[-118.426175,33.9313079991],[-118.4258,33.9313359991],[-118.425423,33.9313509991],[-118.4251,33.9313519991],[-118.425047,33.9313539991],[-118.415962,33.9313829991],[-118.41141,33.9314319991],[-118.411355,33.9314309991],[-118.409485,33.9314249991],[-118.408145,33.9314249991],[-118.403986,33.9314139991],[-118.402059,33.9314949991],[-118.400789,33.9313179991],[-118.398099,33.9309419991],[-118.398015,33.9308859991],[-118.396105,33.9308999991],[-118.39436,33.9308959991],[-118.394145,33.9308959991],[-118.391894,33.9308899991],[-118.389999,33.9308869991],[-118.387474,33.9308839991],[-118.383154,33.9308869991],[-118.382306,33.9308989991],[-118.380765,33.9309219991],[-118.380286,33.9309229991],[-118.380193,33.9309029991],[-118.379633,33.9307809991],[-118.379266,33.9306849991],[-118.378990508,33.9306135752],[-118.378858196,33.9305792722],[-118.378726,33.9305449991],[-118.378724,33.9290079991],[-118.378669,33.9290079991],[-118.378428984,33.9290080018],[-118.377192991,33.9291570017],[-118.377151983,33.929111],[-118.377116985,33.9291050034],[-118.376538986,33.9290980025],[-118.374998986,33.9290980026],[-118.374381982,33.9291120045],[-118.374380989,33.9290130001],[-118.371893986,33.9290170021],[-118.370014986,33.928945003],[-118.369238986,33.9289810034],[-118.369039986,33.929020001],[-118.368873986,33.9290200024],[-118.368543986,33.9290210024],[-118.368489755,33.9290210024],[-118.368374986,33.9290210024],[-118.368215992,33.9290200025],[-118.368244,33.9295999991],[-118.368244,33.9296059991],[-118.368248,33.9297519991],[-118.368249,33.9297939991],[-118.36825,33.9298549991],[-118.368252,33.9299139991],[-118.368248,33.9300669991],[-118.368244,33.9302509991],[-118.368247,33.9303289991],[-118.368248,33.9305529991],[-118.368248991,33.9309450013],[-118.368528986,33.9309490023],[-118.368816986,33.9309500023],[-118.369250986,33.9309430022],[-118.369483986,33.9309320024],[-118.369663986,33.9309240028],[-118.369909039,33.9309266757],[-118.369938986,33.9309270025],[-118.370032977,33.930929001],[-118.370025986,33.9311110024],[-118.370024986,33.9314020024],[-118.370025986,33.9326850024],[-118.370025986,33.9327720024],[-118.370025986,33.9327940024],[-118.370025986,33.9329570024],[-118.370026986,33.9334260024],[-118.370026986,33.9337410024],[-118.370027986,33.9342790024],[-118.370027986,33.9345180024],[-118.370027986,33.9348290024],[-118.370028986,33.9356270024],[-118.370028986,33.9357660024],[-118.370030986,33.9381880024],[-118.370031986,33.9399830024],[-118.370031986,33.9401200024],[-118.370032986,33.9407050024],[-118.370032986,33.9407420024],[-118.370032986,33.9408230024],[-118.370033986,33.9417130024],[-118.370033986,33.9417930024],[-118.370034986,33.9429960024],[-118.370034986,33.9431040024],[-118.370035986,33.9438940024],[-118.370036986,33.9448460024],[-118.370036986,33.9448600024],[-118.370036986,33.9454199988],[-118.370039,33.9459749991],[-118.37004,33.9463449991],[-118.37004,33.9465209991],[-118.37004,33.9466119991],[-118.370041,33.9470049991],[-118.370043,33.9477579991],[-118.370043,33.9478159991],[-118.370044,33.9479089991],[-118.370044,33.9479249991],[-118.370045,33.9483439991],[-118.370047,33.9490919991],[-118.370048,33.9493299991],[-118.37005,33.9500099991],[-118.370053,33.9507199991],[-118.370058,33.9520269991],[-118.370057064,33.9526149735],[-118.370057,33.9526549991],[-118.370057,33.9526719991],[-118.37058,33.9526699991],[-118.37094,33.9526679991],[-118.37108,33.9526669991],[-118.371775,33.9526649991],[-118.372541,33.9526619991],[-118.373501,33.9526569991],[-118.374672,33.9526509991],[-118.374858,33.9526499991],[-118.375306,33.9526479991],[-118.375436,33.9526479991],[-118.376512,33.9526449991],[-118.377019,33.9526429991],[-118.377063,33.9526429991],[-118.377678,33.9526419991],[-118.377964,33.9526409991],[-118.378325,33.9526439991],[-118.378391,33.9526439991],[-118.378615,33.9526459991],[-118.378699,33.9526459991],[-118.378768,33.9526459991],[-118.378843,33.9526469991],[-118.37885,33.9543699991],[-118.378833,33.9555689991],[-118.378833199,33.9557774143],[-118.378835,33.9576619991],[-118.378803,33.9580289991],[-118.378788,33.9582049991],[-118.37879,33.9588949991],[-118.378382,33.9588959991],[-118.378371,33.9589199991],[-118.378241,33.9591779991],[-118.378094,33.9594299991],[-118.377932,33.9596749991],[-118.377833889,33.959804869],[-118.377824489,33.9598173107],[-118.377759,33.9599039991],[-118.377722,33.9599529991],[-118.377522,33.9601869991],[-118.377313,33.9604059991],[-118.37709,33.9606159991],[-118.376855,33.9608159991],[-118.376607,33.9610049991],[-118.376518077,33.9610661121],[-118.376348,33.9611829991],[-118.376078,33.9613499991],[-118.375915625,33.9614407892],[-118.375892,33.9614539991],[-118.375606,33.9615999991],[-118.375301,33.9617379991],[-118.373565,33.9624349991],[-118.371296265,33.9633444922],[-118.371295,33.9633449991],[-118.371239,33.9633669991],[-118.371258,33.9635379991],[-118.37128828,33.9638182961],[-118.371328293,33.9641887042],[-118.371616,33.9668519991],[-118.371804775,33.9671864185],[-118.371826234,33.9672244343],[-118.371918,33.9673869991],[-118.372014401,33.9673492845],[-118.372465,33.9671729991],[-118.37254,33.9671309991],[-118.372665,33.9673129991],[-118.372766,33.9674469991],[-118.372897,33.9676069991],[-118.372823,33.9676479991],[-118.372786411,33.9676753008],[-118.372366,33.9679889991],[-118.371851,33.9679899991],[-118.371818,33.9679899991],[-118.371496,33.9679909991],[-118.370797,33.9679919991],[-118.37034,33.9679929991],[-118.370148,33.9679929991],[-118.370149723,33.9680132406],[-118.370152,33.9680399991],[-118.370154,33.9680849991],[-118.370145,33.9682089991],[-118.370123,33.9683069991],[-118.37009,33.9684569991],[-118.370097,33.9700889991],[-118.370097,33.9701269991],[-118.370101,33.9710439991],[-118.370101,33.9710619991],[-118.370107,33.9723329991],[-118.370107,33.9723999991],[-118.370109,33.9728999991],[-118.370109,33.9729229991],[-118.37011,33.9731609991],[-118.370115,33.9743799991],[-118.370114,33.9744119991],[-118.370101,33.9750099991],[-118.370103686,33.9754854294],[-118.370105,33.9757179991],[-118.370105,33.9758109991],[-118.370108,33.9766079991],[-118.370109,33.9766743991],[-118.370118,33.9772719991],[-118.370128,33.9778159991],[-118.370136,33.9782109991],[-118.370146,33.9787679991],[-118.370147,33.9788079991],[-118.370157,33.9789229991],[-118.370171,33.9790929991],[-118.370218,33.9796609991],[-118.370231,33.9799289991],[-118.370236,33.9800469991],[-118.370328,33.9814199991],[-118.370341,33.9816359991],[-118.370151,33.9816339991],[-118.367348,33.9816419991],[-118.367171,33.9816419991],[-118.366946,33.9816429991],[-118.366927,33.9816329991],[-118.366726,33.9818949991],[-118.366676243,33.981868756],[-118.366252,33.9816449991],[-118.366189871,33.9816451025],[-118.363847,33.9816489991],[-118.360978,33.9816609991],[-118.360058,33.9816619991],[-118.359115,33.9816649991],[-118.358544,33.9816669991],[-118.358386448,33.9816675082],[-118.358509,33.9819119991],[-118.358309,33.9829119991],[-118.3583034,33.9829120009],[-118.35828018,33.9830455168]]]},properties:{Name:"Westchester",Descriptio:""}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-118.261362991,33.8860910013],[-118.260694986,33.8861100038],[-118.260709972,33.8862310056],[-118.260772986,33.8867220012],[-118.259899986,33.8868270031],[-118.260392986,33.8900610018],[-118.259189986,33.8902710027],[-118.259190972,33.8904740056],[-118.259669972,33.8922840056],[-118.260020972,33.8937570056],[-118.260222972,33.8946230056],[-118.260246987,33.8947270045],[-118.260095986,33.8948290026],[-118.259822984,33.8950389992],[-118.259608986,33.8950630024],[-118.259403986,33.8950860032],[-118.259425972,33.8951670056],[-118.259460972,33.8952970056],[-118.259479986,33.8953900001],[-118.259124986,33.8953940039],[-118.259304972,33.8959160056],[-118.259417986,33.896289],[-118.258387993,33.8962950031],[-118.258302979,33.8959290037],[-118.256356986,33.8963290009],[-118.254347986,33.8963280027],[-118.252505986,33.8964210024],[-118.252395986,33.8964270036],[-118.252504972,33.8967270056],[-118.252715986,33.8976749998],[-118.252615986,33.8976740027],[-118.252269986,33.8976850038],[-118.252476972,33.8986270056],[-118.252806972,33.9000080056],[-118.252885972,33.9003400056],[-118.253170972,33.9016090056],[-118.253197972,33.9017020056],[-118.253322972,33.9021580056],[-118.253403972,33.9024100056],[-118.253436972,33.9025070056],[-118.253584972,33.9027440056],[-118.253603986,33.9028070038],[-118.254178986,33.9027880022],[-118.254522986,33.9027690024],[-118.255036986,33.9027400026],[-118.255515986,33.9027260023],[-118.255672986,33.9027210021],[-118.256214986,33.9026850026],[-118.256513986,33.9026730024],[-118.257480986,33.9026340022],[-118.257739986,33.9026180025],[-118.258428986,33.9025900024],[-118.258586986,33.9025840022],[-118.259050986,33.9025570024],[-118.259335986,33.9025410025],[-118.260318986,33.9024990024],[-118.260792986,33.9024790023],[-118.260915986,33.9024730024],[-118.261209986,33.9024580024],[-118.261872986,33.9024250028],[-118.262038986,33.9024280019],[-118.263043986,33.9023810024],[-118.263365986,33.9023670022],[-118.263658986,33.9023480032],[-118.263691972,33.9023460056],[-118.264068972,33.9023030056],[-118.264170972,33.9022910056],[-118.264496972,33.9022510056],[-118.265187972,33.9021410056],[-118.265244972,33.9021290056],[-118.265636972,33.9020670056],[-118.266234972,33.9019790056],[-118.266642972,33.9019490056],[-118.266669972,33.9019490056],[-118.267456972,33.9019490056],[-118.267543972,33.9019490056],[-118.267941972,33.9019440056],[-118.268454972,33.9019500056],[-118.268959972,33.9019560056],[-118.269057972,33.9019500056],[-118.269186972,33.9019400056],[-118.269797972,33.9019560056],[-118.270476972,33.9019560056],[-118.270640972,33.9019550056],[-118.271782972,33.9019610056],[-118.273504972,33.9019560056],[-118.273923972,33.9019520056],[-118.273971972,33.9019630056],[-118.274833972,33.9019600056],[-118.275180972,33.9019600056],[-118.275505972,33.9019610056],[-118.275702972,33.9019630056],[-118.276248972,33.9019600056],[-118.276751972,33.9019570056],[-118.277382972,33.9019680056],[-118.277511972,33.9019580056],[-118.278189972,33.9019680056],[-118.278370972,33.9019700056],[-118.279212972,33.9019620056],[-118.279858972,33.9019680056],[-118.280727972,33.9019460056],[-118.280975972,33.9019430056],[-118.281219972,33.9019330056],[-118.281497972,33.9019210056],[-118.281730972,33.9019140056],[-118.282007972,33.9019080056],[-118.282190972,33.9019030056],[-118.282210385,33.9019020812],[-118.282253972,33.9019000056],[-118.282256986,33.9009840024],[-118.282257986,33.9004610024],[-118.282262986,33.8987180024],[-118.282267995,33.8973149989],[-118.283140985,33.8970140012],[-118.283167988,33.8969960036],[-118.283200977,33.8969850058],[-118.283203986,33.8969480024],[-118.283148986,33.8956110024],[-118.283140986,33.8954290024],[-118.283116986,33.8948420024],[-118.283112986,33.8947470024],[-118.283089986,33.8941960024],[-118.283084986,33.8940640024],[-118.283059986,33.8934710024],[-118.283055986,33.8933660024],[-118.283051986,33.8932700024],[-118.283028986,33.8927220024],[-118.282984986,33.8916490024],[-118.282973986,33.8913880024],[-118.282958986,33.8910210024],[-118.282937986,33.8905070024],[-118.282908986,33.8898230024],[-118.282878986,33.8890900024],[-118.282848986,33.8883530024],[-118.282818986,33.8876350024],[-118.282790986,33.8869620024],[-118.282782986,33.8867660024],[-118.282763986,33.8863240024],[-118.282730986,33.8855260024],[-118.282728986,33.8854660012],[-118.282710117,33.8854673358],[-118.282629986,33.8854730022],[-118.282592986,33.8854750025],[-118.282190986,33.8855050026],[-118.282077986,33.8855170016],[-118.281349986,33.8855180025],[-118.280995986,33.8855260024],[-118.280633986,33.8855350024],[-118.280161986,33.8855470024],[-118.279784986,33.8855590023],[-118.279561986,33.8855630024],[-118.279170986,33.8855700023],[-118.278380986,33.8855820024],[-118.278115986,33.8855890023],[-118.277769986,33.8855930025],[-118.277154986,33.8856080024],[-118.276253986,33.8856380028],[-118.275920986,33.8856710017],[-118.275842986,33.8856720025],[-118.275354986,33.8856860023],[-118.273746986,33.8857240026],[-118.273544986,33.8857350024],[-118.273182987,33.885755001],[-118.272845986,33.8857040036],[-118.272794986,33.8857060023],[-118.271807986,33.8857410024],[-118.271277986,33.8857610023],[-118.270762986,33.8857770024],[-118.269537986,33.8858170024],[-118.268972986,33.8858400024],[-118.268090986,33.8858760024],[-118.267977986,33.8858810023],[-118.267778986,33.8858880024],[-118.265393986,33.8859750023],[-118.265328986,33.8859770021],[-118.265231986,33.8859770026],[-118.263752986,33.8860210024],[-118.263106986,33.8860400024],[-118.261362991,33.8860910013]]]},properties:{Name:"West Compton",Descriptio:""}}];var g_={type:__,features:m_};const y_="FeatureCollection",x_=[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-122.060393396277,37.5750250434658],[-122.058662270293,37.5770328629986],[-122.058430248169,37.5772846649412],[-122.058327812165,37.5772343103027],[-122.057828106478,37.5778210535685],[-122.056891385596,37.5784461876298],[-122.054989580206,37.5795373072827],[-122.054566070041,37.5798028054387],[-122.054000406349,37.5802393905733],[-122.05363941854,37.5805832427286],[-122.053749064407,37.5806474915575],[-122.052916498752,37.5816711095455],[-122.052715468593,37.5817370558936],[-122.052498931947,37.5819231218283],[-122.051076893724,37.5836731649757],[-122.051195619318,37.5837353021164],[-122.050907724734,37.5840847840072],[-122.05068893741,37.58426777334],[-122.050345237979,37.5845923971655],[-122.050692091012,37.5851295534416],[-122.050967907344,37.5852696679384],[-122.051489714175,37.5859690231555],[-122.052814535722,37.5878372443802],[-122.056311626808,37.5927310317131],[-122.056953973934,37.5925818455172],[-122.060470248657,37.5917976858734],[-122.064160100002,37.5868935773382],[-122.062021802514,37.5857116225294],[-122.06276623217,37.5848394716951],[-122.062437890821,37.5842036861546],[-122.062227255504,37.5836952180606],[-122.062061702659,37.5831762963127],[-122.061942043089,37.5826494471365],[-122.060391229813,37.5752275780802],[-122.060393396277,37.5750250434658]]]},properties:{NAME:"Lakes and Birds"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-122.011768233516,37.5606288760432],[-122.014979219507,37.5622899828429],[-122.015965589091,37.5627755716232],[-122.015989356096,37.5627402121633],[-122.022686793212,37.5660923889335],[-122.022703539604,37.5660711268939],[-122.025483437869,37.567430404538],[-122.026764714949,37.5680446822701],[-122.032390487217,37.5708446988957],[-122.035234115704,37.5676052683231],[-122.035951935574,37.5667263495438],[-122.037290167983,37.5650166599878],[-122.038640136824,37.5633481374517],[-122.035360837472,37.5602641164706],[-122.034030160785,37.5589953784635],[-122.031280896456,37.5564033507079],[-122.029791445458,37.5550391441317],[-122.029142500226,37.5543864455111],[-122.028734103922,37.5539366726726],[-122.028052279512,37.5531030196108],[-122.026433733816,37.5509608690541],[-122.024803215475,37.5487632190126],[-122.023058697971,37.5464804574541],[-122.022511791973,37.5471448437158],[-122.021880018463,37.5478416862671],[-122.021562362118,37.5482543392527],[-122.019027676054,37.5513125206353],[-122.018087220079,37.5524890826112],[-122.015637235475,37.5554772889151],[-122.014332085688,37.5572158555938],[-122.013601606621,37.5582236369192],[-122.01336919467,37.558508304792],[-122.011768233516,37.5606288760432]]]},properties:{NAME:"Cabrillo"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.988147674865,37.5683789573277],[-121.987995734712,37.5685070757328],[-121.988861148283,37.5691913482988],[-121.991269945428,37.5709394718006],[-121.996400032399,37.5748487278106],[-121.998054277734,37.5760935051673],[-122.001654934622,37.5789324822485],[-122.00311961522,37.5800703656174],[-122.006672897071,37.582762862424],[-122.007009551645,37.5830422645723],[-122.007258171578,37.5823167493133],[-122.007168273813,37.5822963510486],[-122.008128511174,37.5794769841973],[-122.008219032213,37.5794985118785],[-122.00837271779,37.5790312550658],[-122.009379266201,37.5794752201689],[-122.009312290009,37.5796484505152],[-122.011059033234,37.5806325651922],[-122.012204313198,37.5808396052766],[-122.013204983843,37.5807027023818],[-122.013841664352,37.5802392981274],[-122.014276106084,37.5791336327166],[-122.014837009305,37.5782826511136],[-122.015595674896,37.5770827060186],[-122.016046354438,37.5764499645261],[-122.015758525081,37.5762892088779],[-122.016015020004,37.575664093803],[-122.016861808369,37.5747351889629],[-122.018246135418,37.5745385407382],[-122.018381054057,37.5746141370702],[-122.022940028093,37.5765560636597],[-122.023496563333,37.5768246442157],[-122.024026190976,37.5771553337955],[-122.024686337374,37.577711202657],[-122.025494861285,37.5785260317693],[-122.026065860455,37.5778779415569],[-122.026548329538,37.5773669552705],[-122.028277052195,37.5754232354801],[-122.030857999416,37.5725966514588],[-122.032390487217,37.5708446988957],[-122.026764714949,37.5680446822701],[-122.025483437869,37.567430404538],[-122.022703539604,37.5660711268939],[-122.022686793212,37.5660923889335],[-122.015989356096,37.5627402121633],[-122.015965589091,37.5627755716232],[-122.014979219507,37.5622899828429],[-122.011768233516,37.5606288760432],[-122.011601958901,37.5608126232869],[-122.011175945168,37.5614116701878],[-122.010842434234,37.5617740202856],[-122.010549487559,37.5620089296285],[-122.009455582809,37.5626757854884],[-122.007460947179,37.5644150125697],[-122.00724793666,37.5646289164905],[-122.006650870813,37.5641884362652],[-122.006241571221,37.5645488567179],[-122.006157354732,37.5644917957326],[-122.005347431582,37.5652062068739],[-122.004640816437,37.5649790451943],[-122.004365347749,37.5655036344885],[-122.004028731349,37.5658660978914],[-122.003877801389,37.566210160379],[-122.003850998764,37.5664669983045],[-122.00387162102,37.5670434238904],[-122.003288336297,37.5668251964796],[-122.002820147513,37.5665374303662],[-122.00092164909,37.5657879975847],[-121.999981160445,37.5653926172333],[-121.99918924112,37.5652079328179],[-121.998468226995,37.5651570256167],[-121.997782896302,37.5651716412912],[-121.997216244341,37.5653138738717],[-121.996881762505,37.5653146611662],[-121.994116379792,37.565475514422],[-121.99346181166,37.5655460198788],[-121.992760766687,37.565672768106],[-121.992312617323,37.5657861035319],[-121.99157886068,37.5660245219162],[-121.990830436236,37.5663572326057],[-121.990452900104,37.56645629649],[-121.98981299909,37.5668552609929],[-121.989880495916,37.56691631323],[-121.989423655817,37.5672631901059],[-121.988734697302,37.5678390612648],[-121.988147674865,37.5683789573277]]]},properties:{NAME:"Brookvale"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.961571701155,37.5655379765304],[-121.962501549843,37.5665916968602],[-121.963178783189,37.567332811314],[-121.965106655869,37.5694723432364],[-121.966395837653,37.5708897341981],[-121.968949610592,37.5737546773605],[-121.969825042629,37.573130635509],[-121.970711785433,37.5726321580563],[-121.970086740642,37.5720834666682],[-121.969995967824,37.5713317974744],[-121.970097247824,37.5708762263147],[-121.970370667475,37.5704483840028],[-121.970699516275,37.5701589678279],[-121.970943942551,37.5700182648729],[-121.971508824527,37.5698137359169],[-121.972866170737,37.569435432267],[-121.97248315289,37.568374381805],[-121.972842517944,37.5681825717861],[-121.972871208445,37.5679407735791],[-121.97267094045,37.5676429083047],[-121.974498487276,37.5666219862203],[-121.976808825496,37.5652839933742],[-121.977525055225,37.5648992048863],[-121.978184410111,37.5644087325233],[-121.978583939385,37.5638628432892],[-121.978730762725,37.5634647213844],[-121.978803816967,37.5630782349604],[-121.978778354886,37.5624734308156],[-121.978621043198,37.5620041618028],[-121.978487236283,37.5613632344204],[-121.978494630479,37.5610579004344],[-121.978607608653,37.5606494919921],[-121.97889141863,37.5601944237859],[-121.976546889311,37.5596116235964],[-121.976883123096,37.5587729647778],[-121.976071085907,37.5583396745033],[-121.976054980092,37.558268611473],[-121.974386576611,37.5573927862371],[-121.973809190812,37.5571082171937],[-121.973234023023,37.5578161745722],[-121.97287031926,37.5581805587489],[-121.972331843658,37.5586054995947],[-121.971233392461,37.5593110161578],[-121.970786515585,37.5588888775096],[-121.970320105694,37.5581585786734],[-121.9699419873,37.5577056301366],[-121.968956522038,37.5567225915061],[-121.96860069256,37.5565244635322],[-121.967712801655,37.5562893754559],[-121.96723716244,37.5560515380127],[-121.966706788105,37.555574383796],[-121.966110482535,37.554902342309],[-121.964412505413,37.5555789565475],[-121.963750118575,37.5559326134075],[-121.961744200962,37.5574463184395],[-121.95897112042,37.5594319985217],[-121.958588566836,37.5597186323478],[-121.957140469864,37.5607429346732],[-121.957482855654,37.5610480428451],[-121.958037574013,37.5616241625743],[-121.960836650329,37.5647416596693],[-121.961571701155,37.5655379765304]]]},properties:{NAME:"Cherry/Guardino"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.987257184302,37.5567461849107],[-121.989939841579,37.558047508582],[-121.991518722887,37.558853661879],[-121.992480766888,37.5594127578331],[-121.994304367289,37.5603729130895],[-121.994911828715,37.5609053835827],[-121.995152029291,37.561197253006],[-121.99603030929,37.5630175019491],[-122.001729600897,37.5614333080588],[-122.001809469201,37.5617237978332],[-122.002230585067,37.5629534890622],[-122.002437674519,37.5636838500688],[-122.00135284248,37.5639037511784],[-122.001520468478,37.5645052436763],[-122.001527028661,37.5648381598277],[-122.001335913013,37.5652111353631],[-122.001122382634,37.5653425791854],[-122.000871221645,37.5656291638493],[-122.00092164909,37.5657879975847],[-122.002820147513,37.5665374303662],[-122.003288336297,37.5668251964796],[-122.00387162102,37.5670434238904],[-122.003850998764,37.5664669983045],[-122.003877801389,37.566210160379],[-122.004028731349,37.5658660978914],[-122.004365347749,37.5655036344885],[-122.004640816437,37.5649790451943],[-122.005347431582,37.5652062068739],[-122.006157354732,37.5644917957326],[-122.006241571221,37.5645488567179],[-122.006650870813,37.5641884362652],[-122.00724793666,37.5646289164905],[-122.007460947179,37.5644150125697],[-122.009455582809,37.5626757854884],[-122.010549487559,37.5620089296285],[-122.010842434234,37.5617740202856],[-122.011175945168,37.5614116701878],[-122.011601958901,37.5608126232869],[-122.011768233516,37.5606288760432],[-122.01336919467,37.558508304792],[-122.013601606621,37.5582236369192],[-122.014332085688,37.5572158555938],[-122.015637235475,37.5554772889151],[-122.018087220079,37.5524890826112],[-122.019027676054,37.5513125206353],[-122.021562362118,37.5482543392527],[-122.021880018463,37.5478416862671],[-122.022511791973,37.5471448437158],[-122.023058697971,37.5464804574541],[-122.021108901809,37.5436600555157],[-122.020326814822,37.5426441429478],[-122.01924045342,37.5411848468323],[-122.01755898692,37.5389610689142],[-122.017072148922,37.5395603098797],[-122.016640629044,37.5401857069538],[-122.01657990349,37.5403811275635],[-122.015807671699,37.5414611308839],[-122.014052485287,37.5438348092832],[-122.012265891639,37.5461596314777],[-122.010191493665,37.5487155180765],[-122.00973152734,37.5492523794581],[-122.009372726995,37.5496210955035],[-122.008365790652,37.5508388712249],[-122.007110981929,37.5524012998229],[-122.00554538031,37.5543282880884],[-122.0037455565,37.5565272525441],[-121.998966674884,37.554082481877],[-121.99626843494,37.5526721649757],[-121.996290191088,37.5526453800465],[-121.994499988086,37.5517304675304],[-121.992458643841,37.5507091080221],[-121.992233740239,37.5506113253439],[-121.990786129541,37.5498910371145],[-121.988357075564,37.5486365451745],[-121.985775796268,37.5517853007949],[-121.984336308911,37.5535811039613],[-121.983361823809,37.5547326882768],[-121.985350321042,37.5557434902768],[-121.987257184302,37.5567461849107]]]},properties:{NAME:"Centerville"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.991142851607,37.5453291877355],[-121.990926343009,37.5454612436788],[-121.988368700128,37.5486222919369],[-121.988357075564,37.5486365451745],[-121.990786129541,37.5498910371145],[-121.992233740239,37.5506113253439],[-121.992458643841,37.5507091080221],[-121.994499988086,37.5517304675304],[-121.996290191088,37.5526453800465],[-121.99626843494,37.5526721649757],[-121.998966674884,37.554082481877],[-122.0037455565,37.5565272525441],[-122.00554538031,37.5543282880884],[-122.007110981929,37.5524012998229],[-122.008365790652,37.5508388712249],[-122.009372726995,37.5496210955035],[-122.00973152734,37.5492523794581],[-122.010191493665,37.5487155180765],[-122.012265891639,37.5461596314777],[-122.014052485287,37.5438348092832],[-122.015807671699,37.5414611308839],[-122.01657990349,37.5403811275635],[-122.016640629044,37.5401857069538],[-122.017072148922,37.5395603098797],[-122.01755898692,37.5389610689142],[-122.016781090714,37.5381317058035],[-122.016059783,37.5374818176745],[-122.015355628268,37.5368814021117],[-122.01457539975,37.5362861633459],[-122.014123273307,37.5359851069351],[-122.013346600191,37.5355437577935],[-122.010971147143,37.53424297581],[-122.008068169236,37.5326685218919],[-122.003448394555,37.5302418458236],[-122.000850435804,37.5333452048012],[-121.999965151653,37.5344497339252],[-121.99848395276,37.5362453913853],[-121.998355230312,37.5363815077023],[-121.99718073573,37.5377948454126],[-121.996747709695,37.5383463941722],[-121.993808533997,37.5419542477168],[-121.991800807275,37.5444364891062],[-121.991703255776,37.5446400224014],[-121.991142851607,37.5453291877355]]]},properties:{NAME:"Glenmoor"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.954218641903,37.5418068847802],[-121.954606857261,37.5471053598235],[-121.954737395772,37.5486749954149],[-121.954716849673,37.5486902523302],[-121.954796214331,37.5499640005474],[-121.954983685056,37.5521781752647],[-121.95496536065,37.5524929449156],[-121.955148758628,37.5550419603313],[-121.955114278321,37.5550665149873],[-121.955450765545,37.5596697105048],[-121.95545114489,37.5596734249153],[-121.956474432017,37.5602962565109],[-121.957140469864,37.5607429346732],[-121.958588566836,37.5597186323478],[-121.95897112042,37.5594319985217],[-121.961744200962,37.5574463184395],[-121.963750118575,37.5559326134075],[-121.964412505413,37.5555789565475],[-121.966110482535,37.554902342309],[-121.966706788105,37.555574383796],[-121.96723716244,37.5560515380127],[-121.967712801655,37.5562893754559],[-121.96860069256,37.5565244635322],[-121.968956522038,37.5567225915061],[-121.9699419873,37.5577056301366],[-121.970320105694,37.5581585786734],[-121.970786515585,37.5588888775096],[-121.971233392461,37.5593110161578],[-121.972331843658,37.5586054995947],[-121.97287031926,37.5581805587489],[-121.973234023023,37.5578161745722],[-121.973809190812,37.5571082171937],[-121.974386576611,37.5573927862371],[-121.976054980092,37.558268611473],[-121.976071085907,37.5583396745033],[-121.976883123096,37.5587729647778],[-121.976546889311,37.5596116235964],[-121.97889141863,37.5601944237859],[-121.979492621817,37.5594762096468],[-121.980213406877,37.5585719262006],[-121.981785998535,37.5593891355506],[-121.982119128479,37.5595594326541],[-121.982671857975,37.558878385975],[-121.982785143678,37.5587388546405],[-121.983971034009,37.5572794185249],[-121.984287932287,37.5575181563432],[-121.984414237074,37.5577421303968],[-121.985905432218,37.5575930425174],[-121.986276816733,37.557507607801],[-121.986725770496,37.5572875734646],[-121.986987931795,37.5570628110283],[-121.987257184302,37.5567461849107],[-121.985350321042,37.5557434902768],[-121.983361823809,37.5547326882768],[-121.984336308911,37.5535811039613],[-121.985775796268,37.5517853007949],[-121.988357075564,37.5486365451745],[-121.988368700128,37.5486222919369],[-121.98262060775,37.5456507784291],[-121.980754032119,37.5447347734583],[-121.979601351731,37.544131296548],[-121.978279621708,37.5434568826307],[-121.976784131317,37.5426696854001],[-121.974337752819,37.5414099708112],[-121.973024898957,37.540714332531],[-121.971103605652,37.5396520523273],[-121.965951822769,37.5367287685213],[-121.965853127459,37.5369240384279],[-121.963136487134,37.5402415427566],[-121.961970852575,37.5416740584925],[-121.961492626008,37.5420111389463],[-121.961279987957,37.5418219245725],[-121.960933981564,37.5417599851852],[-121.960545020684,37.5415087206843],[-121.959939460563,37.5412360748432],[-121.959396293476,37.541066685482],[-121.958826996792,37.5409721238037],[-121.95804717537,37.5409601708427],[-121.956988012897,37.5411281554061],[-121.955964138421,37.541336895425],[-121.955179759884,37.5415333899562],[-121.954218641903,37.5418068847802]]]},properties:{NAME:"Central/Downtown"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.923716128023,37.5577219147138],[-121.923699915486,37.5596496054696],[-121.923781963402,37.5597502562753],[-121.923795133827,37.5604003820174],[-121.919417242573,37.560434112776],[-121.919583753807,37.5608617622585],[-121.919962828991,37.5615308410721],[-121.92002365838,37.5630938556675],[-121.920163966667,37.5636478894069],[-121.920320038212,37.5638352004207],[-121.920519293557,37.5643579965543],[-121.920181529705,37.565279515168],[-121.920162532831,37.5659611110133],[-121.920469769304,37.5663244934163],[-121.921297760053,37.5669577486196],[-121.92348842528,37.5683530870756],[-121.924377754695,37.5682119104744],[-121.925715291536,37.5681276472548],[-121.925827708202,37.5694345170328],[-121.926874394045,37.5707307407007],[-121.927629331899,37.5714828330644],[-121.928092009094,37.5716677469333],[-121.929873978628,37.572308514346],[-121.930502149592,37.5725166943491],[-121.931560831464,37.5727315251251],[-121.931831461427,37.5730102592943],[-121.932001267911,37.5720769512964],[-121.932110720025,37.5719130001558],[-121.932685867476,37.5714355511416],[-121.933249738309,37.5710705014317],[-121.933735984692,37.5710336781646],[-121.934175068708,37.5706422357768],[-121.934678367097,37.5706200570895],[-121.935071756834,37.5704709160348],[-121.935296058516,37.5703130944234],[-121.935896245649,37.570038520884],[-121.936548190809,37.5700626315174],[-121.937530796742,37.5705157163915],[-121.938623127677,37.5707375760527],[-121.939575798259,37.5706831473705],[-121.940855732738,37.5705338193252],[-121.941596009481,37.5706102799588],[-121.942578364654,37.5707876986149],[-121.944160836771,37.5705681098468],[-121.944590229919,37.5702954948205],[-121.946099975666,37.5700286972311],[-121.946915889675,37.5701954790477],[-121.947918070157,37.5700918114098],[-121.948990384586,37.5704003124888],[-121.951901541423,37.5706840500937],[-121.952475704635,37.5708400469156],[-121.954146865267,37.5703575901392],[-121.954628456185,37.5702791870102],[-121.955064558272,37.5700804889318],[-121.95614866438,37.5694902475246],[-121.957477496586,37.5692392766],[-121.958147404437,37.5683808499486],[-121.958241830488,37.5676517874886],[-121.959096936915,37.5670958819526],[-121.961571701155,37.5655379765304],[-121.960836650329,37.5647416596693],[-121.958037574013,37.5616241625743],[-121.957482855654,37.5610480428451],[-121.957140469864,37.5607429346732],[-121.956474432017,37.5602962565109],[-121.95545114489,37.5596734249153],[-121.955450765545,37.5596697105048],[-121.955114278321,37.5550665149873],[-121.955148758628,37.5550419603313],[-121.95496536065,37.5524929449156],[-121.954983685056,37.5521781752647],[-121.954796214331,37.5499640005474],[-121.954716849673,37.5486902523302],[-121.954737395772,37.5486749954149],[-121.954606857261,37.5471053598235],[-121.954218641903,37.5418068847802],[-121.953846055737,37.5364959415998],[-121.953704906801,37.5352786171141],[-121.953647020113,37.5333710578826],[-121.953459071181,37.5333989615238],[-121.95351189276,37.5346356240636],[-121.953499620848,37.5349791213855],[-121.953327355957,37.5354313777117],[-121.95282882843,37.536034489584],[-121.952618847161,37.5363370406105],[-121.951280658597,37.5378442953263],[-121.949467045549,37.5398333586177],[-121.948840120204,37.5404992811532],[-121.947641430807,37.5418311237506],[-121.945717727723,37.5439344430021],[-121.943126125032,37.5465582016216],[-121.941878882214,37.5477978746516],[-121.941470204936,37.5481609957929],[-121.939845565964,37.5497795203134],[-121.938919622245,37.550780376966],[-121.937398583337,37.5523338284943],[-121.937264014503,37.5524394845163],[-121.936785759186,37.552598823164],[-121.936612790578,37.5527203333656],[-121.934603339569,37.5536494581941],[-121.935036348871,37.5542190878758],[-121.936086815599,37.5548919914596],[-121.936650009622,37.5559685804461],[-121.936856000625,37.5566138244483],[-121.934398776415,37.5575930414123],[-121.932628185066,37.5585932202437],[-121.929774805972,37.5605767440438],[-121.924309394102,37.5575724884252],[-121.923716128023,37.5577219147138]]]},properties:{NAME:"Kimber/Gomes"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.973024898957,37.540714332531],[-121.974337752819,37.5414099708112],[-121.976784131317,37.5426696854001],[-121.978279621708,37.5434568826307],[-121.979601351731,37.544131296548],[-121.980754032119,37.5447347734583],[-121.98262060775,37.5456507784291],[-121.988368700128,37.5486222919369],[-121.990926343009,37.5454612436788],[-121.991142851607,37.5453291877355],[-121.991703255776,37.5446400224014],[-121.991800807275,37.5444364891062],[-121.993808533997,37.5419542477168],[-121.996747709695,37.5383463941722],[-121.99718073573,37.5377948454126],[-121.998355230312,37.5363815077023],[-121.995702167241,37.5350410313762],[-121.994891668552,37.53461727409],[-121.994310808075,37.534282508265],[-121.991861054474,37.5330360399015],[-121.989749000254,37.5319421498853],[-121.98826111928,37.5311853811897],[-121.985737257001,37.5299307989598],[-121.983123253264,37.5285928902896],[-121.982924817379,37.5284728588993],[-121.982867804018,37.5285961144012],[-121.98185665403,37.5298204892919],[-121.981330210471,37.5304908176994],[-121.979507404134,37.5327496585657],[-121.979122230552,37.5332410300462],[-121.976599282346,37.5363499154968],[-121.975865157516,37.5371932781462],[-121.973024898957,37.540714332531]]]},properties:{NAME:"Sundale"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.965951822769,37.5367287685213],[-121.971103605652,37.5396520523273],[-121.973024898957,37.540714332531],[-121.975865157516,37.5371932781462],[-121.976599282346,37.5363499154968],[-121.979122230552,37.5332410300462],[-121.979507404134,37.5327496585657],[-121.981330210471,37.5304908176994],[-121.98185665403,37.5298204892919],[-121.982867804018,37.5285961144012],[-121.982924817379,37.5284728588993],[-121.982778952938,37.528365601141],[-121.980931307834,37.527426322701],[-121.971803243869,37.5227688425177],[-121.971328251418,37.5225428340544],[-121.970665959529,37.5223775633246],[-121.970239554236,37.5223866281962],[-121.96910175986,37.522534155655],[-121.969322469986,37.523687528873],[-121.969512995744,37.5248714377199],[-121.969944030584,37.5278871020067],[-121.970172786152,37.5295578966298],[-121.970221422692,37.5302888182061],[-121.970162327688,37.5305819800335],[-121.969917491214,37.5310214373132],[-121.967939362307,37.5334677859931],[-121.966935415127,37.5346820350444],[-121.965496080209,37.5364449795875],[-121.965951822769,37.5367287685213]]]},properties:{NAME:"South Sundale"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.954218641903,37.5418068847802],[-121.955179759884,37.5415333899562],[-121.955964138421,37.541336895425],[-121.956988012897,37.5411281554061],[-121.95804717537,37.5409601708427],[-121.958826996792,37.5409721238037],[-121.959396293476,37.541066685482],[-121.959939460563,37.5412360748432],[-121.960545020684,37.5415087206843],[-121.960933981564,37.5417599851852],[-121.961279987957,37.5418219245725],[-121.961492626008,37.5420111389463],[-121.961970852575,37.5416740584925],[-121.963136487134,37.5402415427566],[-121.965853127459,37.5369240384279],[-121.965951822769,37.5367287685213],[-121.965496080209,37.5364449795875],[-121.966935415127,37.5346820350444],[-121.967939362307,37.5334677859931],[-121.969917491214,37.5310214373132],[-121.970162327688,37.5305819800335],[-121.970221422692,37.5302888182061],[-121.970172786152,37.5295578966298],[-121.969944030584,37.5278871020067],[-121.969512995744,37.5248714377199],[-121.969322469986,37.523687528873],[-121.96910175986,37.522534155655],[-121.957562039265,37.5240062889254],[-121.956904674835,37.52407486995],[-121.955847435319,37.5241525247569],[-121.954963329369,37.5242646235001],[-121.953340599127,37.5244376354885],[-121.952593348418,37.5245838709395],[-121.951323779123,37.5250043645303],[-121.949604679674,37.5256305611891],[-121.950016963114,37.5263475296632],[-121.950343584498,37.5268269286662],[-121.950827055485,37.5276566627546],[-121.953006498015,37.5314470460125],[-121.953031960742,37.5315147134021],[-121.953323642466,37.533268867925],[-121.953459071181,37.5333989615238],[-121.953647020113,37.5333710578826],[-121.953704906801,37.5352786171141],[-121.953846055737,37.5364959415998],[-121.954218641903,37.5418068847802]]]},properties:{NAME:"Irvington"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.962943951732,37.5092651156325],[-121.962119726081,37.5095883369942],[-121.961507109774,37.5097923237754],[-121.960843426548,37.5099618526197],[-121.960123049145,37.510111889861],[-121.958628026049,37.5103942707084],[-121.954317320988,37.5111656331126],[-121.953520412784,37.511349209213],[-121.952069088518,37.5118631613099],[-121.950916608193,37.5120848575709],[-121.949572503617,37.5123177791546],[-121.949121940728,37.5123469801873],[-121.947601145195,37.5122853462352],[-121.947239231318,37.5122945338896],[-121.946528832815,37.5123931237723],[-121.945902709243,37.5125521434512],[-121.944198529743,37.5131357956392],[-121.943358305016,37.5135811417287],[-121.942642690399,37.5138338932092],[-121.943947019222,37.5160412952751],[-121.944471252275,37.5168614320498],[-121.945771651765,37.5189791218851],[-121.946479955995,37.5202349889045],[-121.946815507385,37.5208800797063],[-121.948002500916,37.5229567737671],[-121.948707048108,37.5241625007027],[-121.949604679674,37.5256305611891],[-121.951323779123,37.5250043645303],[-121.952593348418,37.5245838709395],[-121.953340599127,37.5244376354885],[-121.954963329369,37.5242646235001],[-121.955847435319,37.5241525247569],[-121.956904674835,37.52407486995],[-121.957562039265,37.5240062889254],[-121.96910175986,37.522534155655],[-121.968498601344,37.520169194422],[-121.968348341011,37.5196571393983],[-121.967918752334,37.5180335624713],[-121.967742290097,37.517425570096],[-121.967509731477,37.516867014412],[-121.967015735194,37.5159903234073],[-121.964559753933,37.5117597365921],[-121.964416543971,37.5114382467608],[-121.963896156313,37.5106270375333],[-121.963149513076,37.5095128096245],[-121.962943951732,37.5092651156325]]]},properties:{NAME:"Grimmer"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.884277051425,37.5138425415066],[-121.880993098896,37.5110541990564],[-121.881126669387,37.5133706679236],[-121.879469704463,37.5256730409449],[-121.879071835853,37.5288537622043],[-121.878684590491,37.5290509765411],[-121.87813610463,37.5302243823809],[-121.880508546252,37.5333319356036],[-121.883128340147,37.5361215030496],[-121.885785647948,37.5380362247777],[-121.887302725128,37.5389796567587],[-121.888750654351,37.5312599678769],[-121.889505308059,37.5283112073549],[-121.890732060617,37.5287190091386],[-121.891254721652,37.5272928879245],[-121.892349843981,37.5277302275788],[-121.893682928499,37.5275112288863],[-121.894545241174,37.5280172553656],[-121.894687810448,37.5280129876775],[-121.89540545272,37.5277252980629],[-121.89607746519,37.5277424252824],[-121.898596328521,37.5278649805272],[-121.899096473906,37.5274344430236],[-121.901101170519,37.5264165252611],[-121.901237499317,37.5258181810178],[-121.901643770221,37.5251729869383],[-121.902298716776,37.5247213865346],[-121.903611856966,37.5244118184737],[-121.904203731497,37.5244994600659],[-121.905270624782,37.5245527505147],[-121.906108142261,37.5247757166445],[-121.907389674599,37.5260369261773],[-121.908823743327,37.5255424145804],[-121.909063736159,37.5254354651903],[-121.910066762025,37.524859455479],[-121.911642601132,37.5239116703881],[-121.913980453747,37.5241885360368],[-121.917824612904,37.5246554178707],[-121.917857013904,37.5223716507246],[-121.917836513632,37.5216220080193],[-121.917893575866,37.5189093538271],[-121.917940743559,37.5183179729373],[-121.918098602716,37.5175891396967],[-121.918871950604,37.5154829469934],[-121.91922015795,37.5141891287594],[-121.919023952913,37.5141553991954],[-121.918831161083,37.5143512031522],[-121.918339880415,37.5143826583205],[-121.917929745798,37.5140287001465],[-121.91707707738,37.514143775941],[-121.915511149004,37.5132173235285],[-121.914395795059,37.5134095663894],[-121.910751085483,37.512888302343],[-121.910269504661,37.5124568765644],[-121.909453347591,37.512426554567],[-121.908334640859,37.51325079857],[-121.907398853286,37.5134578836504],[-121.906757113619,37.5135996080781],[-121.906022841203,37.513769337974],[-121.905570304466,37.5142798455062],[-121.905267090685,37.5144632276857],[-121.905629653182,37.5151543275139],[-121.903777097843,37.5151755712018],[-121.903683478998,37.5153054793244],[-121.902754454175,37.5137457480559],[-121.90264312629,37.513558833723],[-121.901942595376,37.5123826633199],[-121.901799228347,37.5127603414276],[-121.901336249794,37.5130582955755],[-121.900873513779,37.5130505440285],[-121.900545796867,37.5134060828275],[-121.899816356071,37.5136940115982],[-121.899512097672,37.5138426731142],[-121.898883919676,37.5138881920812],[-121.89793784331,37.5140896312641],[-121.897507330272,37.5145687314927],[-121.89725445901,37.5150915008359],[-121.897104910842,37.5152076321826],[-121.89644003713,37.5153925368554],[-121.896244672016,37.5155770510357],[-121.895712285632,37.5158173761237],[-121.895206590998,37.516215282144],[-121.895189235506,37.5165815845619],[-121.895051427495,37.5167584435382],[-121.893273885187,37.515877511909],[-121.8902493546,37.5139486393204],[-121.889853079917,37.5139961504572],[-121.888657767515,37.5157716514039],[-121.885519462457,37.515365670527],[-121.884277051425,37.5138425415066]]]},properties:{NAME:"Mission Hills"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.931831461427,37.5730102592943],[-121.932980504817,37.5741936819339],[-121.9327165268,37.574425539533],[-121.932415511325,37.5750433918882],[-121.933243211852,37.5758872828941],[-121.933314525669,37.5771360591161],[-121.931317802361,37.5762868855597],[-121.9308208296,37.5768666233852],[-121.929426756536,37.5787551577209],[-121.926028765831,37.5797656494123],[-121.927158610634,37.5812359077486],[-121.925621379968,37.5823366699932],[-121.92836786152,37.5843623283773],[-121.92846979954,37.5853031663074],[-121.928114341582,37.5859442106086],[-121.929916267008,37.5860540658035],[-121.930256370631,37.5862027372511],[-121.932379902087,37.5906187365563],[-121.932323900732,37.5925222112316],[-121.93288391903,37.592048737072],[-121.933435427992,37.5917872504841],[-121.934187248175,37.5916005802447],[-121.93463856662,37.5915624777321],[-121.935091821215,37.5915810228108],[-121.93553584806,37.5916557605883],[-121.936050110398,37.591820620928],[-121.936515395134,37.5920605319539],[-121.936909476681,37.592361994311],[-121.937285478654,37.5930255194812],[-121.937449068782,37.5934657402139],[-121.937783008411,37.5946957604965],[-121.937871259927,37.5952500276895],[-121.937894704811,37.5957948049408],[-121.93785533505,37.5960986693711],[-121.937689118658,37.5968617314138],[-121.937674878845,37.5977977673219],[-121.937857271456,37.5982069036883],[-121.938093347519,37.5983839911877],[-121.938573163039,37.5984655382833],[-121.939534788053,37.5984890731787],[-121.940558604098,37.5983071655584],[-121.941036485455,37.5981319384694],[-121.941604898619,37.5978525026813],[-121.942358366008,37.5975707965318],[-121.943048771863,37.5973782260042],[-121.943406496861,37.5972118276392],[-121.944292205424,37.5970684007324],[-121.945421203032,37.5970618940238],[-121.945939936811,37.597084975588],[-121.946376396581,37.597160612146],[-121.946871093651,37.5973754482941],[-121.947738342704,37.5977108860728],[-121.94811929057,37.5977872004475],[-121.948415527426,37.5977909168079],[-121.948972715309,37.59788714976],[-121.950138876958,37.5978875052231],[-121.951021853393,37.5976041444454],[-121.951424822092,37.597385616013],[-121.951770691291,37.5970867848148],[-121.952038369977,37.5965753618538],[-121.952290125893,37.5961966865361],[-121.952886155343,37.595438192124],[-121.953458727615,37.5949009057646],[-121.954046345694,37.5941866920562],[-121.955028352598,37.5932908605865],[-121.955489146195,37.5927181279872],[-121.955671312467,37.5925685901528],[-121.955905973037,37.59226376194],[-121.956278262222,37.5918983128658],[-121.956544739178,37.5913279792448],[-121.956953018515,37.5909105356711],[-121.957208075616,37.5902298828336],[-121.957247563318,37.5898832824435],[-121.957575781372,37.5894294330544],[-121.957519746345,37.5893861697973],[-121.957397062388,37.5892905234164],[-121.957275141852,37.5888810530809],[-121.957704597907,37.5885138461563],[-121.958740553671,37.5877435837113],[-121.959297611902,37.5873716976867],[-121.961935124111,37.5862515687272],[-121.962534670789,37.5859354461033],[-121.962953374172,37.5856380517573],[-121.963530188675,37.5851316530247],[-121.963954212378,37.5841396034321],[-121.963998011664,37.5838218088816],[-121.963842503944,37.5820562096103],[-121.963810196566,37.5812027149104],[-121.963853840968,37.5803503346346],[-121.964122570919,37.5799751468113],[-121.964373909462,37.5797687574987],[-121.964739775096,37.5795945886473],[-121.967587095027,37.5787189192721],[-121.969340404007,37.5781043472894],[-121.969951226648,37.5779329995448],[-121.971610987065,37.5765216914605],[-121.971033437614,37.5760238588227],[-121.970707576622,37.5756880229593],[-121.968949610592,37.5737546773605],[-121.966395837653,37.5708897341981],[-121.965106655869,37.5694723432364],[-121.963178783189,37.567332811314],[-121.962501549843,37.5665916968602],[-121.961571701155,37.5655379765304],[-121.959096936915,37.5670958819526],[-121.958241830488,37.5676517874886],[-121.958147404437,37.5683808499486],[-121.957477496586,37.5692392766],[-121.95614866438,37.5694902475246],[-121.955064558272,37.5700804889318],[-121.954628456185,37.5702791870102],[-121.954146865267,37.5703575901392],[-121.952475704635,37.5708400469156],[-121.951901541423,37.5706840500937],[-121.948990384586,37.5704003124888],[-121.947918070157,37.5700918114098],[-121.946915889675,37.5701954790477],[-121.946099975666,37.5700286972311],[-121.944590229919,37.5702954948205],[-121.944160836771,37.5705681098468],[-121.942578364654,37.5707876986149],[-121.941596009481,37.5706102799588],[-121.940855732738,37.5705338193252],[-121.939575798259,37.5706831473705],[-121.938623127677,37.5707375760527],[-121.937530796742,37.5705157163915],[-121.936548190809,37.5700626315174],[-121.935896245649,37.570038520884],[-121.935296058516,37.5703130944234],[-121.935071756834,37.5704709160348],[-121.934678367097,37.5706200570895],[-121.934175068708,37.5706422357768],[-121.933735984692,37.5710336781646],[-121.933249738309,37.5710705014317],[-121.932685867476,37.5714355511416],[-121.932110720025,37.5719130001558],[-121.932001267911,37.5720769512964],[-121.931831461427,37.5730102592943]]]},properties:{NAME:"Canyon Heights/Vallejo Mills/Niles Crest"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.936531728715,37.533253634487],[-121.937336275622,37.5328174451332],[-121.937787911767,37.5324496912346],[-121.938218675892,37.5324303425647],[-121.938339595085,37.5322619964906],[-121.938431074298,37.5318193355749],[-121.938401306433,37.5314385873622],[-121.938676817141,37.5311492089584],[-121.939645404482,37.5310291916473],[-121.940776001444,37.5309937044316],[-121.941923497283,37.5311186839945],[-121.943010538619,37.5313274823108],[-121.944340757441,37.5317149117932],[-121.948984532957,37.5332078461808],[-121.950072219521,37.5335303179421],[-121.950383758624,37.5335875883724],[-121.951179578336,37.5335628008728],[-121.953323642466,37.533268867925],[-121.953031960742,37.5315147134021],[-121.953006498015,37.5314470460125],[-121.950827055485,37.5276566627546],[-121.950343584498,37.5268269286662],[-121.950016963114,37.5263475296632],[-121.949604679674,37.5256305611891],[-121.948707048108,37.5241625007027],[-121.948002500916,37.5229567737671],[-121.946815507385,37.5208800797063],[-121.946479955995,37.5202349889045],[-121.945771651765,37.5189791218851],[-121.944471252275,37.5168614320498],[-121.943947019222,37.5160412952751],[-121.942642690399,37.5138338932092],[-121.942340776268,37.513897780366],[-121.941396391935,37.5141774317155],[-121.938964341179,37.5148697666238],[-121.938334239382,37.5150296385968],[-121.937650466613,37.5150557540946],[-121.936932138209,37.5149403185334],[-121.934566767906,37.5139182021939],[-121.934265335084,37.513828543589],[-121.933939747634,37.5138373475769],[-121.931210509467,37.514289667894],[-121.931126995248,37.5147427135419],[-121.930907864103,37.5150995102026],[-121.93063349821,37.5153527457736],[-121.930302887629,37.5155425583669],[-121.929990640159,37.5156519815289],[-121.92786849747,37.5160204904841],[-121.927196376648,37.5162351820681],[-121.926682026409,37.5165248917348],[-121.926307072198,37.5168597358243],[-121.926090537885,37.5171235787735],[-121.92505845413,37.5186204824096],[-121.924882364239,37.5190475027275],[-121.924842159531,37.5196024324925],[-121.924874062367,37.5199092884787],[-121.925043112839,37.52036478437],[-121.925485456206,37.5209758252716],[-121.926003972799,37.5214442653213],[-121.926432877296,37.5216919939191],[-121.927736038967,37.5222998698597],[-121.928123412825,37.5225696493133],[-121.928396237302,37.5230472850778],[-121.928505084964,37.5235645439483],[-121.928703127512,37.5247205799248],[-121.928922021636,37.5254348212025],[-121.929168586491,37.5258833191251],[-121.929347418661,37.5261266353],[-121.931432182262,37.5283693871933],[-121.933516368255,37.5305753741929],[-121.933941668094,37.5311481115131],[-121.934032208173,37.5314804644588],[-121.934227160952,37.5319349276779],[-121.934587711122,37.5323892343858],[-121.934904374746,37.5326239917603],[-121.93530628144,37.5328075798384],[-121.936531728715,37.533253634487]]]},properties:{NAME:"Cameron Hills"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.98780372009,37.5225935098953],[-121.9862261937,37.5244417000422],[-121.985962931561,37.5247296653398],[-121.98473357336,37.5262075216438],[-121.982953047584,37.5283720633807],[-121.982924817379,37.5284728588993],[-121.983123253264,37.5285928902896],[-121.985737257001,37.5299307989598],[-121.98826111928,37.5311853811897],[-121.989749000254,37.5319421498853],[-121.991861054474,37.5330360399015],[-121.994310808075,37.534282508265],[-121.994891668552,37.53461727409],[-121.995702167241,37.5350410313762],[-121.998355230312,37.5363815077023],[-121.99848395276,37.5362453913853],[-121.999965151653,37.5344497339252],[-122.000850435804,37.5333452048012],[-122.003448394555,37.5302418458236],[-121.990292434316,37.5237609518023],[-121.98780372009,37.5225935098953]]]},properties:{NAME:"28 Palms"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.887302725128,37.5389796567587],[-121.887365626489,37.5423581376406],[-121.887428014329,37.5430554108868],[-121.887146830116,37.5432571061739],[-121.888347958674,37.5451528918757],[-121.890524180339,37.5477151831315],[-121.890710529121,37.5479461507193],[-121.893623512947,37.5502068701052],[-121.896994160218,37.548128583632],[-121.899297703484,37.5465701559643],[-121.904829361078,37.5501154135756],[-121.906611158844,37.5494427762762],[-121.906733672332,37.5495524417908],[-121.907352591387,37.5492842289734],[-121.907686527475,37.5501269758624],[-121.909583093063,37.5550098920944],[-121.914600546597,37.5561392387719],[-121.914905958574,37.5565376772054],[-121.91482678641,37.5574846030686],[-121.916747005098,37.555233361686],[-121.917516143112,37.5557645105383],[-121.918181843127,37.5551206096572],[-121.918358072282,37.554863035988],[-121.918410874013,37.5544651513241],[-121.918323253651,37.554212135613],[-121.917900687242,37.5535813627824],[-121.917866520032,37.553327015227],[-121.917919630513,37.5531265486338],[-121.918701600244,37.5515096233069],[-121.919300459931,37.5502714686281],[-121.919536409266,37.5501614964057],[-121.919410400743,37.5499758958532],[-121.920282146416,37.5484714801542],[-121.920565602381,37.5475966499256],[-121.920520870522,37.5465170338379],[-121.922029158853,37.5465564755742],[-121.922070490524,37.5459204477226],[-121.92080757699,37.5449087822536],[-121.921009172517,37.5446880746634],[-121.921326074241,37.5443411253834],[-121.921642210286,37.5439950099264],[-121.923016139478,37.5430527286255],[-121.923763594529,37.5423631696875],[-121.924144407362,37.5418929828542],[-121.924535492419,37.5415994908044],[-121.925251226253,37.5412755817533],[-121.924819845313,37.5409560518192],[-121.92437277641,37.5404859397468],[-121.923731660433,37.539616933728],[-121.923791173055,37.5392030460821],[-121.925364763344,37.5390572769507],[-121.925670617313,37.5389976010353],[-121.925976902188,37.538870282335],[-121.927000718719,37.5382958002872],[-121.929600796235,37.5369986337345],[-121.931667273989,37.5359393230941],[-121.93259463556,37.5353755807324],[-121.933175151344,37.5349815531278],[-121.93350047094,37.534859131507],[-121.934583297652,37.5343099569105],[-121.936531728715,37.533253634487],[-121.93530628144,37.5328075798384],[-121.934904374746,37.5326239917603],[-121.934587711122,37.5323892343858],[-121.934227160952,37.5319349276779],[-121.934032208173,37.5314804644588],[-121.933941668094,37.5311481115131],[-121.933516368255,37.5305753741929],[-121.931432182262,37.5283693871933],[-121.929347418661,37.5261266353],[-121.929168586491,37.5258833191251],[-121.928922021636,37.5254348212025],[-121.928703127512,37.5247205799248],[-121.928505084964,37.5235645439483],[-121.928396237302,37.5230472850778],[-121.928123412825,37.5225696493133],[-121.927736038967,37.5222998698597],[-121.926432877296,37.5216919939191],[-121.926003972799,37.5214442653213],[-121.925485456206,37.5209758252716],[-121.925043112839,37.52036478437],[-121.924874062367,37.5199092884787],[-121.924842159531,37.5196024324925],[-121.924882364239,37.5190475027275],[-121.92505845413,37.5186204824096],[-121.926090537885,37.5171235787735],[-121.926307072198,37.5168597358243],[-121.926682026409,37.5165248917348],[-121.927196376648,37.5162351820681],[-121.92786849747,37.5160204904841],[-121.929990640159,37.5156519815289],[-121.930302887629,37.5155425583669],[-121.93063349821,37.5153527457736],[-121.930907864103,37.5150995102026],[-121.931126995248,37.5147427135419],[-121.931210509467,37.514289667894],[-121.927172951716,37.5149785255159],[-121.926635587808,37.5150376597015],[-121.926192553861,37.5150487640917],[-121.925365202015,37.5149671703443],[-121.924856635658,37.5148521114262],[-121.924415548197,37.5147088556871],[-121.923347370514,37.5143099865568],[-121.922589067611,37.5140908689014],[-121.922147207486,37.5140242274796],[-121.920876079908,37.5138806468503],[-121.920165774612,37.5137791180975],[-121.919357192819,37.5136025529588],[-121.91922015795,37.5141891287594],[-121.918871950604,37.5154829469934],[-121.918098602716,37.5175891396967],[-121.917940743559,37.5183179729373],[-121.917893575866,37.5189093538271],[-121.917836513632,37.5216220080193],[-121.917857013904,37.5223716507246],[-121.917824612904,37.5246554178707],[-121.913980453747,37.5241885360368],[-121.911642601132,37.5239116703881],[-121.910066762025,37.524859455479],[-121.909063736159,37.5254354651903],[-121.908823743327,37.5255424145804],[-121.907389674599,37.5260369261773],[-121.906108142261,37.5247757166445],[-121.905270624782,37.5245527505147],[-121.904203731497,37.5244994600659],[-121.903611856966,37.5244118184737],[-121.902298716776,37.5247213865346],[-121.901643770221,37.5251729869383],[-121.901237499317,37.5258181810178],[-121.901101170519,37.5264165252611],[-121.899096473906,37.5274344430236],[-121.898596328521,37.5278649805272],[-121.89607746519,37.5277424252824],[-121.89540545272,37.5277252980629],[-121.894687810448,37.5280129876775],[-121.894545241174,37.5280172553656],[-121.893682928499,37.5275112288863],[-121.892349843981,37.5277302275788],[-121.891254721652,37.5272928879245],[-121.890732060617,37.5287190091386],[-121.889505308059,37.5283112073549],[-121.888750654351,37.5312599678769],[-121.887302725128,37.5389796567587]]]},properties:{NAME:"Mission San Jose"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.91482678641,37.5574846030686],[-121.914753560973,37.5583603674534],[-121.914510307935,37.5607747085248],[-121.916462171095,37.5603093120139],[-121.916539289424,37.5610260774823],[-121.918830604983,37.5609702773023],[-121.918858280483,37.5607132750565],[-121.918506040077,37.5598318432909],[-121.920638423553,37.5593237902432],[-121.922125030769,37.5584224072453],[-121.92216627386,37.5581597472815],[-121.923716128023,37.5577219147138],[-121.924309394102,37.5575724884252],[-121.929774805972,37.5605767440438],[-121.932628185066,37.5585932202437],[-121.934398776415,37.5575930414123],[-121.936856000625,37.5566138244483],[-121.936650009622,37.5559685804461],[-121.936086815599,37.5548919914596],[-121.935036348871,37.5542190878758],[-121.934603339569,37.5536494581941],[-121.936612790578,37.5527203333656],[-121.936785759186,37.552598823164],[-121.937264014503,37.5524394845163],[-121.937398583337,37.5523338284943],[-121.938919622245,37.550780376966],[-121.939845565964,37.5497795203134],[-121.941470204936,37.5481609957929],[-121.941878882214,37.5477978746516],[-121.943126125032,37.5465582016216],[-121.945717727723,37.5439344430021],[-121.947641430807,37.5418311237506],[-121.948840120204,37.5404992811532],[-121.949467045549,37.5398333586177],[-121.951280658597,37.5378442953263],[-121.952618847161,37.5363370406105],[-121.95282882843,37.536034489584],[-121.953327355957,37.5354313777117],[-121.953499620848,37.5349791213855],[-121.95351189276,37.5346356240636],[-121.953459071181,37.5333989615238],[-121.953323642466,37.533268867925],[-121.951179578336,37.5335628008728],[-121.950383758624,37.5335875883724],[-121.950072219521,37.5335303179421],[-121.948984532957,37.5332078461808],[-121.944340757441,37.5317149117932],[-121.943010538619,37.5313274823108],[-121.941923497283,37.5311186839945],[-121.940776001444,37.5309937044316],[-121.939645404482,37.5310291916473],[-121.938676817141,37.5311492089584],[-121.938401306433,37.5314385873622],[-121.938431074298,37.5318193355749],[-121.938339595085,37.5322619964906],[-121.938218675892,37.5324303425647],[-121.937787911767,37.5324496912346],[-121.937336275622,37.5328174451332],[-121.936531728715,37.533253634487],[-121.934583297652,37.5343099569105],[-121.93350047094,37.534859131507],[-121.933175151344,37.5349815531278],[-121.93259463556,37.5353755807324],[-121.931667273989,37.5359393230941],[-121.929600796235,37.5369986337345],[-121.927000718719,37.5382958002872],[-121.925976902188,37.538870282335],[-121.925670617313,37.5389976010353],[-121.925364763344,37.5390572769507],[-121.923791173055,37.5392030460821],[-121.923731660433,37.539616933728],[-121.92437277641,37.5404859397468],[-121.924819845313,37.5409560518192],[-121.925251226253,37.5412755817533],[-121.924535492419,37.5415994908044],[-121.924144407362,37.5418929828542],[-121.923763594529,37.5423631696875],[-121.923016139478,37.5430527286255],[-121.921642210286,37.5439950099264],[-121.921326074241,37.5443411253834],[-121.921009172517,37.5446880746634],[-121.92080757699,37.5449087822536],[-121.922070490524,37.5459204477226],[-121.922029158853,37.5465564755742],[-121.920520870522,37.5465170338379],[-121.920565602381,37.5475966499256],[-121.920282146416,37.5484714801542],[-121.919410400743,37.5499758958532],[-121.919536409266,37.5501614964057],[-121.919300459931,37.5502714686281],[-121.918701600244,37.5515096233069],[-121.917919630513,37.5531265486338],[-121.917866520032,37.553327015227],[-121.917900687242,37.5535813627824],[-121.918323253651,37.554212135613],[-121.918410874013,37.5544651513241],[-121.918358072282,37.554863035988],[-121.918181843127,37.5551206096572],[-121.917516143112,37.5557645105383],[-121.916747005098,37.555233361686],[-121.91482678641,37.5574846030686]]]},properties:{NAME:"Mission Valley"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.931210509467,37.514289667894],[-121.933939747634,37.5138373475769],[-121.934265335084,37.513828543589],[-121.934566767906,37.5139182021939],[-121.936932138209,37.5149403185334],[-121.937650466613,37.5150557540946],[-121.938334239382,37.5150296385968],[-121.938964341179,37.5148697666238],[-121.941396391935,37.5141774317155],[-121.941128902216,37.5136810126746],[-121.94086085774,37.5134469980713],[-121.939531987978,37.5129266877763],[-121.939118165969,37.5126567390058],[-121.93891710212,37.5124226366543],[-121.937198369703,37.5095705641272],[-121.937007819246,37.5091656877327],[-121.935897449933,37.5072805659109],[-121.935385536284,37.5063906922018],[-121.935259045265,37.505999107383],[-121.934957156804,37.5057256030756],[-121.934506325164,37.505153789759],[-121.933630867311,37.5042648900872],[-121.931312763002,37.5022524476923],[-121.931085796127,37.5020994366762],[-121.928602063968,37.499836529725],[-121.927640626103,37.4986890874174],[-121.926911347107,37.4980521170435],[-121.926025755084,37.4971725799653],[-121.925792993971,37.4968162667364],[-121.925711888404,37.4965596015579],[-121.925345007645,37.4957187966464],[-121.925240826003,37.4954229518312],[-121.925702876606,37.4953413205658],[-121.925662677277,37.4951320233188],[-121.925388350609,37.4950282295498],[-121.925192798502,37.4947171292882],[-121.925300846297,37.4944181376049],[-121.924843977262,37.4941925780004],[-121.924041824309,37.4949206166297],[-121.921284044176,37.4969018704066],[-121.921283945984,37.4969018220307],[-121.920725128506,37.4973057979045],[-121.920443028261,37.4976379424944],[-121.920150523077,37.4980746545359],[-121.919632916505,37.4990697632679],[-121.919536281839,37.4993660447954],[-121.91950220321,37.4997105431315],[-121.919519413116,37.5012215195184],[-121.91957048841,37.5022763033559],[-121.919572782525,37.5028118469237],[-121.919695623342,37.506459890973],[-121.919739033828,37.5066542890932],[-121.919877223346,37.5100797957178],[-121.919834576919,37.5107822730573],[-121.919357192819,37.5136025529588],[-121.920165774612,37.5137791180975],[-121.920876079908,37.5138806468503],[-121.922147207486,37.5140242274796],[-121.922589067611,37.5140908689014],[-121.923347370514,37.5143099865568],[-121.924415548197,37.5147088556871],[-121.924856635658,37.5148521114262],[-121.925365202015,37.5149671703443],[-121.926192553861,37.5150487640917],[-121.926635587808,37.5150376597015],[-121.927172951716,37.5149785255159],[-121.931210509467,37.514289667894]]]},properties:{NAME:"Weibel"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.884277051425,37.5138425415066],[-121.885519462457,37.515365670527],[-121.888657767515,37.5157716514039],[-121.889853079917,37.5139961504572],[-121.8902493546,37.5139486393204],[-121.893273885187,37.515877511909],[-121.895051427495,37.5167584435382],[-121.895189235506,37.5165815845619],[-121.895206590998,37.516215282144],[-121.895712285632,37.5158173761237],[-121.896244672016,37.5155770510357],[-121.89644003713,37.5153925368554],[-121.897104910842,37.5152076321826],[-121.89725445901,37.5150915008359],[-121.897507330272,37.5145687314927],[-121.89793784331,37.5140896312641],[-121.898883919676,37.5138881920812],[-121.899512097672,37.5138426731142],[-121.899816356071,37.5136940115982],[-121.900545796867,37.5134060828275],[-121.900873513779,37.5130505440285],[-121.901336249794,37.5130582955755],[-121.901799228347,37.5127603414276],[-121.901942595376,37.5123826633199],[-121.90264312629,37.513558833723],[-121.902754454175,37.5137457480559],[-121.903683478998,37.5153054793244],[-121.903777097843,37.5151755712018],[-121.905629653182,37.5151543275139],[-121.905267090685,37.5144632276857],[-121.905570304466,37.5142798455062],[-121.906022841203,37.513769337974],[-121.906757113619,37.5135996080781],[-121.907398853286,37.5134578836504],[-121.908334640859,37.51325079857],[-121.909453347591,37.512426554567],[-121.910269504661,37.5124568765644],[-121.910751085483,37.512888302343],[-121.914395795059,37.5134095663894],[-121.915511149004,37.5132173235285],[-121.91707707738,37.514143775941],[-121.917929745798,37.5140287001465],[-121.918339880415,37.5143826583205],[-121.918831161083,37.5143512031522],[-121.919023952913,37.5141553991954],[-121.91922015795,37.5141891287594],[-121.919357192819,37.5136025529588],[-121.919834576919,37.5107822730573],[-121.919877223346,37.5100797957178],[-121.919739033828,37.5066542890932],[-121.919695623342,37.506459890973],[-121.919572782525,37.5028118469237],[-121.91957048841,37.5022763033559],[-121.919519413116,37.5012215195184],[-121.91950220321,37.4997105431315],[-121.919536281839,37.4993660447954],[-121.919632916505,37.4990697632679],[-121.920150523077,37.4980746545359],[-121.920443028261,37.4976379424944],[-121.920725128506,37.4973057979045],[-121.921283945984,37.4969018220307],[-121.921080148178,37.4967988778193],[-121.921371001202,37.49641321629],[-121.921463108739,37.4961813725122],[-121.92105585077,37.4946196188409],[-121.920784398039,37.4942139801377],[-121.918885684276,37.4928951420981],[-121.918515852511,37.4926627022151],[-121.918331128667,37.4917409925168],[-121.918108209589,37.4916200806129],[-121.917441632981,37.4909187779419],[-121.916383603275,37.4902060553298],[-121.916576648769,37.4898435581228],[-121.917020935591,37.4895508182677],[-121.916530970851,37.4887999970857],[-121.915929285796,37.488246228021],[-121.915502323782,37.4875447721791],[-121.915398346308,37.4870608784599],[-121.915105176176,37.4865974627598],[-121.91461284712,37.4861742134697],[-121.914262504256,37.4853310583155],[-121.913383221762,37.4848595876905],[-121.913427866792,37.4843962234759],[-121.91264216748,37.4839510885357],[-121.912898966381,37.4831328984718],[-121.912860669011,37.48265782864],[-121.912192608591,37.4821443224185],[-121.911170130363,37.4806599752478],[-121.911503443537,37.4798779496528],[-121.910960983048,37.4794429287037],[-121.911497196225,37.4784552041083],[-121.910840134173,37.4781561502186],[-121.910319695785,37.4777002611877],[-121.910336950765,37.4772458088138],[-121.911135070612,37.4768945914087],[-121.910461883616,37.4757421740272],[-121.910541530822,37.4750332397845],[-121.91010529272,37.474016686515],[-121.909409027875,37.4730997312292],[-121.909297686029,37.4725877672949],[-121.908627953288,37.4719795006132],[-121.908243260807,37.4715916720781],[-121.907976837498,37.4708965035535],[-121.907796726748,37.4706658759974],[-121.907307739811,37.4697725181576],[-121.907317251664,37.4693634794585],[-121.906689138935,37.4689497235627],[-121.906530857123,37.4685056149774],[-121.906091712975,37.4682440968062],[-121.905897230992,37.4680730361785],[-121.904030370836,37.4671154701653],[-121.903619259022,37.4670606441173],[-121.903145566567,37.4671596969125],[-121.903027777324,37.4668517507859],[-121.904089742551,37.4665166556825],[-121.904339991119,37.4663553799952],[-121.904405114931,37.4661537428831],[-121.904342199458,37.4660150977911],[-121.903825713627,37.465396387724],[-121.903138144183,37.4646581837644],[-121.90164486267,37.4649615749658],[-121.901198139083,37.4651379505658],[-121.901063246146,37.4652643637417],[-121.900734614489,37.4653824853635],[-121.90040473614,37.4656038322576],[-121.90020266637,37.4656716751564],[-121.899508545401,37.4657879842493],[-121.899025579169,37.4659999181002],[-121.898815194215,37.4661345105206],[-121.89866718723,37.4665544125438],[-121.898315267482,37.4668020776801],[-121.897717072782,37.4670992019998],[-121.897090274938,37.4670702582196],[-121.896885938087,37.4671568683191],[-121.896342190671,37.4675133218875],[-121.895757778906,37.4674605996714],[-121.895588167025,37.4675017121014],[-121.895216191662,37.467781288383],[-121.894290564667,37.4678633451904],[-121.893303803076,37.4678936661682],[-121.892975470669,37.4678136089065],[-121.892045427705,37.4680581639628],[-121.891057458511,37.4680069277432],[-121.890623283396,37.4683406363366],[-121.890193210957,37.4688242437641],[-121.88989854963,37.46951046998],[-121.889634691239,37.4698252227697],[-121.889429258852,37.4701559523332],[-121.888785674904,37.4704581579869],[-121.88809801231,37.4708817586684],[-121.887801329952,37.4710166455322],[-121.887038843522,37.4711761436866],[-121.885943844013,37.4715046671143],[-121.885363854278,37.4715292721814],[-121.885181294786,37.4714498799422],[-121.884865872778,37.4714586220948],[-121.884576100565,37.4713267193062],[-121.884082813556,37.4709158533361],[-121.8834225785,37.4709061710847],[-121.882507237067,37.4706849045995],[-121.882013239923,37.4707773221391],[-121.881299256449,37.4711008353277],[-121.880762803753,37.4714296756932],[-121.879871915397,37.4718594427389],[-121.879511892264,37.47219919926],[-121.879307186937,37.472516919766],[-121.879152033262,37.4726161245653],[-121.878637018354,37.4731730610165],[-121.877121191558,37.4744868645372],[-121.877243620788,37.4746482845604],[-121.877266034855,37.4748745960624],[-121.876106135113,37.4755254535039],[-121.874880553944,37.4764477769587],[-121.872908096032,37.4784838835071],[-121.871341447959,37.4793972964769],[-121.870217507745,37.4808551554633],[-121.872133378516,37.4833528553181],[-121.874512525551,37.4890550717815],[-121.873291813577,37.4910986328532],[-121.875786677776,37.497988272996],[-121.87656677546,37.5002441037993],[-121.878290188212,37.5037247864975],[-121.878984863429,37.5055934189575],[-121.880308468744,37.5076076484767],[-121.880783817013,37.5079109034393],[-121.880993098913,37.5110541999574],[-121.884277051425,37.5138425415066]]]},properties:{NAME:"Vineyards/Avalon"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.903138144183,37.4646581837644],[-121.903825713627,37.465396387724],[-121.904342199458,37.4660150977911],[-121.904405114931,37.4661537428831],[-121.904339991119,37.4663553799952],[-121.904089742551,37.4665166556825],[-121.903027777324,37.4668517507859],[-121.903145566567,37.4671596969125],[-121.903619259022,37.4670606441173],[-121.904030370836,37.4671154701653],[-121.905897230992,37.4680730361785],[-121.906091712975,37.4682440968062],[-121.906530857123,37.4685056149774],[-121.906689138935,37.4689497235627],[-121.907317251664,37.4693634794585],[-121.907307739811,37.4697725181576],[-121.907796726748,37.4706658759974],[-121.907976837498,37.4708965035535],[-121.908243260807,37.4715916720781],[-121.908627953288,37.4719795006132],[-121.909297686029,37.4725877672949],[-121.909409027875,37.4730997312292],[-121.91010529272,37.474016686515],[-121.910541530822,37.4750332397845],[-121.910461883616,37.4757421740272],[-121.911135070612,37.4768945914087],[-121.910336950765,37.4772458088138],[-121.910319695785,37.4777002611877],[-121.910840134173,37.4781561502186],[-121.911497196225,37.4784552041083],[-121.910960983048,37.4794429287037],[-121.911503443537,37.4798779496528],[-121.911170130363,37.4806599752478],[-121.912192608591,37.4821443224185],[-121.912860669011,37.48265782864],[-121.912898966381,37.4831328984718],[-121.91264216748,37.4839510885357],[-121.913427866792,37.4843962234759],[-121.913383221762,37.4848595876905],[-121.914262504256,37.4853310583155],[-121.91461284712,37.4861742134697],[-121.915105176176,37.4865974627598],[-121.915398346308,37.4870608784599],[-121.915502323782,37.4875447721791],[-121.915929285796,37.488246228021],[-121.916530970851,37.4887999970857],[-121.917020935591,37.4895508182677],[-121.916576648769,37.4898435581228],[-121.916383603275,37.4902060553298],[-121.917441632981,37.4909187779419],[-121.918108209589,37.4916200806129],[-121.918331128667,37.4917409925168],[-121.918515852511,37.4926627022151],[-121.918885684276,37.4928951420981],[-121.920784398039,37.4942139801377],[-121.92105585077,37.4946196188409],[-121.921463108739,37.4961813725122],[-121.921371001202,37.49641321629],[-121.921080148178,37.4967988778193],[-121.921284044176,37.4969018704066],[-121.924041824309,37.4949206166297],[-121.924843977262,37.4941925780004],[-121.925981328835,37.4929705026489],[-121.926796327915,37.4920503446638],[-121.927467244272,37.491428662943],[-121.929328216966,37.4901476015383],[-121.929511499201,37.489997862215],[-121.92846112358,37.488127943346],[-121.927910003296,37.4871002453456],[-121.926649096158,37.4849115395059],[-121.926484448908,37.4846457686059],[-121.925466801097,37.4828528167731],[-121.925214984754,37.4823464758843],[-121.921507219625,37.4758800604592],[-121.917698387038,37.4693408442497],[-121.916597370491,37.4674266257722],[-121.915821789006,37.4660582211868],[-121.914306576962,37.4634769795795],[-121.914134466513,37.4631320449594],[-121.912674659467,37.4606237419124],[-121.910901146354,37.4615186645158],[-121.911313399493,37.4622238033942],[-121.90917077948,37.4630030454858],[-121.907669702456,37.4635284450166],[-121.907487437557,37.4632260388731],[-121.907255257218,37.4633328294942],[-121.907415359844,37.4636157850666],[-121.905163360611,37.4644307229735],[-121.904224366897,37.4646514269672],[-121.903352726745,37.4646088808482],[-121.903138144183,37.4646581837644]]]},properties:{NAME:"Warm Springs"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.924843977262,37.4941925780004],[-121.925300846297,37.4944181376049],[-121.925192798502,37.4947171292882],[-121.925388350609,37.4950282295498],[-121.925662677277,37.4951320233188],[-121.925702876606,37.4953413205658],[-121.925240826003,37.4954229518312],[-121.925345007645,37.4957187966464],[-121.925711888404,37.4965596015579],[-121.925792993971,37.4968162667364],[-121.926025755084,37.4971725799653],[-121.926911347107,37.4980521170435],[-121.927640626103,37.4986890874174],[-121.928602063968,37.499836529725],[-121.931085796127,37.5020994366762],[-121.931312763002,37.5022524476923],[-121.933630867311,37.5042648900872],[-121.934506325164,37.505153789759],[-121.934957156804,37.5057256030756],[-121.935259045265,37.505999107383],[-121.935385536284,37.5063906922018],[-121.935897449933,37.5072805659109],[-121.937007819246,37.5091656877327],[-121.937198369703,37.5095705641272],[-121.93891710212,37.5124226366543],[-121.939118165969,37.5126567390058],[-121.939531987978,37.5129266877763],[-121.94086085774,37.5134469980713],[-121.941128902216,37.5136810126746],[-121.941396391935,37.5141774317155],[-121.942340776268,37.513897780366],[-121.942642690399,37.5138338932092],[-121.943358305016,37.5135811417287],[-121.944198529743,37.5131357956392],[-121.945902709243,37.5125521434512],[-121.946528832815,37.5123931237723],[-121.947239231318,37.5122945338896],[-121.947601145195,37.5122853462352],[-121.949121940728,37.5123469801873],[-121.949572503617,37.5123177791546],[-121.950916608193,37.5120848575709],[-121.952069088518,37.5118631613099],[-121.953520412784,37.511349209213],[-121.954317320988,37.5111656331126],[-121.958628026049,37.5103942707084],[-121.960123049145,37.510111889861],[-121.960843426548,37.5099618526197],[-121.961507109774,37.5097923237754],[-121.962119726081,37.5095883369942],[-121.962943951732,37.5092651156325],[-121.963712573018,37.5089307597013],[-121.965591730949,37.5081554894847],[-121.966638699679,37.5076530734771],[-121.96737414967,37.5073535635799],[-121.966108972802,37.5063080400076],[-121.963122580218,37.5038811806656],[-121.9613520182,37.5025822819719],[-121.954166712899,37.4969084617733],[-121.947897343102,37.4921942642193],[-121.937703833247,37.484355824386],[-121.936985810217,37.4836655465361],[-121.93390830334,37.4798705226575],[-121.933655716698,37.4793712917541],[-121.930242987251,37.4719739763686],[-121.927140587414,37.4657219729802],[-121.924975067003,37.4613180849821],[-121.923470285818,37.4583025355173],[-121.923147608614,37.4574631899048],[-121.922844404766,37.4563798321794],[-121.922585263083,37.4561611700733],[-121.921772651034,37.4560513715973],[-121.912839026632,37.460548395306],[-121.912674659467,37.4606237419124],[-121.914134466513,37.4631320449594],[-121.914306576962,37.4634769795795],[-121.915821789006,37.4660582211868],[-121.916597370491,37.4674266257722],[-121.917698387038,37.4693408442497],[-121.921507219625,37.4758800604592],[-121.925214984754,37.4823464758843],[-121.925466801097,37.4828528167731],[-121.926484448908,37.4846457686059],[-121.926649096158,37.4849115395059],[-121.927910003296,37.4871002453456],[-121.92846112358,37.488127943346],[-121.929511499201,37.489997862215],[-121.929328216966,37.4901476015383],[-121.927467244272,37.491428662943],[-121.926796327915,37.4920503446638],[-121.925981328835,37.4929705026489],[-121.924843977262,37.4941925780004]]]},properties:{NAME:"East Industrial"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.96910175986,37.522534155655],[-121.970239554236,37.5223866281962],[-121.970665959529,37.5223775633246],[-121.971328251418,37.5225428340544],[-121.971803243869,37.5227688425177],[-121.980931307834,37.527426322701],[-121.982778952938,37.528365601141],[-121.982924817379,37.5284728588993],[-121.982953047584,37.5283720633807],[-121.98473357336,37.5262075216438],[-121.985962931561,37.5247296653398],[-121.9862261937,37.5244417000422],[-121.98780372009,37.5225935098953],[-121.984661565976,37.5210742594038],[-121.983879177936,37.5206080144026],[-121.983338872864,37.5202200172965],[-121.980984343252,37.5183021737796],[-121.975270618363,37.5136571545999],[-121.972240372613,37.5112500922067],[-121.967999407334,37.5078702511379],[-121.96737414967,37.5073535635799],[-121.966638699679,37.5076530734771],[-121.965591730949,37.5081554894847],[-121.963712573018,37.5089307597013],[-121.962943951732,37.5092651156325],[-121.963149513076,37.5095128096245],[-121.963896156313,37.5106270375333],[-121.964416543971,37.5114382467608],[-121.964559753933,37.5117597365921],[-121.967015735194,37.5159903234073],[-121.967509731477,37.516867014412],[-121.967742290097,37.517425570096],[-121.967918752334,37.5180335624713],[-121.968348341011,37.5196571393983],[-121.968498601344,37.520169194422],[-121.96910175986,37.522534155655]]]},properties:{NAME:"Blacow"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.921772651034,37.4560513715973],[-121.922585263083,37.4561611700733],[-121.922844404766,37.4563798321794],[-121.923147608614,37.4574631899048],[-121.923470285818,37.4583025355173],[-121.924975067003,37.4613180849821],[-121.927140587414,37.4657219729802],[-121.930242987251,37.4719739763686],[-121.933655716698,37.4793712917541],[-121.93390830334,37.4798705226575],[-121.936985810217,37.4836655465361],[-121.937703833247,37.484355824386],[-121.947897343102,37.4921942642193],[-121.954166712899,37.4969084617733],[-121.9613520182,37.5025822819719],[-121.963122580218,37.5038811806656],[-121.966108972802,37.5063080400076],[-121.96737414967,37.5073535635799],[-121.967999407334,37.5078702511379],[-121.972240372613,37.5112500922067],[-121.975270618363,37.5136571545999],[-121.980984343252,37.5183021737796],[-121.983338872864,37.5202200172965],[-121.983879177936,37.5206080144026],[-121.984661565976,37.5210742594038],[-121.98780372009,37.5225935098953],[-121.987994089567,37.5223675792068],[-121.994809716448,37.5140174178846],[-121.994850785923,37.5139252484816],[-121.995048969585,37.5127534687024],[-121.994957794181,37.5127305532266],[-121.995271519647,37.510920099268],[-121.995827297734,37.5094831371331],[-121.997281450633,37.5056693215265],[-121.997937822754,37.504264251185],[-121.998121295068,37.5037680629236],[-121.996645975083,37.5024049272565],[-121.992613040594,37.498623305543],[-121.992612611783,37.4986229036609],[-121.99202574412,37.4980725593547],[-121.992037147514,37.4984975244843],[-121.989483932267,37.4960793965634],[-121.979467235159,37.4868803318501],[-121.975226506934,37.4830473066644],[-121.974474145607,37.4822592624847],[-121.974100214227,37.4817779843549],[-121.973620533774,37.4810200459732],[-121.973382763866,37.4805495903291],[-121.969078442123,37.4806035205463],[-121.969037890535,37.4842292836785],[-121.964558069563,37.4843016196841],[-121.964691220727,37.4873184188428],[-121.960076455604,37.4872772992842],[-121.959922323671,37.4836832678638],[-121.952687584951,37.4836873000535],[-121.95180815393,37.4807014165029],[-121.951145549472,37.4792145997024],[-121.951091823174,37.4780383976914],[-121.951700923588,37.478262832097],[-121.951982344431,37.478265384896],[-121.952486773942,37.4781558259211],[-121.952982259413,37.4779551209764],[-121.953105719221,37.4776103575491],[-121.953002711325,37.4772959661872],[-121.952718621546,37.4769545506106],[-121.952691782112,37.4767160838433],[-121.952814473351,37.4763330060471],[-121.953360875549,37.475743774216],[-121.95377730124,37.4754732877879],[-121.953885832237,37.4753481238076],[-121.953883582948,37.4751190556714],[-121.95365008994,37.4748552420594],[-121.953487737737,37.4742869505608],[-121.953656380058,37.4732548562434],[-121.953574584031,37.4730436058993],[-121.953315281273,37.4728345519142],[-121.95284639504,37.4726900005852],[-121.952490348104,37.4726413393624],[-121.951936501857,37.4726924120149],[-121.951561881621,37.4728297083159],[-121.950479906684,37.4733148784664],[-121.950187190164,37.4733505516406],[-121.949493278689,37.4732367366689],[-121.949239332859,37.4730902976908],[-121.948572655333,37.4723776514972],[-121.948041096964,37.4721868185903],[-121.947787351391,37.47190829657],[-121.947678255072,37.4709057970846],[-121.947755102914,37.4705255067239],[-121.948693565092,37.4690451486784],[-121.949052578843,37.4686315320307],[-121.94912302294,37.4683932533105],[-121.948970381543,37.4680217303566],[-121.948594380638,37.4678447102432],[-121.946991304093,37.4676800605825],[-121.946742539405,37.4684679684477],[-121.946596161084,37.4687145573783],[-121.946228508536,37.4690252913819],[-121.945788998,37.4691937228794],[-121.945450657667,37.4692348837734],[-121.94489895875,37.4691587553096],[-121.944446121547,37.4689303861238],[-121.944227600602,37.4687204268382],[-121.944029664736,37.4683235183288],[-121.944011407914,37.4680123287412],[-121.944090521058,37.4675219466593],[-121.944324295243,37.4669562695951],[-121.944419044479,37.4665393809291],[-121.944316338629,37.4659342859019],[-121.944010919045,37.4655792586527],[-121.943577121736,37.4653367065282],[-121.943192621155,37.4652583431347],[-121.942340834546,37.4653390709049],[-121.94141505608,37.4651900110784],[-121.940908943799,37.4648956627294],[-121.940550619426,37.4644549690766],[-121.940450395222,37.4642348433193],[-121.940255039114,37.4634570801892],[-121.940175247731,37.4632863463359],[-121.93987846193,37.4629140227925],[-121.939513228897,37.4626557627787],[-121.938706015752,37.4623512540537],[-121.938227400313,37.4622745876277],[-121.937830907926,37.4622919121767],[-121.936701719541,37.4625046459531],[-121.936367619705,37.4625186264066],[-121.935873937336,37.4624618307336],[-121.935519405616,37.4617248186744],[-121.935490359221,37.4611160312781],[-121.935318015156,37.4607226662325],[-121.935119745451,37.4605424545346],[-121.934634553299,37.4603517343211],[-121.932585812662,37.4603568867804],[-121.932406888623,37.4602918770959],[-121.93226159027,37.460037686085],[-121.932507187182,37.4594325031216],[-121.932654256349,37.4591541473206],[-121.932727385493,37.4586329245118],[-121.932664524084,37.4576805112745],[-121.932691932144,37.4574118767262],[-121.932805309078,37.4571361586316],[-121.933308754829,37.4563590864221],[-121.933463563045,37.4560370840605],[-121.933482590401,37.4553290191448],[-121.933317251818,37.4550494430464],[-121.932731682621,37.4551017809282],[-121.932385987102,37.4552538945293],[-121.931457075798,37.4560080688],[-121.930166097277,37.4567199269767],[-121.929903812272,37.4568442493845],[-121.929465071904,37.456940907601],[-121.929220848568,37.4569210925825],[-121.928974280176,37.4568152006276],[-121.928768332959,37.4565689107339],[-121.928478678922,37.4557005414974],[-121.928151934631,37.4552943876798],[-121.927790631451,37.4550755190171],[-121.925462726525,37.4541928669117],[-121.921772651034,37.4560513715973]]]},properties:{NAME:"Bayside"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.968949610592,37.5737546773605],[-121.970707576622,37.5756880229593],[-121.971033437614,37.5760238588227],[-121.971610987065,37.5765216914605],[-121.969951226648,37.5779329995448],[-121.969340404007,37.5781043472894],[-121.967587095027,37.5787189192721],[-121.964739775096,37.5795945886473],[-121.964373909462,37.5797687574987],[-121.964122570919,37.5799751468113],[-121.963853840968,37.5803503346346],[-121.963810196566,37.5812027149104],[-121.963842503944,37.5820562096103],[-121.963998011664,37.5838218088816],[-121.963954212378,37.5841396034321],[-121.963530188675,37.5851316530247],[-121.962953374172,37.5856380517573],[-121.962534670789,37.5859354461033],[-121.961935124111,37.5862515687272],[-121.959297611902,37.5873716976867],[-121.958740553671,37.5877435837113],[-121.957704597907,37.5885138461563],[-121.957275141852,37.5888810530809],[-121.957397062388,37.5892905234164],[-121.957519746345,37.5893861697973],[-121.957897605164,37.5896783809645],[-121.968520503663,37.598783001595],[-121.978360422387,37.6066788829626],[-121.992472350556,37.5961888764882],[-121.997465353086,37.5924772925215],[-121.998244117222,37.5919048870483],[-122.001228375564,37.5897546233368],[-122.00139238717,37.589537306035],[-122.001315962814,37.5894675093666],[-122.002201945973,37.5888604294324],[-122.002883609727,37.5884774298563],[-122.003237827827,37.5884275419721],[-122.003541951997,37.5882471706998],[-122.003512671472,37.588048065864],[-122.005481411266,37.5866021468525],[-122.005871712995,37.5862892970887],[-122.007009551645,37.5830422645723],[-122.006672897071,37.582762862424],[-122.00311961522,37.5800703656174],[-122.001654934622,37.5789324822485],[-121.998054277734,37.5760935051673],[-121.996400032399,37.5748487278106],[-121.991269945428,37.5709394718006],[-121.988861148283,37.5691913482988],[-121.987995734712,37.5685070757328],[-121.988147674865,37.5683789573277],[-121.985992514066,37.5657992661314],[-121.972866170737,37.569435432267],[-121.971508824527,37.5698137359169],[-121.970943942551,37.5700182648729],[-121.970699516275,37.5701589678279],[-121.970370667475,37.5704483840028],[-121.970097247824,37.5708762263147],[-121.969995967824,37.5713317974744],[-121.970086740642,37.5720834666682],[-121.970711785433,37.5726321580563],[-121.969825042629,37.573130635509],[-121.968949610592,37.5737546773605]]]},properties:{NAME:"Niles"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-122.03990155187,37.56261382599],[-122.040107417104,37.5630450036923],[-122.040191539142,37.5634434251038],[-122.040139658732,37.5641050536457],[-122.040171003301,37.5643693638612],[-122.040284296347,37.5646751764814],[-122.040627825813,37.5648512780273],[-122.043178357951,37.5674568080489],[-122.043121018064,37.5675207368742],[-122.043474102831,37.5679040901838],[-122.043717646606,37.5679197720771],[-122.044449305121,37.5687561761502],[-122.044800227571,37.5692040990462],[-122.045294346598,37.5699004417993],[-122.045597528463,37.5703754295497],[-122.045837635378,37.5710534773953],[-122.04617306546,37.5717515587746],[-122.046463914704,37.572462930441],[-122.04774208166,37.5761786614013],[-122.047878085804,37.5764954984665],[-122.048097004532,37.5768163948086],[-122.048387760182,37.5771064734061],[-122.048856383001,37.5774855390805],[-122.049216938626,37.5778955548841],[-122.049640990842,37.5787030180633],[-122.050088587555,37.5791489657199],[-122.050668377021,37.5795110711251],[-122.050525656881,37.5796941232971],[-122.050717312037,37.5797823921135],[-122.050252499701,37.5803083557296],[-122.049735769677,37.5810186886397],[-122.049659368307,37.5812449340212],[-122.0497250884,37.5815005482872],[-122.050203117026,37.5827443824628],[-122.050642824145,37.5836388461947],[-122.050907724734,37.5840847840072],[-122.051195619318,37.5837353021164],[-122.051076893724,37.5836731649757],[-122.052498931947,37.5819231218283],[-122.052715468593,37.5817370558936],[-122.052916498752,37.5816711095455],[-122.053749064407,37.5806474915575],[-122.05363941854,37.5805832427286],[-122.054000406349,37.5802393905733],[-122.054566070041,37.5798028054387],[-122.054989580206,37.5795373072827],[-122.056891385596,37.5784461876298],[-122.057828106478,37.5778210535685],[-122.058327812165,37.5772343103027],[-122.058430248169,37.5772846649412],[-122.058662270293,37.5770328629986],[-122.060393396277,37.5750250434658],[-122.060221244518,37.5741533136765],[-122.067873680794,37.5653789680408],[-122.06626224466,37.5645774233648],[-122.065483718812,37.5641467364371],[-122.06502390347,37.5634770025741],[-122.064734690781,37.5629321637376],[-122.064570455364,37.5624677044439],[-122.064381917292,37.5617566599187],[-122.063963610058,37.5604243210798],[-122.064759353011,37.559984912811],[-122.065298787086,37.5595651958445],[-122.065585157831,37.5592544719321],[-122.065910554599,37.5587758229025],[-122.066812671572,37.5568767312356],[-122.067575937793,37.5552246376595],[-122.068783622159,37.5527180534711],[-122.06907694815,37.5520389399609],[-122.06931933375,37.5513210050943],[-122.069497532136,37.5505934667261],[-122.069612054048,37.5498556604852],[-122.069830792963,37.5475714482537],[-122.069859270329,37.5471756049522],[-122.069821396113,37.5463602807349],[-122.069725925811,37.5456264033444],[-122.076869121243,37.5428355775845],[-122.073102822887,37.5371232811784],[-122.072681538819,37.5365161014111],[-122.070928850241,37.5377237672008],[-122.067591240574,37.5402314933955],[-122.067717606615,37.540512118966],[-122.063983552828,37.54334375995],[-122.061070055261,37.5455460276024],[-122.060428650582,37.545922711064],[-122.0553436688,37.5496599895135],[-122.055206772743,37.5499531682705],[-122.052567917888,37.5519162462789],[-122.0522813625,37.5520999194189],[-122.048523428849,37.5544157375774],[-122.047597421375,37.5549785444628],[-122.045818858322,37.5561668470545],[-122.045017904535,37.5567971817195],[-122.043802141239,37.5578541667909],[-122.043177523441,37.5584434990972],[-122.041171398356,37.5609179377732],[-122.040648462214,37.5617237202206],[-122.03990155187,37.56261382599]]]},properties:{NAME:"Ardenwood"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-122.025494861285,37.5785260317693],[-122.027102077718,37.5801415205576],[-122.029308118175,37.5823857479508],[-122.031660210063,37.5847398522276],[-122.032102665656,37.5851504800681],[-122.03280686481,37.5857029828571],[-122.033486774541,37.586087524752],[-122.034347351325,37.5864564501714],[-122.03732528031,37.587557161324],[-122.037713523755,37.587692317715],[-122.038815219928,37.5879656583698],[-122.039802165899,37.5880749365942],[-122.04029197511,37.5880874870696],[-122.041025773807,37.5880552878596],[-122.041872115756,37.5879406270449],[-122.044256369099,37.587454862394],[-122.045061535906,37.5872706410481],[-122.04587106234,37.5870461157095],[-122.046599559071,37.586778020644],[-122.047094201027,37.5865471137937],[-122.047913671699,37.586048580359],[-122.048244290615,37.5857954138041],[-122.048696622101,37.5853828157741],[-122.049030458956,37.5850117639659],[-122.050016208793,37.5837909114317],[-122.050436055682,37.584479858416],[-122.05068893741,37.58426777334],[-122.050907724734,37.5840847840072],[-122.050642824145,37.5836388461947],[-122.050203117026,37.5827443824628],[-122.0497250884,37.5815005482872],[-122.049659368307,37.5812449340212],[-122.049735769677,37.5810186886397],[-122.050252499701,37.5803083557296],[-122.050717312037,37.5797823921135],[-122.050525656881,37.5796941232971],[-122.050668377021,37.5795110711251],[-122.050088587555,37.5791489657199],[-122.049640990842,37.5787030180633],[-122.049216938626,37.5778955548841],[-122.048856383001,37.5774855390805],[-122.048387760182,37.5771064734061],[-122.048097004532,37.5768163948086],[-122.047878085804,37.5764954984665],[-122.04774208166,37.5761786614013],[-122.046463914704,37.572462930441],[-122.04617306546,37.5717515587746],[-122.045837635378,37.5710534773953],[-122.045597528463,37.5703754295497],[-122.045294346598,37.5699004417993],[-122.044800227571,37.5692040990462],[-122.044449305121,37.5687561761502],[-122.043717646606,37.5679197720771],[-122.043474102831,37.5679040901838],[-122.043121018064,37.5675207368742],[-122.043178357951,37.5674568080489],[-122.040627825813,37.5648512780273],[-122.040284296347,37.5646751764814],[-122.040171003301,37.5643693638612],[-122.040139658732,37.5641050536457],[-122.040191539142,37.5634434251038],[-122.040107417104,37.5630450036923],[-122.03990155187,37.56261382599],[-122.039000766801,37.5636872689973],[-122.038640136824,37.5633481374517],[-122.037290167983,37.5650166599878],[-122.035951935574,37.5667263495438],[-122.035234115704,37.5676052683231],[-122.032390487217,37.5708446988957],[-122.030857999416,37.5725966514588],[-122.028277052195,37.5754232354801],[-122.026548329538,37.5773669552705],[-122.026065860455,37.5778779415569],[-122.025494861285,37.5785260317693]]]},properties:{NAME:"Northgate"}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[[-121.97889141863,37.5601944237859],[-121.978607608653,37.5606494919921],[-121.978494630479,37.5610579004344],[-121.978487236283,37.5613632344204],[-121.978621043198,37.5620041618028],[-121.978778354886,37.5624734308156],[-121.978803816967,37.5630782349604],[-121.978730762725,37.5634647213844],[-121.978583939385,37.5638628432892],[-121.978184410111,37.5644087325233],[-121.977525055225,37.5648992048863],[-121.976808825496,37.5652839933742],[-121.974498487276,37.5666219862203],[-121.97267094045,37.5676429083047],[-121.972871208445,37.5679407735791],[-121.972842517944,37.5681825717861],[-121.97248315289,37.568374381805],[-121.972866170737,37.569435432267],[-121.985992514066,37.5657992661314],[-121.988147674865,37.5683789573277],[-121.988734697302,37.5678390612648],[-121.989423655817,37.5672631901059],[-121.989880495916,37.56691631323],[-121.98981299909,37.5668552609929],[-121.990452900104,37.56645629649],[-121.990830436236,37.5663572326057],[-121.99157886068,37.5660245219162],[-121.992312617323,37.5657861035319],[-121.992760766687,37.565672768106],[-121.99346181166,37.5655460198788],[-121.994116379792,37.565475514422],[-121.996881762505,37.5653146611662],[-121.997216244341,37.5653138738717],[-121.997782896302,37.5651716412912],[-121.998468226995,37.5651570256167],[-121.99918924112,37.5652079328179],[-121.999981160445,37.5653926172333],[-122.00092164909,37.5657879975847],[-122.000871221645,37.5656291638493],[-122.001122382634,37.5653425791854],[-122.001335913013,37.5652111353631],[-122.001527028661,37.5648381598277],[-122.001520468478,37.5645052436763],[-122.00135284248,37.5639037511784],[-122.002437674519,37.5636838500688],[-122.002230585067,37.5629534890622],[-122.001809469201,37.5617237978332],[-122.001729600897,37.5614333080588],[-121.99603030929,37.5630175019491],[-121.995152029291,37.561197253006],[-121.994911828715,37.5609053835827],[-121.994304367289,37.5603729130895],[-121.992480766888,37.5594127578331],[-121.991518722887,37.558853661879],[-121.989939841579,37.558047508582],[-121.987257184302,37.5567461849107],[-121.986987931795,37.5570628110283],[-121.986725770496,37.5572875734646],[-121.986276816733,37.557507607801],[-121.985905432218,37.5575930425174],[-121.984414237074,37.5577421303968],[-121.984287932287,37.5575181563432],[-121.983971034009,37.5572794185249],[-121.982785143678,37.5587388546405],[-121.982671857975,37.558878385975],[-121.982119128479,37.5595594326541],[-121.981785998535,37.5593891355506],[-121.980213406877,37.5585719262006],[-121.979492621817,37.5594762096468],[-121.97889141863,37.5601944237859]]]},properties:{NAME:"Parkmont"}}];var v_={type:y_,features:x_},N8=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},G8={exports:{}};(function(g,x){(function(E,I){g.exports=I()})(N8,function(){var E,I,k;function L(o,Z){if(!E)E=Z;else if(!I)I=Z;else{var ae="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+E+")(sharedChunk); ("+I+")(sharedChunk); self.onerror = null;",te={};E(te),k=Z(te),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(k.workerUrl=window.URL.createObjectURL(new Blob([ae],{type:"text/javascript"})))}}L(["exports"],function(o){var Z=typeof self!="undefined"?self:{},ae=te;function te(i,e,r,n){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=r,this.p2y=n}te.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},te.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},te.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},te.prototype.solveCurveX=function(i,e){var r,n,s,c,h;for(e===void 0&&(e=1e-6),s=i,h=0;h<8;h++){if(c=this.sampleCurveX(s)-i,Math.abs(c)<e)return s;var d=this.sampleCurveDerivativeX(s);if(Math.abs(d)<1e-6)break;s-=c/d}if((s=i)<(r=0))return r;if(s>(n=1))return n;for(;r<n;){if(c=this.sampleCurveX(s),Math.abs(c-i)<e)return s;i>c?r=s:n=s,s=.5*(n-r)+r}return s},te.prototype.solve=function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))};var N=K;function K(i,e){this.x=i,this.y=e}K.prototype={clone:function(){return new K(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,r=i.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),r=Math.sin(i),n=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=n,this},_rotateAround:function(i,e){var r=Math.cos(i),n=Math.sin(i),s=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-n*(this.y-e.y),this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},K.convert=function(i){return i instanceof K?i:Array.isArray(i)?new K(i[0],i[1]):i};const fe=Math.PI/180,Te=180/Math.PI;function Ce(i){return i*fe}function ke(i){return i*Te}const Qe=[[0,0],[1,0],[1,1],[0,1]];function Ve(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,r=e*i;return 4*(i<.5?r:3*(i-e)+r-.75)}function Oe(i,e,r,n){const s=new ae(i,e,r,n);return function(c){return s.solve(c)}}const $e=Oe(.25,.1,.25,1);function xe(i,e,r){return Math.min(r,Math.max(e,i))}function dt(i,e,r){return(r=xe((r-i)/(e-i),0,1))*r*(3-2*r)}function We(i,e,r){const n=r-e,s=((i-e)%n+n)%n+e;return s===e?r:s}function gt(i,e,r){if(!i.length)return r(null,[]);let n=i.length;const s=new Array(i.length);let c=null;i.forEach((h,d)=>{e(h,(_,m)=>{_&&(c=_),s[d]=m,--n==0&&r(c,s)})})}function wt(i){const e=[];for(const r in i)e.push(i[r]);return e}function He(i,...e){for(const r of e)for(const n in r)i[n]=r[n];return i}let Je=1;function Ye(){return Je++}function qe(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function Xe(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function ze(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function St(i,e){i.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function zt(i,e){return i.indexOf(e,i.length-e.length)!==-1}function ei(i,e,r){const n={};for(const s in i)n[s]=e.call(r||this,i[s],s,i);return n}function si(i,e,r){const n={};for(const s in i)e.call(r||this,i[s],s,i)&&(n[s]=i[s]);return n}function Ri(i){return Array.isArray(i)?i.map(Ri):typeof i=="object"&&i?ei(i,Ri):i}const mt={};function _t(i){mt[i]||(typeof console!="undefined"&&console.warn(i),mt[i]=!0)}function xt(i,e,r){return(r.y-i.y)*(e.x-i.x)>(e.y-i.y)*(r.x-i.x)}function Ht(i){let e=0;for(let r,n,s=0,c=i.length,h=c-1;s<c;h=s++)r=i[s],n=i[h],e+=(n.x-r.x)*(r.y+n.y);return e}function Bt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function fi(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,n,s,c)=>{const h=s||c;return e[n]=!h||h.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let ni=null;function wi(i){if(ni==null){const e=i.navigator?i.navigator.userAgent:null;ni=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return ni}function Ji(i){try{const e=Z[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function ji(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}const gr=Z.performance;function or(i){const e=i?i.url.toString():void 0;return gr.getEntriesByName(e)}var yr="2.9.1";let Lt,er,br,$i;const zi={now:()=>br!==void 0?br:Z.performance.now(),setNow(i){br=i},restoreNow(){br=void 0},frame(i){const e=Z.requestAnimationFrame(i);return{cancel:()=>Z.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:r,height:n}=i;$i||($i=Z.document.createElement("canvas"));const s=$i.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return(r>$i.width||n>$i.height)&&($i.width=r,$i.height=n),s.clearRect(-e,-e,r+2*e,n+2*e),s.drawImage(i,0,0,r,n),s.getImageData(-e,-e,r+2*e,n+2*e)},resolveURL:i=>(Lt||(Lt=Z.document.createElement("a")),Lt.href=i,Lt.href),get devicePixelRatio(){return Z.devicePixelRatio},get prefersReducedMotion(){return!!Z.matchMedia&&(er==null&&(er=Z.matchMedia("(prefers-reduced-motion: reduce)")),er.matches)}};let ur;const Ut={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ur==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ur={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{ur=i}}return ur},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Zi={supported:!1,testSupport:function(i){!ao&&kn&&(zo?fa(i):wr=i)}};let wr,kn,ao=!1,zo=!1;function fa(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,kn),i.isContextLost())return;Zi.supported=!0}catch{}i.deleteTexture(e),ao=!0}Z.document&&(kn=Z.document.createElement("img"),kn.onload=function(){wr&&fa(wr),wr=null,zo=!0},kn.onerror=function(){ao=!0,wr=null},kn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _a="01",Lr="NO_ACCESS_TOKEN";function un(i){return i.indexOf("mapbox:")===0}function so(i){return Ut.API_URL_REGEX.test(i)}const cs=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Rr(i){const e=i.match(cs);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Mn(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}function us(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(Z.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ma{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=us(Ut.ACCESS_TOKEN);let n="";return n=r&&r.u?Z.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(s,c)=>String.fromCharCode(Number("0x"+c)))):Ut.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${n}`:`mapbox.eventData:${n}`}fetchEventData(){const e=Ji("localStorage"),r=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{const s=Z.localStorage.getItem(r);s&&(this.eventData=JSON.parse(s));const c=Z.localStorage.getItem(n);c&&(this.anonId=c)}catch{_t("Unable to read from LocalStorage")}}saveEventData(){const e=Ji("localStorage"),r=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{Z.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&Z.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{_t("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,n,s){if(!Ut.EVENTS_URL)return;const c=Rr(Ut.EVENTS_URL);c.params.push(`access_token=${s||Ut.ACCESS_TOKEN||""}`);const h={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:yr,skuId:_a,userId:this.anonId},d=r?He(h,r):h,_={url:Mn(c),headers:{"Content-Type":"text/plain"},body:JSON.stringify([d])};this.pendingRequest=ve(_,m=>{this.pendingRequest=null,n(m),this.saveEventData(),this.processRequests(s)})}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const ga=new class extends ma{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){Ut.EVENTS_URL&&Ut.ACCESS_TOKEN&&Array.isArray(i)&&i.some(r=>un(r)||so(r))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=us(Ut.ACCESS_TOKEN),r=e?e.u:Ut.ACCESS_TOKEN;let n=r!==this.eventData.tokenU;ze(this.anonId)||(this.anonId=qe(),n=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const c=new Date(this.eventData.lastSuccess),h=new Date(s),d=(s-this.eventData.lastSuccess)/864e5;n=n||d>=1||d<-1||c.getDate()!==h.getDate()}else n=!0;n?this.postEvent(s,{"enabled.telemetry":!1},c=>{c||(this.eventData.lastSuccess=s,this.eventData.tokenU=r)},i):this.processRequests()}},ya=ga.postTurnstileEvent.bind(ga),xa=new class extends ma{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,r,n){this.skuToken=e,this.errorCb=n,Ut.EVENTS_URL&&(r||Ut.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(Lr)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),ze(this.anonId)||(this.anonId=qe()),this.postEvent(r,{skuToken:this.skuToken},n=>{n?this.errorCb(n):e&&(this.success[e]=!0)},i))}},hs=xa.postMapLoadEvent.bind(xa),ps=new class extends ma{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,r,n){if(!Ut.API_URL||!Ut.SESSION_PATH)return;const s=Rr(Ut.API_URL+Ut.SESSION_PATH);s.params.push(`sku=${e||""}`),s.params.push(`access_token=${n||Ut.ACCESS_TOKEN||""}`);const c={url:Mn(s),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Be(c,h=>{this.pendingRequest=null,r(h),this.saveEventData(),this.processRequests(n)})}getSessionAPI(i,e,r,n){this.skuToken=e,this.errorCb=n,Ut.SESSION_PATH&&Ut.API_URL&&(r||Ut.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(Lr)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,n=>{n?this.errorCb(n):e&&(this.success[e]=!0)},i)}},S1=ps.getSessionAPI.bind(ps),$n=new Set;let Cn,Po=500,ds=50,Tr={};function va(i){const e=D(i);let r,n;e&&e.forEach(c=>{const h=c.split("=");h[0]==="language"?r=h[1]:h[0]==="worldview"&&(n=h[1])});let s="mapbox-tiles";return r&&(s+=`-${r}`),n&&(s+=`-${n}`),s}function X(i){Z.caches&&!Tr[i]&&(Tr[i]=Z.caches.open(i))}function D(i){const e=i.indexOf("?");return e>0?i.slice(e+1).split("&"):[]}function R(i){const e=i.indexOf("?");if(e<0)return i;const r=D(i).filter(n=>{const s=n.split("=");return s[0]==="language"||s[0]==="worldview"});return r.length?`${i.slice(0,e)}?${r.join("&")}`:i.slice(0,e)}let W=1/0;const ie={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ie);class ue extends Error{constructor(e,r,n){r===401&&so(n)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ge=Bt()?()=>self.worker&&self.worker.referrer:()=>(Z.location.protocol==="blob:"?Z.parent:Z).location.href,_e=function(i,e){if(!(/^file:/.test(r=i.url)||/^file:/.test(ge())&&!/^\w+:/.test(r))){if(Z.fetch&&Z.Request&&Z.AbortController&&Z.Request.prototype.hasOwnProperty("signal"))return function(n,s){const c=new Z.AbortController,h=new Z.Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,referrer:ge(),signal:c.signal});let d=!1,_=!1;const m=(b=h.url).indexOf("sku=")>0&&so(b);var b;n.type==="json"&&h.headers.set("Accept","application/json");const T=(M,z,B)=>{if(_)return;if(M&&M.message!=="SecurityError"&&_t(M),z&&B)return S(z);const q=Date.now();Z.fetch(h).then(H=>{if(H.ok){const se=m?H.clone():null;return S(H,se,q)}return s(new ue(H.statusText,H.status,n.url))}).catch(H=>{H.code!==20&&s(new Error(H.message))})},S=(M,z,B)=>{(n.type==="arrayBuffer"?M.arrayBuffer():n.type==="json"?M.json():M.text()).then(q=>{_||(z&&B&&function(H,se,oe){const le=va(H.url);if(X(le),!Tr[le])return;const he={status:se.status,statusText:se.statusText,headers:new Z.Headers};se.headers.forEach((Ee,Re)=>he.headers.set(Re,Ee));const de=fi(se.headers.get("Cache-Control")||"");if(de["no-store"])return;de["max-age"]&&he.headers.set("Expires",new Date(oe+1e3*de["max-age"]).toUTCString());const Se=he.headers.get("Expires");Se&&(new Date(Se).getTime()-oe<42e4||function(Ee,Re){if(Cn===void 0)try{new Response(new ReadableStream),Cn=!0}catch{Cn=!1}Cn?Re(Ee.body):Ee.blob().then(Re)}(se,Ee=>{const Re=new Z.Response(Ee,he);X(le),Tr[le]&&Tr[le].then(Ge=>Ge.put(R(H.url),Re)).catch(Ge=>_t(Ge.message))}))}(h,z,B),d=!0,s(null,q,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(q=>{_||s(new Error(q.message))})};return m?function(M,z){const B=va(M.url);if(X(B),!Tr[B])return z(null);const q=R(M.url);Tr[B].then(H=>{H.match(q).then(se=>{const oe=function(le){if(!le)return!1;const he=new Date(le.headers.get("Expires")||0),de=fi(le.headers.get("Cache-Control")||"");return he>Date.now()&&!de["no-cache"]}(se);H.delete(q),oe&&H.put(q,se.clone()),z(null,se,oe)}).catch(z)}).catch(z)}(h,T):T(null,null),{cancel:()=>{_=!0,d||c.abort()}}}(i,e);if(Bt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var r;return function(n,s){const c=new Z.XMLHttpRequest;c.open(n.method||"GET",n.url,!0),n.type==="arrayBuffer"&&(c.responseType="arraybuffer");for(const h in n.headers)c.setRequestHeader(h,n.headers[h]);return n.type==="json"&&(c.responseType="text",c.setRequestHeader("Accept","application/json")),c.withCredentials=n.credentials==="include",c.onerror=()=>{s(new Error(c.statusText))},c.onload=()=>{if((c.status>=200&&c.status<300||c.status===0)&&c.response!==null){let h=c.response;if(n.type==="json")try{h=JSON.parse(c.response)}catch(d){return s(d)}s(null,h,c.getResponseHeader("Cache-Control"),c.getResponseHeader("Expires"))}else s(new ue(c.statusText,c.status,n.url))},c.send(n.body),{cancel:()=>c.abort()}}(i,e)},pe=function(i,e){return _e(He(i,{type:"arrayBuffer"}),e)},ve=function(i,e){return _e(He(i,{method:"POST"}),e)},Be=function(i,e){return _e(He(i,{method:"GET"}),e)};function st(i){const e=Z.document.createElement("a");return e.href=i,e.protocol===Z.document.location.protocol&&e.host===Z.document.location.host}const Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Tt,Et;Tt=[],Et=0;const It=function(i,e){if(Zi.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Et>=Ut.MAX_PARALLEL_IMAGE_REQUESTS){const c={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Tt.push(c),c}Et++;let r=!1;const n=()=>{if(!r)for(r=!0,Et--;Tt.length&&Et<Ut.MAX_PARALLEL_IMAGE_REQUESTS;){const c=Tt.shift(),{requestParameters:h,callback:d,cancelled:_}=c;_||(c.cancel=It(h,d).cancel)}},s=pe(i,(c,h,d,_)=>{n(),c?e(c):h&&(Z.createImageBitmap?function(m,b){const T=new Z.Blob([new Uint8Array(m)],{type:"image/png"});Z.createImageBitmap(T).then(S=>{b(null,S)}).catch(S=>{b(new Error(`Could not load image because of ${S.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(h,(m,b)=>e(m,b,d,_)):function(m,b){const T=new Z.Image,S=Z.URL;T.onload=()=>{b(null,T),S.revokeObjectURL(T.src),T.onload=null,Z.requestAnimationFrame(()=>{T.src=Ne})},T.onerror=()=>b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const M=new Z.Blob([new Uint8Array(m)],{type:"image/png"});T.src=m.byteLength?S.createObjectURL(M):Ne}(h,(m,b)=>e(m,b,d,_)))});return{cancel:()=>{s.cancel(),n()}}};function Mt(i,e,r){r[i]&&r[i].indexOf(e)!==-1||(r[i]=r[i]||[],r[i].push(e))}function Vt(i,e,r){if(r&&r[i]){const n=r[i].indexOf(e);n!==-1&&r[i].splice(n,1)}}class ti{constructor(e,r={}){He(this,r),this.type=e}}class xi extends ti{constructor(e,r={}){super("error",He({error:e},r))}}class li{on(e,r){return this._listeners=this._listeners||{},Mt(e,r,this._listeners),this}off(e,r){return Vt(e,r,this._listeners),Vt(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Mt(e,r,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,r){typeof e=="string"&&(e=new ti(e,r||{}));const n=e.type;if(this.listens(n)){e.target=this;const s=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const d of s)d.call(this,e);const c=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const d of c)Vt(n,d,this._oneTimeListeners),d.call(this,e);const h=this._eventedParent;h&&(He(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),h.fire(e))}else e instanceof xi&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var me=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Br(i,...e){for(const r of e)for(const n in r)i[n]=r[n];return i}function Si(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Ur(i){if(Array.isArray(i))return i.map(Ur);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const r in i)e[r]=Ur(i[r]);return e}return Si(i)}class i3 extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var Or=i3;class fs{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[n,s]of r)this.bindings[n]=s}concat(e){return new fs(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Jl=fs;const ba={kind:"null"},ot={kind:"number"},Wt={kind:"string"},jt={kind:"boolean"},tn={kind:"color"},lo={kind:"object"},Ot={kind:"value"},zn={kind:"collator"},Do={kind:"formatted"},wa={kind:"resolvedImage"};function Vr(i,e){return{kind:"array",itemType:i,N:e}}function Ei(i){if(i.kind==="array"){const e=Ei(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const Hl=[ba,ot,Wt,jt,tn,Do,lo,Vr(Ot),wa];function Lo(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Lo(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const r of Hl)if(!Lo(r,e))return null}}return`Expected ${Ei(i)} but found ${Ei(e)} instead.`}function _s(i,e){return e.some(r=>r.kind===i.kind)}function Ro(i,e){return e.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}function Bo(i){var e={exports:{}};return i(e,e.exports),e.exports}var Yl=Bo(function(i,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(d){return(d=Math.round(d))<0?0:d>255?255:d}function s(d){return n(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function c(d){return(_=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:_>1?1:_;var _}function h(d,_,m){return m<0?m+=1:m>1&&(m-=1),6*m<1?d+(_-d)*m*6:2*m<1?_:3*m<2?d+(_-d)*(2/3-m)*6:d}try{e.parseCSSColor=function(d){var _,m=d.replace(/ /g,"").toLowerCase();if(m in r)return r[m].slice();if(m[0]==="#")return m.length===4?(_=parseInt(m.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:m.length===7&&(_=parseInt(m.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var b=m.indexOf("("),T=m.indexOf(")");if(b!==-1&&T+1===m.length){var S=m.substr(0,b),M=m.substr(b+1,T-(b+1)).split(","),z=1;switch(S){case"rgba":if(M.length!==4)return null;z=c(M.pop());case"rgb":return M.length!==3?null:[s(M[0]),s(M[1]),s(M[2]),z];case"hsla":if(M.length!==4)return null;z=c(M.pop());case"hsl":if(M.length!==3)return null;var B=(parseFloat(M[0])%360+360)%360/360,q=c(M[1]),H=c(M[2]),se=H<=.5?H*(q+1):H+q-H*q,oe=2*H-se;return[n(255*h(oe,se,B+1/3)),n(255*h(oe,se,B)),n(255*h(oe,se,B-1/3)),z];default:return null}}return null}}catch{}});class Hi{constructor(e,r,n,s=1){this.r=e,this.g=r,this.b=n,this.a=s}static parse(e){if(!e)return;if(e instanceof Hi)return e;if(typeof e!="string")return;const r=Yl.parseCSSColor(e);return r?new Hi(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,n,s]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(n)},${s})`}toArray(){const{r:e,g:r,b:n,a:s}=this;return s===0?[0,0,0,0]:[255*e/s,255*r/s,255*n/s,s]}toArray01(){const{r:e,g:r,b:n,a:s}=this;return s===0?[0,0,0,0]:[e/s,r/s,n/s,s]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:n,a:s}=this;return[e,r,n,s]}}Hi.black=new Hi(0,0,0,1),Hi.white=new Hi(1,1,1,1),Hi.transparent=new Hi(0,0,0,0),Hi.red=new Hi(1,0,0,1),Hi.blue=new Hi(0,0,1,1);var Bi=Hi;class jr{constructor(e,r,n){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class E1{constructor(e,r,n,s,c){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=n,this.fontStack=s,this.textColor=c}}class hr{constructor(e){this.sections=e}static fromString(e){return new hr([new E1(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof hr?e:hr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.name]);continue}e.push(r.text);const n={};r.fontStack&&(n["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(n["font-scale"]=r.scale),r.textColor&&(n["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(n)}return e}}class $r{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new $r({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ms(i,e,r,n){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?n===void 0||typeof n=="number"&&n>=0&&n<=1?null:`Invalid rgba value [${[i,e,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof n=="number"?[i,e,r,n]:[i,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ta(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Bi||i instanceof jr||i instanceof hr||i instanceof $r)return!0;if(Array.isArray(i)){for(const e of i)if(!Ta(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!Ta(i[e]))return!1;return!0}return!1}function Pi(i){if(i===null)return ba;if(typeof i=="string")return Wt;if(typeof i=="boolean")return jt;if(typeof i=="number")return ot;if(i instanceof Bi)return tn;if(i instanceof jr)return zn;if(i instanceof hr)return Do;if(i instanceof $r)return wa;if(Array.isArray(i)){const e=i.length;let r;for(const n of i){const s=Pi(n);if(r){if(r===s)continue;r=Ot;break}r=s}return Vr(r||Ot,e)}return lo}function co(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Bi||i instanceof hr||i instanceof $r?i.toString():JSON.stringify(i)}class A1{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ta(e[1]))return r.error("invalid value");const n=e[1];let s=Pi(n);const c=r.expectedType;return s.kind!=="array"||s.N!==0||!c||c.kind!=="array"||typeof c.N=="number"&&c.N!==0||(s=c),new A1(s,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Bi?["rgba"].concat(this.value.toArray()):this.value instanceof hr?this.value.serialize():this.value}}var Ia=A1,ar=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const gs={string:Wt,number:ot,boolean:jt,object:lo};class Sa{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let n,s=1;const c=e[0];if(c==="array"){let d,_;if(e.length>2){const m=e[1];if(typeof m!="string"||!(m in gs)||m==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);d=gs[m],s++}else d=Ot;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);_=e[2],s++}n=Vr(d,_)}else n=gs[c];const h=[];for(;s<e.length;s++){const d=r.parse(e[s],s,Ot);if(!d)return null;h.push(d)}return new Sa(n,h)}evaluate(e){for(let r=0;r<this.args.length;r++){const n=this.args[r].evaluate(e);if(!Lo(this.type,Pi(n)))return n;if(r===this.args.length-1)throw new ar(`Expected value to be of type ${Ei(this.type)}, but found ${Ei(Pi(n))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if(e.kind==="array"){const n=e.itemType;if(n.kind==="string"||n.kind==="number"||n.kind==="boolean"){r.push(n.kind);const s=e.N;(typeof s=="number"||this.args.length>1)&&r.push(s)}}return r.concat(this.args.map(n=>n.serialize()))}}var Pn=Sa;class Zn{constructor(e){this.type=Do,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");const s=[];let c=!1;for(let h=1;h<=e.length-1;++h){const d=e[h];if(c&&typeof d=="object"&&!Array.isArray(d)){c=!1;let _=null;if(d["font-scale"]&&(_=r.parse(d["font-scale"],1,ot),!_))return null;let m=null;if(d["text-font"]&&(m=r.parse(d["text-font"],1,Vr(Wt)),!m))return null;let b=null;if(d["text-color"]&&(b=r.parse(d["text-color"],1,tn),!b))return null;const T=s[s.length-1];T.scale=_,T.font=m,T.textColor=b}else{const _=r.parse(e[h],1,Ot);if(!_)return null;const m=_.type.kind;if(m!=="string"&&m!=="value"&&m!=="null"&&m!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");c=!0,s.push({content:_,scale:null,font:null,textColor:null})}}return new Zn(s)}evaluate(e){return new hr(this.sections.map(r=>{const n=r.content.evaluate(e);return Pi(n)===wa?new E1("",n,null,null,null):new E1(co(n),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const n={};r.scale&&(n["font-scale"]=r.scale.serialize()),r.font&&(n["text-font"]=r.font.serialize()),r.textColor&&(n["text-color"]=r.textColor.serialize()),e.push(n)}return e}}class ys{constructor(e){this.type=wa,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const n=r.parse(e[1],1,Wt);return n?new ys(n):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),n=$r.fromString(r);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(r)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const r3={"to-boolean":jt,"to-color":tn,"to-number":ot,"to-string":Wt};class k1{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const n=e[0];if((n==="to-boolean"||n==="to-string")&&e.length!==2)return r.error("Expected one argument.");const s=r3[n],c=[];for(let h=1;h<e.length;h++){const d=r.parse(e[h],h,Ot);if(!d)return null;c.push(d)}return new k1(s,c)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let r,n;for(const s of this.args){if(r=s.evaluate(e),n=null,r instanceof Bi)return r;if(typeof r=="string"){const c=e.parseColor(r);if(c)return c}else if(Array.isArray(r)&&(n=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:ms(r[0],r[1],r[2],r[3]),!n))return new Bi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ar(n||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const n of this.args){if(r=n.evaluate(e),r===null)return 0;const s=Number(r);if(!isNaN(s))return s}throw new ar(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?hr.fromString(co(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?$r.fromString(co(this.args[0].evaluate(e))):co(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Zn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ys(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Oo=k1;const n3=["Unknown","Point","LineString","Polygon"];var Kl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?n3[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:n}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-i[0])+this.featureDistanceData.bearing[1]*(n*e-i[1])}return 0}parseColor(i){let e=this._parseColorCache[i];return e||(e=this._parseColorCache[i]=Bi.parse(i)),e}};class Fo{constructor(e,r,n,s){this.name=e,this.type=r,this._evaluate=n,this.args=s}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const n=e[0],s=Fo.definitions[n];if(!s)return r.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const c=Array.isArray(s)?s[0]:s.type,h=Array.isArray(s)?[[s[1],s[2]]]:s.overloads,d=h.filter(([m])=>!Array.isArray(m)||m.length===e.length-1);let _=null;for(const[m,b]of d){_=new ic(r.registry,r.path,null,r.scope);const T=[];let S=!1;for(let M=1;M<e.length;M++){const z=e[M],B=Array.isArray(m)?m[M-1]:m.type,q=_.parse(z,1+T.length,B);if(!q){S=!0;break}T.push(q)}if(!S)if(Array.isArray(m)&&m.length!==T.length)_.error(`Expected ${m.length} arguments, but found ${T.length} instead.`);else{for(let M=0;M<T.length;M++){const z=Array.isArray(m)?m[M]:m.type,B=T[M];_.concat(M+1).checkSubtype(z,B.type)}if(_.errors.length===0)return new Fo(n,c,b,T)}}if(d.length===1)r.errors.push(..._.errors);else{const m=(d.length?d:h).map(([T])=>{return S=T,Array.isArray(S)?`(${S.map(Ei).join(", ")})`:`(${Ei(S.type)}...)`;var S}).join(" | "),b=[];for(let T=1;T<e.length;T++){const S=r.parse(e[T],1+b.length);if(!S)return null;b.push(Ei(S.type))}r.error(`Expected arguments of type ${m}, but found (${b.join(", ")}) instead.`)}return null}static register(e,r){Fo.definitions=r;for(const n in r)e[n]=Fo}}var Dn=Fo;class uo{constructor(e,r,n){this.type=zn,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const n=e[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");const s=r.parse(n["case-sensitive"]!==void 0&&n["case-sensitive"],1,jt);if(!s)return null;const c=r.parse(n["diacritic-sensitive"]!==void 0&&n["diacritic-sensitive"],1,jt);if(!c)return null;let h=null;return n.locale&&(h=r.parse(n.locale,1,Wt),!h)?null:new uo(s,c,h)}evaluate(e){return new jr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const qn=8192;function M1(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function xs(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function o3(i,e){const r=(180+i[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,s=Math.pow(2,e.z);return[Math.round(r*s*qn),Math.round(n*s*qn)]}function a3(i,e,r){const n=i[0]-e[0],s=i[1]-e[1],c=i[0]-r[0],h=i[1]-r[1];return n*h-c*s==0&&n*c<=0&&s*h<=0}function C1(i,e){let r=!1;for(let h=0,d=e.length;h<d;h++){const _=e[h];for(let m=0,b=_.length;m<b-1;m++){if(a3(i,_[m],_[m+1]))return!1;(s=_[m])[1]>(n=i)[1]!=(c=_[m+1])[1]>n[1]&&n[0]<(c[0]-s[0])*(n[1]-s[1])/(c[1]-s[1])+s[0]&&(r=!r)}}var n,s,c;return r}function Ql(i,e){for(let r=0;r<e.length;r++)if(C1(i,e[r]))return!0;return!1}function Ea(i,e,r,n){const s=n[0]-r[0],c=n[1]-r[1],h=(i[0]-r[0])*c-s*(i[1]-r[1]),d=(e[0]-r[0])*c-s*(e[1]-r[1]);return h>0&&d<0||h<0&&d>0}function s3(i,e,r){for(const m of r)for(let b=0;b<m.length-1;++b)if((d=[(h=m[b+1])[0]-(c=m[b])[0],h[1]-c[1]])[0]*(_=[(s=e)[0]-(n=i)[0],s[1]-n[1]])[1]-d[1]*_[0]!=0&&Ea(n,s,c,h)&&Ea(c,h,n,s))return!0;var n,s,c,h,d,_;return!1}function ec(i,e){for(let r=0;r<i.length;++r)if(!C1(i[r],e))return!1;for(let r=0;r<i.length-1;++r)if(s3(i[r],i[r+1],e))return!1;return!0}function l3(i,e){for(let r=0;r<e.length;r++)if(ec(i,e[r]))return!0;return!1}function z1(i,e,r){const n=[];for(let s=0;s<i.length;s++){const c=[];for(let h=0;h<i[s].length;h++){const d=o3(i[s][h],r);M1(e,d),c.push(d)}n.push(c)}return n}function rn(i,e,r){const n=[];for(let s=0;s<i.length;s++){const c=z1(i[s],e,r);n.push(c)}return n}function P1(i,e,r,n){if(i[0]<r[0]||i[0]>r[2]){const s=.5*n;let c=i[0]-r[0]>s?-n:r[0]-i[0]>s?n:0;c===0&&(c=i[0]-r[2]>s?-n:r[2]-i[0]>s?n:0),i[0]+=c}M1(e,i)}function D1(i,e,r,n){const s=Math.pow(2,n.z)*qn,c=[n.x*qn,n.y*qn],h=[];if(!i)return h;for(const d of i)for(const _ of d){const m=[_.x+c[0],_.y+c[1]];P1(m,e,r,s),h.push(m)}return h}function Aa(i,e,r,n){const s=Math.pow(2,n.z)*qn,c=[n.x*qn,n.y*qn],h=[];if(!i)return h;for(const _ of i){const m=[];for(const b of _){const T=[b.x+c[0],b.y+c[1]];M1(e,T),m.push(T)}h.push(m)}if(e[2]-e[0]<=s/2){(d=e)[0]=d[1]=1/0,d[2]=d[3]=-1/0;for(const _ of h)for(const m of _)P1(m,e,r,s)}var d;return h}class Ln{constructor(e,r){this.type=jt,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ta(e[1])){const n=e[1];if(n.type==="FeatureCollection")for(let s=0;s<n.features.length;++s){const c=n.features[s].geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new Ln(n,n.features[s].geometry)}else if(n.type==="Feature"){const s=n.geometry.type;if(s==="Polygon"||s==="MultiPolygon")return new Ln(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new Ln(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,n){const s=[1/0,1/0,-1/0,-1/0],c=[1/0,1/0,-1/0,-1/0],h=r.canonicalID();if(!h)return!1;if(n.type==="Polygon"){const d=z1(n.coordinates,c,h),_=D1(r.geometry(),s,c,h);if(!xs(s,c))return!1;for(const m of _)if(!C1(m,d))return!1}if(n.type==="MultiPolygon"){const d=rn(n.coordinates,c,h),_=D1(r.geometry(),s,c,h);if(!xs(s,c))return!1;for(const m of _)if(!Ql(m,d))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,n){const s=[1/0,1/0,-1/0,-1/0],c=[1/0,1/0,-1/0,-1/0],h=r.canonicalID();if(!h)return!1;if(n.type==="Polygon"){const d=z1(n.coordinates,c,h),_=Aa(r.geometry(),s,c,h);if(!xs(s,c))return!1;for(const m of _)if(!ec(m,d))return!1}if(n.type==="MultiPolygon"){const d=rn(n.coordinates,c,h),_=Aa(r.geometry(),s,c,h);if(!xs(s,c))return!1;for(const m of _)if(!l3(m,d))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var vs=Ln;function No(i){if(i instanceof Dn&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof vs)return!1;let e=!0;return i.eachChild(r=>{e&&!No(r)&&(e=!1)}),e}function Go(i){if(i instanceof Dn&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(r=>{e&&!Go(r)&&(e=!1)}),e}function bs(i,e){if(i instanceof Dn&&e.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(n=>{r&&!bs(n,e)&&(r=!1)}),r}class ii{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const n=e[1];return r.scope.has(n)?new ii(n,r.scope.get(n)):r.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var tc=ii;class L1{constructor(e,r=[],n,s=new Jl,c=[]){this.registry=e,this.path=r,this.key=r.map(h=>`[${h}]`).join(""),this.scope=s,this.errors=c,this.expectedType=n}parse(e,r,n,s,c={}){return r?this.concat(r,n,s)._parse(e,c):this._parse(e,c)}_parse(e,r){function n(s,c,h){return h==="assert"?new Pn(c,[s]):h==="coerce"?new Oo(c,[s]):s}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const s=e[0];if(typeof s!="string")return this.error(`Expression name must be a string, but found ${typeof s} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const c=this.registry[s];if(c){let h=c.parse(e,this);if(!h)return null;if(this.expectedType){const d=this.expectedType,_=h.type;if(d.kind!=="string"&&d.kind!=="number"&&d.kind!=="boolean"&&d.kind!=="object"&&d.kind!=="array"||_.kind!=="value")if(d.kind!=="color"&&d.kind!=="formatted"&&d.kind!=="resolvedImage"||_.kind!=="value"&&_.kind!=="string"){if(this.checkSubtype(d,_))return null}else h=n(h,d,r.typeAnnotation||"coerce");else h=n(h,d,r.typeAnnotation||"assert")}if(!(h instanceof Ia)&&h.type.kind!=="resolvedImage"&&ws(h)){const d=new Kl;try{h=new Ia(h.type,h.evaluate(d))}catch(_){return this.error(_.message),null}}return h}return this.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,n){const s=typeof e=="number"?this.path.concat(e):this.path,c=n?this.scope.concat(n):this.scope;return new L1(this.registry,s,r||null,c,this.errors)}error(e,...r){const n=`${this.key}${r.map(s=>`[${s}]`).join("")}`;this.errors.push(new Or(n,e))}checkSubtype(e,r){const n=Lo(e,r);return n&&this.error(n),n}}var ic=L1;function ws(i){if(i instanceof tc)return ws(i.boundExpression);if(i instanceof Dn&&i.name==="error"||i instanceof uo||i instanceof vs)return!1;const e=i instanceof Oo||i instanceof Pn;let r=!0;return i.eachChild(n=>{r=e?r&&ws(n):r&&n instanceof Ia}),!!r&&No(i)&&bs(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ts(i,e){const r=i.length-1;let n,s,c=0,h=r,d=0;for(;c<=h;)if(d=Math.floor((c+h)/2),n=i[d],s=i[d+1],n<=e){if(d===r||e<s)return d;c=d+1}else{if(!(n>e))throw new ar("Input is not a number.");h=d-1}return 0}class Is{constructor(e,r,n){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[s,c]of n)this.labels.push(s),this.outputs.push(c)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const n=r.parse(e[1],1,ot);if(!n)return null;const s=[];let c=null;r.expectedType&&r.expectedType.kind!=="value"&&(c=r.expectedType);for(let h=1;h<e.length;h+=2){const d=h===1?-1/0:e[h],_=e[h+1],m=h,b=h+1;if(typeof d!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',m);if(s.length&&s[s.length-1][0]>=d)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',m);const T=r.parse(_,b,c);if(!T)return null;c=c||T.type,s.push([d,T])}return new Is(c,n,s)}evaluate(e){const r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);const s=this.input.evaluate(e);if(s<=r[0])return n[0].evaluate(e);const c=r.length;return s>=r[c-1]?n[c-1].evaluate(e):n[Ts(r,s)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var Ss=Is;function Yt(i,e,r){return i*(1-r)+e*r}var ka=Object.freeze({__proto__:null,number:Yt,color:function(i,e,r){return new Bi(Yt(i.r,e.r,r),Yt(i.g,e.g,r),Yt(i.b,e.b,r),Yt(i.a,e.a,r))},array:function(i,e,r){return i.map((n,s)=>Yt(n,e[s],r))}});const ho=.95047,Ma=1.08883,rc=4/29,Ca=6/29,R1=3*Ca*Ca,c3=Math.PI/180,u3=180/Math.PI;function Es(i){return i>.008856451679035631?Math.pow(i,1/3):i/R1+rc}function B1(i){return i>Ca?i*i*i:R1*(i-rc)}function As(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function ks(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function O1(i){const e=ks(i.r),r=ks(i.g),n=ks(i.b),s=Es((.4124564*e+.3575761*r+.1804375*n)/ho),c=Es((.2126729*e+.7151522*r+.072175*n)/1);return{l:116*c-16,a:500*(s-c),b:200*(c-Es((.0193339*e+.119192*r+.9503041*n)/Ma)),alpha:i.a}}function nc(i){let e=(i.l+16)/116,r=isNaN(i.a)?e:e+i.a/500,n=isNaN(i.b)?e:e-i.b/200;return e=1*B1(e),r=ho*B1(r),n=Ma*B1(n),new Bi(As(3.2404542*r-1.5371385*e-.4985314*n),As(-.969266*r+1.8760108*e+.041556*n),As(.0556434*r-.2040259*e+1.0572252*n),i.alpha)}function oc(i,e,r){const n=e-i;return i+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const za={forward:O1,reverse:nc,interpolate:function(i,e,r){return{l:Yt(i.l,e.l,r),a:Yt(i.a,e.a,r),b:Yt(i.b,e.b,r),alpha:Yt(i.alpha,e.alpha,r)}}},Uo={forward:function(i){const{l:e,a:r,b:n}=O1(i),s=Math.atan2(n,r)*u3;return{h:s<0?s+360:s,c:Math.sqrt(r*r+n*n),l:e,alpha:i.a}},reverse:function(i){const e=i.h*c3,r=i.c;return nc({l:i.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:i.alpha})},interpolate:function(i,e,r){return{h:oc(i.h,e.h,r),c:Yt(i.c,e.c,r),l:Yt(i.l,e.l,r),alpha:Yt(i.alpha,e.alpha,r)}}};var F1=Object.freeze({__proto__:null,lab:za,hcl:Uo});class Ms{constructor(e,r,n,s,c){this.type=e,this.operator=r,this.interpolation=n,this.input=s,this.labels=[],this.outputs=[];for(const[h,d]of c)this.labels.push(h),this.outputs.push(d)}static interpolationFactor(e,r,n,s){let c=0;if(e.name==="exponential")c=N1(r,e.base,n,s);else if(e.name==="linear")c=N1(r,1,n,s);else if(e.name==="cubic-bezier"){const h=e.controlPoints;c=new ae(h[0],h[1],h[2],h[3]).solve(N1(r,1,n,s))}return c}static parse(e,r){let[n,s,c,...h]=e;if(!Array.isArray(s)||s.length===0)return r.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){const m=s[1];if(typeof m!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:m}}else{if(s[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(s[0])}`,1,0);{const m=s.slice(1);if(m.length!==4||m.some(b=>typeof b!="number"||b<0||b>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:m}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(c=r.parse(c,2,ot),!c)return null;const d=[];let _=null;n==="interpolate-hcl"||n==="interpolate-lab"?_=tn:r.expectedType&&r.expectedType.kind!=="value"&&(_=r.expectedType);for(let m=0;m<h.length;m+=2){const b=h[m],T=h[m+1],S=m+3,M=m+4;if(typeof b!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(d.length&&d[d.length-1][0]>=b)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',S);const z=r.parse(T,M,_);if(!z)return null;_=_||z.type,d.push([b,z])}return _.kind==="number"||_.kind==="color"||_.kind==="array"&&_.itemType.kind==="number"&&typeof _.N=="number"?new Ms(_,n,s,c,d):r.error(`Type ${Ei(_)} is not interpolatable.`)}evaluate(e){const r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(e);const s=this.input.evaluate(e);if(s<=r[0])return n[0].evaluate(e);const c=r.length;if(s>=r[c-1])return n[c-1].evaluate(e);const h=Ts(r,s),d=Ms.interpolationFactor(this.interpolation,s,r[h],r[h+1]),_=n[h].evaluate(e),m=n[h+1].evaluate(e);return this.operator==="interpolate"?ka[this.type.kind.toLowerCase()](_,m,d):this.operator==="interpolate-hcl"?Uo.reverse(Uo.interpolate(Uo.forward(_),Uo.forward(m),d)):za.reverse(za.interpolate(za.forward(_),za.forward(m),d))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let n=0;n<this.labels.length;n++)r.push(this.labels[n],this.outputs[n].serialize());return r}}function N1(i,e,r,n){const s=n-r,c=i-r;return s===0?0:e===1?c/s:(Math.pow(e,c)-1)/(Math.pow(e,s)-1)}var hn=Ms;class G1{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let n=null;const s=r.expectedType;s&&s.kind!=="value"&&(n=s);const c=[];for(const d of e.slice(1)){const _=r.parse(d,1+c.length,n,void 0,{typeAnnotation:"omit"});if(!_)return null;n=n||_.type,c.push(_)}const h=s&&c.some(d=>Lo(s,d.type));return new G1(h?Ot:n,c)}evaluate(e){let r,n=null,s=0;for(const c of this.args){if(s++,n=c.evaluate(e),n&&n instanceof $r&&!n.available&&(r||(r=n),n=null,s===this.args.length))return r;if(n!==null)break}return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var ac=G1;class U1{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const n=[];for(let c=1;c<e.length-1;c+=2){const h=e[c];if(typeof h!="string")return r.error(`Expected string, but found ${typeof h} instead.`,c);if(/[^a-zA-Z0-9_]/.test(h))return r.error("Variable names must contain only alphanumeric characters or '_'.",c);const d=r.parse(e[c+1],c+1);if(!d)return null;n.push([h,d])}const s=r.parse(e[e.length-1],e.length-1,r.expectedType,n);return s?new U1(n,s):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,n]of this.bindings)e.push(r,n.serialize());return e.push(this.result.serialize()),e}}var V1=U1;class j1{constructor(e,r,n){this.type=e,this.index=r,this.input=n}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,ot),s=r.parse(e[2],2,Vr(r.expectedType||Ot));return n&&s?new j1(s.type.itemType,n,s):null}evaluate(e){const r=this.index.evaluate(e),n=this.input.evaluate(e);if(r<0)throw new ar(`Array index out of bounds: ${r} < 0.`);if(r>=n.length)throw new ar(`Array index out of bounds: ${r} > ${n.length-1}.`);if(r!==Math.floor(r))throw new ar(`Array index must be an integer, but found ${r} instead.`);return n[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var h3=j1;class $1{constructor(e,r){this.type=jt,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,Ot),s=r.parse(e[2],2,Ot);return n&&s?_s(n.type,[jt,Wt,ot,ba,Ot])?new $1(n,s):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ei(n.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(n==null)return!1;if(!Ro(r,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${Ei(Pi(r))} instead.`);if(!Ro(n,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${Ei(Pi(n))} instead.`);return n.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var p3=$1;class Pa{constructor(e,r,n){this.type=ot,this.needle=e,this.haystack=r,this.fromIndex=n}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,Ot),s=r.parse(e[2],2,Ot);if(!n||!s)return null;if(!_s(n.type,[jt,Wt,ot,ba,Ot]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ei(n.type)} instead`);if(e.length===4){const c=r.parse(e[3],3,ot);return c?new Pa(n,s,c):null}return new Pa(n,s)}evaluate(e){const r=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Ro(r,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${Ei(Pi(r))} instead.`);if(!Ro(n,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${Ei(Pi(n))} instead.`);if(this.fromIndex){const s=this.fromIndex.evaluate(e);return n.indexOf(r,s)}return n.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var sc=Pa;class Cs{constructor(e,r,n,s,c,h){this.inputType=e,this.type=r,this.input=n,this.cases=s,this.outputs=c,this.otherwise=h}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let n,s;r.expectedType&&r.expectedType.kind!=="value"&&(s=r.expectedType);const c={},h=[];for(let m=2;m<e.length-1;m+=2){let b=e[m];const T=e[m+1];Array.isArray(b)||(b=[b]);const S=r.concat(m);if(b.length===0)return S.error("Expected at least one branch label.");for(const z of b){if(typeof z!="number"&&typeof z!="string")return S.error("Branch labels must be numbers or strings.");if(typeof z=="number"&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return S.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof z=="number"&&Math.floor(z)!==z)return S.error("Numeric branch labels must be integer values.");if(n){if(S.checkSubtype(n,Pi(z)))return null}else n=Pi(z);if(c[String(z)]!==void 0)return S.error("Branch labels must be unique.");c[String(z)]=h.length}const M=r.parse(T,m,s);if(!M)return null;s=s||M.type,h.push(M)}const d=r.parse(e[1],1,Ot);if(!d)return null;const _=r.parse(e[e.length-1],e.length-1,s);return _?d.type.kind!=="value"&&r.concat(1).checkSubtype(n,d.type)?null:new Cs(n,s,d,c,h,_):null}evaluate(e){const r=this.input.evaluate(e);return(Pi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),n=[],s={};for(const h of r){const d=s[this.cases[h]];d===void 0?(s[this.cases[h]]=n.length,n.push([this.cases[h],[h]])):n[d][1].push(h)}const c=h=>this.inputType.kind==="number"?Number(h):h;for(const[h,d]of n)e.push(d.length===1?c(d[0]):d.map(c)),e.push(this.outputs[h].serialize());return e.push(this.otherwise.serialize()),e}}var d3=Cs;class Z1{constructor(e,r,n){this.type=e,this.branches=r,this.otherwise=n}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);const s=[];for(let h=1;h<e.length-1;h+=2){const d=r.parse(e[h],h,jt);if(!d)return null;const _=r.parse(e[h+1],h+1,n);if(!_)return null;s.push([d,_]),n=n||_.type}const c=r.parse(e[e.length-1],e.length-1,n);return c?new Z1(n,s,c):null}evaluate(e){for(const[r,n]of this.branches)if(r.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,n]of this.branches)e(r),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var lc=Z1;class Da{constructor(e,r,n,s){this.type=e,this.input=r,this.beginIndex=n,this.endIndex=s}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=r.parse(e[1],1,Ot),s=r.parse(e[2],2,ot);if(!n||!s)return null;if(!_s(n.type,[Vr(Ot),Wt,Ot]))return r.error(`Expected first argument to be of type array or string, but found ${Ei(n.type)} instead`);if(e.length===4){const c=r.parse(e[3],3,ot);return c?new Da(n.type,n,s,c):null}return new Da(n.type,n,s)}evaluate(e){const r=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!Ro(r,["string","array"]))throw new ar(`Expected first argument to be of type array or string, but found ${Ei(Pi(r))} instead.`);if(this.endIndex){const s=this.endIndex.evaluate(e);return r.slice(n,s)}return r.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var cc=Da;function uc(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function hc(i,e,r,n){return n.compare(e,r)===0}function Vo(i,e,r){const n=i!=="=="&&i!=="!=";return class U8{constructor(c,h,d){this.type=jt,this.lhs=c,this.rhs=h,this.collator=d,this.hasUntypedArgument=c.type.kind==="value"||h.type.kind==="value"}static parse(c,h){if(c.length!==3&&c.length!==4)return h.error("Expected two or three arguments.");const d=c[0];let _=h.parse(c[1],1,Ot);if(!_)return null;if(!uc(d,_.type))return h.concat(1).error(`"${d}" comparisons are not supported for type '${Ei(_.type)}'.`);let m=h.parse(c[2],2,Ot);if(!m)return null;if(!uc(d,m.type))return h.concat(2).error(`"${d}" comparisons are not supported for type '${Ei(m.type)}'.`);if(_.type.kind!==m.type.kind&&_.type.kind!=="value"&&m.type.kind!=="value")return h.error(`Cannot compare types '${Ei(_.type)}' and '${Ei(m.type)}'.`);n&&(_.type.kind==="value"&&m.type.kind!=="value"?_=new Pn(m.type,[_]):_.type.kind!=="value"&&m.type.kind==="value"&&(m=new Pn(_.type,[m])));let b=null;if(c.length===4){if(_.type.kind!=="string"&&m.type.kind!=="string"&&_.type.kind!=="value"&&m.type.kind!=="value")return h.error("Cannot use collator to compare non-string types.");if(b=h.parse(c[3],3,zn),!b)return null}return new U8(_,m,b)}evaluate(c){const h=this.lhs.evaluate(c),d=this.rhs.evaluate(c);if(n&&this.hasUntypedArgument){const _=Pi(h),m=Pi(d);if(_.kind!==m.kind||_.kind!=="string"&&_.kind!=="number")throw new ar(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${_.kind}, ${m.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const _=Pi(h),m=Pi(d);if(_.kind!=="string"||m.kind!=="string")return e(c,h,d)}return this.collator?r(c,h,d,this.collator.evaluate(c)):e(c,h,d)}eachChild(c){c(this.lhs),c(this.rhs),this.collator&&c(this.collator)}outputDefined(){return!0}serialize(){const c=[i];return this.eachChild(h=>{c.push(h.serialize())}),c}}}const f3=Vo("==",function(i,e,r){return e===r},hc),zs=Vo("!=",function(i,e,r){return e!==r},function(i,e,r,n){return!hc(0,e,r,n)}),pc=Vo("<",function(i,e,r){return e<r},function(i,e,r,n){return n.compare(e,r)<0}),dc=Vo(">",function(i,e,r){return e>r},function(i,e,r,n){return n.compare(e,r)>0}),_3=Vo("<=",function(i,e,r){return e<=r},function(i,e,r,n){return n.compare(e,r)<=0}),m3=Vo(">=",function(i,e,r){return e>=r},function(i,e,r,n){return n.compare(e,r)>=0});class q1{constructor(e,r,n,s,c){this.type=Wt,this.number=e,this.locale=r,this.currency=n,this.minFractionDigits=s,this.maxFractionDigits=c}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const n=r.parse(e[1],1,ot);if(!n)return null;const s=e[2];if(typeof s!="object"||Array.isArray(s))return r.error("NumberFormat options argument must be an object.");let c=null;if(s.locale&&(c=r.parse(s.locale,1,Wt),!c))return null;let h=null;if(s.currency&&(h=r.parse(s.currency,1,Wt),!h))return null;let d=null;if(s["min-fraction-digits"]&&(d=r.parse(s["min-fraction-digits"],1,ot),!d))return null;let _=null;return s["max-fraction-digits"]&&(_=r.parse(s["max-fraction-digits"],1,ot),!_)?null:new q1(n,c,h,d,_)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ps{constructor(e){this.type=ot,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const n=r.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Ei(n.type)} instead.`):new Ps(n):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new ar(`Expected value to be of type string or array, but found ${Ei(Pi(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}const W1={"==":f3,"!=":zs,">":dc,"<":pc,">=":m3,"<=":_3,array:Pn,at:h3,boolean:Pn,case:lc,coalesce:ac,collator:uo,format:Zn,image:ys,in:p3,"index-of":sc,interpolate:hn,"interpolate-hcl":hn,"interpolate-lab":hn,length:Ps,let:V1,literal:Ia,match:d3,number:Pn,"number-format":q1,object:Pn,slice:cc,step:Ss,string:Pn,"to-boolean":Oo,"to-color":Oo,"to-number":Oo,"to-string":Oo,var:tc,within:vs};function X1(i,[e,r,n,s]){e=e.evaluate(i),r=r.evaluate(i),n=n.evaluate(i);const c=s?s.evaluate(i):1,h=ms(e,r,n,c);if(h)throw new ar(h);return new Bi(e/255*c,r/255*c,n/255*c,c)}function Ds(i,e){return i in e}function J1(i,e){const r=e[i];return r===void 0?null:r}function po(i){return{type:i}}Dn.register(W1,{error:[{kind:"error"},[Wt],(i,[e])=>{throw new ar(e.evaluate(i))}],typeof:[Wt,[Ot],(i,[e])=>Ei(Pi(e.evaluate(i)))],"to-rgba":[Vr(ot,4),[tn],(i,[e])=>e.evaluate(i).toArray()],rgb:[tn,[ot,ot,ot],X1],rgba:[tn,[ot,ot,ot,ot],X1],has:{type:jt,overloads:[[[Wt],(i,[e])=>Ds(e.evaluate(i),i.properties())],[[Wt,lo],(i,[e,r])=>Ds(e.evaluate(i),r.evaluate(i))]]},get:{type:Ot,overloads:[[[Wt],(i,[e])=>J1(e.evaluate(i),i.properties())],[[Wt,lo],(i,[e,r])=>J1(e.evaluate(i),r.evaluate(i))]]},"feature-state":[Ot,[Wt],(i,[e])=>J1(e.evaluate(i),i.featureState||{})],properties:[lo,[],i=>i.properties()],"geometry-type":[Wt,[],i=>i.geometryType()],id:[Ot,[],i=>i.id()],zoom:[ot,[],i=>i.globals.zoom],pitch:[ot,[],i=>i.globals.pitch||0],"distance-from-center":[ot,[],i=>i.distanceFromCenter()],"heatmap-density":[ot,[],i=>i.globals.heatmapDensity||0],"line-progress":[ot,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[ot,[],i=>i.globals.skyRadialProgress||0],accumulated:[Ot,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[ot,po(ot),(i,e)=>{let r=0;for(const n of e)r+=n.evaluate(i);return r}],"*":[ot,po(ot),(i,e)=>{let r=1;for(const n of e)r*=n.evaluate(i);return r}],"-":{type:ot,overloads:[[[ot,ot],(i,[e,r])=>e.evaluate(i)-r.evaluate(i)],[[ot],(i,[e])=>-e.evaluate(i)]]},"/":[ot,[ot,ot],(i,[e,r])=>e.evaluate(i)/r.evaluate(i)],"%":[ot,[ot,ot],(i,[e,r])=>e.evaluate(i)%r.evaluate(i)],ln2:[ot,[],()=>Math.LN2],pi:[ot,[],()=>Math.PI],e:[ot,[],()=>Math.E],"^":[ot,[ot,ot],(i,[e,r])=>Math.pow(e.evaluate(i),r.evaluate(i))],sqrt:[ot,[ot],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[ot,[ot],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[ot,[ot],(i,[e])=>Math.log(e.evaluate(i))],log2:[ot,[ot],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[ot,[ot],(i,[e])=>Math.sin(e.evaluate(i))],cos:[ot,[ot],(i,[e])=>Math.cos(e.evaluate(i))],tan:[ot,[ot],(i,[e])=>Math.tan(e.evaluate(i))],asin:[ot,[ot],(i,[e])=>Math.asin(e.evaluate(i))],acos:[ot,[ot],(i,[e])=>Math.acos(e.evaluate(i))],atan:[ot,[ot],(i,[e])=>Math.atan(e.evaluate(i))],min:[ot,po(ot),(i,e)=>Math.min(...e.map(r=>r.evaluate(i)))],max:[ot,po(ot),(i,e)=>Math.max(...e.map(r=>r.evaluate(i)))],abs:[ot,[ot],(i,[e])=>Math.abs(e.evaluate(i))],round:[ot,[ot],(i,[e])=>{const r=e.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[ot,[ot],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[ot,[ot],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[jt,[Wt,Ot],(i,[e,r])=>i.properties()[e.value]===r.value],"filter-id-==":[jt,[Ot],(i,[e])=>i.id()===e.value],"filter-type-==":[jt,[Wt],(i,[e])=>i.geometryType()===e.value],"filter-<":[jt,[Wt,Ot],(i,[e,r])=>{const n=i.properties()[e.value],s=r.value;return typeof n==typeof s&&n<s}],"filter-id-<":[jt,[Ot],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[jt,[Wt,Ot],(i,[e,r])=>{const n=i.properties()[e.value],s=r.value;return typeof n==typeof s&&n>s}],"filter-id->":[jt,[Ot],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[jt,[Wt,Ot],(i,[e,r])=>{const n=i.properties()[e.value],s=r.value;return typeof n==typeof s&&n<=s}],"filter-id-<=":[jt,[Ot],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[jt,[Wt,Ot],(i,[e,r])=>{const n=i.properties()[e.value],s=r.value;return typeof n==typeof s&&n>=s}],"filter-id->=":[jt,[Ot],(i,[e])=>{const r=i.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[jt,[Ot],(i,[e])=>e.value in i.properties()],"filter-has-id":[jt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[jt,[Vr(Wt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[jt,[Vr(Ot)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[jt,[Wt,Vr(Ot)],(i,[e,r])=>r.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[jt,[Wt,Vr(Ot)],(i,[e,r])=>function(n,s,c,h){for(;c<=h;){const d=c+h>>1;if(s[d]===n)return!0;s[d]>n?h=d-1:c=d+1}return!1}(i.properties()[e.value],r.value,0,r.value.length-1)],all:{type:jt,overloads:[[[jt,jt],(i,[e,r])=>e.evaluate(i)&&r.evaluate(i)],[po(jt),(i,e)=>{for(const r of e)if(!r.evaluate(i))return!1;return!0}]]},any:{type:jt,overloads:[[[jt,jt],(i,[e,r])=>e.evaluate(i)||r.evaluate(i)],[po(jt),(i,e)=>{for(const r of e)if(r.evaluate(i))return!0;return!1}]]},"!":[jt,[jt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[jt,[Wt],(i,[e])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(e.evaluate(i))}],upcase:[Wt,[Wt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Wt,[Wt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Wt,po(Ot),(i,e)=>e.map(r=>co(r.evaluate(i))).join("")],"resolved-locale":[Wt,[zn],(i,[e])=>e.evaluate(i).resolvedLocale()]});var La=W1;function fc(i){return{result:"success",value:i}}function jo(i){return{result:"error",value:i}}function $o(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function H1(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Ls(i){return!!i.expression&&i.expression.interpolated}function Kt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Rs(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function g3(i){return i}function _c(i,e){const r=e.type==="color",n=i.stops&&typeof i.stops[0][0]=="object",s=n||!(n||i.property!==void 0),c=i.type||(Ls(e)?"exponential":"interval");if(r&&((i=Br({},i)).stops&&(i.stops=i.stops.map(m=>[m[0],Bi.parse(m[1])])),i.default=Bi.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!F1[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let h,d,_;if(c==="exponential")h=gc;else if(c==="interval")h=Zo;else if(c==="categorical"){h=mc,d=Object.create(null);for(const m of i.stops)d[m[0]]=m[1];_=typeof i.stops[0][0]}else{if(c!=="identity")throw new Error(`Unknown function type "${c}"`);h=y3}if(n){const m={},b=[];for(let M=0;M<i.stops.length;M++){const z=i.stops[M],B=z[0].zoom;m[B]===void 0&&(m[B]={zoom:B,type:i.type,property:i.property,default:i.default,stops:[]},b.push(B)),m[B].stops.push([z[0].value,z[1]])}const T=[];for(const M of b)T.push([m[M].zoom,_c(m[M],e)]);const S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:hn.interpolationFactor.bind(void 0,S),zoomStops:T.map(M=>M[0]),evaluate:({zoom:M},z)=>gc({stops:T,base:i.base},e,M).evaluate(M,z)}}if(s){const m=c==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:m,interpolationFactor:hn.interpolationFactor.bind(void 0,m),zoomStops:i.stops.map(b=>b[0]),evaluate:({zoom:b})=>h(i,e,b,d,_)}}return{kind:"source",evaluate(m,b){const T=b&&b.properties?b.properties[i.property]:void 0;return T===void 0?Zr(i.default,e.default):h(i,e,T,d,_)}}}function Zr(i,e,r){return i!==void 0?i:e!==void 0?e:r!==void 0?r:void 0}function mc(i,e,r,n,s){return Zr(typeof r===s?n[r]:void 0,i.default,e.default)}function Zo(i,e,r){if(Kt(r)!=="number")return Zr(i.default,e.default);const n=i.stops.length;if(n===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[n-1][0])return i.stops[n-1][1];const s=Ts(i.stops.map(c=>c[0]),r);return i.stops[s][1]}function gc(i,e,r){const n=i.base!==void 0?i.base:1;if(Kt(r)!=="number")return Zr(i.default,e.default);const s=i.stops.length;if(s===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[s-1][0])return i.stops[s-1][1];const c=Ts(i.stops.map(b=>b[0]),r),h=function(b,T,S,M){const z=M-S,B=b-S;return z===0?0:T===1?B/z:(Math.pow(T,B)-1)/(Math.pow(T,z)-1)}(r,n,i.stops[c][0],i.stops[c+1][0]),d=i.stops[c][1],_=i.stops[c+1][1];let m=ka[e.type]||g3;if(i.colorSpace&&i.colorSpace!=="rgb"){const b=F1[i.colorSpace];m=(T,S)=>b.reverse(b.interpolate(b.forward(T),b.forward(S),h))}return typeof d.evaluate=="function"?{evaluate(...b){const T=d.evaluate.apply(void 0,b),S=_.evaluate.apply(void 0,b);if(T!==void 0&&S!==void 0)return m(T,S,h)}}:m(d,_,h)}function y3(i,e,r){return e.type==="color"?r=Bi.parse(r):e.type==="formatted"?r=hr.fromString(r.toString()):e.type==="resolvedImage"?r=$r.fromString(r.toString()):Kt(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),Zr(r,i.default,e.default)}class Bs{constructor(e,r){this.expression=e,this._warningHistory={},this._evaluator=new Kl,this._defaultValue=r?function(n){return n.type==="color"&&(Rs(n.default)||Array.isArray(n.default))?new Bi(0,0,0,0):n.type==="color"?Bi.parse(n.default)||null:n.default===void 0?null:n.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,n,s,c,h,d,_){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=s||null,this._evaluator.availableImages=c||null,this._evaluator.formattedSection=h,this._evaluator.featureTileCoord=d||null,this._evaluator.featureDistanceData=_||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,n,s,c,h,d,_){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=s||null,this._evaluator.availableImages=c||null,this._evaluator.formattedSection=h||null,this._evaluator.featureTileCoord=d||null,this._evaluator.featureDistanceData=_||null;try{const m=this.expression.evaluate(this._evaluator);if(m==null||typeof m=="number"&&m!=m)return this._defaultValue;if(this._enumValues&&!(m in this._enumValues))throw new ar(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(m)} instead.`);return m}catch(m){return this._warningHistory[m.message]||(this._warningHistory[m.message]=!0,typeof console!="undefined"&&console.warn(m.message)),this._defaultValue}}}function Os(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in La}function fo(i,e){const r=new ic(La,[],e?function(s){const c={color:tn,string:Wt,number:ot,enum:Wt,boolean:jt,formatted:Do,resolvedImage:wa};return s.type==="array"?Vr(c[s.value]||Ot,s.length):c[s.type]}(e):void 0),n=r.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?fc(new Bs(n,e)):jo(r.errors)}class Fs{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!Go(r.expression)}evaluateWithoutErrorHandling(e,r,n,s,c,h){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,s,c,h)}evaluate(e,r,n,s,c,h){return this._styleExpression.evaluate(e,r,n,s,c,h)}}class Ra{constructor(e,r,n,s){this.kind=e,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Go(r.expression),this.interpolationType=s}evaluateWithoutErrorHandling(e,r,n,s,c,h){return this._styleExpression.evaluateWithoutErrorHandling(e,r,n,s,c,h)}evaluate(e,r,n,s,c,h){return this._styleExpression.evaluate(e,r,n,s,c,h)}interpolationFactor(e,r,n){return this.interpolationType?hn.interpolationFactor(this.interpolationType,e,r,n):0}}function Ns(i,e){if((i=fo(i,e)).result==="error")return i;const r=i.value.expression,n=No(r);if(!n&&!$o(e))return jo([new Or("","data expressions not supported")]);const s=bs(r,["zoom","pitch","distance-from-center"]);if(!s&&!H1(e))return jo([new Or("","zoom expressions not supported")]);const c=qo(r);return c||s?c instanceof Or?jo([c]):c instanceof hn&&!Ls(e)?jo([new Or("",'"interpolate" expressions cannot be used with this property')]):fc(c?new Ra(n?"camera":"composite",i.value,c.labels,c instanceof hn?c.interpolation:void 0):new Fs(n?"constant":"source",i.value)):jo([new Or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ba{constructor(e,r){this._parameters=e,this._specification=r,Br(this,_c(this._parameters,this._specification))}static deserialize(e){return new Ba(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function qo(i){let e=null;if(i instanceof V1)e=qo(i.result);else if(i instanceof ac){for(const r of i.args)if(e=qo(r),e)break}else(i instanceof Ss||i instanceof hn)&&i.input instanceof Dn&&i.input.name==="zoom"&&(e=i);return e instanceof Or||i.eachChild(r=>{const n=qo(r);n instanceof Or?e=n:!e&&n?e=new Or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Or("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class lt{constructor(e,r,n,s){this.message=(e?`${e}: `:"")+n,s&&(this.identifier=s),r!=null&&r.__line__&&(this.line=r.__line__)}}function qr(i){const e=i.key,r=i.value,n=i.valueSpec||{},s=i.objectElementValidators||{},c=i.style,h=i.styleSpec;let d=[];const _=Kt(r);if(_!=="object")return[new lt(e,r,`object expected, ${_} found`)];for(const m in r){const b=m.split(".")[0],T=n[b]||n["*"];let S;s[b]?S=s[b]:n[b]?S=tr:s["*"]?S=s["*"]:n["*"]&&(S=tr),S?d=d.concat(S({key:(e&&`${e}.`)+m,value:r[m],valueSpec:T,style:c,styleSpec:h,object:r,objectKey:m},r)):d.push(new lt(e,r[m],`unknown property "${m}"`))}for(const m in n)s[m]||n[m].required&&n[m].default===void 0&&r[m]===void 0&&d.push(new lt(e,r,`missing required property "${m}"`));return d}function Oa(i){const e=i.value,r=i.valueSpec,n=i.style,s=i.styleSpec,c=i.key,h=i.arrayElementValidator||tr;if(Kt(e)!=="array")return[new lt(c,e,`array expected, ${Kt(e)} found`)];if(r.length&&e.length!==r.length)return[new lt(c,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new lt(c,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let d={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};s.$version<7&&(d.function=r.function),Kt(r.value)==="object"&&(d=r.value);let _=[];for(let m=0;m<e.length;m++)_=_.concat(h({array:e,arrayIndex:m,value:e[m],valueSpec:d,style:n,styleSpec:s,key:`${c}[${m}]`}));return _}function _o(i){const e=i.key,r=i.value,n=i.valueSpec;let s=Kt(r);if(s==="number"&&r!=r&&(s="NaN"),s!=="number")return[new lt(e,r,`number expected, ${s} found`)];if("minimum"in n){let c=n.minimum;if(Kt(n.minimum)==="array"&&(c=n.minimum[i.arrayIndex]),r<c)return[new lt(e,r,`${r} is less than the minimum value ${c}`)]}if("maximum"in n){let c=n.maximum;if(Kt(n.maximum)==="array"&&(c=n.maximum[i.arrayIndex]),r>c)return[new lt(e,r,`${r} is greater than the maximum value ${c}`)]}return[]}function Y1(i){const e=i.valueSpec,r=Si(i.value.type);let n,s,c,h={};const d=r!=="categorical"&&i.value.property===void 0,_=!d,m=Kt(i.value.stops)==="array"&&Kt(i.value.stops[0])==="array"&&Kt(i.value.stops[0][0])==="object",b=qr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(M){if(r==="identity")return[new lt(M.key,M.value,'identity function may not have a "stops" property')];let z=[];const B=M.value;return z=z.concat(Oa({key:M.key,value:B,valueSpec:M.valueSpec,style:M.style,styleSpec:M.styleSpec,arrayElementValidator:T})),Kt(B)==="array"&&B.length===0&&z.push(new lt(M.key,B,"array must have at least one stop")),z},default:function(M){return tr({key:M.key,value:M.value,valueSpec:e,style:M.style,styleSpec:M.styleSpec})}}});return r==="identity"&&d&&b.push(new lt(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||b.push(new lt(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!Ls(i.valueSpec)&&b.push(new lt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(_&&!$o(i.valueSpec)?b.push(new lt(i.key,i.value,"property functions not supported")):d&&!H1(i.valueSpec)&&b.push(new lt(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!m||i.value.property!==void 0||b.push(new lt(i.key,i.value,'"property" property is required')),b;function T(M){let z=[];const B=M.value,q=M.key;if(Kt(B)!=="array")return[new lt(q,B,`array expected, ${Kt(B)} found`)];if(B.length!==2)return[new lt(q,B,`array length 2 expected, length ${B.length} found`)];if(m){if(Kt(B[0])!=="object")return[new lt(q,B,`object expected, ${Kt(B[0])} found`)];if(B[0].zoom===void 0)return[new lt(q,B,"object stop key must have zoom")];if(B[0].value===void 0)return[new lt(q,B,"object stop key must have value")];const H=Si(B[0].zoom);if(typeof H!="number")return[new lt(q,B[0].zoom,"stop zoom values must be numbers")];if(c&&c>H)return[new lt(q,B[0].zoom,"stop zoom values must appear in ascending order")];H!==c&&(c=H,s=void 0,h={}),z=z.concat(qr({key:`${q}[0]`,value:B[0],valueSpec:{zoom:{}},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{zoom:_o,value:S}}))}else z=z.concat(S({key:`${q}[0]`,value:B[0],valueSpec:{},style:M.style,styleSpec:M.styleSpec},B));return Os(Ur(B[1]))?z.concat([new lt(`${q}[1]`,B[1],"expressions are not allowed in function stops.")]):z.concat(tr({key:`${q}[1]`,value:B[1],valueSpec:e,style:M.style,styleSpec:M.styleSpec}))}function S(M,z){const B=Kt(M.value),q=Si(M.value),H=M.value!==null?M.value:z;if(n){if(B!==n)return[new lt(M.key,H,`${B} stop domain type must match previous stop domain type ${n}`)]}else n=B;if(B!=="number"&&B!=="string"&&B!=="boolean"&&typeof q!="number"&&typeof q!="string"&&typeof q!="boolean")return[new lt(M.key,H,"stop domain value must be a number, string, or boolean")];if(B!=="number"&&r!=="categorical"){let se=`number expected, ${B} found`;return $o(e)&&r===void 0&&(se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new lt(M.key,H,se)]}return r!=="categorical"||B!=="number"||typeof q=="number"&&isFinite(q)&&Math.floor(q)===q?r!=="categorical"&&B==="number"&&typeof q=="number"&&typeof s=="number"&&s!==void 0&&q<s?[new lt(M.key,H,"stop domain values must appear in ascending order")]:(s=q,r==="categorical"&&q in h?[new lt(M.key,H,"stop domain values must be unique")]:(h[q]=!0,[])):[new lt(M.key,H,`integer expected, found ${String(q)}`)]}}function mo(i){const e=(i.expressionContext==="property"?Ns:fo)(Ur(i.value),i.valueSpec);if(e.result==="error")return e.value.map(n=>new lt(`${i.key}${n.key}`,i.value,n.message));const r=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new lt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Go(r))return[new lt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return Gs(r,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!bs(r,["zoom","feature-state"]))return[new lt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!No(r))return[new lt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gs(i,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const s of e.valueSpec.expression.parameters)r.delete(s);if(r.size===0)return[];const n=[];return i instanceof Dn&&r.has(i.name)?[new lt(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(s=>{n.push(...Gs(s,e))}),n)}function Fa(i){const e=i.key,r=i.value,n=i.valueSpec,s=[];return Array.isArray(n.values)?n.values.indexOf(Si(r))===-1&&s.push(new lt(e,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(n.values).indexOf(Si(r))===-1&&s.push(new lt(e,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),s}function K1(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!K1(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function go(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};K1(i)||(i=yo(i));const r=i;let n=!0;try{n=function(m){if(!Wo(m))return m;let b=Ur(m);return xc(b),b=yc(b),b}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const s=me[`filter_${e}`],c=fo(n,s);let h=null;if(c.result==="error")throw new Error(c.value.map(m=>`${m.key}: ${m.message}`).join(", "));h=(m,b,T)=>c.value.evaluate(m,b,{},T);let d=null,_=null;if(n!==r){const m=fo(r,s);if(m.result==="error")throw new Error(m.value.map(b=>`${b.key}: ${b.message}`).join(", "));d=(b,T,S,M,z)=>m.value.evaluate(b,T,{},S,void 0,void 0,M,z),_=!No(m.value.expression)}return h=h,{filter:h,dynamicFilter:d||void 0,needGeometry:Na(n),needFeature:!!_}}function yc(i){if(!Array.isArray(i))return i;const e=function(r){if(x3.has(r[0])){for(let n=1;n<r.length;n++)if(Wo(r[n]))return!0}return r}(i);return e===!0?e:e.map(r=>yc(r))}function xc(i){let e=!1;const r=[];if(i[0]==="case"){for(let n=1;n<i.length-1;n+=2)e=e||Wo(i[n]),r.push(i[n+1]);r.push(i[i.length-1])}else if(i[0]==="match"){e=e||Wo(i[1]);for(let n=2;n<i.length-1;n+=2)r.push(i[n+1]);r.push(i[i.length-1])}else if(i[0]==="step"){e=e||Wo(i[1]);for(let n=1;n<i.length-1;n+=2)r.push(i[n+1])}e&&(i.length=0,i.push("any",...r));for(let n=1;n<i.length;n++)xc(i[n])}function Wo(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let r=1;r<i.length;r++)if(Wo(i[r]))return!0;return!1}const x3=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function v3(i,e){return i<e?-1:i>e?1:0}function Na(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Na(i[e]))return!0;return!1}function yo(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?xr(i[1],i[2],"=="):e==="!="?Us(xr(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?xr(i[1],i[2],e):e==="any"?(r=i.slice(1),["any"].concat(r.map(yo))):e==="all"?["all"].concat(i.slice(1).map(yo)):e==="none"?["all"].concat(i.slice(1).map(yo).map(Us)):e==="in"?Ga(i[1],i.slice(2)):e==="!in"?Us(Ga(i[1],i.slice(2))):e==="has"?vc(i[1]):e==="!has"?Us(vc(i[1])):e!=="within"||i;var r}function xr(i,e,r){switch(i){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,i,e]}}function Ga(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",i,["literal",e.sort(v3)]]:["filter-in-small",i,["literal",e]]}}function vc(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Us(i){return["!",i]}function Q1(i){return K1(Ur(i.value))?mo(Br({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):bc(i)}function bc(i){const e=i.value,r=i.key;if(Kt(e)!=="array")return[new lt(r,e,`array expected, ${Kt(e)} found`)];const n=i.styleSpec;let s,c=[];if(e.length<1)return[new lt(r,e,"filter array must have at least 1 element")];switch(c=c.concat(Fa({key:`${r}[0]`,value:e[0],valueSpec:n.filter_operator,style:i.style,styleSpec:i.styleSpec})),Si(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Si(e[1])==="$type"&&c.push(new lt(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&c.push(new lt(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(s=Kt(e[1]),s!=="string"&&c.push(new lt(`${r}[1]`,e[1],`string expected, ${s} found`)));for(let h=2;h<e.length;h++)s=Kt(e[h]),Si(e[1])==="$type"?c=c.concat(Fa({key:`${r}[${h}]`,value:e[h],valueSpec:n.geometry_type,style:i.style,styleSpec:i.styleSpec})):s!=="string"&&s!=="number"&&s!=="boolean"&&c.push(new lt(`${r}[${h}]`,e[h],`string, number, or boolean expected, ${s} found`));break;case"any":case"all":case"none":for(let h=1;h<e.length;h++)c=c.concat(bc({key:`${r}[${h}]`,value:e[h],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":s=Kt(e[1]),e.length!==2?c.push(new lt(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):s!=="string"&&c.push(new lt(`${r}[1]`,e[1],`string expected, ${s} found`));break;case"within":s=Kt(e[1]),e.length!==2?c.push(new lt(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):s!=="object"&&c.push(new lt(`${r}[1]`,e[1],`object expected, ${s} found`))}return c}function Vs(i,e){const r=i.key,n=i.style,s=i.styleSpec,c=i.value,h=i.objectKey,d=s[`${e}_${i.layerType}`];if(!d)return[];const _=h.match(/^(.*)-transition$/);if(e==="paint"&&_&&d[_[1]]&&d[_[1]].transition)return tr({key:r,value:c,valueSpec:s.transition,style:n,styleSpec:s});const m=i.valueSpec||d[h];if(!m)return[new lt(r,c,`unknown property "${h}"`)];let b;if(Kt(c)==="string"&&$o(m)&&!m.tokens&&(b=/^{([^}]+)}$/.exec(c)))return[new lt(r,c,`"${h}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(b[1])} }\`.`)];const T=[];return i.layerType==="symbol"&&(h==="text-field"&&n&&!n.glyphs&&T.push(new lt(r,c,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&Rs(Ur(c))&&Si(c.type)==="identity"&&T.push(new lt(r,c,'"text-font" does not support identity functions'))),T.concat(tr({key:i.key,value:c,valueSpec:m,style:n,styleSpec:s,expressionContext:"property",propertyType:e,propertyKey:h}))}function wc(i){return Vs(i,"paint")}function js(i){return Vs(i,"layout")}function Tc(i){let e=[];const r=i.value,n=i.key,s=i.style,c=i.styleSpec;r.type||r.ref||e.push(new lt(n,r,'either "type" or "ref" is required'));let h=Si(r.type);const d=Si(r.ref);if(r.id){const _=Si(r.id);for(let m=0;m<i.arrayIndex;m++){const b=s.layers[m];Si(b.id)===_&&e.push(new lt(n,r.id,`duplicate layer id "${r.id}", previously used at line ${b.id.__line__}`))}}if("ref"in r){let _;["type","source","source-layer","filter","layout"].forEach(m=>{m in r&&e.push(new lt(n,r[m],`"${m}" is prohibited for ref layers`))}),s.layers.forEach(m=>{Si(m.id)===d&&(_=m)}),_?_.ref?e.push(new lt(n,r.ref,"ref cannot reference another ref layer")):h=Si(_.type):typeof d=="string"&&e.push(new lt(n,r.ref,`ref layer "${d}" not found`))}else if(h!=="background"&&h!=="sky")if(r.source){const _=s.sources&&s.sources[r.source],m=_&&Si(_.type);_?m==="vector"&&h==="raster"?e.push(new lt(n,r.source,`layer "${r.id}" requires a raster source`)):m==="raster"&&h!=="raster"?e.push(new lt(n,r.source,`layer "${r.id}" requires a vector source`)):m!=="vector"||r["source-layer"]?m==="raster-dem"&&h!=="hillshade"?e.push(new lt(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):h!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||m==="geojson"&&_.lineMetrics||e.push(new lt(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new lt(n,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new lt(n,r.source,`source "${r.source}" not found`))}else e.push(new lt(n,r,'missing required property "source"'));return e=e.concat(qr({key:n,value:r,valueSpec:c.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>tr({key:`${n}.type`,value:r.type,valueSpec:c.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:_=>Q1(Br({layerType:h},_)),layout:_=>qr({layer:r,key:_.key,value:_.value,valueSpec:{},style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":m=>js(Br({layerType:h},m))}}),paint:_=>qr({layer:r,key:_.key,value:_.value,valueSpec:{},style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":m=>wc(Br({layerType:h},m))}})}})),e}function Xo(i){const e=i.value,r=i.key,n=Kt(e);return n!=="string"?[new lt(r,e,`string expected, ${n} found`)]:[]}const $s={promoteId:function({key:i,value:e}){if(Kt(e)==="string")return Xo({key:i,value:e});{const r=[];for(const n in e)r.push(...Xo({key:`${i}.${n}`,value:e[n]}));return r}}};function Ic(i){const e=i.value,r=i.key,n=i.styleSpec,s=i.style;if(!e.type)return[new lt(r,e,'"type" is required')];const c=Si(e.type);let h;switch(c){case"vector":case"raster":case"raster-dem":return h=qr({key:r,value:e,valueSpec:n[`source_${c.replace("-","_")}`],style:i.style,styleSpec:n,objectElementValidators:$s}),h;case"geojson":if(h=qr({key:r,value:e,valueSpec:n.source_geojson,style:s,styleSpec:n,objectElementValidators:$s}),e.cluster)for(const d in e.clusterProperties){const[_,m]=e.clusterProperties[d],b=typeof _=="string"?[_,["accumulated"],["get",d]]:_;h.push(...mo({key:`${r}.${d}.map`,value:m,expressionContext:"cluster-map"})),h.push(...mo({key:`${r}.${d}.reduce`,value:b,expressionContext:"cluster-reduce"}))}return h;case"video":return qr({key:r,value:e,valueSpec:n.source_video,style:s,styleSpec:n});case"image":return qr({key:r,value:e,valueSpec:n.source_image,style:s,styleSpec:n});case"canvas":return[new lt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fa({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:s,styleSpec:n})}}function el(i){const e=i.value,r=i.styleSpec,n=r.light,s=i.style;let c=[];const h=Kt(e);if(e===void 0)return c;if(h!=="object")return c=c.concat([new lt("light",e,`object expected, ${h} found`)]),c;for(const d in e){const _=d.match(/^(.*)-transition$/);c=c.concat(_&&n[_[1]]&&n[_[1]].transition?tr({key:d,value:e[d],valueSpec:r.transition,style:s,styleSpec:r}):n[d]?tr({key:d,value:e[d],valueSpec:n[d],style:s,styleSpec:r}):[new lt(d,e[d],`unknown property "${d}"`)])}return c}function tl(i){const e=i.value,r=i.key,n=i.style,s=i.styleSpec,c=s.terrain;let h=[];const d=Kt(e);if(e===void 0)return h;if(d!=="object")return h=h.concat([new lt("terrain",e,`object expected, ${d} found`)]),h;for(const _ in e){const m=_.match(/^(.*)-transition$/);h=h.concat(m&&c[m[1]]&&c[m[1]].transition?tr({key:_,value:e[_],valueSpec:s.transition,style:n,styleSpec:s}):c[_]?tr({key:_,value:e[_],valueSpec:c[_],style:n,styleSpec:s}):[new lt(_,e[_],`unknown property "${_}"`)])}if(e.source){const _=n.sources&&n.sources[e.source],m=_&&Si(_.type);_?m!=="raster-dem"&&h.push(new lt(r,e.source,`terrain cannot be used with a source of type ${String(m)}, it only be used with a "raster-dem" source type`)):h.push(new lt(r,e.source,`source "${e.source}" not found`))}else h.push(new lt(r,e,'terrain is missing required property "source"'));return h}function Sc(i){const e=i.value,r=i.style,n=i.styleSpec,s=n.fog;let c=[];const h=Kt(e);if(e===void 0)return c;if(h!=="object")return c=c.concat([new lt("fog",e,`object expected, ${h} found`)]),c;for(const d in e){const _=d.match(/^(.*)-transition$/);c=c.concat(_&&s[_[1]]&&s[_[1]].transition?tr({key:d,value:e[d],valueSpec:n.transition,style:r,styleSpec:n}):s[d]?tr({key:d,value:e[d],valueSpec:s[d],style:r,styleSpec:n}):[new lt(d,e[d],`unknown property "${d}"`)])}return c}const Zs={"*":()=>[],array:Oa,boolean:function(i){const e=i.value,r=i.key,n=Kt(e);return n!=="boolean"?[new lt(r,e,`boolean expected, ${n} found`)]:[]},number:_o,color:function(i){const e=i.key,r=i.value,n=Kt(r);return n!=="string"?[new lt(e,r,`color expected, ${n} found`)]:Yl.parseCSSColor(r)===null?[new lt(e,r,`color expected, "${r}" found`)]:[]},enum:Fa,filter:Q1,function:Y1,layer:Tc,object:qr,source:Ic,light:el,terrain:tl,fog:Sc,string:Xo,formatted:function(i){return Xo(i).length===0?[]:mo(i)},resolvedImage:function(i){return Xo(i).length===0?[]:mo(i)},projection:function(i){const e=i.value,r=i.styleSpec,n=r.projection,s=i.style;let c=[];const h=Kt(e);if(h==="object")for(const d in e)c=c.concat(tr({key:d,value:e[d],valueSpec:n[d],style:s,styleSpec:r}));else h!=="string"&&(c=c.concat([new lt("projection",e,`object or string expected, ${h} found`)]));return c}};function tr(i){const e=i.value,r=i.valueSpec,n=i.styleSpec;return r.expression&&Rs(Si(e))?Y1(i):r.expression&&Os(Ur(e))?mo(i):r.type&&Zs[r.type]?Zs[r.type](i):qr(Br({},i,{valueSpec:r.type?n[r.type]:r}))}function Ec(i){const e=i.value,r=i.key,n=Xo(i);return n.length||(e.indexOf("{fontstack}")===-1&&n.push(new lt(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&n.push(new lt(r,e,'"glyphs" url must include a "{range}" token'))),n}function Ac(i,e=me){return nn(tr({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:Ec,"*":()=>[]}}))}const kc=i=>nn(wc(i)),b3=i=>nn(js(i));function nn(i){return i.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function Mc(i,e){let r=!1;if(e&&e.length)for(const n of e)i.fire(new xi(new Error(n.message))),r=!0;return r}var Jo=pn;function pn(i,e,r){var n=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var s=new Int32Array(this.arrayBuffer);i=s[0],this.d=(e=s[1])+2*(r=s[2]);for(var c=0;c<this.d*this.d;c++){var h=s[3+c],d=s[3+c+1];n.push(h===d?null:s.subarray(h,d))}var _=s[3+n.length+1];this.keys=s.subarray(s[3+n.length],_),this.bboxes=s.subarray(_),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var m=0;m<this.d*this.d;m++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=r,this.scale=e/i,this.uid=0;var b=r/e*i;this.min=-b,this.max=i+b}pn.prototype.insert=function(i,e,r,n,s){this._forEachCell(e,r,n,s,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(s)},pn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},pn.prototype._insertCell=function(i,e,r,n,s,c){this.cells[s].push(c)},pn.prototype.query=function(i,e,r,n,s){var c=this.min,h=this.max;if(i<=c&&e<=c&&h<=r&&h<=n&&!s)return Array.prototype.slice.call(this.keys);var d=[];return this._forEachCell(i,e,r,n,this._queryCell,d,{},s),d},pn.prototype._queryCell=function(i,e,r,n,s,c,h,d){var _=this.cells[s];if(_!==null)for(var m=this.keys,b=this.bboxes,T=0;T<_.length;T++){var S=_[T];if(h[S]===void 0){var M=4*S;(d?d(b[M+0],b[M+1],b[M+2],b[M+3]):i<=b[M+2]&&e<=b[M+3]&&r>=b[M+0]&&n>=b[M+1])?(h[S]=!0,c.push(m[S])):h[S]=!1}}},pn.prototype._forEachCell=function(i,e,r,n,s,c,h,d){for(var _=this._convertToCellCoord(i),m=this._convertToCellCoord(e),b=this._convertToCellCoord(r),T=this._convertToCellCoord(n),S=_;S<=b;S++)for(var M=m;M<=T;M++){var z=this.d*M+S;if((!d||d(this._convertFromCellCoord(S),this._convertFromCellCoord(M),this._convertFromCellCoord(S+1),this._convertFromCellCoord(M+1)))&&s.call(this,i,e,r,n,z,c,h,d))return}},pn.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},pn.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},pn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var s=new Int32Array(e+r+this.keys.length+this.bboxes.length);s[0]=this.extent,s[1]=this.n,s[2]=this.padding;for(var c=e,h=0;h<i.length;h++){var d=i[h];s[3+h]=c,s.set(d,c),c+=d.length}return s[3+i.length]=c,s.set(this.keys,c),s[3+i.length+1]=c+=this.keys.length,s.set(this.bboxes,c),c+=this.bboxes.length,s.buffer};const qs={};function ct(i,e,r={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writeable:!1}),qs[e]={klass:i,omit:r.omit||[]}}ct(Object,"Object"),Jo.serialize=function(i,e){const r=i.toArrayBuffer();return e&&e.push(r),{buffer:r}},Jo.deserialize=function(i){return new Jo(i.buffer)},Object.defineProperty(Jo,"name",{value:"Grid"}),ct(Jo,"Grid"),ct(Bi,"Color"),ct(Error,"Error"),ct(ue,"AJAXError"),ct($r,"ResolvedImage"),ct(Ba,"StylePropertyFunction"),ct(Bs,"StyleExpression",{omit:["_evaluator"]}),ct(Ra,"ZoomDependentExpression"),ct(Fs,"ZoomConstantExpression"),ct(Dn,"CompoundExpression",{omit:["_evaluate"]});for(const i in La)qs[La[i]._classRegistryKey]||ct(La[i],`Expression${i}`);function Cc(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function zc(i){return Z.ImageBitmap&&i instanceof Z.ImageBitmap}function Ua(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Cc(i)||zc(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return e&&e.push(r.buffer),r}if(i instanceof Z.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const n of i)r.push(Ua(n,e));return r}if(typeof i=="object"){const r=i.constructor,n=r._classRegistryKey;if(!n)throw new Error(`can't serialize object of unregistered class ${n}`);const s=r.serialize?r.serialize(i,e):{};if(!r.serialize){for(const c in i)i.hasOwnProperty(c)&&(qs[n].omit.indexOf(c)>=0||(s[c]=Ua(i[c],e)));i instanceof Error&&(s.message=i.message)}if(s.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(s.$name=n),s}throw new Error("can't serialize object of type "+typeof i)}function Va(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Cc(i)||zc(i)||ArrayBuffer.isView(i)||i instanceof Z.ImageData)return i;if(Array.isArray(i))return i.map(Va);if(typeof i=="object"){const e=i.$name||"Object",{klass:r}=qs[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(i);const n=Object.create(r.prototype);for(const s of Object.keys(i))s!=="$name"&&(n[s]=Va(i[s]));return n}throw new Error("can't deserialize object of type "+typeof i)}class Pc{constructor(){this.first=!0}update(e,r){const n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=n,!0))}}const Dc=i=>i>=1536&&i<=1791,Lc=i=>i>=1872&&i<=1919,ja=i=>i>=2208&&i<=2303,Rc=i=>i>=11904&&i<=12031,Bc=i=>i>=12032&&i<=12255,$a=i=>i>=12272&&i<=12287,Ws=i=>i>=12288&&i<=12351,Xs=i=>i>=12352&&i<=12447,Js=i=>i>=12448&&i<=12543,il=i=>i>=12544&&i<=12591,rl=i=>i>=12704&&i<=12735,nl=i=>i>=12736&&i<=12783,ol=i=>i>=12784&&i<=12799,Hs=i=>i>=12800&&i<=13055,Ys=i=>i>=13056&&i<=13311,Oc=i=>i>=13312&&i<=19903,al=i=>i>=19968&&i<=40959,Fc=i=>i>=40960&&i<=42127,Ks=i=>i>=42128&&i<=42191,Nc=i=>i>=44032&&i<=55215,Gc=i=>i>=63744&&i<=64255,sl=i=>i>=64336&&i<=65023,Uc=i=>i>=65040&&i<=65055,xo=i=>i>=65072&&i<=65103,Vc=i=>i>=65104&&i<=65135,ll=i=>i>=65136&&i<=65279,Qs=i=>i>=65280&&i<=65519;function Ho(i){for(const e of i)if(a(e.charCodeAt(0)))return!0;return!1}function l(i){for(const e of i)if(!t(e.charCodeAt(0)))return!1;return!0}function t(i){return!(Dc(i)||Lc(i)||ja(i)||sl(i)||ll(i))}function a(i){return!(i!==746&&i!==747&&(i<4352||!(rl(i)||il(i)||xo(i)&&!(i>=65097&&i<=65103)||Gc(i)||Ys(i)||Rc(i)||nl(i)||!(!Ws(i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Oc(i)||al(i)||Hs(i)||(e=>e>=12592&&e<=12687)(i)||(e=>e>=43360&&e<=43391)(i)||(e=>e>=55216&&e<=55295)(i)||(e=>e>=4352&&e<=4607)(i)||Nc(i)||Xs(i)||$a(i)||(e=>e>=12688&&e<=12703)(i)||Bc(i)||ol(i)||Js(i)&&i!==12540||!(!Qs(i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Vc(i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||(e=>e>=5120&&e<=5759)(i)||(e=>e>=6320&&e<=6399)(i)||Uc(i)||(e=>e>=19904&&e<=19967)(i)||Fc(i)||Ks(i))))}function u(i){return!(a(i)||function(e){return!!((r=>r>=128&&r<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(r=>r>=8192&&r<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(r=>r>=8448&&r<=8527)(e)||(r=>r>=8528&&r<=8591)(e)||(r=>r>=8960&&r<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(r=>r>=9216&&r<=9279)(e)&&e!==9251||(r=>r>=9280&&r<=9311)(e)||(r=>r>=9312&&r<=9471)(e)||(r=>r>=9632&&r<=9727)(e)||(r=>r>=9728&&r<=9983)(e)&&!(e>=9754&&e<=9759)||(r=>r>=11008&&r<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ws(e)||Js(e)||(r=>r>=57344&&r<=63743)(e)||xo(e)||Vc(e)||Qs(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function p(i){return i>=1424&&i<=2303||sl(i)||ll(i)}function f(i,e){return!(!e&&p(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||(r=>r>=6016&&r<=6143)(i))}function y(i){for(const e of i)if(p(e.charCodeAt(0)))return!0;return!1}const v="deferred",w="loading",A="loaded";let C=null,P="unavailable",O=null;const U=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(P="error"),C&&C(i)};function j(){G.fire(new ti("pluginStateChange",{pluginStatus:P,pluginURL:O}))}const G=new li,Q=function(){return P},$=function(){if(P!==v||!O)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");P=w,j(),O&&pe({url:O},i=>{i?U(i):(P=A,j())})},J={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>P===A||J.applyArabicShaping!=null,isLoading:()=>P===w,setState(i){P=i.pluginStatus,O=i.pluginURL},isParsed:()=>J.applyArabicShaping!=null&&J.processBidirectionalText!=null&&J.processStyledBidirectionalText!=null,getPluginURL:()=>O};class V{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition,this.pitch=r.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pc,this.transition={},this.pitch=0)}isSupportedScript(e){return function(r,n){for(const s of r)if(!f(s.charCodeAt(0),n))return!1;return!0}(e,J.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}}class ne{constructor(e,r){this.property=e,this.value=r,this.expression=function(n,s){if(Rs(n))return new Ba(n,s);if(Os(n)){const c=Ns(n,s);if(c.result==="error")throw new Error(c.value.map(h=>`${h.key}: ${h.message}`).join(", "));return c.value}{let c=n;return typeof n=="string"&&s.type==="color"&&(c=Bi.parse(n)),{kind:"constant",evaluate:()=>c}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,n){return this.property.possiblyEvaluate(this,e,r,n)}}class Y{constructor(e){this.property=e,this.value=new ne(e,void 0)}transitioned(e,r){return new ce(this.property,this.value,r,He({},e.transition,this.transition),e.now)}untransitioned(){return new ce(this.property,this.value,null,{},0)}}class ee{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ri(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new Y(this._values[e].property)),this._values[e].value=new ne(this._values[e].property,r===null?void 0:Ri(r))}getTransition(e){return Ri(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new Y(this._values[e].property)),this._values[e].transition=Ri(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const n=this.getValue(r);n!==void 0&&(e[r]=n);const s=this.getTransition(r);s!==void 0&&(e[`${r}-transition`]=s)}return e}transitioned(e,r){const n=new Ie(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].transitioned(e,r._values[s]);return n}untransitioned(){const e=new Ie(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class ce{constructor(e,r,n,s,c){const h=s.delay||0,d=s.duration||0;c=c||0,this.property=e,this.value=r,this.begin=c+h,this.end=this.begin+d,e.specification.transition&&(s.delay||s.duration)&&(this.prior=n)}possiblyEvaluate(e,r,n){const s=e.now||0,c=this.value.possiblyEvaluate(e,r,n),h=this.prior;if(h){if(s>this.end)return this.prior=null,c;if(this.value.isDataDriven())return this.prior=null,c;if(s<this.begin)return h.possiblyEvaluate(e,r,n);{const d=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(h.possiblyEvaluate(e,r,n),c,Ve(d))}}return c}}class Ie{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,n){const s=new Ze(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].possiblyEvaluate(e,r,n);return s}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ae{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Ri(this._values[e].value)}setValue(e,r){this._values[e]=new ne(this._values[e].property,r===null?void 0:Ri(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const n=this.getValue(r);n!==void 0&&(e[r]=n)}return e}possiblyEvaluate(e,r,n){const s=new Ze(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].possiblyEvaluate(e,r,n);return s}}class we{constructor(e,r,n){this.property=e,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,n,s){return this.property.evaluate(this.value,this.parameters,e,r,n,s)}}class Ze{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class re{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,n){const s=ka[this.specification.type];return s?s(e,r,n):e}}class ye{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,n,s){return new we(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},n,s)}:e.expression,r)}interpolate(e,r,n){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new we(this,{kind:"constant",value:void 0},e.parameters);const s=ka[this.specification.type];return s?new we(this,{kind:"constant",value:s(e.value.value,r.value.value,n)},e.parameters):e}evaluate(e,r,n,s,c,h){return e.kind==="constant"?e.value:e.evaluate(r,n,s,c,h)}}class Le extends ye{possiblyEvaluate(e,r,n,s){if(e.value===void 0)return new we(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const c=e.expression.evaluate(r,null,{},n,s),h=e.property.specification.type==="resolvedImage"&&typeof c!="string"?c.name:c,d=this._calculate(h,h,h,r);return new we(this,{kind:"constant",value:d},r)}if(e.expression.kind==="camera"){const c=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new we(this,{kind:"constant",value:c},r)}return new we(this,e.expression,r)}evaluate(e,r,n,s,c,h){if(e.kind==="source"){const d=e.evaluate(r,n,s,c,h);return this._calculate(d,d,d,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},n,s),e.evaluate({zoom:Math.floor(r.zoom)},n,s),e.evaluate({zoom:Math.floor(r.zoom)+1},n,s),r):e.value}_calculate(e,r,n,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:e,to:r,other:n}:{from:n,to:r,other:e}}interpolate(e){return e}}class tt{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,s){if(e.value!==void 0){if(e.expression.kind==="constant"){const c=e.expression.evaluate(r,null,{},n,s);return this._calculate(c,c,c,r)}return this._calculate(e.expression.evaluate(new V(Math.floor(r.zoom-1),r)),e.expression.evaluate(new V(Math.floor(r.zoom),r)),e.expression.evaluate(new V(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,n,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:n,to:r}}interpolate(e){return e}}class De{constructor(e){this.specification=e}possiblyEvaluate(e,r,n,s){return!!e.expression.evaluate(r,null,{},n,s)}interpolate(){return!1}}class ft{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new V(0,{});for(const n in e){const s=e[n];s.specification.overridable&&this.overridableProperties.push(n);const c=this.defaultPropertyValues[n]=new ne(s,void 0),h=this.defaultTransitionablePropertyValues[n]=new Y(s);this.defaultTransitioningPropertyValues[n]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=c.possiblyEvaluate(r)}}}function Ke(i,e){return 256*(i=xe(Math.floor(i),0,255))+xe(Math.floor(e),0,255)}ct(ye,"DataDrivenProperty"),ct(re,"DataConstantProperty"),ct(Le,"CrossFadedDataDrivenProperty"),ct(tt,"CrossFadedProperty"),ct(De,"ColorRampProperty");const it={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rt{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class et{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ut(i,e=1){let r=0,n=0;return{members:i.map(s=>{const c=it[s.type].BYTES_PER_ELEMENT,h=r=Ct(r,Math.max(e,c)),d=s.components||1;return n=Math.max(n,c),r+=c*d,{name:s.name,type:s.type,components:d,offset:h}}),size:Ct(r,Math.max(n,e)),alignment:e}}function Ct(i,e){return Math.ceil(i/e)*e}class Dt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){const s=2*e;return this.int16[s+0]=r,this.int16[s+1]=n,e}}Dt.prototype.bytesPerElement=4,ct(Dt,"StructArrayLayout2i4");class vt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,n)}emplace(e,r,n,s){const c=3*e;return this.int16[c+0]=r,this.int16[c+1]=n,this.int16[c+2]=s,e}}vt.prototype.bytesPerElement=6,ct(vt,"StructArrayLayout3i6");class Pt extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,s)}emplace(e,r,n,s,c){const h=4*e;return this.int16[h+0]=r,this.int16[h+1]=n,this.int16[h+2]=s,this.int16[h+3]=c,e}}Pt.prototype.bytesPerElement=8,ct(Pt,"StructArrayLayout4i8");class ci extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,s,c,h,d)}emplace(e,r,n,s,c,h,d,_){const m=6*e,b=12*e,T=3*e;return this.int16[m+0]=r,this.int16[m+1]=n,this.uint8[b+4]=s,this.uint8[b+5]=c,this.uint8[b+6]=h,this.uint8[b+7]=d,this.float32[T+2]=_,e}}ci.prototype.bytesPerElement=12,ct(ci,"StructArrayLayout2i4ub1f12");class _i extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,s)}emplace(e,r,n,s,c){const h=4*e;return this.float32[h+0]=r,this.float32[h+1]=n,this.float32[h+2]=s,this.float32[h+3]=c,e}}_i.prototype.bytesPerElement=16,ct(_i,"StructArrayLayout4f16");class Ti extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d,_,m,b){const T=this.length;return this.resize(T+1),this.emplace(T,e,r,n,s,c,h,d,_,m,b)}emplace(e,r,n,s,c,h,d,_,m,b,T){const S=10*e;return this.uint16[S+0]=r,this.uint16[S+1]=n,this.uint16[S+2]=s,this.uint16[S+3]=c,this.uint16[S+4]=h,this.uint16[S+5]=d,this.uint16[S+6]=_,this.uint16[S+7]=m,this.uint16[S+8]=b,this.uint16[S+9]=T,e}}Ti.prototype.bytesPerElement=20,ct(Ti,"StructArrayLayout10ui20");class pi extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d,_){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,n,s,c,h,d,_)}emplace(e,r,n,s,c,h,d,_,m){const b=8*e;return this.uint16[b+0]=r,this.uint16[b+1]=n,this.uint16[b+2]=s,this.uint16[b+3]=c,this.uint16[b+4]=h,this.uint16[b+5]=d,this.uint16[b+6]=_,this.uint16[b+7]=m,e}}pi.prototype.bytesPerElement=16,ct(pi,"StructArrayLayout8ui16");class Ir extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,n,s,c,h)}emplace(e,r,n,s,c,h,d){const _=6*e;return this.int16[_+0]=r,this.int16[_+1]=n,this.int16[_+2]=s,this.int16[_+3]=c,this.int16[_+4]=h,this.int16[_+5]=d,e}}Ir.prototype.bytesPerElement=12,ct(Ir,"StructArrayLayout6i12");class dn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d,_,m,b,T,S){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,n,s,c,h,d,_,m,b,T,S)}emplace(e,r,n,s,c,h,d,_,m,b,T,S,M){const z=12*e;return this.int16[z+0]=r,this.int16[z+1]=n,this.int16[z+2]=s,this.int16[z+3]=c,this.uint16[z+4]=h,this.uint16[z+5]=d,this.uint16[z+6]=_,this.uint16[z+7]=m,this.int16[z+8]=b,this.int16[z+9]=T,this.int16[z+10]=S,this.int16[z+11]=M,e}}dn.prototype.bytesPerElement=24,ct(dn,"StructArrayLayout4i4ui4i24");class Rn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,n,s,c,h)}emplace(e,r,n,s,c,h,d){const _=10*e,m=5*e;return this.int16[_+0]=r,this.int16[_+1]=n,this.int16[_+2]=s,this.float32[m+2]=c,this.float32[m+3]=h,this.float32[m+4]=d,e}}Rn.prototype.bytesPerElement=20,ct(Rn,"StructArrayLayout3i3f20");class vi extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}vi.prototype.bytesPerElement=4,ct(vi,"StructArrayLayout1ul4");class Ai extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d,_,m,b,T,S,M){const z=this.length;return this.resize(z+1),this.emplace(z,e,r,n,s,c,h,d,_,m,b,T,S,M)}emplace(e,r,n,s,c,h,d,_,m,b,T,S,M,z){const B=20*e,q=10*e;return this.int16[B+0]=r,this.int16[B+1]=n,this.int16[B+2]=s,this.int16[B+3]=c,this.int16[B+4]=h,this.float32[q+3]=d,this.float32[q+4]=_,this.float32[q+5]=m,this.float32[q+6]=b,this.int16[B+14]=T,this.uint32[q+8]=S,this.uint16[B+18]=M,this.uint16[B+19]=z,e}}Ai.prototype.bytesPerElement=40,ct(Ai,"StructArrayLayout5i4f1i1ul2ui40");class ri extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,s,c,h,d)}emplace(e,r,n,s,c,h,d,_){const m=8*e;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=s,this.int16[m+4]=c,this.int16[m+5]=h,this.int16[m+6]=d,this.int16[m+7]=_,e}}ri.prototype.bytesPerElement=16,ct(ri,"StructArrayLayout3i2i2i16");class qi extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,n,s,c)}emplace(e,r,n,s,c,h){const d=4*e,_=8*e;return this.float32[d+0]=r,this.float32[d+1]=n,this.float32[d+2]=s,this.int16[_+6]=c,this.int16[_+7]=h,e}}qi.prototype.bytesPerElement=16,ct(qi,"StructArrayLayout2f1f2i16");class pr extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,s)}emplace(e,r,n,s,c){const h=12*e,d=3*e;return this.uint8[h+0]=r,this.uint8[h+1]=n,this.float32[d+1]=s,this.float32[d+2]=c,e}}pr.prototype.bytesPerElement=12,ct(pr,"StructArrayLayout2ub2f12");class mi extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,n)}emplace(e,r,n,s){const c=3*e;return this.float32[c+0]=r,this.float32[c+1]=n,this.float32[c+2]=s,e}}mi.prototype.bytesPerElement=12,ct(mi,"StructArrayLayout3f12");class Di extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,n)}emplace(e,r,n,s){const c=3*e;return this.uint16[c+0]=r,this.uint16[c+1]=n,this.uint16[c+2]=s,e}}Di.prototype.bytesPerElement=6,ct(Di,"StructArrayLayout3ui6");class vo extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q,H,se,oe,le,he){const de=this.length;return this.resize(de+1),this.emplace(de,e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q,H,se,oe,le,he)}emplace(e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q,H,se,oe,le,he,de){const Se=30*e,Ee=15*e,Re=60*e;return this.int16[Se+0]=r,this.int16[Se+1]=n,this.int16[Se+2]=s,this.float32[Ee+2]=c,this.float32[Ee+3]=h,this.uint16[Se+8]=d,this.uint16[Se+9]=_,this.uint32[Ee+5]=m,this.uint32[Ee+6]=b,this.uint32[Ee+7]=T,this.uint16[Se+16]=S,this.uint16[Se+17]=M,this.uint16[Se+18]=z,this.float32[Ee+10]=B,this.float32[Ee+11]=q,this.uint8[Re+48]=H,this.uint8[Re+49]=se,this.uint8[Re+50]=oe,this.uint32[Ee+13]=le,this.int16[Se+28]=he,this.uint8[Re+58]=de,e}}vo.prototype.bytesPerElement=60,ct(vo,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class fn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q,H,se,oe,le,he,de,Se,Ee,Re,Ge,be,Pe,Ue,je){const at=this.length;return this.resize(at+1),this.emplace(at,e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q,H,se,oe,le,he,de,Se,Ee,Re,Ge,be,Pe,Ue,je)}emplace(e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q,H,se,oe,le,he,de,Se,Ee,Re,Ge,be,Pe,Ue,je,at){const Fe=38*e,nt=19*e;return this.int16[Fe+0]=r,this.int16[Fe+1]=n,this.int16[Fe+2]=s,this.float32[nt+2]=c,this.float32[nt+3]=h,this.int16[Fe+8]=d,this.int16[Fe+9]=_,this.int16[Fe+10]=m,this.int16[Fe+11]=b,this.int16[Fe+12]=T,this.int16[Fe+13]=S,this.uint16[Fe+14]=M,this.uint16[Fe+15]=z,this.uint16[Fe+16]=B,this.uint16[Fe+17]=q,this.uint16[Fe+18]=H,this.uint16[Fe+19]=se,this.uint16[Fe+20]=oe,this.uint16[Fe+21]=le,this.uint16[Fe+22]=he,this.uint16[Fe+23]=de,this.uint16[Fe+24]=Se,this.uint16[Fe+25]=Ee,this.uint16[Fe+26]=Re,this.uint16[Fe+27]=Ge,this.uint16[Fe+28]=be,this.uint32[nt+15]=Pe,this.float32[nt+16]=Ue,this.float32[nt+17]=je,this.float32[nt+18]=at,e}}fn.prototype.bytesPerElement=76,ct(fn,"StructArrayLayout3i2f6i15ui1ul3f76");class Yo extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}Yo.prototype.bytesPerElement=4,ct(Yo,"StructArrayLayout1f4");class bo extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c,h,d){const _=this.length;return this.resize(_+1),this.emplace(_,e,r,n,s,c,h,d)}emplace(e,r,n,s,c,h,d,_){const m=7*e;return this.float32[m+0]=r,this.float32[m+1]=n,this.float32[m+2]=s,this.float32[m+3]=c,this.float32[m+4]=h,this.float32[m+5]=d,this.float32[m+6]=_,e}}bo.prototype.bytesPerElement=28,ct(bo,"StructArrayLayout7f28");class Wn extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,n,s,c){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,n,s,c)}emplace(e,r,n,s,c,h){const d=5*e;return this.float32[d+0]=r,this.float32[d+1]=n,this.float32[d+2]=s,this.float32[d+3]=c,this.float32[d+4]=h,e}}Wn.prototype.bytesPerElement=20,ct(Wn,"StructArrayLayout5f20");class dr extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,n,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,n,s)}emplace(e,r,n,s,c){const h=6*e;return this.uint32[3*e+0]=r,this.uint16[h+2]=n,this.uint16[h+3]=s,this.uint16[h+4]=c,e}}dr.prototype.bytesPerElement=12,ct(dr,"StructArrayLayout1ul3ui12");class Fr extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){const s=2*e;return this.uint16[s+0]=r,this.uint16[s+1]=n,e}}Fr.prototype.bytesPerElement=4,ct(Fr,"StructArrayLayout2ui4");class _n extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}_n.prototype.bytesPerElement=2,ct(_n,"StructArrayLayout1ui2");class wo extends et{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,r)}emplace(e,r,n){const s=2*e;return this.float32[s+0]=r,this.float32[s+1]=n,e}}wo.prototype.bytesPerElement=8,ct(wo,"StructArrayLayout2f8");class pu extends rt{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}pu.prototype.size=12;class du extends Ir{get(e){return new pu(this,e)}}ct(du,"FillExtrusionExtArray");class fu extends rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}fu.prototype.size=40;class w3 extends Ai{get(e){return new fu(this,e)}}ct(w3,"CollisionBoxArray");class _u extends rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}_u.prototype.size=60;class mu extends vo{get(e){return new _u(this,e)}}ct(mu,"PlacedSymbolArray");class gu extends rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}gu.prototype.size=76;class yu extends fn{get(e){return new gu(this,e)}}ct(yu,"SymbolInstanceArray");class xu extends Yo{getoffsetX(e){return this.float32[1*e+0]}}ct(xu,"GlyphOffsetArray");class vu extends vt{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}ct(vu,"SymbolLineVertexArray");class bu extends rt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}bu.prototype.size=12;class wu extends dr{get(e){return new bu(this,e)}}ct(wu,"FeatureIndexArray");class Tu extends rt{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Tu.prototype.size=4;class Iu extends Fr{get(e){return new Tu(this,e)}}ct(Iu,"FillExtrusionCentroidArray");class Su extends rt{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Su.prototype.size=12;class Eu extends Ir{get(e){return new Su(this,e)}}ct(Eu,"CircleGlobeExtArray");const gp=ut([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),yp=ut([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Au=Bo(function(i){i.exports=function(e,r){var n,s,c,h,d,_,m,b;for(s=e.length-(n=3&e.length),c=r,d=3432918353,_=461845907,b=0;b<s;)m=255&e.charCodeAt(b)|(255&e.charCodeAt(++b))<<8|(255&e.charCodeAt(++b))<<16|(255&e.charCodeAt(++b))<<24,++b,c=27492+(65535&(h=5*(65535&(c=(c^=m=(65535&(m=(m=(65535&m)*d+(((m>>>16)*d&65535)<<16)&4294967295)<<15|m>>>17))*_+(((m>>>16)*_&65535)<<16)&4294967295)<<13|c>>>19))+((5*(c>>>16)&65535)<<16)&4294967295))+((58964+(h>>>16)&65535)<<16);switch(m=0,n){case 3:m^=(255&e.charCodeAt(b+2))<<16;case 2:m^=(255&e.charCodeAt(b+1))<<8;case 1:c^=m=(65535&(m=(m=(65535&(m^=255&e.charCodeAt(b)))*d+(((m>>>16)*d&65535)<<16)&4294967295)<<15|m>>>17))*_+(((m>>>16)*_&65535)<<16)&4294967295}return c^=e.length,c=2246822507*(65535&(c^=c>>>16))+((2246822507*(c>>>16)&65535)<<16)&4294967295,c=3266489909*(65535&(c^=c>>>13))+((3266489909*(c>>>16)&65535)<<16)&4294967295,(c^=c>>>16)>>>0}}),xp=Bo(function(i){i.exports=function(e,r){for(var n,s=e.length,c=r^s,h=0;s>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(h)|(255&e.charCodeAt(++h))<<8|(255&e.charCodeAt(++h))<<16|(255&e.charCodeAt(++h))<<24))+((1540483477*(n>>>16)&65535)<<16),c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),s-=4,++h;switch(s){case 3:c^=(255&e.charCodeAt(h+2))<<16;case 2:c^=(255&e.charCodeAt(h+1))<<8;case 1:c=1540483477*(65535&(c^=255&e.charCodeAt(h)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^=c>>>15)>>>0}}),cl=Au,vp=xp;cl.murmur3=Au,cl.murmur2=vp;class jc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,n,s){this.ids.push(ku(e)),this.positions.push(r,n,s)}getPositions(e){const r=ku(e);let n=0,s=this.ids.length-1;for(;n<s;){const h=n+s>>1;this.ids[h]>=r?s=h:n=h+1}const c=[];for(;this.ids[n]===r;)c.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return c}static serialize(e,r){const n=new Float64Array(e.ids),s=new Uint32Array(e.positions);return T3(n,s,0,n.length-1),r&&r.push(n.buffer,s.buffer),{ids:n,positions:s}}static deserialize(e){const r=new jc;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function ku(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:cl(String(i))}function T3(i,e,r,n){for(;r<n;){const s=i[r+n>>1];let c=r-1,h=n+1;for(;;){do c++;while(i[c]<s);do h--;while(i[h]>s);if(c>=h)break;$c(i,c,h),$c(e,3*c,3*h),$c(e,3*c+1,3*h+1),$c(e,3*c+2,3*h+2)}h-r<n-h?(T3(i,e,r,h),r=h+1):(T3(i,e,h+1,n),n=h)}}function $c(i,e,r){const n=i[e];i[e]=i[r],i[r]=n}ct(jc,"FeaturePositionMap");class To{constructor(e,r){this.gl=e.gl,this.location=r}}class Zc extends To{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Mu extends To{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Cu extends To{constructor(e,r){super(e,r),this.current=Bi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const bp=new Float32Array(16),wp=new Float32Array(9),Tp=new Float32Array(4);function I3(i){return[Ke(255*i.r,255*i.g),Ke(255*i.b,255*i.a)]}class ul{constructor(e,r,n){this.value=e,this.uniformNames=r.map(s=>`u_${s}`),this.type=n}setUniform(e,r,n){e.set(n.constantOr(this.value))}getBinding(e,r,n){return this.type==="color"?new Cu(e,r):new Zc(e,r)}}class e1{constructor(e,r){this.uniformNames=r.map(n=>`u_${n}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=r.tl.concat(r.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,r,n,s){const c=s==="u_pattern_to"||s==="u_dash_to"?this.patternTo:s==="u_pattern_from"||s==="u_dash_from"?this.patternFrom:s==="u_pixel_ratio_to"?this.pixelRatioTo:s==="u_pixel_ratio_from"?this.pixelRatioFrom:null;c&&e.set(c)}getBinding(e,r,n){return n==="u_pattern_from"||n==="u_pattern_to"||n==="u_dash_from"||n==="u_dash_to"?new Mu(e,r):new Zc(e,r)}}class Io{constructor(e,r,n,s){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(c=>({name:`a_${c}`,type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new s}populatePaintArray(e,r,n,s,c,h){const d=this.paintVertexArray.length,_=this.expression.evaluate(new V(0),r,{},c,s,h);this.paintVertexArray.resize(e),this._setPaintValue(d,e,_)}updatePaintArray(e,r,n,s,c){const h=this.expression.evaluate({zoom:0},n,s,void 0,c);this._setPaintValue(e,r,h)}_setPaintValue(e,r,n){if(this.type==="color"){const s=I3(n);for(let c=e;c<r;c++)this.paintVertexArray.emplace(c,s[0],s[1])}else{for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bn{constructor(e,r,n,s,c,h){this.expression=e,this.uniformNames=r.map(d=>`u_${d}_t`),this.type=n,this.useIntegerZoom=s,this.zoom=c,this.maxValue=0,this.paintVertexAttributes=r.map(d=>({name:`a_${d}`,type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,r,n,s,c,h){const d=this.expression.evaluate(new V(this.zoom),r,{},c,s,h),_=this.expression.evaluate(new V(this.zoom+1),r,{},c,s,h),m=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(m,e,d,_)}updatePaintArray(e,r,n,s,c){const h=this.expression.evaluate({zoom:this.zoom},n,s,void 0,c),d=this.expression.evaluate({zoom:this.zoom+1},n,s,void 0,c);this._setPaintValue(e,r,h,d)}_setPaintValue(e,r,n,s){if(this.type==="color"){const c=I3(n),h=I3(s);for(let d=e;d<r;d++)this.paintVertexArray.emplace(d,c[0],c[1],h[0],h[1])}else{for(let c=e;c<r;c++)this.paintVertexArray.emplace(c,n,s);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,s=xe(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(s)}getBinding(e,r,n){return new Zc(e,r)}}class Ko{constructor(e,r,n,s,c,h,d){this.expression=e,this.type=n,this.useIntegerZoom=s,this.zoom=c,this.layerId=d,this.paintVertexAttributes=(n==="array"?yp:gp).members;for(let _=0;_<r.length;++_);this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h}populatePaintArray(e,r,n){const s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(s,e,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(e,r,n,s,c,h){this._setPaintValues(e,r,n.patterns&&n.patterns[this.layerId],h)}_setPaintValues(e,r,n,s){if(!s||!n)return;const{min:c,mid:h,max:d}=n,_=s[c],m=s[h],b=s[d];if(_&&m&&b)for(let T=e;T<r;T++)this._setPaintValue(this.zoomInPaintVertexArray,T,m,_),this._setPaintValue(this.zoomOutPaintVertexArray,T,m,b)}_setPaintValue(e,r,n,s){e.emplace(r,n.tl[0],n.tl[1],n.br[0],n.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],n.pixelRatio,s.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qo{constructor(e,r,n=()=>!0){this.binders={},this._buffers=[];const s=[];for(const c in e.paint._values){if(!n(c))continue;const h=e.paint.get(c);if(!(h instanceof we&&$o(h.property.specification)))continue;const d=Sp(c,e.type),_=h.value,m=h.property.specification.type,b=h.property.useIntegerZoom,T=h.property.specification["property-type"],S=T==="cross-faded"||T==="cross-faded-data-driven",M=String(c)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(_.kind!=="constant"||M)if(_.kind==="source"||M||S){const z=zu(c,m,"source");this.binders[c]=S?new Ko(_,d,m,b,r,z,e.id):new Io(_,d,m,z),s.push(`/a_${c}`)}else{const z=zu(c,m,"composite");this.binders[c]=new Bn(_,d,m,b,r,z),s.push(`/z_${c}`)}else this.binders[c]=S?new e1(_.value,d):new ul(_.value,d,m),s.push(`/u_${c}`)}this.cacheKey=s.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Io||r instanceof Bn?r.maxValue:0}populatePaintArrays(e,r,n,s,c,h){for(const d in this.binders){const _=this.binders[d];(_ instanceof Io||_ instanceof Bn||_ instanceof Ko)&&_.populatePaintArray(e,r,n,s,c,h)}}setConstantPatternPositions(e,r){for(const n in this.binders){const s=this.binders[n];s instanceof e1&&s.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,n,s,c,h){let d=!1;for(const _ in e){const m=r.getPositions(_);for(const b of m){const T=n.feature(b.index);for(const S in this.binders){const M=this.binders[S];if((M instanceof Io||M instanceof Bn||M instanceof Ko)&&M.expression.isStateDependent===!0){const z=s.paint.get(S);M.expression=z.value,M.updatePaintArray(b.start,b.end,T,e[_],c,h),d=!0}}}}return d}defines(){const e=[];for(const r in this.binders){const n=this.binders[r];(n instanceof ul||n instanceof e1)&&e.push(...n.uniformNames.map(s=>`#define HAS_UNIFORM_${s}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof Io||n instanceof Bn||n instanceof Ko)for(let s=0;s<n.paintVertexAttributes.length;s++)e.push(n.paintVertexAttributes[s].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof ul||n instanceof e1||n instanceof Bn)for(const s of n.uniformNames)e.push(s)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof ul||c instanceof e1||c instanceof Bn){for(const h of c.uniformNames)if(r[h]){const d=c.getBinding(e,r[h],h);n.push({name:h,property:s,binding:d})}}}return n}setUniforms(e,r,n,s){for(const{name:c,property:h,binding:d}of r)this.binders[h].setUniform(d,s,n.get(h),c)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const n=this.binders[r];if(e&&n instanceof Ko){const s=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(n instanceof Io||n instanceof Bn)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const r in this.binders){const n=this.binders[r];(n instanceof Io||n instanceof Bn||n instanceof Ko)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Io||r instanceof Bn||r instanceof Ko)&&r.destroy()}}}class Za{constructor(e,r,n=()=>!0){this.programConfigurations={};for(const s of e)this.programConfigurations[s.id]=new Qo(s,r,n);this.needsUpload=!1,this._featureMap=new jc,this._bufferOffset=0}populatePaintArrays(e,r,n,s,c,h,d){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,r,s,c,h,d);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,n,s,c){for(const h of n)this.needsUpload=this.programConfigurations[h.id].updatePaintArrays(e,this._featureMap,r,h,s,c)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Ip={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Sp(i,e){return Ip[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const Ep={"line-pattern":{source:Ti,composite:Ti},"fill-pattern":{source:Ti,composite:Ti},"fill-extrusion-pattern":{source:Ti,composite:Ti},"line-dasharray":{source:pi,composite:pi}},Ap={color:{source:wo,composite:_i},number:{source:Yo,composite:wo}};function zu(i,e,r){const n=Ep[i];return n&&n[r]||Ap[e][r]}ct(ul,"ConstantBinder"),ct(e1,"CrossFadedConstantBinder"),ct(Io,"SourceExpressionBinder"),ct(Ko,"CrossFadedCompositeBinder"),ct(Bn,"CompositeExpressionBinder"),ct(Qo,"ProgramConfiguration",{omit:["_buffers"]}),ct(Za,"ProgramConfigurationSet");const qc="-transition";class On extends li{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Ae(r.layout)),r.paint)){this._transitionablePaint=new ee(r.paint);for(const n in e.paint)this.setPaintProperty(n,e.paint[n],{validate:!1});for(const n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ze(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,n={}){r!=null&&this._validate(b3,`layers.${this.id}.layout.${e}`,e,r,n)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return zt(e,qc)?this._transitionablePaint.getTransition(e.slice(0,-qc.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,n={}){if(r!=null&&this._validate(kc,`layers.${this.id}.paint.${e}`,e,r,n))return!1;if(zt(e,qc))return this._transitionablePaint.setTransition(e.slice(0,-qc.length),r||void 0),!1;{const s=this._transitionablePaint._values[e],c=s.property.specification["property-type"]==="cross-faded-data-driven",h=s.value.isDataDriven(),d=s.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const _=this._transitionablePaint._values[e].value;return _.isDataDriven()||h||c||this._handleOverridablePaintPropertyUpdate(e,d,_)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),si(e,(r,n)=>!(r===void 0||n==="layout"&&!Object.keys(r).length||n==="paint"&&!Object.keys(r).length))}_validate(e,r,n,s,c={}){return(!c||c.validate!==!1)&&Mc(this,e.call(Ac,{key:r,layerType:this.type,objectKey:n,value:s,styleSpec:me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof we&&$o(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=go(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const kp=ut([{name:"a_pos",components:2,type:"Int16"}],4),Mp=ut([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ni{constructor(e=[]){this.segments=e}prepareSegment(e,r,n,s){let c=this.segments[this.segments.length-1];return e>Ni.MAX_VERTEX_ARRAY_LENGTH&&_t(`Max vertices per segment is ${Ni.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!c||c.vertexLength+e>Ni.MAX_VERTEX_ARRAY_LENGTH||c.sortKey!==s)&&(c={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},s!==void 0&&(c.sortKey=s),this.segments.push(c)),c}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,n,s){return new Ni([{vertexOffset:e,primitiveOffset:r,vertexLength:n,primitiveLength:s,vaos:{},sortKey:0}])}}Ni.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ct(Ni,"SegmentVector");var kt=8192;class ea{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof ui?new ui(e.lng,e.lat):ui.convert(e),this}setSouthWest(e){return this._sw=e instanceof ui?new ui(e.lng,e.lat):ui.convert(e),this}extend(e){const r=this._sw,n=this._ne;let s,c;if(e instanceof ui)s=e,c=e;else{if(!(e instanceof ea))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ea.convert(e)):this.extend(ui.convert(e)):this;if(s=e._sw,c=e._ne,!s||!c)return this}return r||n?(r.lng=Math.min(s.lng,r.lng),r.lat=Math.min(s.lat,r.lat),n.lng=Math.max(c.lng,n.lng),n.lat=Math.max(c.lat,n.lat)):(this._sw=new ui(s.lng,s.lat),this._ne=new ui(c.lng,c.lat)),this}getCenter(){return new ui((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ui(this.getWest(),this.getNorth())}getSouthEast(){return new ui(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:n}=ui.convert(e);let s=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(s=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&s}static convert(e){return!e||e instanceof ea?e:new ea(e)}}const S3=63710088e-1;class ui{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ui(We(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,n=this.lat*r,s=e.lat*r,c=Math.sin(n)*Math.sin(s)+Math.cos(n)*Math.cos(s)*Math.cos((e.lng-this.lng)*r);return S3*Math.acos(Math.min(c,1))}toBounds(e=0){const r=360*e/40075017,n=r/Math.cos(Math.PI/180*this.lat);return new ea(new ui(this.lng-n,this.lat-r),new ui(this.lng+n,this.lat+r))}static convert(e){if(e instanceof ui)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ui(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ui(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Pu=2*Math.PI*S3;function E3(i){return Pu*Math.cos(i*Math.PI/180)}function qa(i){return(180+i)/360}function Wa(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function mn(i,e){return i/E3(e)}function Sr(i){return 360*i-180}function Yi(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Du(i,e){return i*E3(Yi(e))}const Xn=85.051129;class t1{constructor(e,r,n=0){this.x=+e,this.y=+r,this.z=+n}static fromLngLat(e,r=0){const n=ui.convert(e);return new t1(qa(n.lng),Wa(n.lat),mn(r,n.lat))}toLngLat(){return new ui(Sr(this.x),Yi(this.y))}toAltitude(){return Du(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Pu*(e=Yi(this.y),1/Math.cos(e*Math.PI/180));var e}}function A3(i,e,r,n,s,c,h,d,_){const m=(e+n)/2,b=(r+s)/2,T=new N(m,b);d(T),function(S,M,z,B,q,H){const se=z-q,oe=B-H;return Math.abs((B-M)*se-(z-S)*oe)/Math.hypot(se,oe)}(T.x,T.y,c.x,c.y,h.x,h.y)>=_?(A3(i,e,r,m,b,c,T,d,_),A3(i,m,b,n,s,T,h,d,_)):i.push(h)}function Lu(i,e,r){let n=i[0],s=n.x,c=n.y;e(n);const h=[n];for(let d=1;d<i.length;d++){const _=i[d],{x:m,y:b}=_;e(_),A3(h,s,c,m,b,n,_,e,r),s=m,c=b,n=_}return h}function k3(i,e,r,n,s){if(s(e,r)){const c=e.add(r).mult(.5);n(c),k3(i,e,c,n,s),k3(i,c,r,n,s)}else i.push(r)}function Cp(i,e,r){let n=i[0];e(n);const s=[n];for(let c=1;c<i.length;c++){const h=i[c];e(h),k3(s,n,h,e,r),n=h}return s}const M3=Math.pow(2,14)-1,Ru=-M3-1;function zp(i,e){const r=Math.round(i.x*e),n=Math.round(i.y*e);return i.x=xe(r,Ru,M3),i.y=xe(n,Ru,M3),(r<i.x||r>i.x+1||n<i.y||n>i.y+1)&&_t("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function So(i,e,r){const n=i.loadGeometry(),s=i.extent,c=kt/s;if(e&&r&&r.projection.isReprojectedInTileSpace){const h=1<<e.z,{scale:d,x:_,y:m,projection:b}=r,T=S=>{const M=Sr((e.x+S.x/s)/h),z=Yi((e.y+S.y/s)/h),B=b.project(M,z);S.x=(B.x*d-_)*s,S.y=(B.y*d-m)*s};for(let S=0;S<n.length;S++)if(i.type!==1)n[S]=Lu(n[S],T,1);else{const M=[];for(const z of n[S])z.x<0||z.x>=s||z.y<0||z.y>=s||(T(z),M.push(z));n[S]=M}}for(const h of n)for(const d of h)zp(d,c);return n}function Xa(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?So(i):[]}}function Wc(i,e,r,n,s){i.emplaceBack(2*e+(n+1)/2,2*r+(s+1)/2)}function Xc(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class C3{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Dt,this.indexArray=new Di,this.segments=new Ni,this.programConfigurations=new Za(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n,s){const c=this.layers[0],h=[];let d=null;c.type==="circle"&&(d=c.layout.get("circle-sort-key"));for(const{feature:m,id:b,index:T,sourceLayerIndex:S}of e){const M=this.layers[0]._featureFilter.needGeometry,z=Xa(m,M);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),z,n))continue;const B=d?d.evaluate(z,{},n):void 0,q={id:b,properties:m.properties,type:m.type,sourceLayerIndex:S,index:T,geometry:M?z.geometry:So(m,n,s),patterns:{},sortKey:B};h.push(q)}d&&h.sort((m,b)=>m.sortKey-b.sortKey);let _=null;s.projection.name==="globe"&&(this.globeExtVertexArray=new Eu,_=s.projection);for(const m of h){const{geometry:b,index:T,sourceLayerIndex:S}=m,M=e[T].feature;this.addFeature(m,b,T,r.availableImages,n,_),r.featureIndex.insert(M,b,T,S,this.index)}}update(e,r,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Mp.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,n,s,c,h){for(const d of r)for(const _ of d){const m=_.x,b=_.y;if(m<0||m>=kt||b<0||b>=kt)continue;if(h){const M=h.projectTilePoint(m,b,c),z=h.upVector(c,m,b),B=this.globeExtVertexArray;Xc(B,M,z),Xc(B,M,z),Xc(B,M,z),Xc(B,M,z)}const T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),S=T.vertexLength;Wc(this.layoutVertexArray,m,b,-1,-1),Wc(this.layoutVertexArray,m,b,1,-1),Wc(this.layoutVertexArray,m,b,1,1),Wc(this.layoutVertexArray,m,b,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+2,S+3),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},s,c)}}function Bu(i,e){for(let r=0;r<i.length;r++)if(Ja(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Ja(i,e[r]))return!0;return!!z3(i,e)}function Pp(i,e,r){return!!Ja(i,e)||!!P3(e,i,r)}function Ou(i,e){if(i.length===1)return Nu(e,i[0]);for(let r=0;r<e.length;r++){const n=e[r];for(let s=0;s<n.length;s++)if(Ja(i,n[s]))return!0}for(let r=0;r<i.length;r++)if(Nu(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(z3(i,e[r]))return!0;return!1}function Dp(i,e,r){if(i.length>1){if(z3(i,e))return!0;for(let n=0;n<e.length;n++)if(P3(e[n],i,r))return!0}for(let n=0;n<i.length;n++)if(P3(i[n],e,r))return!0;return!1}function z3(i,e){if(i.length===0||e.length===0)return!1;for(let r=0;r<i.length-1;r++){const n=i[r],s=i[r+1];for(let c=0;c<e.length-1;c++)if(Lp(n,s,e[c],e[c+1]))return!0}return!1}function Lp(i,e,r,n){return xt(i,r,n)!==xt(e,r,n)&&xt(i,e,r)!==xt(i,e,n)}function P3(i,e,r){const n=r*r;if(e.length===1)return i.distSqr(e[0])<n;for(let s=1;s<e.length;s++)if(Fu(i,e[s-1],e[s])<n)return!0;return!1}function Fu(i,e,r){const n=e.distSqr(r);if(n===0)return i.distSqr(e);const s=((i.x-e.x)*(r.x-e.x)+(i.y-e.y)*(r.y-e.y))/n;return i.distSqr(s<0?e:s>1?r:r.sub(e)._mult(s)._add(e))}function Nu(i,e){let r,n,s,c=!1;for(let h=0;h<i.length;h++){r=i[h];for(let d=0,_=r.length-1;d<r.length;_=d++)n=r[d],s=r[_],n.y>e.y!=s.y>e.y&&e.x<(s.x-n.x)*(e.y-n.y)/(s.y-n.y)+n.x&&(c=!c)}return c}function Ja(i,e){let r=!1;for(let n=0,s=i.length-1;n<i.length;s=n++){const c=i[n],h=i[s];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(r=!r)}return r}function Gu(i,e,r,n,s){for(const h of i)if(e<=h.x&&r<=h.y&&n>=h.x&&s>=h.y)return!0;const c=[new N(e,r),new N(e,s),new N(n,s),new N(n,r)];if(i.length>2){for(const h of c)if(Ja(i,h))return!0}for(let h=0;h<i.length-1;h++)if(Rp(i[h],i[h+1],c))return!0;return!1}function Rp(i,e,r){const n=r[0],s=r[2];if(i.x<n.x&&e.x<n.x||i.x>s.x&&e.x>s.x||i.y<n.y&&e.y<n.y||i.y>s.y&&e.y>s.y)return!1;const c=xt(i,e,r[0]);return c!==xt(i,e,r[1])||c!==xt(i,e,r[2])||c!==xt(i,e,r[3])}function i1(i,e,r){const n=e.paint.get(i).value;return n.kind==="constant"?n.value:r.programConfigurations.get(e.id).getMaxValue(i)}function Jc(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Uu(i,e,r,n,s){if(!e[0]&&!e[1])return i;const c=N.convert(e)._mult(s);r==="viewport"&&c._rotate(-n);const h=[];for(let d=0;d<i.length;d++)h.push(i[d].sub(c));return h}function Vu(i,e,r,n){const s=N.convert(i)._mult(n);return e==="viewport"&&s._rotate(-r),s}ct(C3,"CircleBucket",{omit:["layers"]});const Bp=new ft({"circle-sort-key":new ye(me.layout_circle["circle-sort-key"])});var Op={paint:new ft({"circle-radius":new ye(me.paint_circle["circle-radius"]),"circle-color":new ye(me.paint_circle["circle-color"]),"circle-blur":new ye(me.paint_circle["circle-blur"]),"circle-opacity":new ye(me.paint_circle["circle-opacity"]),"circle-translate":new re(me.paint_circle["circle-translate"]),"circle-translate-anchor":new re(me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new re(me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new re(me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ye(me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ye(me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ye(me.paint_circle["circle-stroke-opacity"])}),layout:Bp},Hc=1e-6,Wr=typeof Float32Array!="undefined"?Float32Array:Array;function ju(){var i=new Wr(9);return Wr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Xr(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ta(i,e,r){var n=e[0],s=e[1],c=e[2],h=e[3],d=e[4],_=e[5],m=e[6],b=e[7],T=e[8],S=e[9],M=e[10],z=e[11],B=e[12],q=e[13],H=e[14],se=e[15],oe=r[0],le=r[1],he=r[2],de=r[3];return i[0]=oe*n+le*d+he*T+de*B,i[1]=oe*s+le*_+he*S+de*q,i[2]=oe*c+le*m+he*M+de*H,i[3]=oe*h+le*b+he*z+de*se,i[4]=(oe=r[4])*n+(le=r[5])*d+(he=r[6])*T+(de=r[7])*B,i[5]=oe*s+le*_+he*S+de*q,i[6]=oe*c+le*m+he*M+de*H,i[7]=oe*h+le*b+he*z+de*se,i[8]=(oe=r[8])*n+(le=r[9])*d+(he=r[10])*T+(de=r[11])*B,i[9]=oe*s+le*_+he*S+de*q,i[10]=oe*c+le*m+he*M+de*H,i[11]=oe*h+le*b+he*z+de*se,i[12]=(oe=r[12])*n+(le=r[13])*d+(he=r[14])*T+(de=r[15])*B,i[13]=oe*s+le*_+he*S+de*q,i[14]=oe*c+le*m+he*M+de*H,i[15]=oe*h+le*b+he*z+de*se,i}function Ha(i,e,r){var n,s,c,h,d,_,m,b,T,S,M,z,B=r[0],q=r[1],H=r[2];return e===i?(i[12]=e[0]*B+e[4]*q+e[8]*H+e[12],i[13]=e[1]*B+e[5]*q+e[9]*H+e[13],i[14]=e[2]*B+e[6]*q+e[10]*H+e[14],i[15]=e[3]*B+e[7]*q+e[11]*H+e[15]):(s=e[1],c=e[2],h=e[3],d=e[4],_=e[5],m=e[6],b=e[7],T=e[8],S=e[9],M=e[10],z=e[11],i[0]=n=e[0],i[1]=s,i[2]=c,i[3]=h,i[4]=d,i[5]=_,i[6]=m,i[7]=b,i[8]=T,i[9]=S,i[10]=M,i[11]=z,i[12]=n*B+d*q+T*H+e[12],i[13]=s*B+_*q+S*H+e[13],i[14]=c*B+m*q+M*H+e[14],i[15]=h*B+b*q+z*H+e[15]),i}function Jn(i,e,r){var n=r[0],s=r[1],c=r[2];return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i[4]=e[4]*s,i[5]=e[5]*s,i[6]=e[6]*s,i[7]=e[7]*s,i[8]=e[8]*c,i[9]=e[9]*c,i[10]=e[10]*c,i[11]=e[11]*c,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Yc(i,e,r){var n=Math.sin(r),s=Math.cos(r),c=e[4],h=e[5],d=e[6],_=e[7],m=e[8],b=e[9],T=e[10],S=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=c*s+m*n,i[5]=h*s+b*n,i[6]=d*s+T*n,i[7]=_*s+S*n,i[8]=m*s-c*n,i[9]=b*s-h*n,i[10]=T*s-d*n,i[11]=S*s-_*n,i}function Kc(i,e,r){var n=Math.sin(r),s=Math.cos(r),c=e[0],h=e[1],d=e[2],_=e[3],m=e[8],b=e[9],T=e[10],S=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=c*s-m*n,i[1]=h*s-b*n,i[2]=d*s-T*n,i[3]=_*s-S*n,i[8]=c*n+m*s,i[9]=h*n+b*s,i[10]=d*n+T*s,i[11]=_*n+S*s,i}function $u(i,e,r){var n,s,c,h=r[0],d=r[1],_=r[2],m=Math.hypot(h,d,_);return m<Hc?null:(h*=m=1/m,d*=m,_*=m,n=Math.sin(e),s=Math.cos(e),i[0]=h*h*(c=1-s)+s,i[1]=d*h*c+_*n,i[2]=_*h*c-d*n,i[3]=0,i[4]=h*d*c-_*n,i[5]=d*d*c+s,i[6]=_*d*c+h*n,i[7]=0,i[8]=h*_*c+d*n,i[9]=d*_*c-h*n,i[10]=_*_*c+s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Fp=ta;function D3(){var i=new Wr(3);return Wr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Zu(i){var e=new Wr(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function hl(i){return Math.hypot(i[0],i[1],i[2])}function r1(i,e,r){var n=new Wr(3);return n[0]=i,n[1]=e,n[2]=r,n}function ia(i,e,r){return i[0]=e[0]+r[0],i[1]=e[1]+r[1],i[2]=e[2]+r[2],i}function L3(i,e,r){return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],i}function qu(i,e,r){return i[0]=e[0]*r[0],i[1]=e[1]*r[1],i[2]=e[2]*r[2],i}function Qc(i,e,r){return i[0]=Math.min(e[0],r[0]),i[1]=Math.min(e[1],r[1]),i[2]=Math.min(e[2],r[2]),i}function e9(i,e,r){return i[0]=Math.max(e[0],r[0]),i[1]=Math.max(e[1],r[1]),i[2]=Math.max(e[2],r[2]),i}function Hn(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i}function t9(i,e,r,n){return i[0]=e[0]+r[0]*n,i[1]=e[1]+r[1]*n,i[2]=e[2]+r[2]*n,i}function Er(i,e){var r=e[0],n=e[1],s=e[2],c=r*r+n*n+s*s;return c>0&&(c=1/Math.sqrt(c)),i[0]=e[0]*c,i[1]=e[1]*c,i[2]=e[2]*c,i}function gn(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function R3(i,e,r){var n=e[0],s=e[1],c=e[2],h=r[0],d=r[1],_=r[2];return i[0]=s*_-c*d,i[1]=c*h-n*_,i[2]=n*d-s*h,i}function fr(i,e,r){var n=e[0],s=e[1],c=e[2],h=r[3]*n+r[7]*s+r[11]*c+r[15];return i[0]=(r[0]*n+r[4]*s+r[8]*c+r[12])/(h=h||1),i[1]=(r[1]*n+r[5]*s+r[9]*c+r[13])/h,i[2]=(r[2]*n+r[6]*s+r[10]*c+r[14])/h,i}function Wu(i,e,r){var n=r[0],s=r[1],c=r[2],h=e[0],d=e[1],_=e[2],m=s*_-c*d,b=c*h-n*_,T=n*d-s*h,S=s*T-c*b,M=c*m-n*T,z=n*b-s*m,B=2*r[3];return b*=B,T*=B,M*=2,z*=2,i[0]=h+(m*=B)+(S*=2),i[1]=d+b+M,i[2]=_+T+z,i}var pl,yn=L3,Np=qu,Gp=hl;function Xu(i,e,r){return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i}function Ya(i,e,r){var n=e[0],s=e[1],c=e[2],h=e[3];return i[0]=r[0]*n+r[4]*s+r[8]*c+r[12]*h,i[1]=r[1]*n+r[5]*s+r[9]*c+r[13]*h,i[2]=r[2]*n+r[6]*s+r[10]*c+r[14]*h,i[3]=r[3]*n+r[7]*s+r[11]*c+r[15]*h,i}function Ju(){var i=new Wr(4);return Wr!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Hu(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function Yu(i,e,r){r*=.5;var n=e[0],s=e[1],c=e[2],h=e[3],d=Math.sin(r),_=Math.cos(r);return i[0]=n*_+h*d,i[1]=s*_+c*d,i[2]=c*_-s*d,i[3]=h*_-n*d,i}function Ku(i,e,r){r*=.5;var n=e[0],s=e[1],c=e[2],h=e[3],d=Math.sin(r),_=Math.cos(r);return i[0]=n*_-c*d,i[1]=s*_+h*d,i[2]=c*_+n*d,i[3]=h*_-s*d,i}D3(),pl=new Wr(4),Wr!=Float32Array&&(pl[0]=0,pl[1]=0,pl[2]=0,pl[3]=0),D3(),r1(1,0,0),r1(0,1,0),Ju(),Ju(),ju();class B3{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,n){const s=gn(r,this.dir);if(Math.abs(s)<1e-6)return!1;const c=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/s;return n[0]=this.pos[0]+this.dir[0]*c,n[1]=this.pos[1]+this.dir[1]*c,n[2]=this.pos[2]+this.dir[2]*c,!0}closestPointOnSphere(e,r,n){if(function(M,z){var B=M[0],q=M[1],H=M[2],se=z[0],oe=z[1],le=z[2];return Math.abs(B-se)<=Hc*Math.max(1,Math.abs(B),Math.abs(se))&&Math.abs(q-oe)<=Hc*Math.max(1,Math.abs(q),Math.abs(oe))&&Math.abs(H-le)<=Hc*Math.max(1,Math.abs(H),Math.abs(le))}(this.pos,e)||r===0)return n[0]=n[1]=n[2]=0,!1;const[s,c,h]=this.dir,d=this.pos[0]-e[0],_=this.pos[1]-e[1],m=this.pos[2]-e[2],b=s*s+c*c+h*h,T=2*(d*s+_*c+m*h),S=T*T-4*b*(d*d+_*_+m*m-r*r);if(S<0){const M=Math.max(-T/2,0),z=d+s*M,B=_+c*M,q=m+h*M,H=Math.hypot(z,B,q);return n[0]=z*r/H,n[1]=B*r/H,n[2]=q*r/H,!1}{const M=(-T-Math.sqrt(S))/(2*b);if(M<0){const z=Math.hypot(d,_,m);return n[0]=d*r/z,n[1]=_*r/z,n[2]=m*r/z,!1}return n[0]=d+s*M,n[1]=_+c*M,n[2]=m+h*M,!0}}}class O3{constructor(e,r,n,s,c){this.TL=e,this.TR=r,this.BR=n,this.BL=s,this.horizon=c}static fromInvProjectionMatrix(e,r,n){const s=[-1,1,1],c=[1,1,1],h=[1,-1,1],d=[-1,-1,1],_=fr(s,s,e),m=fr(c,c,e),b=fr(h,h,e),T=fr(d,d,e);return new O3(_,m,b,T,r/n)}}class F3{constructor(e,r){this.points=e,this.planes=r}static fromInvProjectionMatrix(e,r,n,s){const c=Math.pow(2,n),h=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(_=>{const m=Ya([],_,e),b=1/m[3]/r*c;return function(T,S,M){return T[0]=S[0]*M[0],T[1]=S[1]*M[1],T[2]=S[2]*M[2],T[3]=S[3]*M[3],T}(m,m,[b,b,s?1/m[3]:b,b])}),d=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(_=>{const m=Er([],R3([],yn([],h[_[0]],h[_[1]]),yn([],h[_[2]],h[_[1]]))),b=-gn(m,h[_[1]]);return m.concat(b)});return new F3(h,d)}}class on{constructor(e,r){this.min=e,this.max=r,this.center=Hn([],ia([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],n=Zu(this.min),s=Zu(this.max);for(let c=0;c<r.length;c++)n[c]=r[c]?this.min[c]:this.center[c],s[c]=r[c]?this.center[c]:this.max[c];return s[2]=this.max[2],new on(n,s)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){const r=this.getCorners();let n=!0;for(let s=0;s<e.planes.length;s++){const c=e.planes[s];let h=0;for(let d=0;d<r.length;d++)h+=gn(c,r[d])+c[3]>=0;if(h===0)return 0;h!==r.length&&(n=!1)}if(n)return 2;for(let s=0;s<3;s++){let c=Number.MAX_VALUE,h=-Number.MAX_VALUE;for(let d=0;d<e.points.length;d++){const _=e.points[d][s]-this.min[s];c=Math.min(c,_),h=Math.max(h,_)}if(h<0||c>this.max[s]-this.min[s])return 0}return 1}}function Qu(i,e,r,n,s,c,h,d,_){if(c&&i.queryGeometry.isAboveHorizon)return!1;c&&(_*=i.pixelToTileUnitsFactor);const m=i.tileID.canonical,b=r.projection.upVectorScale(m,r.center.lat,r.worldSize).metersToTile;for(const T of e)for(const S of T){const M=S.add(d),z=s&&r.elevation?r.elevation.exaggeration()*s.getElevationAt(M.x,M.y,!0):0,B=r.projection.projectTilePoint(M.x,M.y,m);if(z>0){const oe=r.projection.upVector(m,M.x,M.y);B.x+=oe[0]*b*z,B.y+=oe[1]*b*z,B.z+=oe[2]*b*z}const q=c?M:Up(B.x,B.y,B.z,n),H=c?i.tilespaceRays.map(oe=>jp(oe,z)):i.queryGeometry.screenGeometry,se=Ya([],[B.x,B.y,B.z,1],n);if(!h&&c?_*=se[3]/r.cameraToCenterDistance:h&&!c&&(_*=r.cameraToCenterDistance/se[3]),c){const oe=Yi((S.y/kt+m.y)/(1<<m.z));_/=r.projection.pixelsPerMeter(oe,1)/mn(1,oe)}if(Pp(H,q,_))return!0}return!1}function Up(i,e,r,n){const s=Ya([],[i,e,r,1],n);return new N(s[0]/s[3],s[1]/s[3])}const eh=r1(0,0,0),Vp=r1(0,0,1);function jp(i,e){const r=D3();return eh[2]=e,i.intersectsPlane(eh,Vp,r),new N(r[0],r[1])}class th extends C3{}function ih(i,{width:e,height:r},n,s){if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==e*r*n)throw new RangeError("mismatched image size")}else s=new Uint8Array(e*r*n);return i.width=e,i.height=r,i.data=s,i}function rh(i,e,r){const{width:n,height:s}=e;n===i.width&&s===i.height||(N3(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,s)},r),i.width=n,i.height=s,i.data=e.data)}function N3(i,e,r,n,s,c){if(s.width===0||s.height===0)return e;if(s.width>i.width||s.height>i.height||r.x>i.width-s.width||r.y>i.height-s.height)throw new RangeError("out of range source coordinates for image copy");if(s.width>e.width||s.height>e.height||n.x>e.width-s.width||n.y>e.height-s.height)throw new RangeError("out of range destination coordinates for image copy");const h=i.data,d=e.data;for(let _=0;_<s.height;_++){const m=((r.y+_)*i.width+r.x)*c,b=((n.y+_)*e.width+n.x)*c;for(let T=0;T<s.width*c;T++)d[b+T]=h[m+T]}return e}ct(th,"HeatmapBucket",{omit:["layers"]});class Eo{constructor(e,r){ih(this,e,1,r)}resize(e){rh(this,new Eo(e),1)}clone(){return new Eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,s,c){N3(e,r,n,s,c,1)}}class Jr{constructor(e,r){ih(this,e,4,r)}resize(e){rh(this,new Jr(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Jr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,n,s,c){N3(e,r,n,s,c,4)}}ct(Eo,"AlphaImage"),ct(Jr,"RGBAImage");var $p={paint:new ft({"heatmap-radius":new ye(me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ye(me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new re(me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new De(me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new re(me.paint_heatmap["heatmap-opacity"])})};function G3(i){const e={},r=i.resolution||256,n=i.clips?i.clips.length:1,s=i.image||new Jr({width:r,height:n}),c=(h,d,_)=>{e[i.evaluationKey]=_;const m=i.expression.evaluate(e);s.data[h+d+0]=Math.floor(255*m.r/m.a),s.data[h+d+1]=Math.floor(255*m.g/m.a),s.data[h+d+2]=Math.floor(255*m.b/m.a),s.data[h+d+3]=Math.floor(255*m.a)};if(i.clips)for(let h=0,d=0;h<n;++h,d+=4*r)for(let _=0,m=0;_<r;_++,m+=4){const b=_/(r-1),{start:T,end:S}=i.clips[h];c(d,m,T*(1-b)+S*b)}else for(let h=0,d=0;h<r;h++,d+=4)c(0,d,h/(r-1));return s}var Zp={paint:new ft({"hillshade-illumination-direction":new re(me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new re(me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new re(me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new re(me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new re(me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new re(me.paint_hillshade["hillshade-accent-color"])})};const qp=ut([{name:"a_pos",components:2,type:"Int16"}],4),{members:Wp}=qp;var i9=r9,Xp=r9;function r9(i,e,r){r=r||2;var n,s,c,h,d,_,m,b=e&&e.length,T=b?e[0]*r:i.length,S=nh(i,0,T,r,!0),M=[];if(!S||S.next===S.prev)return M;if(b&&(S=function(B,q,H,se){var oe,le,he,de=[];for(oe=0,le=q.length;oe<le;oe++)(he=nh(B,q[oe]*se,oe<le-1?q[oe+1]*se:B.length,se,!1))===he.next&&(he.steiner=!0),de.push(id(he));for(de.sort(Qp),oe=0;oe<de.length;oe++)H=ra(H=ed(de[oe],H),H.next);return H}(i,e,S,r)),i.length>80*r){n=c=i[0],s=h=i[1];for(var z=r;z<T;z+=r)(d=i[z])<n&&(n=d),(_=i[z+1])<s&&(s=_),d>c&&(c=d),_>h&&(h=_);m=(m=Math.max(c-n,h-s))!==0?1/m:0}return dl(S,M,r,n,s,m),M}function nh(i,e,r,n,s){var c,h;if(s===j3(i,e,r,n)>0)for(c=e;c<r;c+=n)h=sh(c,i[c],i[c+1],h);else for(c=r-n;c>=e;c-=n)h=sh(c,i[c],i[c+1],h);return h&&n9(h,h.next)&&(_l(h),h=h.next),h}function ra(i,e){if(!i)return i;e||(e=i);var r,n=i;do if(r=!1,n.steiner||!n9(n,n.next)&&Wi(n.prev,n,n.next)!==0)n=n.next;else{if(_l(n),(n=e=n.prev)===n.next)break;r=!0}while(r||n!==e);return e}function dl(i,e,r,n,s,c,h){if(i){!h&&c&&function(b,T,S,M){var z=b;do z.z===null&&(z.z=U3(z.x,z.y,T,S,M)),z.prevZ=z.prev,z.nextZ=z.next,z=z.next;while(z!==b);z.prevZ.nextZ=null,z.prevZ=null,function(B){var q,H,se,oe,le,he,de,Se,Ee=1;do{for(H=B,B=null,le=null,he=0;H;){for(he++,se=H,de=0,q=0;q<Ee&&(de++,se=se.nextZ);q++);for(Se=Ee;de>0||Se>0&&se;)de!==0&&(Se===0||!se||H.z<=se.z)?(oe=H,H=H.nextZ,de--):(oe=se,se=se.nextZ,Se--),le?le.nextZ=oe:B=oe,oe.prevZ=le,le=oe;H=se}le.nextZ=null,Ee*=2}while(he>1)}(z)}(i,n,s,c);for(var d,_,m=i;i.prev!==i.next;)if(d=i.prev,_=i.next,c?Hp(i,n,s,c):Jp(i))e.push(d.i/r),e.push(i.i/r),e.push(_.i/r),_l(i),i=_.next,m=_.next;else if((i=_)===m){h?h===1?dl(i=Yp(ra(i),e,r),e,r,n,s,c,2):h===2&&Kp(i,e,r,n,s,c):dl(ra(i),e,r,n,s,c,1);break}}}function Jp(i){var e=i.prev,r=i,n=i.next;if(Wi(e,r,n)>=0)return!1;for(var s=i.next.next;s!==i.prev;){if(n1(e.x,e.y,r.x,r.y,n.x,n.y,s.x,s.y)&&Wi(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function Hp(i,e,r,n){var s=i.prev,c=i,h=i.next;if(Wi(s,c,h)>=0)return!1;for(var d=s.x>c.x?s.x>h.x?s.x:h.x:c.x>h.x?c.x:h.x,_=s.y>c.y?s.y>h.y?s.y:h.y:c.y>h.y?c.y:h.y,m=U3(s.x<c.x?s.x<h.x?s.x:h.x:c.x<h.x?c.x:h.x,s.y<c.y?s.y<h.y?s.y:h.y:c.y<h.y?c.y:h.y,e,r,n),b=U3(d,_,e,r,n),T=i.prevZ,S=i.nextZ;T&&T.z>=m&&S&&S.z<=b;){if(T!==i.prev&&T!==i.next&&n1(s.x,s.y,c.x,c.y,h.x,h.y,T.x,T.y)&&Wi(T.prev,T,T.next)>=0||(T=T.prevZ,S!==i.prev&&S!==i.next&&n1(s.x,s.y,c.x,c.y,h.x,h.y,S.x,S.y)&&Wi(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;T&&T.z>=m;){if(T!==i.prev&&T!==i.next&&n1(s.x,s.y,c.x,c.y,h.x,h.y,T.x,T.y)&&Wi(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;S&&S.z<=b;){if(S!==i.prev&&S!==i.next&&n1(s.x,s.y,c.x,c.y,h.x,h.y,S.x,S.y)&&Wi(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function Yp(i,e,r){var n=i;do{var s=n.prev,c=n.next.next;!n9(s,c)&&oh(s,n,n.next,c)&&fl(s,c)&&fl(c,s)&&(e.push(s.i/r),e.push(n.i/r),e.push(c.i/r),_l(n),_l(n.next),n=i=c),n=n.next}while(n!==i);return ra(n)}function Kp(i,e,r,n,s,c){var h=i;do{for(var d=h.next.next;d!==h.prev;){if(h.i!==d.i&&rd(h,d)){var _=ah(h,d);return h=ra(h,h.next),_=ra(_,_.next),dl(h,e,r,n,s,c),void dl(_,e,r,n,s,c)}d=d.next}h=h.next}while(h!==i)}function Qp(i,e){return i.x-e.x}function ed(i,e){var r=function(c,h){var d,_=h,m=c.x,b=c.y,T=-1/0;do{if(b<=_.y&&b>=_.next.y&&_.next.y!==_.y){var S=_.x+(b-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(S<=m&&S>T){if(T=S,S===m){if(b===_.y)return _;if(b===_.next.y)return _.next}d=_.x<_.next.x?_:_.next}}_=_.next}while(_!==h);if(!d)return null;if(m===T)return d;var M,z=d,B=d.x,q=d.y,H=1/0;_=d;do m>=_.x&&_.x>=B&&m!==_.x&&n1(b<q?m:T,b,B,q,b<q?T:m,b,_.x,_.y)&&(M=Math.abs(b-_.y)/(m-_.x),fl(_,c)&&(M<H||M===H&&(_.x>d.x||_.x===d.x&&td(d,_)))&&(d=_,H=M)),_=_.next;while(_!==z);return d}(i,e);if(!r)return e;var n=ah(r,i),s=ra(r,r.next);return ra(n,n.next),e===r?s:e}function td(i,e){return Wi(i.prev,i,e.prev)<0&&Wi(e.next,i,i.next)<0}function U3(i,e,r,n,s){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-r)*s)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function id(i){var e=i,r=i;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==i);return r}function n1(i,e,r,n,s,c,h,d){return(s-h)*(e-d)-(i-h)*(c-d)>=0&&(i-h)*(n-d)-(r-h)*(e-d)>=0&&(r-h)*(c-d)-(s-h)*(n-d)>=0}function rd(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(r,n){var s=r;do{if(s.i!==r.i&&s.next.i!==r.i&&s.i!==n.i&&s.next.i!==n.i&&oh(s,s.next,r,n))return!0;s=s.next}while(s!==r);return!1}(i,e)&&(fl(i,e)&&fl(e,i)&&function(r,n){var s=r,c=!1,h=(r.x+n.x)/2,d=(r.y+n.y)/2;do s.y>d!=s.next.y>d&&s.next.y!==s.y&&h<(s.next.x-s.x)*(d-s.y)/(s.next.y-s.y)+s.x&&(c=!c),s=s.next;while(s!==r);return c}(i,e)&&(Wi(i.prev,i,e.prev)||Wi(i,e.prev,e))||n9(i,e)&&Wi(i.prev,i,i.next)>0&&Wi(e.prev,e,e.next)>0)}function Wi(i,e,r){return(e.y-i.y)*(r.x-e.x)-(e.x-i.x)*(r.y-e.y)}function n9(i,e){return i.x===e.x&&i.y===e.y}function oh(i,e,r,n){var s=a9(Wi(i,e,r)),c=a9(Wi(i,e,n)),h=a9(Wi(r,n,i)),d=a9(Wi(r,n,e));return s!==c&&h!==d||!(s!==0||!o9(i,r,e))||!(c!==0||!o9(i,n,e))||!(h!==0||!o9(r,i,n))||!(d!==0||!o9(r,e,n))}function o9(i,e,r){return e.x<=Math.max(i.x,r.x)&&e.x>=Math.min(i.x,r.x)&&e.y<=Math.max(i.y,r.y)&&e.y>=Math.min(i.y,r.y)}function a9(i){return i>0?1:i<0?-1:0}function fl(i,e){return Wi(i.prev,i,i.next)<0?Wi(i,e,i.next)>=0&&Wi(i,i.prev,e)>=0:Wi(i,e,i.prev)<0||Wi(i,i.next,e)<0}function ah(i,e){var r=new V3(i.i,i.x,i.y),n=new V3(e.i,e.x,e.y),s=i.next,c=e.prev;return i.next=e,e.prev=i,r.next=s,s.prev=r,n.next=r,r.prev=n,c.next=n,n.prev=c,n}function sh(i,e,r,n){var s=new V3(i,e,r);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function _l(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function V3(i,e,r){this.i=i,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function j3(i,e,r,n){for(var s=0,c=e,h=r-n;c<r;c+=n)s+=(i[h]-i[c])*(i[c+1]+i[h+1]),h=c;return s}function nd(i,e,r,n,s){lh(i,e,r||0,n||i.length-1,s||od)}function lh(i,e,r,n,s){for(;n>r;){if(n-r>600){var c=n-r+1,h=e-r+1,d=Math.log(c),_=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*_*(c-_)/c)*(h-c/2<0?-1:1);lh(i,e,Math.max(r,Math.floor(e-h*_/c+m)),Math.min(n,Math.floor(e+(c-h)*_/c+m)),s)}var b=i[e],T=r,S=n;for(ml(i,r,e),s(i[n],b)>0&&ml(i,r,n);T<S;){for(ml(i,T,S),T++,S--;s(i[T],b)<0;)T++;for(;s(i[S],b)>0;)S--}s(i[r],b)===0?ml(i,r,S):ml(i,++S,n),S<=e&&(r=S+1),e<=S&&(n=S-1)}}function ml(i,e,r){var n=i[e];i[e]=i[r],i[r]=n}function od(i,e){return i<e?-1:i>e?1:0}function $3(i,e){const r=i.length;if(r<=1)return[i];const n=[];let s,c;for(let h=0;h<r;h++){const d=Ht(i[h]);d!==0&&(i[h].area=Math.abs(d),c===void 0&&(c=d<0),c===d<0?(s&&n.push(s),s=[i[h]]):s.push(i[h]))}if(s&&n.push(s),e>1)for(let h=0;h<n.length;h++)n[h].length<=e||(nd(n[h],e,1,n[h].length-1,ad),n[h]=n[h].slice(0,e));return n}function ad(i,e){return e.area-i.area}function Z3(i,e,r){const n=r.patternDependencies;let s=!1;for(const c of e){const h=c.paint.get(`${i}-pattern`);h.isConstant()||(s=!0);const d=h.constantOr(null);d&&(s=!0,n[d.to]=!0,n[d.from]=!0)}return s}function q3(i,e,r,n,s){const c=s.patternDependencies;for(const h of e){const d=h.paint.get(`${i}-pattern`).value;if(d.kind!=="constant"){let _=d.evaluate({zoom:n-1},r,{},s.availableImages),m=d.evaluate({zoom:n},r,{},s.availableImages),b=d.evaluate({zoom:n+1},r,{},s.availableImages);_=_&&_.name?_.name:_,m=m&&m.name?m.name:m,b=b&&b.name?b.name:b,c[_]=!0,c[m]=!0,c[b]=!0,r.patterns[h.id]={min:_,mid:m,max:b}}}return r}r9.deviation=function(i,e,r,n){var s=e&&e.length,c=Math.abs(j3(i,0,s?e[0]*r:i.length,r));if(s)for(var h=0,d=e.length;h<d;h++)c-=Math.abs(j3(i,e[h]*r,h<d-1?e[h+1]*r:i.length,r));var _=0;for(h=0;h<n.length;h+=3){var m=n[h]*r,b=n[h+1]*r,T=n[h+2]*r;_+=Math.abs((i[m]-i[T])*(i[b+1]-i[m+1])-(i[m]-i[b])*(i[T+1]-i[m+1]))}return c===0&&_===0?0:Math.abs((_-c)/c)},r9.flatten=function(i){for(var e=i[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,s=0;s<i.length;s++){for(var c=0;c<i[s].length;c++)for(var h=0;h<e;h++)r.vertices.push(i[s][c][h]);s>0&&r.holes.push(n+=i[s-1].length)}return r},i9.default=Xp;class s9{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dt,this.indexArray=new Di,this.indexArray2=new Fr,this.programConfigurations=new Za(e.layers,e.zoom),this.segments=new Ni,this.segments2=new Ni,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,n,s){this.hasPattern=Z3("fill",this.layers,r);const c=this.layers[0].layout.get("fill-sort-key"),h=[];for(const{feature:d,id:_,index:m,sourceLayerIndex:b}of e){const T=this.layers[0]._featureFilter.needGeometry,S=Xa(d,T);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),S,n))continue;const M=c?c.evaluate(S,{},n,r.availableImages):void 0,z={id:_,properties:d.properties,type:d.type,sourceLayerIndex:b,index:m,geometry:T?S.geometry:So(d,n,s),patterns:{},sortKey:M};h.push(z)}c&&h.sort((d,_)=>d.sortKey-_.sortKey);for(const d of h){const{geometry:_,index:m,sourceLayerIndex:b}=d;if(this.hasPattern){const T=q3("fill",this.layers,d,this.zoom,r);this.patternFeatures.push(T)}else this.addFeature(d,_,m,n,{},r.availableImages);r.featureIndex.insert(e[m].feature,_,m,b,this.index)}}update(e,r,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,s)}addFeatures(e,r,n,s,c){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,n,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Wp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,n,s,c,h=[]){for(const d of $3(r,500)){let _=0;for(const z of d)_+=z.length;const m=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),b=m.vertexLength,T=[],S=[];for(const z of d){if(z.length===0)continue;z!==d[0]&&S.push(T.length/2);const B=this.segments2.prepareSegment(z.length,this.layoutVertexArray,this.indexArray2),q=B.vertexLength;this.layoutVertexArray.emplaceBack(z[0].x,z[0].y),this.indexArray2.emplaceBack(q+z.length-1,q),T.push(z[0].x),T.push(z[0].y);for(let H=1;H<z.length;H++)this.layoutVertexArray.emplaceBack(z[H].x,z[H].y),this.indexArray2.emplaceBack(q+H-1,q+H),T.push(z[H].x),T.push(z[H].y);B.vertexLength+=z.length,B.primitiveLength+=z.length}const M=i9(T,S);for(let z=0;z<M.length;z+=3)this.indexArray.emplaceBack(b+M[z],b+M[z+1],b+M[z+2]);m.vertexLength+=_,m.primitiveLength+=M.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,c,h,s)}}ct(s9,"FillBucket",{omit:["layers","patternFeatures"]});const sd=new ft({"fill-sort-key":new ye(me.layout_fill["fill-sort-key"])});var ld={paint:new ft({"fill-antialias":new re(me.paint_fill["fill-antialias"]),"fill-opacity":new ye(me.paint_fill["fill-opacity"]),"fill-color":new ye(me.paint_fill["fill-color"]),"fill-outline-color":new ye(me.paint_fill["fill-outline-color"]),"fill-translate":new re(me.paint_fill["fill-translate"]),"fill-translate-anchor":new re(me.paint_fill["fill-translate-anchor"]),"fill-pattern":new Le(me.paint_fill["fill-pattern"])}),layout:sd};const cd=ut([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ud=ut([{name:"a_centroid_pos",components:2,type:"Uint16"}]),hd=ut([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:pd}=cd;var ch=o1;function o1(i,e,r,n,s){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=n,this._values=s,i.readFields(dd,this,e)}function dd(i,e,r){i==1?e.id=r.readVarint():i==2?function(n,s){for(var c=n.readVarint()+n.pos;n.pos<c;){var h=s._keys[n.readVarint()],d=s._values[n.readVarint()];s.properties[h]=d}}(r,e):i==3?e.type=r.readVarint():i==4&&(e._geometry=r.pos)}function fd(i){for(var e,r,n=0,s=0,c=i.length,h=c-1;s<c;h=s++)n+=((r=i[h]).x-(e=i[s]).x)*(e.y+r.y);return n}o1.types=["Unknown","Point","LineString","Polygon"],o1.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,r=i.readVarint()+i.pos,n=1,s=0,c=0,h=0,d=[];i.pos<r;){if(s<=0){var _=i.readVarint();n=7&_,s=_>>3}if(s--,n===1||n===2)c+=i.readSVarint(),h+=i.readSVarint(),n===1&&(e&&d.push(e),e=[]),e.push(new N(c,h));else{if(n!==7)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&d.push(e),d},o1.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,r=1,n=0,s=0,c=0,h=1/0,d=-1/0,_=1/0,m=-1/0;i.pos<e;){if(n<=0){var b=i.readVarint();r=7&b,n=b>>3}if(n--,r===1||r===2)(s+=i.readSVarint())<h&&(h=s),s>d&&(d=s),(c+=i.readSVarint())<_&&(_=c),c>m&&(m=c);else if(r!==7)throw new Error("unknown command "+r)}return[h,_,d,m]},o1.prototype.toGeoJSON=function(i,e,r){var n,s,c=this.extent*Math.pow(2,r),h=this.extent*i,d=this.extent*e,_=this.loadGeometry(),m=o1.types[this.type];function b(M){for(var z=0;z<M.length;z++){var B=M[z];M[z]=[360*(B.x+h)/c-180,360/Math.PI*Math.atan(Math.exp((180-360*(B.y+d)/c)*Math.PI/180))-90]}}switch(this.type){case 1:var T=[];for(n=0;n<_.length;n++)T[n]=_[n][0];b(_=T);break;case 2:for(n=0;n<_.length;n++)b(_[n]);break;case 3:for(_=function(M){var z=M.length;if(z<=1)return[M];for(var B,q,H=[],se=0;se<z;se++){var oe=fd(M[se]);oe!==0&&(q===void 0&&(q=oe<0),q===oe<0?(B&&H.push(B),B=[M[se]]):B.push(M[se]))}return B&&H.push(B),H}(_),n=0;n<_.length;n++)for(s=0;s<_[n].length;s++)b(_[n][s])}_.length===1?_=_[0]:m="Multi"+m;var S={type:"Feature",geometry:{type:m,coordinates:_},properties:this.properties};return"id"in this&&(S.id=this.id),S};var uh=hh;function hh(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(_d,this,e),this.length=this._features.length}function _d(i,e,r){i===15?e.version=r.readVarint():i===1?e.name=r.readString():i===5?e.extent=r.readVarint():i===2?e._features.push(r.pos):i===3?e._keys.push(r.readString()):i===4&&e._values.push(function(n){for(var s=null,c=n.readVarint()+n.pos;n.pos<c;){var h=n.readVarint()>>3;s=h===1?n.readString():h===2?n.readFloat():h===3?n.readDouble():h===4?n.readVarint64():h===5?n.readVarint():h===6?n.readSVarint():h===7?n.readBoolean():null}return s}(r))}function md(i,e,r){if(i===3){var n=new uh(r,r.readVarint()+r.pos);n.length&&(e[n.name]=n)}}hh.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new ch(this._pbf,e,this.extent,this._keys,this._values)};var Ka={VectorTile:function(i,e){this.layers=i.readFields(md,{},e)},VectorTileFeature:ch,VectorTileLayer:uh};function l9(i,e,r,n){const s=[],c=n===0?(h,d,_,m,b,T)=>{h.push(new N(T,_+(T-d)/(m-d)*(b-_)))}:(h,d,_,m,b,T)=>{h.push(new N(d+(T-_)/(b-_)*(m-d),T))};for(const h of i){const d=[];for(const _ of h){if(_.length<=2)continue;const m=[];for(let S=0;S<_.length-1;S++){const M=_[S].x,z=_[S].y,B=_[S+1].x,q=_[S+1].y,H=n===0?M:z,se=n===0?B:q;H<e?se>e&&c(m,M,z,B,q,e):H>r?se<r&&c(m,M,z,B,q,r):m.push(_[S]),se<e&&H>=e&&c(m,M,z,B,q,e),se>r&&H<=r&&c(m,M,z,B,q,r)}let b=_[_.length-1];const T=n===0?b.x:b.y;T>=e&&T<=r&&m.push(b),m.length&&(b=m[m.length-1],m[0].x===b.x&&m[0].y===b.y||m.push(m[0]),d.push(m))}d.length&&s.push(d)}return s}const gd=Ka.VectorTileFeature.types,yd=Math.pow(2,13);function gl(i,e,r,n,s,c,h,d){i.emplaceBack((e<<1)+h,(r<<1)+c,(Math.floor(n*yd)<<1)+s,Math.round(d))}function yl(i,e,r){i.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class ph{constructor(){this.acc=new N(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new N(e.x,e.y),this.max=new N(e.x,e.y))}append(e,r){this.currentPolyCount.edges++,this.acc._add(e);const n=this.min,s=this.max;e.x<n.x?n.x=e.x:e.x>s.x&&(s.x=e.x),e.y<n.y?n.y=e.y:e.y>s.y&&(s.y=e.y),((e.x===0||e.x===kt)&&e.x===r.x)!=((e.y===0||e.y===kt)&&e.y===r.y)&&this.processBorderOverlap(e,r),r.x<0!=e.x<0&&this.addBorderIntersection(0,Yt(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>kt!=e.x>kt&&this.addBorderIntersection(1,Yt(r.y,e.y,(kt-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,Yt(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>kt!=e.y>kt&&this.addBorderIntersection(3,Yt(r.x,e.x,(kt-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[e];r<n[0]&&(n[0]=r),r>n[1]&&(n[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const n=e.x===0?0:1;this.addBorderIntersection(n,r.y),this.addBorderIntersection(n,e.y)}else{const n=e.y===0?2:3;this.addBorderIntersection(n,r.x),this.addBorderIntersection(n,e.x)}}centroid(){const e=this.polyCount.reduce((r,n)=>r+n.edges,0);return e!==0?this.acc.div(e)._round():new N(0,0)}span(){return new N(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0)}}class xl{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Pt,this.centroidVertexArray=new Iu,this.indexArray=new Di,this.programConfigurations=new Za(e.layers,e.zoom),this.segments=new Ni,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.enableTerrain=e.enableTerrain}populate(e,r,n,s){this.features=[],this.hasPattern=Z3("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(c){const h=Math.exp(Math.PI*(1-c.y/(1<<c.z)*2));return 80150034*h/(h*h+1)/kt/(1<<c.z)}(n);for(const{feature:c,id:h,index:d,sourceLayerIndex:_}of e){const m=this.layers[0]._featureFilter.needGeometry,b=Xa(c,m);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),b,n))continue;const T={id:h,sourceLayerIndex:_,index:d,geometry:m?b.geometry:So(c,n,s),properties:c.properties,type:c.type,patterns:{}},S=this.layoutVertexArray.length;this.hasPattern?this.features.push(q3("fill-extrusion",this.layers,T,this.zoom,r)):this.addFeature(T,T.geometry,d,n,{},r.availableImages,s),r.featureIndex.insert(c,T.geometry,d,_,this.index,S)}this.sortBorders()}addFeatures(e,r,n,s,c){for(const h of this.features){const{geometry:d}=h;this.addFeature(h,d,h.index,r,n,s,c)}this.sortBorders()}update(e,r,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pd),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,hd.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,ud.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,n,s,c,h,d){const _=[new N(0,0),new N(kt,kt)],m=d.projection,b=m.name==="globe",T=this.enableTerrain&&!b?new ph:null;b&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new du);const S=$3(r,500);for(let B=S.length-1;B>=0;B--){const q=S[B];(q.length===0||(M=q[0]).every(H=>H.x<=0)||M.every(H=>H.x>=kt)||M.every(H=>H.y<=0)||M.every(H=>H.y>=kt))&&S.splice(B,1)}var M;let z;if(b)z=fh(S,_,s);else{z=[];for(const B of S)z.push({polygon:B,bounds:_})}for(const B of z){const q=B.polygon;let H=0,se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let Se=0;Se<q.length;Se++){const Ee=q[Se];if(Ee.length===0)continue;H+=Ee.length;let Re=0;T&&T.startRing(Ee[0]);for(let Ge=0;Ge<Ee.length;Ge++){const be=Ee[Ge];if(Ge>=1){const Pe=Ee[Ge-1];if(!xd(be,Pe,B.bounds)){T&&T.append(be,Pe),se.vertexLength+4>Ni.MAX_VERTEX_ARRAY_LENGTH&&(se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ue=be.sub(Pe)._perp(),je=Ue.x/(Math.abs(Ue.x)+Math.abs(Ue.y)),at=Ue.y>0?1:0,Fe=Pe.dist(be);Re+Fe>32768&&(Re=0),gl(this.layoutVertexArray,be.x,be.y,je,at,0,0,Re),gl(this.layoutVertexArray,be.x,be.y,je,at,0,1,Re),Re+=Fe,gl(this.layoutVertexArray,Pe.x,Pe.y,je,at,0,0,Re),gl(this.layoutVertexArray,Pe.x,Pe.y,je,at,0,1,Re);const nt=se.vertexLength;if(this.indexArray.emplaceBack(nt,nt+2,nt+1),this.indexArray.emplaceBack(nt+1,nt+2,nt+3),se.vertexLength+=4,se.primitiveLength+=2,b){const Rt=this.layoutVertexExtArray,$t=m.projectTilePoint(be.x,be.y,s),bt=m.projectTilePoint(Pe.x,Pe.y,s),pt=m.upVector(s,be.x,be.y),Zt=m.upVector(s,Pe.x,Pe.y);yl(Rt,$t,pt),yl(Rt,$t,pt),yl(Rt,bt,Zt),yl(Rt,bt,Zt)}}}}}if(se.vertexLength+H>Ni.MAX_VERTEX_ARRAY_LENGTH&&(se=this.segments.prepareSegment(H,this.layoutVertexArray,this.indexArray)),gd[e.type]!=="Polygon")continue;const oe=[],le=[],he=se.vertexLength;for(let Se=0;Se<q.length;Se++){const Ee=q[Se];if(Ee.length!==0){Ee!==q[0]&&le.push(oe.length/2);for(let Re=0;Re<Ee.length;Re++){const Ge=Ee[Re];gl(this.layoutVertexArray,Ge.x,Ge.y,0,0,1,1,0),oe.push(Ge.x),oe.push(Ge.y),T&&T.currentPolyCount.top++,b&&yl(this.layoutVertexExtArray,m.projectTilePoint(Ge.x,Ge.y,s),m.upVector(s,Ge.x,Ge.y))}}}const de=i9(oe,le);for(let Se=0;Se<de.length;Se+=3)this.indexArray.emplaceBack(he+de[Se],he+de[Se+2],he+de[Se+1]);se.primitiveLength+=de.length/3,se.vertexLength+=H}if(T&&T.polyCount.length>0){if(T.borders){T.vertexArrayOffset=this.centroidVertexArray.length;const B=T.borders,q=this.featuresOnBorder.push(T)-1;for(let H=0;H<4;H++)B[H][0]!==Number.MAX_VALUE&&this.borders[H].push(q)}this.encodeCentroid(T.borders?void 0:T.centroid(),T)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,c,h,s)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((r,n)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[n].borders[e][0])}encodeCentroid(e,r,n=!0){let s,c;if(e)if(e.y!==0){const d=r.span()._mult(this.tileToMeter);s=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(d.x/10)),c=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(d.y/10))}else s=Math.ceil(7*(e.x+450)),c=0;else s=0,c=+n;let h=n?this.centroidVertexArray.length:r.vertexArrayOffset;for(const d of r.polyCount){n&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*d.edges+d.top);for(let _=0;_<2*d.edges;_++)this.centroidVertexArray.emplace(h++,0,c),this.centroidVertexArray.emplace(h++,s,c);for(let _=0;_<d.top;_++)this.centroidVertexArray.emplace(h++,s,c)}}}function xd(i,e,r){return i.x===e.x&&(i.x<r[0].x||i.x>r[1].x)||i.y===e.y&&(i.y<r[0].y||i.y>r[1].y)}function dh(){const i=Math.PI/32,e=Math.tan(i),r=S3;return r*Math.sqrt(1+2*e*e)-r}function fh(i,e,r){const n=1<<r.z,s=Sr(r.x/n),c=Sr((r.x+1)/n),h=Yi(r.y/n),d=Yi((r.y+1)/n);return function(_,m,b,T,S=0,M){const z=[];if(!_.length||!b||!T)return z;const B=(de,Se)=>{for(const Ee of de)z.push({polygon:Ee,bounds:Se})},q=Math.ceil(Math.log2(b)),H=Math.ceil(Math.log2(T)),se=q-H,oe=[];for(let de=0;de<Math.abs(se);de++)oe.push(se>0?0:1);for(let de=0;de<Math.min(q,H);de++)oe.push(0),oe.push(1);let le=_;if(le=l9(le,m[0].y-S,m[1].y+S,1),le=l9(le,m[0].x-S,m[1].x+S,0),!le.length)return z;const he=[];for(oe.length?he.push({polygons:le,bounds:m,depth:0}):B(le,m);he.length;){const de=he.pop(),Se=de.depth,Ee=oe[Se],Re=de.bounds[0],Ge=de.bounds[1],be=Ee===0?Re.x:Re.y,Pe=Ee===0?Ge.x:Ge.y,Ue=M?M(Ee,be,Pe):.5*(be+Pe),je=l9(de.polygons,be-S,Ue+S,Ee),at=l9(de.polygons,Ue-S,Pe+S,Ee);if(je.length){const Fe=[Re,new N(Ee===0?Ue:Ge.x,Ee===1?Ue:Ge.y)];oe.length>Se+1?he.push({polygons:je,bounds:Fe,depth:Se+1}):B(je,Fe)}if(at.length){const Fe=[new N(Ee===0?Ue:Re.x,Ee===1?Ue:Re.y),Ge];oe.length>Se+1?he.push({polygons:at,bounds:Fe,depth:Se+1}):B(at,Fe)}}return z}(i,e,Math.ceil((c-s)/11.25),Math.ceil((h-d)/11.25),1,(_,m,b)=>{if(_===0)return .5*(m+b);{const T=Yi((r.y+m/kt)/n);return(Wa(.5*(Yi((r.y+b/kt)/n)+T))*n-r.y)*kt}})}ct(xl,"FillExtrusionBucket",{omit:["layers","features"]}),ct(ph,"PartMetadata");var vd={paint:new ft({"fill-extrusion-opacity":new re(me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ye(me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new re(me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new re(me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Le(me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ye(me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ye(me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new re(me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function _h(i,e,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[i*n-2*Math.PI*6378137/2,e*n-2*Math.PI*6378137/2]}class c9{constructor(e,r,n){this.z=e,this.x=r,this.y=n,this.key=vl(0,e,e,r,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const n=function(c,h,d){var _=_h(256*c,256*(h=Math.pow(2,d)-h-1),d),m=_h(256*(c+1),256*(h+1),d);return _[0]+","+_[1]+","+m[0]+","+m[1]}(this.x,this.y,this.z),s=function(c,h,d){let _,m="";for(let b=c;b>0;b--)_=1<<b-1,m+=(h&_?1:0)+(d&_?2:0);return m}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",s).replace("{bbox-epsg-3857}",n)}toString(){return`${this.z}/${this.x}/${this.y}`}}class mh{constructor(e,r){this.wrap=e,this.canonical=r,this.key=vl(e,r.z,r.z,r.x,r.y)}}class Ar{constructor(e,r,n,s,c){this.overscaledZ=e,this.wrap=r,this.canonical=new c9(n,+s,+c),this.key=r===0&&e===n?this.canonical.key:vl(r,e,n,s,c)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new Ar(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ar(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return vl(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-e;return vl(this.wrap*+r,e,e,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new Ar(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,n=2*this.canonical.x,s=2*this.canonical.y;return[new Ar(r,this.wrap,r,n,s),new Ar(r,this.wrap,r,n+1,s),new Ar(r,this.wrap,r,n,s+1),new Ar(r,this.wrap,r,n+1,s+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ar(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ar(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new mh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function vl(i,e,r,n,s){const c=1<<Math.min(r,22);let h=c*(s%c)+n%c;return i&&r<22&&(h+=c*c*((i<0?-2*i-1:2*i)%(1<<2*(22-r)))),16*(32*h+r)+(e-r)}function bl(i,e){return i.x*e.x+i.y*e.y}function gh(i,e){if(i.length===1){let r=0;const n=e[r++];let s;for(;!s||n.equals(s);)if(s=e[r++],!s)return 1/0;for(;r<e.length;r++){const c=e[r],h=i[0],d=s.sub(n),_=c.sub(n),m=h.sub(n),b=bl(d,d),T=bl(d,_),S=bl(_,_),M=bl(m,d),z=bl(m,_),B=b*S-T*T,q=(S*M-T*z)/B,H=(b*z-T*M)/B,se=n.z*(1-q-H)+s.z*q+c.z*H;if(isFinite(se))return se}return 1/0}{let r=1/0;for(const n of e)r=Math.min(r,n.z);return r}}function u9(i){const e=new N(i[0],i[1]);return e.z=i[2],e}function yh(i,e,r,n,s,c,h,d){const _=h*s.getElevationAt(i,e,!0,!0),m=c[0]!==0,b=m?c[1]===0?h*(c[0]/7-450):h*function(T,S,M){const z=Math.floor(S[0]/8),B=Math.floor(S[1]/8),q=10*(S[0]-8*z),H=10*(S[1]-8*B),se=T.getElevationAt(z,B,!0,!0),oe=T.getMeterToDEM(M),le=Math.floor(.5*(q*oe-1)),he=Math.floor(.5*(H*oe-1)),de=T.tileCoordToPixel(z,B),Se=2*le+1,Ee=2*he+1,Re=function(at,Fe,nt,Rt,$t){return[at.getElevationAtPixel(Fe,nt,!0),at.getElevationAtPixel(Fe+$t,nt,!0),at.getElevationAtPixel(Fe,nt+$t,!0),at.getElevationAtPixel(Fe+Rt,nt+$t,!0)]}(T,de.x-le,de.y-he,Se,Ee),Ge=Math.abs(Re[0]-Re[1]),be=Math.abs(Re[2]-Re[3]),Pe=Math.abs(Re[0]-Re[2])+Math.abs(Re[1]-Re[3]),Ue=Math.min(.25,.5*oe*(Ge+be)/Se),je=Math.min(.25,.5*oe*Pe/Ee);return se+Math.max(Ue*q,je*H)}(s,c,d):_;return{base:_+(r===0)?-1:r,top:m?Math.max(b+n,_+r+2):_+n}}ct(c9,"CanonicalTileID"),ct(Ar,"OverscaledTileID",{omit:["projMatrix"]});const bd=ut([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:wd}=bd,Td=ut([{name:"a_packed",components:4,type:"Float32"}]),{members:Id}=Td,Sd=Ka.VectorTileFeature.types,Ed=Math.cos(Math.PI/180*37.5);class h9{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new ci,this.layoutVertexArray2=new _i,this.indexArray=new Di,this.programConfigurations=new Za(e.layers,e.zoom),this.segments=new Ni,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,n,s){this.hasPattern=Z3("line",this.layers,r);const c=this.layers[0].layout.get("line-sort-key"),h=[];for(const{feature:b,id:T,index:S,sourceLayerIndex:M}of e){const z=this.layers[0]._featureFilter.needGeometry,B=Xa(b,z);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),B,n))continue;const q=c?c.evaluate(B,{},n):void 0,H={id:T,properties:b.properties,type:b.type,sourceLayerIndex:M,index:S,geometry:z?B.geometry:So(b,n,s),patterns:{},sortKey:q};h.push(H)}c&&h.sort((b,T)=>b.sortKey-T.sortKey);const{lineAtlas:d,featureIndex:_}=r,m=this.addConstantDashes(d);for(const b of h){const{geometry:T,index:S,sourceLayerIndex:M}=b;if(m&&this.addFeatureDashes(b,d),this.hasPattern){const z=q3("line",this.layers,b,this.zoom,r);this.patternFeatures.push(z)}else this.addFeature(b,T,S,n,d.positions,r.availableImages);_.insert(e[S].feature,T,S,M,this.index)}}addConstantDashes(e){let r=!1;for(const n of this.layers){const s=n.paint.get("line-dasharray").value,c=n.layout.get("line-cap").value;if(s.kind!=="constant"||c.kind!=="constant")r=!0;else{const h=c.value,d=s.value;if(!d)continue;e.addDash(d.from,h),e.addDash(d.to,h),d.other&&e.addDash(d.other,h)}}return r}addFeatureDashes(e,r){const n=this.zoom;for(const s of this.layers){const c=s.paint.get("line-dasharray").value,h=s.layout.get("line-cap").value;if(c.kind==="constant"&&h.kind==="constant")continue;let d,_,m,b,T,S;if(c.kind==="constant"){const q=c.value;if(!q)continue;d=q.other||q.to,_=q.to,m=q.from}else d=c.evaluate({zoom:n-1},e),_=c.evaluate({zoom:n},e),m=c.evaluate({zoom:n+1},e);h.kind==="constant"?b=T=S=h.value:(b=h.evaluate({zoom:n-1},e),T=h.evaluate({zoom:n},e),S=h.evaluate({zoom:n+1},e)),r.addDash(d,b),r.addDash(_,T),r.addDash(m,S);const M=r.getKey(d,b),z=r.getKey(_,T),B=r.getKey(m,S);e.patterns[s.id]={min:M,mid:z,max:B}}}update(e,r,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,n,s)}addFeatures(e,r,n,s,c){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,n,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Id)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wd),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,n,s,c,h){const d=this.layers[0].layout,_=d.get("line-join").evaluate(e,{}),m=d.get("line-cap").evaluate(e,{}),b=d.get("line-miter-limit"),T=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const S of r)this.addLine(S,e,_,m,b,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,c,h,s)}addLine(e,r,n,s,c,h){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let H=0;H<e.length-1;H++)this.totalDistance+=e[H].dist(e[H+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const d=Sd[r.type]==="Polygon";let _=e.length;for(;_>=2&&e[_-1].equals(e[_-2]);)_--;let m=0;for(;m<_-1&&e[m].equals(e[m+1]);)m++;if(_<(d?3:2))return;n==="bevel"&&(c=1.05);const b=this.overscaling<=16?122880/(512*this.overscaling):0,T=this.segments.prepareSegment(10*_,this.layoutVertexArray,this.indexArray);let S,M,z,B,q;this.e1=this.e2=-1,d&&(S=e[_-2],q=e[m].sub(S)._unit()._perp());for(let H=m;H<_;H++){if(z=H===_-1?d?e[m+1]:void 0:e[H+1],z&&e[H].equals(z))continue;q&&(B=q),S&&(M=S),S=e[H],q=z?z.sub(S)._unit()._perp():B,B=B||q;let se=B.add(q);se.x===0&&se.y===0||se._unit();const oe=B.x*q.x+B.y*q.y,le=se.x*q.x+se.y*q.y,he=le!==0?1/le:1/0,de=2*Math.sqrt(2-2*le),Se=le<Ed&&M&&z,Ee=B.x*q.y-B.y*q.x>0;if(Se&&H>m){const be=S.dist(M);if(be>2*b){const Pe=S.sub(S.sub(M)._mult(b/be)._round());this.updateDistance(M,Pe),this.addCurrentVertex(Pe,B,0,0,T),M=Pe}}const Re=M&&z;let Ge=Re?n:d?"butt":s;if(Re&&Ge==="round"&&(he<h?Ge="miter":he<=2&&(Ge="fakeround")),Ge==="miter"&&he>c&&(Ge="bevel"),Ge==="bevel"&&(he>2&&(Ge="flipbevel"),he<c&&(Ge="miter")),M&&this.updateDistance(M,S),Ge==="miter")se._mult(he),this.addCurrentVertex(S,se,0,0,T);else if(Ge==="flipbevel"){if(he>100)se=q.mult(-1);else{const be=he*B.add(q).mag()/B.sub(q).mag();se._perp()._mult(be*(Ee?-1:1))}this.addCurrentVertex(S,se,0,0,T),this.addCurrentVertex(S,se.mult(-1),0,0,T)}else if(Ge==="bevel"||Ge==="fakeround"){const be=-Math.sqrt(he*he-1),Pe=Ee?be:0,Ue=Ee?0:be;if(M&&this.addCurrentVertex(S,B,Pe,Ue,T),Ge==="fakeround"){const je=Math.round(180*de/Math.PI/20);for(let at=1;at<je;at++){let Fe=at/je;if(Fe!==.5){const Rt=Fe-.5;Fe+=Fe*Rt*(Fe-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Rt*Rt+(.848013+oe*(.215638*oe-1.06021)))}const nt=q.sub(B)._mult(Fe)._add(B)._unit()._mult(Ee?-1:1);this.addHalfVertex(S,nt.x,nt.y,!1,Ee,0,T)}}z&&this.addCurrentVertex(S,q,-Pe,-Ue,T)}else if(Ge==="butt")this.addCurrentVertex(S,se,0,0,T);else if(Ge==="square"){const be=M?1:-1;M||this.addCurrentVertex(S,se,be,be,T),this.addCurrentVertex(S,se,0,0,T),M&&this.addCurrentVertex(S,se,be,be,T)}else Ge==="round"&&(M&&(this.addCurrentVertex(S,B,0,0,T),this.addCurrentVertex(S,B,1,1,T,!0)),z&&(this.addCurrentVertex(S,q,-1,-1,T,!0),this.addCurrentVertex(S,q,0,0,T)));if(Se&&H<_-1){const be=S.dist(z);if(be>2*b){const Pe=S.add(z.sub(S)._mult(b/be)._round());this.updateDistance(S,Pe),this.addCurrentVertex(Pe,q,0,0,T),S=Pe}}}}addCurrentVertex(e,r,n,s,c,h=!1){const d=r.y*s-r.x,_=-r.y-r.x*s;this.addHalfVertex(e,r.x+r.y*n,r.y-r.x*n,h,!1,n,c),this.addHalfVertex(e,d,_,h,!0,-s,c)}addHalfVertex({x:e,y:r},n,s,c,h,d,_){this.layoutVertexArray.emplaceBack((e<<1)+(c?1:0),(r<<1)+(h?1:0),Math.round(63*n)+128,Math.round(63*s)+128,1+(d===0?0:d<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const m=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,m),_.primitiveLength++),h?this.e2=m:this.e1=m}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}ct(h9,"LineBucket",{omit:["layers","patternFeatures"]});const Ad=new ft({"line-cap":new ye(me.layout_line["line-cap"]),"line-join":new ye(me.layout_line["line-join"]),"line-miter-limit":new re(me.layout_line["line-miter-limit"]),"line-round-limit":new re(me.layout_line["line-round-limit"]),"line-sort-key":new ye(me.layout_line["line-sort-key"])});var xh={paint:new ft({"line-opacity":new ye(me.paint_line["line-opacity"]),"line-color":new ye(me.paint_line["line-color"]),"line-translate":new re(me.paint_line["line-translate"]),"line-translate-anchor":new re(me.paint_line["line-translate-anchor"]),"line-width":new ye(me.paint_line["line-width"]),"line-gap-width":new ye(me.paint_line["line-gap-width"]),"line-offset":new ye(me.paint_line["line-offset"]),"line-blur":new ye(me.paint_line["line-blur"]),"line-dasharray":new Le(me.paint_line["line-dasharray"]),"line-pattern":new Le(me.paint_line["line-pattern"]),"line-gradient":new De(me.paint_line["line-gradient"]),"line-trim-offset":new re(me.paint_line["line-trim-offset"])}),layout:Ad};const vh=new class extends ye{possiblyEvaluate(i,e){return e=new V(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,r,n){return e=He({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,r,n)}}(xh.paint.properties["line-width"].specification);function bh(i,e){return e>0?e+2*i:i}vh.useIntegerZoom=!0;const kd=ut([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Md=ut([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Cd=ut([{name:"a_projected_pos",components:4,type:"Float32"}],4);ut([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zd=ut([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Pd=ut([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ut([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wh=ut([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Dd=ut([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ut([{name:"triangle",components:3,type:"Uint16"}]),ut([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ut([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ut([{type:"Float32",name:"offsetX"}]),ut([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var _r=24;const Yn=128;function W3(i,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new V(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:n,interpolationType:s}=r;let c=0;for(;c<n.length&&n[c]<=i;)c++;c=Math.max(0,c-1);let h=c;for(;h<n.length&&n[h]<i+1;)h++;h=Math.min(n.length-1,h);const d=n[c],_=n[h];return r.kind==="composite"?{kind:"composite",minZoom:d,maxZoom:_,interpolationType:s}:{kind:"camera",minZoom:d,maxZoom:_,minSize:r.evaluate(new V(d)),maxSize:r.evaluate(new V(_)),interpolationType:s}}}function p9(i,{uSize:e,uSizeT:r},{lowerSize:n,upperSize:s}){return i.kind==="source"?n/Yn:i.kind==="composite"?Yt(n/Yn,s/Yn,r):e}function a1(i,e){let r=0,n=0;if(i.kind==="constant")n=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:s,minZoom:c,maxZoom:h}=i,d=s?xe(hn.interpolationFactor(s,e,c,h),0,1):0;i.kind==="camera"?n=Yt(i.minSize,i.maxSize,d):r=d}return{uSizeT:r,uSize:n}}var Ld=Object.freeze({__proto__:null,getSizeData:W3,evaluateSizeForFeature:p9,evaluateSizeForZoom:a1,SIZE_PACK_FACTOR:Yn});function Rd(i,e,r){return i.sections.forEach(n=>{n.text=function(s,c,h){const d=c.layout.get("text-transform").evaluate(h,{});return d==="uppercase"?s=s.toLocaleUpperCase():d==="lowercase"&&(s=s.toLocaleLowerCase()),J.applyArabicShaping&&(s=J.applyArabicShaping(s)),s}(n.text,e,r)}),i}const wl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function Bd(i){return i==="\uFE36"||i==="\uFE48"||i==="\uFE38"||i==="\uFE44"||i==="\uFE42"||i==="\uFE3E"||i==="\uFE3C"||i==="\uFE3A"||i==="\uFE18"||i==="\uFE40"||i==="\uFE10"||i==="\uFE13"||i==="\uFE14"||i==="\uFF40"||i==="\uFFE3"||i==="\uFE11"||i==="\uFE12"}function Od(i){return i==="\uFE35"||i==="\uFE47"||i==="\uFE37"||i==="\uFE43"||i==="\uFE41"||i==="\uFE3D"||i==="\uFE3B"||i==="\uFE39"||i==="\uFE17"||i==="\uFE3F"}var Th=function(i,e,r,n,s){var c,h,d=8*s-n-1,_=(1<<d)-1,m=_>>1,b=-7,T=r?s-1:0,S=r?-1:1,M=i[e+T];for(T+=S,c=M&(1<<-b)-1,M>>=-b,b+=d;b>0;c=256*c+i[e+T],T+=S,b-=8);for(h=c&(1<<-b)-1,c>>=-b,b+=n;b>0;h=256*h+i[e+T],T+=S,b-=8);if(c===0)c=1-m;else{if(c===_)return h?NaN:1/0*(M?-1:1);h+=Math.pow(2,n),c-=m}return(M?-1:1)*h*Math.pow(2,c-n)},Ih=function(i,e,r,n,s,c){var h,d,_,m=8*c-s-1,b=(1<<m)-1,T=b>>1,S=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=n?0:c-1,z=n?1:-1,B=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(d=isNaN(e)?1:0,h=b):(h=Math.floor(Math.log(e)/Math.LN2),e*(_=Math.pow(2,-h))<1&&(h--,_*=2),(e+=h+T>=1?S/_:S*Math.pow(2,1-T))*_>=2&&(h++,_/=2),h+T>=b?(d=0,h=b):h+T>=1?(d=(e*_-1)*Math.pow(2,s),h+=T):(d=e*Math.pow(2,T-1)*Math.pow(2,s),h=0));s>=8;i[r+M]=255&d,M+=z,d/=256,s-=8);for(h=h<<s|d,m+=s;m>0;i[r+M]=255&h,M+=z,h/=256,m-=8);i[r+M-z]|=128*B},Tl=gi;function gi(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}gi.Varint=0,gi.Fixed64=1,gi.Bytes=2,gi.Fixed32=5;var X3=4294967296,Sh=1/X3,Eh=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Ao(i){return i.type===gi.Bytes?i.readVarint()+i.pos:i.pos+1}function s1(i,e,r){return r?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Ah(i,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var s=r.pos-1;s>=i;s--)r.buf[s+n]=r.buf[s]}function Fd(i,e){for(var r=0;r<i.length;r++)e.writeVarint(i[r])}function Nd(i,e){for(var r=0;r<i.length;r++)e.writeSVarint(i[r])}function Gd(i,e){for(var r=0;r<i.length;r++)e.writeFloat(i[r])}function Ud(i,e){for(var r=0;r<i.length;r++)e.writeDouble(i[r])}function Vd(i,e){for(var r=0;r<i.length;r++)e.writeBoolean(i[r])}function jd(i,e){for(var r=0;r<i.length;r++)e.writeFixed32(i[r])}function $d(i,e){for(var r=0;r<i.length;r++)e.writeSFixed32(i[r])}function Zd(i,e){for(var r=0;r<i.length;r++)e.writeFixed64(i[r])}function qd(i,e){for(var r=0;r<i.length;r++)e.writeSFixed64(i[r])}function d9(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function l1(i,e,r){i[r]=e,i[r+1]=e>>>8,i[r+2]=e>>>16,i[r+3]=e>>>24}function kh(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function Wd(i,e,r){e.glyphs=[],i===1&&r.readMessage(Xd,e)}function Xd(i,e,r){if(i===3){const{id:n,bitmap:s,width:c,height:h,left:d,top:_,advance:m}=r.readMessage(Jd,{});e.glyphs.push({id:n,bitmap:new Eo({width:c+6,height:h+6},s),metrics:{width:c,height:h,left:d,top:_,advance:m}})}else i===4?e.ascender=r.readSVarint():i===5&&(e.descender=r.readSVarint())}function Jd(i,e,r){i===1?e.id=r.readVarint():i===2?e.bitmap=r.readBytes():i===3?e.width=r.readVarint():i===4?e.height=r.readVarint():i===5?e.left=r.readSVarint():i===6?e.top=r.readSVarint():i===7&&(e.advance=r.readVarint())}function J3(i){let e=0,r=0;for(const h of i)e+=h.w*h.h,r=Math.max(r,h.w);i.sort((h,d)=>d.h-h.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let s=0,c=0;for(const h of i)for(let d=n.length-1;d>=0;d--){const _=n[d];if(!(h.w>_.w||h.h>_.h)){if(h.x=_.x,h.y=_.y,c=Math.max(c,h.y+h.h),s=Math.max(s,h.x+h.w),h.w===_.w&&h.h===_.h){const m=n.pop();d<n.length&&(n[d]=m)}else h.h===_.h?(_.x+=h.w,_.w-=h.w):h.w===_.w?(_.y+=h.h,_.h-=h.h):(n.push({x:_.x+h.w,y:_.y,w:_.w-h.w,h:h.h}),_.y+=h.h,_.h-=h.h);break}}return{w:s,h:c,fill:e/(s*c)||0}}gi.prototype={destroy:function(){this.buf=null},readFields:function(i,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),s=n>>3,c=this.pos;this.type=7&n,i(s,e,this),this.pos===c&&this.skip(n)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=d9(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=kh(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=d9(this.buf,this.pos)+d9(this.buf,this.pos+4)*X3;return this.pos+=8,i},readSFixed64:function(){var i=d9(this.buf,this.pos)+kh(this.buf,this.pos+4)*X3;return this.pos+=8,i},readFloat:function(){var i=Th(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Th(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(s,c,h){var d,_,m=h.buf;if(d=(112&(_=m[h.pos++]))>>4,_<128||(d|=(127&(_=m[h.pos++]))<<3,_<128)||(d|=(127&(_=m[h.pos++]))<<10,_<128)||(d|=(127&(_=m[h.pos++]))<<17,_<128)||(d|=(127&(_=m[h.pos++]))<<24,_<128)||(d|=(1&(_=m[h.pos++]))<<31,_<128))return s1(s,d,c);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Eh?function(r,n,s){return Eh.decode(r.subarray(n,s))}(this.buf,e,i):function(r,n,s){for(var c="",h=n;h<s;){var d,_,m,b=r[h],T=null,S=b>239?4:b>223?3:b>191?2:1;if(h+S>s)break;S===1?b<128&&(T=b):S===2?(192&(d=r[h+1]))==128&&(T=(31&b)<<6|63&d)<=127&&(T=null):S===3?(_=r[h+2],(192&(d=r[h+1]))==128&&(192&_)==128&&((T=(15&b)<<12|(63&d)<<6|63&_)<=2047||T>=55296&&T<=57343)&&(T=null)):S===4&&(_=r[h+2],m=r[h+3],(192&(d=r[h+1]))==128&&(192&_)==128&&(192&m)==128&&((T=(15&b)<<18|(63&d)<<12|(63&_)<<6|63&m)<=65535||T>=1114112)&&(T=null)),T===null?(T=65533,S=1):T>65535&&(T-=65536,c+=String.fromCharCode(T>>>10&1023|55296),T=56320|1023&T),c+=String.fromCharCode(T),h+=S}return c}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==gi.Bytes)return i.push(this.readVarint(e));var r=Ao(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==gi.Bytes)return i.push(this.readSVarint());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==gi.Bytes)return i.push(this.readBoolean());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==gi.Bytes)return i.push(this.readFloat());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==gi.Bytes)return i.push(this.readDouble());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==gi.Bytes)return i.push(this.readFixed32());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==gi.Bytes)return i.push(this.readSFixed32());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==gi.Bytes)return i.push(this.readFixed64());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==gi.Bytes)return i.push(this.readSFixed64());var e=Ao(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===gi.Varint)for(;this.buf[this.pos++]>127;);else if(e===gi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===gi.Fixed32)this.pos+=4;else{if(e!==gi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),l1(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),l1(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),l1(this.buf,-1&i,this.pos),l1(this.buf,Math.floor(i*Sh),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),l1(this.buf,-1&i,this.pos),l1(this.buf,Math.floor(i*Sh),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,r){var n,s;if(e>=0?(n=e%4294967296|0,s=e/4294967296|0):(s=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,s=s+1|0)),e>=0xffffffffffffffff||e<-0xffffffffffffffff)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(c,h,d){d.buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos++]=127&c|128,d.buf[d.pos]=127&(c>>>=7)}(n,0,r),function(c,h){var d=(7&c)<<4;h.buf[h.pos++]|=d|((c>>>=3)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c)))))}(s,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(n,s,c){for(var h,d,_=0;_<s.length;_++){if((h=s.charCodeAt(_))>55295&&h<57344){if(!d){h>56319||_+1===s.length?(n[c++]=239,n[c++]=191,n[c++]=189):d=h;continue}if(h<56320){n[c++]=239,n[c++]=191,n[c++]=189,d=h;continue}h=d-55296<<10|h-56320|65536,d=null}else d&&(n[c++]=239,n[c++]=191,n[c++]=189,d=null);h<128?n[c++]=h:(h<2048?n[c++]=h>>6|192:(h<65536?n[c++]=h>>12|224:(n[c++]=h>>18|240,n[c++]=h>>12&63|128),n[c++]=h>>6&63|128),n[c++]=63&h|128)}return c}(this.buf,i,this.pos);var r=this.pos-e;r>=128&&Ah(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),Ih(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Ih(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,e){this.pos++;var r=this.pos;i(e,this);var n=this.pos-r;n>=128&&Ah(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(i,e,r){this.writeTag(i,gi.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,Fd,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,Nd,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,Vd,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,Gd,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,Ud,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,jd,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,$d,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,Zd,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,qd,e)},writeBytesField:function(i,e){this.writeTag(i,gi.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,gi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,gi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,gi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,gi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,gi.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,gi.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,gi.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,gi.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,gi.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,Boolean(e))}};class H3{constructor(e,{pixelRatio:r,version:n,stretchX:s,stretchY:c,content:h}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=s,this.stretchY=c,this.content=h,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Mh{constructor(e,r){const n={},s={};this.haveRenderCallbacks=[];const c=[];this.addImages(e,n,c),this.addImages(r,s,c);const{w:h,h:d}=J3(c),_=new Jr({width:h||1,height:d||1});for(const m in e){const b=e[m],T=n[m].paddedRect;Jr.copy(b.data,_,{x:0,y:0},{x:T.x+1,y:T.y+1},b.data)}for(const m in r){const b=r[m],T=s[m].paddedRect,S=T.x+1,M=T.y+1,z=b.data.width,B=b.data.height;Jr.copy(b.data,_,{x:0,y:0},{x:S,y:M},b.data),Jr.copy(b.data,_,{x:0,y:B-1},{x:S,y:M-1},{width:z,height:1}),Jr.copy(b.data,_,{x:0,y:0},{x:S,y:M+B},{width:z,height:1}),Jr.copy(b.data,_,{x:z-1,y:0},{x:S-1,y:M},{width:1,height:B}),Jr.copy(b.data,_,{x:0,y:0},{x:S+z,y:M},{width:1,height:B})}this.image=_,this.iconPositions=n,this.patternPositions=s}addImages(e,r,n){for(const s in e){const c=e[s],h={x:0,y:0,w:c.data.width+2,h:c.data.height+2};n.push(h),r[s]=new H3(h,c),c.hasRenderCallback&&this.haveRenderCallbacks.push(s)}}patchUpdatedImages(e,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(n=>e.hasImage(n)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),r)}patchUpdatedImage(e,r,n){if(!e||!r||e.version===r.version)return;e.version=r.version;const[s,c]=e.tl;n.update(r.data,void 0,{x:s,y:c})}}ct(H3,"ImagePosition"),ct(Mh,"ImageAtlas");const an={horizontal:1,vertical:2,horizontalOnly:3};class Il{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const n=new Il;return n.scale=e||1,n.fontStack=r,n}static forImage(e){const r=new Il;return r.imageName=e,r}}class c1{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const n=new c1;for(let s=0;s<e.sections.length;s++){const c=e.sections[s];c.image?n.addImageSection(c):n.addTextSection(c,r)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(r,n){let s="";for(let c=0;c<r.length;c++){const h=r.charCodeAt(c+1)||null,d=r.charCodeAt(c-1)||null;s+=!n&&(h&&u(h)&&!wl[r[c+1]]||d&&u(d)&&!wl[r[c-1]])||!wl[r[c]]?r[c]:wl[r[c]]}return s}(this.text,e)}trim(){let e=0;for(let n=0;n<this.text.length&&f9[this.text.charCodeAt(n)];n++)e++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&f9[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const n=new c1;return n.text=this.text.substring(e,r),n.sectionIndex=this.sectionIndex.slice(e,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Il.forText(e.scale,e.fontStack||r));const n=this.sections.length-1;for(let s=0;s<e.text.length;++s)this.sectionIndex.push(n)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void _t("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Il.forImage(r)),this.sectionIndex.push(this.sections.length-1)):_t("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Y3(i,e,r,n,s,c,h,d,_,m,b,T,S,M,z,B){const q=c1.fromFeature(i,s);let H;T===an.vertical&&q.verticalizePunctuation(S);const{processBidirectionalText:se,processStyledBidirectionalText:oe}=J;if(se&&q.sections.length===1){H=[];const de=se(q.toString(),K3(q,m,c,e,n,M,z));for(const Se of de){const Ee=new c1;Ee.text=Se,Ee.sections=q.sections;for(let Re=0;Re<Se.length;Re++)Ee.sectionIndex.push(0);H.push(Ee)}}else if(oe){H=[];const de=oe(q.text,q.sectionIndex,K3(q,m,c,e,n,M,z));for(const Se of de){const Ee=new c1;Ee.text=Se[0],Ee.sectionIndex=Se[1],Ee.sections=q.sections,H.push(Ee)}}else H=function(de,Se){const Ee=[],Re=de.text;let Ge=0;for(const be of Se)Ee.push(de.substring(Ge,be)),Ge=be;return Ge<Re.length&&Ee.push(de.substring(Ge,Re.length)),Ee}(q,K3(q,m,c,e,n,M,z));const le=[],he={positionedLines:le,text:q.toString(),top:b[1],bottom:b[1],left:b[0],right:b[0],writingMode:T,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(de,Se,Ee,Re,Ge,be,Pe,Ue,je,at,Fe,nt){let Rt=0,$t=0,bt=0;const pt=Ue==="right"?1:Ue==="left"?0:.5;let Zt=!1;for(const qt of Ge){const Qt=qt.getSections();for(const yi of Qt){if(yi.imageName)continue;const di=Se[yi.fontStack];if(di&&(Zt=di.ascender!==void 0&&di.descender!==void 0,!Zt))break}if(!Zt)break}let Ft=0;for(const qt of Ge){qt.trim();const Qt=qt.getMaxScale(),yi=(Qt-1)*_r,di={positionedGlyphs:[],lineOffset:0};de.positionedLines[Ft]=di;const hi=di.positionedGlyphs;let bi=0;if(!qt.length()){$t+=be,++Ft;continue}let ki=0,sr=0;for(let Xt=0;Xt<qt.length();Xt++){const Fi=qt.getSection(Xt),vr=qt.getSectionIndex(Xt),oi=qt.getCharCode(Xt);let Mi=Fi.scale,Mr=null,Ii=null,Ui=null,lr=_r,rr=0;const mr=!(je===an.horizontal||!Fe&&!a(oi)||Fe&&(f9[oi]||(yt=oi,Dc(yt)||Lc(yt)||ja(yt)||sl(yt)||ll(yt))));if(Fi.imageName){const Cr=Re[Fi.imageName];if(!Cr)continue;Ui=Fi.imageName,de.iconsInText=de.iconsInText||!0,Ii=Cr.paddedRect;const cr=Cr.displaySize;Mi=Mi*_r/nt,Mr={width:cr[0],height:cr[1],left:1,top:-3,advance:mr?cr[1]:cr[0],localGlyph:!1},rr=Zt?-Mr.height*Mi:Qt*_r-17-cr[1]*Mi,lr=Mr.advance;const Mo=(mr?cr[0]:cr[1])*Mi-_r*Qt;Mo>0&&Mo>bi&&(bi=Mo)}else{const Cr=Ee[Fi.fontStack];if(!Cr)continue;Cr[oi]&&(Ii=Cr[oi]);const cr=Se[Fi.fontStack];if(!cr)continue;const Mo=cr.glyphs[oi];if(!Mo)continue;if(Mr=Mo.metrics,lr=oi!==8203?_r:0,Zt){const _1=cr.ascender!==void 0?Math.abs(cr.ascender):0,Ll=cr.descender!==void 0?Math.abs(cr.descender):0,Rl=(_1+Ll)*Mi;ki<Rl&&(ki=Rl,sr=(_1-Ll)/2*Mi),rr=-_1*Mi}else rr=(Qt-Mi)*_r-17}mr?(de.verticalizable=!0,hi.push({glyph:oi,imageName:Ui,x:Rt,y:$t+rr,vertical:mr,scale:Mi,localGlyph:Mr.localGlyph,fontStack:Fi.fontStack,sectionIndex:vr,metrics:Mr,rect:Ii}),Rt+=lr*Mi+at):(hi.push({glyph:oi,imageName:Ui,x:Rt,y:$t+rr,vertical:mr,scale:Mi,localGlyph:Mr.localGlyph,fontStack:Fi.fontStack,sectionIndex:vr,metrics:Mr,rect:Ii}),Rt+=Mr.advance*Mi+at)}hi.length!==0&&(bt=Math.max(Rt-at,bt),Zt?Lh(hi,pt,bi,sr,be*Qt/2):Lh(hi,pt,bi,0,be/2)),Rt=0;const Nr=be*Qt+bi;di.lineOffset=Math.max(bi,yi),$t+=Nr,++Ft}var yt;const Ki=$t,{horizontalAlign:Gi,verticalAlign:Oi}=Q3(Pe);(function(qt,Qt,yi,di,hi,bi){const ki=(Qt-yi)*hi,sr=-bi*di;for(const Nr of qt)for(const Xt of Nr.positionedGlyphs)Xt.x+=ki,Xt.y+=sr})(de.positionedLines,pt,Gi,Oi,bt,Ki),de.top+=-Oi*Ki,de.bottom=de.top+Ki,de.left+=-Gi*bt,de.right=de.left+bt,de.hasBaseline=Zt}(he,e,r,n,H,h,d,_,T,m,S,B),!function(de){for(const Se of de)if(Se.positionedGlyphs.length!==0)return!1;return!0}(le)&&he}const f9={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Hd={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ch(i,e,r,n,s,c){if(e.imageName){const h=n[e.imageName];return h?h.displaySize[0]*e.scale*_r/c+s:0}{const h=r[e.fontStack],d=h&&h.glyphs[i];return d?d.metrics.advance*e.scale+s:0}}function zh(i,e,r,n){const s=Math.pow(i-e,2);return n?i<e?s/2:2*s:s+Math.abs(r)*r}function Yd(i,e,r){let n=0;return i===10&&(n-=1e4),r&&(n+=150),i!==40&&i!==65288||(n+=50),e!==41&&e!==65289||(n+=50),n}function Ph(i,e,r,n,s,c){let h=null,d=zh(e,r,s,c);for(const _ of n){const m=zh(e-_.x,r,s,c)+_.badness;m<=d&&(h=_,d=m)}return{index:i,x:e,priorBreak:h,badness:d}}function Dh(i){return i?Dh(i.priorBreak).concat(i.index):[]}function K3(i,e,r,n,s,c,h){if(c!=="point")return[];if(!i)return[];const d=[],_=function(S,M,z,B,q,H){let se=0;for(let oe=0;oe<S.length();oe++){const le=S.getSection(oe);se+=Ch(S.getCharCode(oe),le,B,q,M,H)}return se/Math.max(1,Math.ceil(se/z))}(i,e,r,n,s,h),m=i.text.indexOf("\u200B")>=0;let b=0;for(let S=0;S<i.length();S++){const M=i.getSection(S),z=i.getCharCode(S);if(f9[z]||(b+=Ch(z,M,n,s,e,h)),S<i.length()-1){const B=!((T=z)<11904||!(rl(T)||il(T)||xo(T)||Gc(T)||Ys(T)||Rc(T)||nl(T)||Ws(T)||Oc(T)||al(T)||Hs(T)||Qs(T)||Xs(T)||$a(T)||Bc(T)||ol(T)||Js(T)||Uc(T)||Ks(T)||Fc(T)));(Hd[z]||B||M.imageName)&&d.push(Ph(S+1,b,_,d,Yd(z,i.getCharCode(S+1),B&&m),!1))}}var T;return Dh(Ph(i.length(),b,_,d,0,!0))}function Q3(i){let e=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Lh(i,e,r,n,s){if(!(e||r||n||s))return;const c=i.length-1,h=i[c],d=(h.x+h.metrics.advance*h.scale)*e;for(let _=0;_<=c;_++)i[_].x-=d,i[_].y+=r+n+s}function Kd(i,e,r){const{horizontalAlign:n,verticalAlign:s}=Q3(r),c=e[0]-i.displaySize[0]*n,h=e[1]-i.displaySize[1]*s;return{image:i,top:h,bottom:h+i.displaySize[1],left:c,right:c+i.displaySize[0]}}function Rh(i,e,r,n,s,c){const h=i.image;let d;if(h.content){const q=h.content,H=h.pixelRatio||1;d=[q[0]/H,q[1]/H,h.displaySize[0]-q[2]/H,h.displaySize[1]-q[3]/H]}const _=e.left*c,m=e.right*c;let b,T,S,M;r==="width"||r==="both"?(M=s[0]+_-n[3],T=s[0]+m+n[1]):(M=s[0]+(_+m-h.displaySize[0])/2,T=M+h.displaySize[0]);const z=e.top*c,B=e.bottom*c;return r==="height"||r==="both"?(b=s[1]+z-n[0],S=s[1]+B+n[2]):(b=s[1]+(z+B-h.displaySize[1])/2,S=b+h.displaySize[1]),{image:h,top:b,right:T,bottom:S,left:M,collisionPadding:d}}class ko extends N{constructor(e,r,n,s,c){super(e,r),this.angle=s,this.z=n,c!==void 0&&(this.segment=c)}clone(){return new ko(this.x,this.y,this.z,this.angle,this.segment)}}function Bh(i,e,r,n,s){if(e.segment===void 0)return!0;let c=e,h=e.segment+1,d=0;for(;d>-r/2;){if(h--,h<0)return!1;d-=i[h].dist(c),c=i[h]}d+=i[h].dist(i[h+1]),h++;const _=[];let m=0;for(;d<r/2;){const b=i[h],T=i[h+1];if(!T)return!1;let S=i[h-1].angleTo(b)-b.angleTo(T);for(S=Math.abs((S+3*Math.PI)%(2*Math.PI)-Math.PI),_.push({distance:d,angleDelta:S}),m+=S;d-_[0].distance>n;)m-=_.shift().angleDelta;if(m>s)return!1;h++,d+=b.dist(T)}return!0}function Oh(i){let e=0;for(let r=0;r<i.length-1;r++)e+=i[r].dist(i[r+1]);return e}function Fh(i,e,r){return i?.6*e*r:0}function Nh(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function Qd(i,e,r,n,s,c){const h=Fh(r,s,c),d=Nh(r,n)*c;let _=0;const m=Oh(i)/2;for(let b=0;b<i.length-1;b++){const T=i[b],S=i[b+1],M=T.dist(S);if(_+M>m){const z=(m-_)/M,B=Yt(T.x,S.x,z),q=Yt(T.y,S.y,z),H=new ko(B,q,0,S.angleTo(T),b);return!h||Bh(i,H,d,h,e)?H:void 0}_+=M}}function ef(i,e,r,n,s,c,h,d,_){const m=Fh(n,c,h),b=Nh(n,s),T=b*h,S=i[0].x===0||i[0].x===_||i[0].y===0||i[0].y===_;return e-T<e/4&&(e=T+e/4),Gh(i,S?e/2*d%e:(b/2+2*c)*h*d%e,e,m,r,T,S,!1,_)}function Gh(i,e,r,n,s,c,h,d,_){const m=c/2,b=Oh(i);let T=0,S=e-r,M=[];for(let z=0;z<i.length-1;z++){const B=i[z],q=i[z+1],H=B.dist(q),se=q.angleTo(B);for(;S+r<T+H;){S+=r;const oe=(S-T)/H,le=Yt(B.x,q.x,oe),he=Yt(B.y,q.y,oe);if(le>=0&&le<_&&he>=0&&he<_&&S-m>=0&&S+m<=b){const de=new ko(le,he,0,se,z);de._round(),n&&!Bh(i,de,c,n,s)||M.push(de)}}T+=H}return d||M.length||h||(M=Gh(i,T/2,r,n,s,c,h,!0,_)),M}function Uh(i,e,r,n,s){const c=[];for(let h=0;h<i.length;h++){const d=i[h];let _;for(let m=0;m<d.length-1;m++){let b=d[m],T=d[m+1];b.x<e&&T.x<e||(b.x<e?b=new N(e,b.y+(e-b.x)/(T.x-b.x)*(T.y-b.y))._round():T.x<e&&(T=new N(e,b.y+(e-b.x)/(T.x-b.x)*(T.y-b.y))._round()),b.y<r&&T.y<r||(b.y<r?b=new N(b.x+(r-b.y)/(T.y-b.y)*(T.x-b.x),r)._round():T.y<r&&(T=new N(b.x+(r-b.y)/(T.y-b.y)*(T.x-b.x),r)._round()),b.x>=n&&T.x>=n||(b.x>=n?b=new N(n,b.y+(n-b.x)/(T.x-b.x)*(T.y-b.y))._round():T.x>=n&&(T=new N(n,b.y+(n-b.x)/(T.x-b.x)*(T.y-b.y))._round()),b.y>=s&&T.y>=s||(b.y>=s?b=new N(b.x+(s-b.y)/(T.y-b.y)*(T.x-b.x),s)._round():T.y>=s&&(T=new N(b.x+(s-b.y)/(T.y-b.y)*(T.x-b.x),s)._round()),_&&b.equals(_[_.length-1])||(_=[b],c.push(_)),_.push(T)))))}}return c}ct(ko,"Anchor");const Sl=1e20;function Vh(i,e,r,n,s,c,h,d,_){for(let m=e;m<e+n;m++)jh(i,r*c+m,c,s,h,d,_);for(let m=r;m<r+s;m++)jh(i,m*c+e,1,n,h,d,_)}function jh(i,e,r,n,s,c,h){c[0]=0,h[0]=-Sl,h[1]=Sl,s[0]=i[e];for(let d=1,_=0,m=0;d<n;d++){s[d]=i[e+d*r];const b=d*d;do{const T=c[_];m=(s[d]-s[T]+b-T*T)/(d-T)/2}while(m<=h[_]&&--_>-1);_++,c[_]=d,h[_]=m,h[_+1]=Sl}for(let d=0,_=0;d<n;d++){for(;h[_+1]<d;)_++;const m=c[_],b=d-m;i[e+d*r]=s[m]+b*b}}const e0={none:0,ideographs:1,all:2};class u1{constructor(e,r,n){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,r){const n=[];for(const s in e)for(const c of e[s])n.push({stack:s,id:c});gt(n,({stack:s,id:c},h)=>{let d=this.entries[s];d||(d=this.entries[s]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let _=d.glyphs[c];if(_!==void 0)return void h(null,{stack:s,id:c,glyph:_});if(_=this._tinySDF(d,s,c),_)return d.glyphs[c]=_,void h(null,{stack:s,id:c,glyph:_});const m=Math.floor(c/256);if(256*m>65535)return void h(new Error("glyphs > 65535 not supported"));if(d.ranges[m])return void h(null,{stack:s,id:c,glyph:_});let b=d.requests[m];b||(b=d.requests[m]=[],u1.loadGlyphRange(s,m,this.url,this.requestManager,(T,S)=>{if(S){d.ascender=S.ascender,d.descender=S.descender;for(const M in S.glyphs)this._doesCharSupportLocalGlyph(+M)||(d.glyphs[+M]=S.glyphs[+M]);d.ranges[m]=!0}for(const M of b)M(T,S);delete d.requests[m]})),b.push((T,S)=>{T?h(T):S&&h(null,{stack:s,id:c,glyph:S.glyphs[c]||null})})},(s,c)=>{if(s)r(s);else if(c){const h={};for(const{stack:d,id:_,glyph:m}of c)h[d]===void 0&&(h[d]={}),h[d].glyphs===void 0&&(h[d].glyphs={}),h[d].glyphs[_]=m&&{id:m.id,bitmap:m.bitmap.clone(),metrics:m.metrics},h[d].ascender=this.entries[d].ascender,h[d].descender=this.entries[d].descender;r(null,h)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==e0.none&&(this.localGlyphMode===e0.all?!!this.localFontFamily:!!this.localFontFamily&&(al(e)||Nc(e)||Xs(e)||Js(e)||Ws(e)))}_tinySDF(e,r,n){const s=this.localFontFamily;if(!s||!this._doesCharSupportLocalGlyph(n))return;let c=e.tinySDF;if(!c){let B="400";/bold/i.test(r)?B="900":/medium/i.test(r)?B="500":/light/i.test(r)&&(B="200"),c=e.tinySDF=new u1.TinySDF({fontFamily:s,fontWeight:B,fontSize:48,buffer:6,radius:16}),c.fontWeight=B}if(this.localGlyphs[c.fontWeight][n])return this.localGlyphs[c.fontWeight][n];const h=String.fromCharCode(n),{data:d,width:_,height:m,glyphWidth:b,glyphHeight:T,glyphLeft:S,glyphTop:M,glyphAdvance:z}=c.draw(h);return this.localGlyphs[c.fontWeight][n]={id:n,bitmap:new Eo({width:_,height:m},d),metrics:{width:b/2,height:T/2,left:S/2,top:M/2-27,advance:z/2,localGlyph:!0}}}}function $h(i,e,r,n){const s=[],c=i.image,h=c.pixelRatio,d=c.paddedRect.w-2,_=c.paddedRect.h-2,m=i.right-i.left,b=i.bottom-i.top,T=c.stretchX||[[0,d]],S=c.stretchY||[[0,_]],M=(be,Pe)=>be+Pe[1]-Pe[0],z=T.reduce(M,0),B=S.reduce(M,0),q=d-z,H=_-B;let se=0,oe=z,le=0,he=B,de=0,Se=q,Ee=0,Re=H;if(c.content&&n){const be=c.content;se=_9(T,0,be[0]),le=_9(S,0,be[1]),oe=_9(T,be[0],be[2]),he=_9(S,be[1],be[3]),de=be[0]-se,Ee=be[1]-le,Se=be[2]-be[0]-oe,Re=be[3]-be[1]-he}const Ge=(be,Pe,Ue,je)=>{const at=m9(be.stretch-se,oe,m,i.left),Fe=g9(be.fixed-de,Se,be.stretch,z),nt=m9(Pe.stretch-le,he,b,i.top),Rt=g9(Pe.fixed-Ee,Re,Pe.stretch,B),$t=m9(Ue.stretch-se,oe,m,i.left),bt=g9(Ue.fixed-de,Se,Ue.stretch,z),pt=m9(je.stretch-le,he,b,i.top),Zt=g9(je.fixed-Ee,Re,je.stretch,B),Ft=new N(at,nt),yt=new N($t,nt),Ki=new N($t,pt),Gi=new N(at,pt),Oi=new N(Fe/h,Rt/h),qt=new N(bt/h,Zt/h),Qt=e*Math.PI/180;if(Qt){const hi=Math.sin(Qt),bi=Math.cos(Qt),ki=[bi,-hi,hi,bi];Ft._matMult(ki),yt._matMult(ki),Gi._matMult(ki),Ki._matMult(ki)}const yi=be.stretch+be.fixed,di=Pe.stretch+Pe.fixed;return{tl:Ft,tr:yt,bl:Gi,br:Ki,tex:{x:c.paddedRect.x+1+yi,y:c.paddedRect.y+1+di,w:Ue.stretch+Ue.fixed-yi,h:je.stretch+je.fixed-di},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oi,pixelOffsetBR:qt,minFontScaleX:Se/h/m,minFontScaleY:Re/h/b,isSDF:r}};if(n&&(c.stretchX||c.stretchY)){const be=Zh(T,q,z),Pe=Zh(S,H,B);for(let Ue=0;Ue<be.length-1;Ue++){const je=be[Ue],at=be[Ue+1];for(let Fe=0;Fe<Pe.length-1;Fe++)s.push(Ge(je,Pe[Fe],at,Pe[Fe+1]))}}else s.push(Ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:d+1},{fixed:0,stretch:_+1}));return s}function _9(i,e,r){let n=0;for(const s of i)n+=Math.max(e,Math.min(r,s[1]))-Math.max(e,Math.min(r,s[0]));return n}function Zh(i,e,r){const n=[{fixed:-1,stretch:0}];for(const[s,c]of i){const h=n[n.length-1];n.push({fixed:s-h.stretch,stretch:h.stretch}),n.push({fixed:s-h.stretch,stretch:h.stretch+(c-s)})}return n.push({fixed:e+1,stretch:r}),n}function m9(i,e,r,n){return i/e*r+n}function g9(i,e,r,n){return i-e*r/n}function tf(i,e,r,n){const s=e+i.positionedLines[n].lineOffset;return n===0?r+s/2:r+(s+(e+i.positionedLines[n-1].lineOffset))/2}u1.loadGlyphRange=function(i,e,r,n,s){const c=256*e,h=c+255,d=n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}",i).replace("{range}",`${c}-${h}`),ie.Glyphs);pe(d,(_,m)=>{if(_)s(_);else if(m){const b={},T=function(S){return new Tl(S).readFields(Wd,{})}(m);for(const S of T.glyphs)b[S.id]=S;s(null,{glyphs:b,ascender:T.ascender,descender:T.descender})}})},u1.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:r=8,cutoff:n=.25,fontFamily:s="sans-serif",fontWeight:c="normal",fontStyle:h="normal"}={}){this.buffer=e,this.cutoff=n,this.radius=r;const d=this.size=i+4*e,_=this._createCanvas(d),m=this.ctx=_.getContext("2d",{willReadFrequently:!0});m.font=`${h} ${c} ${i}px ${s}`,m.textBaseline="alphabetic",m.textAlign="left",m.fillStyle="black",this.gridOuter=new Float64Array(d*d),this.gridInner=new Float64Array(d*d),this.f=new Float64Array(d),this.z=new Float64Array(d+1),this.v=new Uint16Array(d)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:s,actualBoundingBoxRight:c}=this.ctx.measureText(i),h=Math.ceil(r),d=Math.min(this.size-this.buffer,Math.ceil(c-s)),_=Math.min(this.size-this.buffer,h+Math.ceil(n)),m=d+2*this.buffer,b=_+2*this.buffer,T=Math.max(m*b,0),S=new Uint8ClampedArray(T),M={data:S,width:m,height:b,glyphWidth:d,glyphHeight:_,glyphTop:h,glyphLeft:0,glyphAdvance:e};if(d===0||_===0)return M;const{ctx:z,buffer:B,gridInner:q,gridOuter:H}=this;z.clearRect(B,B,d,_),z.fillText(i,B,B+h);const se=z.getImageData(B,B,d,_);H.fill(Sl,0,T),q.fill(0,0,T);for(let oe=0;oe<_;oe++)for(let le=0;le<d;le++){const he=se.data[4*(oe*d+le)+3]/255;if(he===0)continue;const de=(oe+B)*m+le+B;if(he===1)H[de]=0,q[de]=Sl;else{const Se=.5-he;H[de]=Se>0?Se*Se:0,q[de]=Se<0?Se*Se:0}}Vh(H,0,0,m,b,m,this.f,this.v,this.z),Vh(q,B,B,d,_,m,this.f,this.v,this.z);for(let oe=0;oe<T;oe++){const le=Math.sqrt(H[oe])-Math.sqrt(q[oe]);S[oe]=Math.round(255-255*(le/this.radius+this.cutoff))}return M}};class rf{constructor(e=[],r=nf){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,s=r[e];for(;e>0;){const c=e-1>>1,h=r[c];if(n(s,h)>=0)break;r[e]=h,e=c}r[e]=s}_down(e){const{data:r,compare:n}=this,s=this.length>>1,c=r[e];for(;e<s;){let h=1+(e<<1),d=r[h];const _=h+1;if(_<this.length&&n(r[_],d)<0&&(h=_,d=r[_]),n(d,c)>=0)break;r[e]=d,e=h}r[e]=c}}function nf(i,e){return i<e?-1:i>e?1:0}function of(i,e=1,r=!1){let n=1/0,s=1/0,c=-1/0,h=-1/0;const d=i[0];for(let M=0;M<d.length;M++){const z=d[M];(!M||z.x<n)&&(n=z.x),(!M||z.y<s)&&(s=z.y),(!M||z.x>c)&&(c=z.x),(!M||z.y>h)&&(h=z.y)}const _=Math.min(c-n,h-s);let m=_/2;const b=new rf([],af);if(_===0)return new N(n,s);for(let M=n;M<c;M+=_)for(let z=s;z<h;z+=_)b.push(new h1(M+m,z+m,m,i));let T=function(M){let z=0,B=0,q=0;const H=M[0];for(let se=0,oe=H.length,le=oe-1;se<oe;le=se++){const he=H[se],de=H[le],Se=he.x*de.y-de.x*he.y;B+=(he.x+de.x)*Se,q+=(he.y+de.y)*Se,z+=3*Se}return new h1(B/z,q/z,0,M)}(i),S=b.length;for(;b.length;){const M=b.pop();(M.d>T.d||!T.d)&&(T=M,r&&console.log("found best %d after %d probes",Math.round(1e4*M.d)/1e4,S)),M.max-T.d<=e||(m=M.h/2,b.push(new h1(M.p.x-m,M.p.y-m,m,i)),b.push(new h1(M.p.x+m,M.p.y-m,m,i)),b.push(new h1(M.p.x-m,M.p.y+m,m,i)),b.push(new h1(M.p.x+m,M.p.y+m,m,i)),S+=4)}return r&&(console.log(`num probes: ${S}`),console.log(`best distance: ${T.d}`)),T.p}function af(i,e){return e.max-i.max}function h1(i,e,r,n){this.p=new N(i,e),this.h=r,this.d=function(s,c){let h=!1,d=1/0;for(let _=0;_<c.length;_++){const m=c[_];for(let b=0,T=m.length,S=T-1;b<T;S=b++){const M=m[b],z=m[S];M.y>s.y!=z.y>s.y&&s.x<(z.x-M.x)*(s.y-M.y)/(z.y-M.y)+M.x&&(h=!h),d=Math.min(d,Fu(s,M,z))}}return(h?1:-1)*Math.sqrt(d)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}const t0=Number.POSITIVE_INFINITY,sf=Math.sqrt(2);function qh(i,e){return e[1]!==t0?function(r,n,s){let c=0,h=0;switch(n=Math.abs(n),s=Math.abs(s),r){case"top-right":case"top-left":case"top":h=s-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-s}switch(r){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}return[c,h]}(i,e[0],e[1]):function(r,n){let s=0,c=0;n<0&&(n=0);const h=n/sf;switch(r){case"top-right":case"top-left":c=h-7;break;case"bottom-right":case"bottom-left":c=7-h;break;case"bottom":c=7-n;break;case"top":c=n-7}switch(r){case"top-right":case"bottom-right":s=-h;break;case"top-left":case"bottom-left":s=h;break;case"left":s=n;break;case"right":s=-n}return[s,c]}(i,e[0])}function lf(i,e,r,n,s,c,h,d,_,m){i.createArrays(),i.tilePixelRatio=kt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const b=i.layers[0].layout,T=i.layers[0]._unevaluatedLayout._values,S={};if(i.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:q}=i.textSizeData;S.compositeTextSizes=[T["text-size"].possiblyEvaluate(new V(B),d),T["text-size"].possiblyEvaluate(new V(q),d)]}if(i.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:q}=i.iconSizeData;S.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new V(B),d),T["icon-size"].possiblyEvaluate(new V(q),d)]}S.layoutTextSize=T["text-size"].possiblyEvaluate(new V(_+1),d),S.layoutIconSize=T["icon-size"].possiblyEvaluate(new V(_+1),d),S.textMaxSize=T["text-size"].possiblyEvaluate(new V(18),d);const M=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point",z=b.get("text-size");for(const B of i.features){const q=b.get("text-font").evaluate(B,{},d).join(","),H=z.evaluate(B,{},d),se=S.layoutTextSize.evaluate(B,{},d),oe=(S.layoutIconSize.evaluate(B,{},d),{horizontal:{},vertical:void 0}),le=B.text;let he,de=[0,0];if(le){const Re=le.toString(),Ge=b.get("text-letter-spacing").evaluate(B,{},d)*_r,be=b.get("text-line-height").evaluate(B,{},d)*_r,Pe=l(Re)?Ge:0,Ue=b.get("text-anchor").evaluate(B,{},d),je=b.get("text-variable-anchor");if(!je){const bt=b.get("text-radial-offset").evaluate(B,{},d);de=bt?qh(Ue,[bt*_r,t0]):b.get("text-offset").evaluate(B,{},d).map(pt=>pt*_r)}let at=M?"center":b.get("text-justify").evaluate(B,{},d);const Fe=b.get("symbol-placement"),nt=Fe==="point",Rt=Fe==="point"?b.get("text-max-width").evaluate(B,{},d)*_r:0,$t=bt=>{i.allowVerticalPlacement&&Ho(Re)&&(oe.vertical=Y3(le,e,r,s,q,Rt,be,Ue,bt,Pe,de,an.vertical,!0,Fe,se,H))};if(!M&&je){const bt=at==="auto"?je.map(Zt=>i0(Zt)):[at];let pt=!1;for(let Zt=0;Zt<bt.length;Zt++){const Ft=bt[Zt];if(!oe.horizontal[Ft])if(pt)oe.horizontal[Ft]=oe.horizontal[0];else{const yt=Y3(le,e,r,s,q,Rt,be,"center",Ft,Pe,de,an.horizontal,!1,Fe,se,H);yt&&(oe.horizontal[Ft]=yt,pt=yt.positionedLines.length===1)}}$t("left")}else{if(at==="auto"&&(at=i0(Ue)),nt||b.get("text-writing-mode").indexOf("horizontal")>=0||!Ho(Re)){const bt=Y3(le,e,r,s,q,Rt,be,Ue,at,Pe,de,an.horizontal,!1,Fe,se,H);bt&&(oe.horizontal[at]=bt)}$t(Fe==="point"?"left":at)}}let Se=!1;if(B.icon&&B.icon.name){const Re=n[B.icon.name];Re&&(he=Kd(s[B.icon.name],b.get("icon-offset").evaluate(B,{},d),b.get("icon-anchor").evaluate(B,{},d)),Se=Re.sdf,i.sdfIcons===void 0?i.sdfIcons=Re.sdf:i.sdfIcons!==Re.sdf&&_t("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Re.pixelRatio!==i.pixelRatio||b.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Ee=Xh(oe.horizontal)||oe.vertical;i.iconsInText||(i.iconsInText=!!Ee&&Ee.iconsInText),(Ee||he)&&cf(i,B,oe,he,n,S,se,0,de,Se,h,d,m)}c&&i.generateCollisionDebugBuffers(_,i.collisionBoxArray)}function i0(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cf(i,e,r,n,s,c,h,d,_,m,b,T,S){let M=c.textMaxSize.evaluate(e,{},T);M===void 0&&(M=h);const z=i.layers[0].layout,B=z.get("icon-offset").evaluate(e,{},T),q=Xh(r.horizontal)||r.vertical,H=S.name==="globe",se=h/24,oe=i.tilePixelRatio*M/24,le=(Pe=i.overscaling,i.zoom>18&&Pe>2&&(Pe>>=1),Math.max(kt/(512*Pe),1)*z.get("symbol-spacing")),he=z.get("text-padding")*i.tilePixelRatio,de=z.get("icon-padding")*i.tilePixelRatio,Se=Ce(z.get("text-max-angle")),Ee=z.get("text-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",Re=z.get("icon-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",Ge=z.get("symbol-placement"),be=le/2;var Pe;const Ue=z.get("icon-text-fit");let je;n&&Ue!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(je=Rh(n,r.vertical,Ue,z.get("icon-text-fit-padding"),B,se)),q&&(n=Rh(n,q,Ue,z.get("icon-text-fit-padding"),B,se)));const at=(Fe,nt,Rt)=>{if(nt.x<0||nt.x>=kt||nt.y<0||nt.y>=kt)return;let $t=null;if(H){const{x:bt,y:pt,z:Zt}=S.projectTilePoint(nt.x,nt.y,Rt);$t={anchor:new ko(bt,pt,Zt,0,void 0),up:S.upVector(Rt,nt.x,nt.y)}}(function(bt,pt,Zt,Ft,yt,Ki,Gi,Oi,qt,Qt,yi,di,hi,bi,ki,sr,Nr,Xt,Fi,vr,oi,Mi,Mr,Ii,Ui){const lr=bt.addToLineVertexArray(pt,Ft);let rr,mr,Cr,cr,Mo,_1,Ll,Rl=0,z2=0,P2=0,D2=0,x0=-1,v0=-1;const io={};let L2=cl("");const is=Zt?Zt.anchor:pt;let b0=0,w0=0;if(qt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[b0,w0]=qt.layout.get("text-offset").evaluate(oi,{},Ui).map(Kr=>Kr*_r):(b0=qt.layout.get("text-radial-offset").evaluate(oi,{},Ui)*_r,w0=t0),bt.allowVerticalPlacement&&yt.vertical){const Kr=yt.vertical;if(ki)_1=r0(Kr),Oi&&(Ll=r0(Oi));else{const Qr=qt.layout.get("text-rotate").evaluate(oi,{},Ui)+90;Cr=y9(Qt,is,pt,yi,di,hi,Kr,bi,Qr,sr),Oi&&(cr=y9(Qt,is,pt,yi,di,hi,Oi,Xt,Qr))}}if(Ki){const Kr=qt.layout.get("icon-rotate").evaluate(oi,{},Ui),Qr=qt.layout.get("icon-text-fit")!=="none",Bl=$h(Ki,Kr,Mr,Qr),I0=Oi?$h(Oi,Kr,Mr,Qr):void 0;mr=y9(Qt,is,pt,yi,di,hi,Ki,Xt,Kr),Rl=4*Bl.length;const R2=bt.iconSizeData;let rs=null;R2.kind==="source"?(rs=[Yn*qt.layout.get("icon-size").evaluate(oi,{},Ui)],rs[0]>na&&_t(`${bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):R2.kind==="composite"&&(rs=[Yn*Mi.compositeIconSizes[0].evaluate(oi,{},Ui),Yn*Mi.compositeIconSizes[1].evaluate(oi,{},Ui)],(rs[0]>na||rs[1]>na)&&_t(`${bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,Bl,rs,vr,Fi,oi,!1,Zt,pt,lr.lineStartIndex,lr.lineLength,-1,Ii,Ui),x0=bt.icon.placedSymbolArray.length-1,I0&&(z2=4*I0.length,bt.addSymbols(bt.icon,I0,rs,vr,Fi,oi,an.vertical,Zt,pt,lr.lineStartIndex,lr.lineLength,-1,Ii,Ui),v0=bt.icon.placedSymbolArray.length-1)}for(const Kr in yt.horizontal){const Qr=yt.horizontal[Kr];rr||(L2=cl(Qr.text),ki?Mo=r0(Qr):rr=y9(Qt,is,pt,yi,di,hi,Qr,bi,qt.layout.get("text-rotate").evaluate(oi,{},Ui),sr));const Bl=Qr.positionedLines.length===1;if(P2+=Wh(bt,Zt,pt,Qr,Gi,qt,ki,oi,sr,lr,yt.vertical?an.horizontal:an.horizontalOnly,Bl?Object.keys(yt.horizontal):[Kr],io,x0,Mi,Ii,Ui),Bl)break}yt.vertical&&(D2+=Wh(bt,Zt,pt,yt.vertical,Gi,qt,ki,oi,sr,lr,an.vertical,["vertical"],io,v0,Mi,Ii,Ui));let ua=-1;const T0=(Kr,Qr)=>Kr?Math.max(Kr,Qr):Qr;ua=T0(Mo,ua),ua=T0(_1,ua),ua=T0(Ll,ua);const Uf=ua>-1?1:0;bt.glyphOffsetArray.length>=aa.MAX_GLYPHS&&_t("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),oi.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,oi.sortKey),bt.symbolInstances.emplaceBack(is.x,is.y,is.z,pt.x,pt.y,io.right>=0?io.right:-1,io.center>=0?io.center:-1,io.left>=0?io.left:-1,io.vertical>=0?io.vertical:-1,x0,v0,L2,rr!==void 0?rr:bt.collisionBoxArray.length,rr!==void 0?rr+1:bt.collisionBoxArray.length,Cr!==void 0?Cr:bt.collisionBoxArray.length,Cr!==void 0?Cr+1:bt.collisionBoxArray.length,mr!==void 0?mr:bt.collisionBoxArray.length,mr!==void 0?mr+1:bt.collisionBoxArray.length,cr||bt.collisionBoxArray.length,cr?cr+1:bt.collisionBoxArray.length,yi,P2,D2,Rl,z2,Uf,0,b0,w0,ua)})(i,nt,$t,Fe,r,n,s,je,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,he,Ee,_,0,de,Re,B,e,c,m,b,T)};if(Ge==="line")for(const Fe of Uh(e.geometry,0,0,kt,kt)){const nt=ef(Fe,le,Se,r.vertical||q,n,24,oe,i.overscaling,kt);for(const Rt of nt){const $t=q;$t&&uf(i,$t.text,be,Rt)||at(Fe,Rt,T)}}else if(Ge==="line-center"){for(const Fe of e.geometry)if(Fe.length>1){const nt=Qd(Fe,Se,r.vertical||q,n,24,oe);nt&&at(Fe,nt,T)}}else if(e.type==="Polygon")for(const Fe of $3(e.geometry,0)){const nt=of(Fe,16);at(Fe[0],new ko(nt.x,nt.y,0,0,void 0),T)}else if(e.type==="LineString")for(const Fe of e.geometry)at(Fe,new ko(Fe[0].x,Fe[0].y,0,0,void 0),T);else if(e.type==="Point")for(const Fe of e.geometry)for(const nt of Fe)at([nt],new ko(nt.x,nt.y,0,0,void 0),T)}const na=32640;function Wh(i,e,r,n,s,c,h,d,_,m,b,T,S,M,z,B,q){const H=function(le,he,de,Se,Ee,Re,Ge,be){const Pe=[];if(he.positionedLines.length===0)return Pe;const Ue=Se.layout.get("text-rotate").evaluate(Re,{})*Math.PI/180,je=function($t){const bt=$t[0],pt=$t[1],Zt=bt*pt;return Zt>0?[bt,-pt]:Zt<0?[-bt,pt]:bt===0?[pt,bt]:[pt,-bt]}(de);let at=Math.abs(he.top-he.bottom);for(const $t of he.positionedLines)at-=$t.lineOffset;const Fe=he.positionedLines.length,nt=at/Fe;let Rt=he.top-de[1];for(let $t=0;$t<Fe;++$t){const bt=he.positionedLines[$t];Rt=tf(he,nt,Rt,$t);for(const pt of bt.positionedGlyphs){if(!pt.rect)continue;const Zt=pt.rect||{};let Ft=4,yt=!0,Ki=1,Gi=0;if(pt.imageName){const Ii=Ge[pt.imageName];if(!Ii)continue;if(Ii.sdf){_t("SDF images are not supported in formatted text and will be ignored.");continue}yt=!1,Ki=Ii.pixelRatio,Ft=1/Ki}const Oi=(Ee||be)&&pt.vertical,qt=pt.metrics.advance*pt.scale/2,Qt=pt.metrics,yi=pt.rect;if(yi===null)continue;be&&he.verticalizable&&(Gi=pt.imageName?qt-pt.metrics.width*pt.scale/2:0);const di=Ee?[pt.x+qt,pt.y]:[0,0];let hi=[0,0],bi=[0,0],ki=!1;Ee||(Oi?(bi=[pt.x+qt+je[0],pt.y+je[1]-Gi],ki=!0):hi=[pt.x+qt+de[0],pt.y+de[1]-Gi]);const sr=yi.w*pt.scale/(Ki*(pt.localGlyph?2:1)),Nr=yi.h*pt.scale/(Ki*(pt.localGlyph?2:1));let Xt,Fi,vr,oi;if(Oi){const Ii=pt.y-Rt,Ui=new N(-qt,qt-Ii),lr=-Math.PI/2,rr=new N(...bi);Xt=new N(-qt+hi[0],hi[1]),Xt._rotateAround(lr,Ui)._add(rr),Xt.x+=-Ii+qt,Xt.y-=(Qt.left-Ft)*pt.scale;const mr=pt.imageName?Qt.advance*pt.scale:_r*pt.scale,Cr=String.fromCharCode(pt.glyph);Bd(Cr)?Xt.x+=(1-Ft)*pt.scale:Od(Cr)?Xt.x+=mr-Qt.height*pt.scale+(-Ft-1)*pt.scale:Xt.x+=pt.imageName||Qt.width+2*Ft===yi.w&&Qt.height+2*Ft===yi.h?(mr-Nr)/2:(mr-(Qt.height+2*Ft)*pt.scale)/2,Fi=new N(Xt.x,Xt.y-sr),vr=new N(Xt.x+Nr,Xt.y),oi=new N(Xt.x+Nr,Xt.y-sr)}else{const Ii=(Qt.left-Ft)*pt.scale-qt+hi[0],Ui=(-Qt.top-Ft)*pt.scale+hi[1],lr=Ii+sr,rr=Ui+Nr;Xt=new N(Ii,Ui),Fi=new N(lr,Ui),vr=new N(Ii,rr),oi=new N(lr,rr)}if(Ue){let Ii;Ii=Ee?new N(0,0):ki?new N(je[0],je[1]):new N(de[0],de[1]),Xt._rotateAround(Ue,Ii),Fi._rotateAround(Ue,Ii),vr._rotateAround(Ue,Ii),oi._rotateAround(Ue,Ii)}const Mi=new N(0,0),Mr=new N(0,0);Pe.push({tl:Xt,tr:Fi,bl:vr,br:oi,tex:Zt,writingMode:he.writingMode,glyphOffset:di,sectionIndex:pt.sectionIndex,isSDF:yt,pixelOffsetTL:Mi,pixelOffsetBR:Mr,minFontScaleX:0,minFontScaleY:0})}}return Pe}(0,n,_,c,h,d,s,i.allowVerticalPlacement),se=i.textSizeData;let oe=null;se.kind==="source"?(oe=[Yn*c.layout.get("text-size").evaluate(d,{},q)],oe[0]>na&&_t(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):se.kind==="composite"&&(oe=[Yn*z.compositeTextSizes[0].evaluate(d,{},q),Yn*z.compositeTextSizes[1].evaluate(d,{},q)],(oe[0]>na||oe[1]>na)&&_t(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,H,oe,_,h,d,b,e,r,m.lineStartIndex,m.lineLength,M,B,q);for(const le of T)S[le]=i.text.placedSymbolArray.length-1;return 4*H.length}function Xh(i){for(const e in i)return i[e];return null}function y9(i,e,r,n,s,c,h,d,_,m){let b=h.top,T=h.bottom,S=h.left,M=h.right;const z=h.collisionPadding;if(z&&(S-=z[0],b-=z[1],M+=z[2],T+=z[3]),_){const B=new N(S,b),q=new N(M,b),H=new N(S,T),se=new N(M,T),oe=Ce(_);let le=new N(0,0);m&&(le=new N(m[0],m[1])),B._rotateAround(oe,le),q._rotateAround(oe,le),H._rotateAround(oe,le),se._rotateAround(oe,le),S=Math.min(B.x,q.x,H.x,se.x),M=Math.max(B.x,q.x,H.x,se.x),b=Math.min(B.y,q.y,H.y,se.y),T=Math.max(B.y,q.y,H.y,se.y)}return i.emplaceBack(e.x,e.y,e.z,r.x,r.y,S,b,M,T,d,n,s,c),i.length-1}function r0(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function uf(i,e,r,n){const s=i.compareText;if(e in s){const c=s[e];for(let h=c.length-1;h>=0;h--)if(n.dist(c[h])<r)return!0}else s[e]=[];return s[e].push(n),!1}const hf=ut([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),{members:Jh}=hf,Hh=ut([{name:"a_pos_3",components:3,type:"Int16"}]);var El=ut([{name:"a_pos",type:"Int16",components:2}]);const Qa=kt/Math.PI/2,n0=2*mn(1,0)*Qa*Math.PI,p1=[64,32,16],Hr=-Qa,Yr=Qa,pf=[new on([Hr,Hr,Hr],[Yr,Yr,Yr]),new on([Hr,Hr,Hr],[0,0,Yr]),new on([0,Hr,Hr],[Yr,0,Yr]),new on([Hr,0,Hr],[0,Yr,Yr]),new on([0,0,Hr],[Yr,Yr,Yr])];function Yh(i,e,r,n=!0){const s=Hn([],i._camera.position,i.worldSize),c=[e,r,1,1];Ya(c,c,i.pixelMatrixInverse),Xu(c,c,1/c[3]);const h=Er([],yn([],c,s)),d=i.globeMatrix,_=[d[12],d[13],d[14]],m=yn([],_,s),b=hl(m),T=Er([],m),S=i.worldSize/(2*Math.PI),M=gn(T,h),z=Math.asin(S/b);if(z<Math.acos(M)){if(!n)return null;const Ge=[],be=[];Hn(Ge,h,b/M),Er(be,yn(be,Ge,m)),Er(h,ia(h,m,Hn(h,be,Math.tan(z)*b)))}const B=[];new B3(s,h).closestPointOnSphere(_,S,B);const q=Er([],ji(d,0)),H=Er([],ji(d,1)),se=Er([],ji(d,2)),oe=gn(q,B),le=gn(H,B),he=gn(se,B),de=ke(Math.asin(-le/S));let Se=ke(Math.atan2(oe,he));Se=i.center.lng+function(Ge,be){const Pe=(be-Ge+180)%360-180;return Pe<-180?Pe+360:Pe}(i.center.lng,Se);const Ee=qa(Se),Re=xe(Wa(de),0,1);return new t1(Ee,Re)}class df{constructor(e,r,n){this.a=yn([],e,n),this.b=yn([],r,n),this.center=n;const s=Er([],this.a),c=Er([],this.b);this.angle=Math.acos(gn(s,c))}}function o0(i,e){if(i.angle===0)return null;let r;return r=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),r<0||r>1?null:function(n,s,c,h){const d=Math.sin(c);return n*(Math.sin((1-h)*c)/d)+s*(Math.sin(h*c)/d)}(i.a[e],i.b[e],i.angle,xe(r,0,1))+i.center[e]}function Kn(i){if(i.z<=1)return pf[i.z+2*i.y+i.x];const[e,r]=a0(i),n=[kr(e[0],e[1]),kr(e[0],r[1]),kr(r[0],e[1]),kr(r[0],r[1])],s=[Yr,Yr,Yr],c=[Hr,Hr,Hr];for(const h of n)s[0]=Math.min(s[0],h[0]),s[1]=Math.min(s[1],h[1]),s[2]=Math.min(s[2],h[2]),c[0]=Math.max(c[0],h[0]),c[1]=Math.max(c[1],h[1]),c[2]=Math.max(c[2],h[2]);return new on(s,c)}function ff(i,e,r){const n=e/i.worldSize,s=Number.MAX_VALUE,c=[-s,-s,-s],h=[s,s,s],d=Xr(new Float64Array(16));if(Jn(d,d,[n,n,n]),ta(d,d,i.globeMatrix),r.z<=1){const be=Kn(r).getCorners();for(let Pe=0;Pe<be.length;Pe++)fr(be[Pe],be[Pe],d),Qc(h,h,be[Pe]),e9(c,c,be[Pe]);return new on(h,c)}const[_,m]=a0(r),b=new ea;b.setSouthWest([_[1],m[0]]),b.setNorthEast([m[1],_[0]]);const T=[kr(b.getSouth(),b.getWest()),kr(b.getSouth(),b.getEast()),kr(b.getNorth(),b.getEast()),kr(b.getNorth(),b.getWest())];for(let be=0;be<T.length;be++)fr(T[be],T[be],d),Qc(h,h,T[be]),e9(c,c,T[be]);if(b.contains(i.center)){c[2]=0;const be=i.point,Pe=[be.x*n,be.y*n,0];return Qc(h,h,Pe),e9(c,c,Pe),new on(h,c)}const S=[d[12],d[13],d[14]],M=i.center.lng,z=xe(i.center.lat,-85.051129,Xn),B=[qa(M),Wa(z)],q=b.getCenter().lng,H=xe(b.getCenter().lat,-85.051129,Xn),se=[qa(q),Wa(H)];let oe=new Array(3),le=0,he=B[0]-se[0];const de=B[1]-se[1];if(he>.5?he-=1:he<-.5&&(he+=1),Math.abs(he)>Math.abs(de))le=he>=0?1:3,oe=S;else{le=de>=0?0:2;const be=[d[4],d[5],d[6]];let Pe;Pe=de>=0?-Math.sin(Ce(b.getSouth()))*Qa:-Math.sin(Ce(b.getNorth()))*Qa,oe=t9(oe,S,be,Pe)}const Se=T[le],Ee=T[(le+1)%4],Re=new df(Se,Ee,oe),Ge=[o0(Re,0)||Se[0],o0(Re,1)||Se[1],o0(Re,2)||Se[2]];return h[2]=Math.min(Se[2],Ee[2]),Qc(h,h,Ge),e9(c,c,Ge),new on(h,c)}function a0(i){const e=1<<i.z,r=i.x/e,n=(i.x+1)/e,s=(i.y+1)/e;return[[Yi(i.y/e),Sr(r)],[Yi(s),Sr(n)]]}function Kh(i,e,r,n=Qa){return r=Ce(r),[i*Math.sin(r)*n,-e*n,i*Math.cos(r)*n]}function kr(i,e,r){return Kh(Math.cos(Ce(i)),Math.sin(Ce(i)),e,r)}function Qh(i,e,r){const n=Math.pow(2,r.z),s=(i/kt+r.x)/n;return kr(Yi((e/kt+r.y)/n),Sr(s))}function x9(i){return 16383/Math.max(...yn([],i.max,i.min))}function Al(i){const e=Xr(new Float64Array(16)),r=x9(i);var n,s;return Jn(e,e,[r,r,r]),Ha(e,e,((n=[])[0]=-(s=i.min)[0],n[1]=-s[1],n[2]=-s[2],n)),e}function e2(i){const e=Xr(new Float64Array(16)),r=1/x9(i);return Ha(e,e,i.min),Jn(e,e,[r,r,r]),e}function t2(i,e,r,n,s){const c=function(_){const m=kt/(2*Math.PI);return _/(2*Math.PI)/m}(r),h=[i,e,-r/(2*Math.PI)],d=Xr(new Float64Array(16));return Ha(d,d,h),Jn(d,d,[c,c,c]),Yc(d,d,Ce(-s)),Kc(d,d,Ce(-n)),d}function s0(i){return dt(5,6,i)}function i2(i,e){const r=kr(e.lat,e.lng);return c=(n=L3([],function(M){const z=kr(M._center.lat,M._center.lng);let B=R3([],r1(0,1,0),z);const q=$u([],-M.angle,z);B=fr(B,B,q),$u(q,-M._pitch,B);const H=Er([],z);return Hn(H,H,M.cameraToCenterDistance/M.pixelsPerMeter*n0),fr(H,H,q),ia([],z,H)}(i),r))[0],h=n[1],d=n[2],_=(s=r)[0],m=s[1],b=s[2],S=(T=Math.sqrt(c*c+h*h+d*d)*Math.sqrt(_*_+m*m+b*b))&&gn(n,s)/T,Math.acos(Math.min(Math.max(S,-1),1));var n,s,c,h,d,_,m,b,T,S}const r2=Ce(85),_f=Math.cos(r2),mf=Math.sin(r2);function n2(i,e){const r=i.fovAboveCenter,n=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,s=(i._camera.position[2]*i.worldSize-n)/Math.cos(i._pitch),c=Math.sin(r)*s/Math.sin(Math.max(Math.PI/2-i._pitch-r,.01)),h=Math.sin(i._pitch)*c+s;return Math.min(1.01*h,s*(1/i._horizonShift))}function es(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const r=Math.pow(2,-i.z),n=i.x*r,s=(i.x+1)*r,c=i.y*r,h=(i.y+1)*r,d=Sr(n),_=Sr(s),m=Yi(c),b=Yi(h),T=e.project(d,m),S=e.project(_,m),M=e.project(_,b),z=e.project(d,b);let B=Math.min(T.x,S.x,M.x,z.x),q=Math.min(T.y,S.y,M.y,z.y),H=Math.max(T.x,S.x,M.x,z.x),se=Math.max(T.y,S.y,M.y,z.y);const oe=r/16;function le(de,Se,Ee,Re,Ge,be){const Pe=(Ee+Ge)/2,Ue=(Re+be)/2,je=e.project(Sr(Pe),Yi(Ue)),at=Math.max(0,B-je.x,q-je.y,je.x-H,je.y-se);B=Math.min(B,je.x),H=Math.max(H,je.x),q=Math.min(q,je.y),se=Math.max(se,je.y),at>oe&&(le(de,je,Ee,Re,Pe,Ue),le(je,Se,Pe,Ue,Ge,be))}le(T,S,n,c,s,c),le(S,M,s,c,s,h),le(M,z,s,h,n,h),le(z,T,n,h,n,c),B-=oe,q-=oe,H+=oe,se+=oe;const he=1/Math.max(H-B,se-q);return{scale:he,x:B*he,y:q*he,x2:H*he,y2:se*he,projection:e}}const gf=Xr(new Float32Array(16));class oa{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new ui(0,0)}projectTilePoint(e,r,n){return{x:e,y:r,z:0}}locationPoint(e,r,n=!0){return e._coordinatePoint(e.locationCoordinate(r),n)}pixelsPerMeter(e,r){return mn(1,e)*r}pixelSpaceConversion(e,r,n){return 1}farthestPixelDistance(e){return n2(e,e.pixelsPerMeter)}pointCoordinate(e,r,n,s){const c=e.horizonLineFromTop(!1),h=new N(r,Math.max(c,n));return e.rayIntersectionCoordinate(e.pointRayIntersection(h,s))}pointCoordinate3D(e,r,n){const s=new N(r,n);if(e.elevation)return e.elevation.pointCoordinate(s);{const c=this.pointCoordinate(e,s.x,s.y,0);return[c.x,c.y,c.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const n=e.horizonLineFromTop();return r.y<n}createInversionMatrix(e,r){return gf}createTileMatrix(e,r,n){let s,c,h;const d=n.canonical,_=Xr(new Float64Array(16));if(this.isReprojectedInTileSpace){const m=es(d,this);s=1,c=m.x+n.wrap*m.scale,h=m.y,Jn(_,_,[s/m.scale,s/m.scale,e.pixelsPerMeter/r])}else s=r/e.zoomScale(d.z),c=(d.x+Math.pow(2,d.z)*n.wrap)*s,h=d.y*s;return Ha(_,_,[c,h,0]),Jn(_,_,[s/kt,s/kt,1]),_}upVector(e,r,n){return[0,0,1]}upVectorScale(e,r,n){return{metersToTile:1}}}class yf extends oa{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,n]=this.parallels=e.parallels||[29.5,45.5],s=Math.sin(Ce(r));this.n=(s+Math.sin(Ce(n)))/2,this.c=1+s*(2*this.n-s),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n,c:s,r0:c}=this,h=Ce(e-this.center[0]),d=Ce(r),_=Math.sqrt(s-2*n*Math.sin(d))/n;return{x:_*Math.sin(h*n),y:_*Math.cos(h*n)-c,z:0}}unproject(e,r){const{n,c:s,r0:c}=this,h=c+r;let d=Math.atan2(e,Math.abs(h))*Math.sign(h);h*n<0&&(d-=Math.PI*Math.sign(e)*Math.sign(h));const _=Ce(this.center[0])*n;d=We(d,-Math.PI-_,Math.PI-_);const m=ke(d/n)+this.center[0],b=Math.asin(xe((s-(e*e+h*h)*n*n)/(2*n),-1,1)),T=xe(ke(b),-85.051129,Xn);return new ui(m,T)}}const kl=1.340264,Ml=-.081106,Cl=893e-6,zl=.003796,v9=Math.sqrt(3)/2;class xf extends oa{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const n=Math.asin(v9*Math.sin(r)),s=n*n,c=s*s*s;return{x:.5*(e*Math.cos(n)/(v9*(kl+3*Ml*s+c*(7*Cl+9*zl*s)))/Math.PI+.5),y:1-.5*(n*(kl+Ml*s+c*(Cl+zl*s))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let n=r=(2*(1-r)-1)*Math.PI,s=n*n,c=s*s*s;for(let b,T,S,M=0;M<12&&(T=n*(kl+Ml*s+c*(Cl+zl*s))-r,S=kl+3*Ml*s+c*(7*Cl+9*zl*s),b=T/S,n=xe(n-b,-Math.PI/3,Math.PI/3),s=n*n,c=s*s*s,!(Math.abs(b)<1e-12));++M);const h=v9*e*(kl+3*Ml*s+c*(7*Cl+9*zl*s))/Math.cos(n),d=Math.asin(Math.sin(n)/v9),_=xe(180*h/Math.PI,-180,180),m=xe(180*d/Math.PI,-85.051129,Xn);return new ui(_,m)}}class vf extends oa{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const n=360*(e-.5),s=xe(360*(.5-r),-85.051129,Xn);return new ui(n,s)}}const d1=Math.PI/2;function b9(i){return Math.tan((d1+i)/2)}class bf extends oa{constructor(e){super(e),this.center=e.center||[0,30];const[r,n]=this.parallels=e.parallels||[30,30],s=Ce(r),c=Ce(n),h=Math.cos(s);this.n=s===c?Math.sin(s):Math.log(h/Math.cos(c))/Math.log(b9(c)/b9(s)),this.f=h*Math.pow(b9(s),this.n)/this.n}project(e,r){r=Ce(r),e=Ce(e-this.center[0]);const n=1e-6,{n:s,f:c}=this;c>0?r<-d1+n&&(r=-d1+n):r>d1-n&&(r=d1-n);const h=c/Math.pow(b9(r),s),d=h*Math.sin(s*e),_=c-h*Math.cos(s*e);return{x:.5*(d/Math.PI+.5),y:1-.5*(_/Math.PI+.5),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,r=(2*(1-r)-.5)*Math.PI;const{n,f:s}=this,c=s-r,h=Math.sign(c),d=Math.sign(n)*Math.sqrt(e*e+c*c);let _=Math.atan2(e,Math.abs(c))*h;c*n<0&&(_-=Math.PI*Math.sign(e)*h);const m=xe(ke(_/n)+this.center[0],-180,180),b=xe(ke(2*Math.atan(Math.pow(s/d,1/n))-d1),-85.051129,Xn);return new ui(m,b)}}class o2 extends oa{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:qa(e),y:Wa(r),z:0}}unproject(e,r){const n=Sr(e),s=Yi(r);return new ui(n,s)}}const a2=Ce(Xn);class wf extends oa{project(e,r){const n=(r=Ce(r))*r,s=n*n;return{x:.5*((e=Ce(e))*(.8707-.131979*n+s*(s*(.003971*n-.001529*s)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+n*(.015085+s*(.028874*n-.044475-.005916*s)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let n=r=(2*(1-r)-1)*Math.PI,s=25,c=0,h=n*n;do{h=n*n;const m=h*h;c=(n*(1.007226+h*(.015085+m*(.028874*h-.044475-.005916*m)))-r)/(1.007226+h*(.045255+m*(.259866*h-.311325-.005916*11*m))),n=xe(n-c,-a2,a2)}while(Math.abs(c)>1e-6&&--s>0);h=n*n;const d=xe(ke(e/(.8707+h*(h*(h*h*h*(.003971-.001529*h)-.013791)-.131979))),-180,180),_=ke(n);return new ui(d,_)}}const s2=Ce(Xn);class Tf extends oa{project(e,r){r=Ce(r),e=Ce(e);const n=Math.cos(r),s=2/Math.PI,c=Math.acos(n*Math.cos(e/2)),h=Math.sin(c)/c,d=.5*(e*s+2*n*Math.sin(e/2)/h)||0,_=.5*(r+Math.sin(r)/h)||0;return{x:.5*(d/Math.PI+.5),y:1-.5*(_/Math.PI+1),z:0}}unproject(e,r){let n=e=(2*e-.5)*Math.PI,s=r=(2*(1-r)-1)*Math.PI,c=25;const h=1e-6;let d=0,_=0;do{const m=Math.cos(s),b=Math.sin(s),T=2*b*m,S=b*b,M=m*m,z=Math.cos(n/2),B=Math.sin(n/2),q=2*z*B,H=B*B,se=1-M*z*z,oe=se?1/se:0,le=se?Math.acos(m*z)*Math.sqrt(1/se):0,he=.5*(2*le*m*B+2*n/Math.PI)-e,de=.5*(le*b+s)-r,Se=.5*oe*(M*H+le*m*z*S)+1/Math.PI,Ee=oe*(q*T/4-le*b*B),Re=.125*oe*(T*B-le*b*M*q),Ge=.5*oe*(S*z+le*H*m)+.5,be=Ee*Re-Ge*Se;d=(de*Ee-he*Ge)/be,_=(he*Re-de*Se)/be,n=xe(n-d,-Math.PI,Math.PI),s=xe(s-_,-s2,s2)}while((Math.abs(d)>h||Math.abs(_)>h)&&--c>0);return new ui(ke(n),ke(s))}}class l2 extends oa{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ce(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:n,cosPhi:s}=this;return{x:Ce(e)*s*n+.5,y:-Math.sin(Ce(r))/s*n+.5,z:0}}unproject(e,r){const{scale:n,cosPhi:s}=this,c=-(r-.5)/n,h=xe(ke((e-.5)/n)/s,-180,180),d=Math.asin(xe(c*s,-1,1)),_=xe(ke(d),-85.051129,Xn);return new ui(h,_)}}class If extends o2{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,r,n){const s=Math.pow(2,n.z),c=(e/kt+n.x)/s,h=kr(Yi((r/kt+n.y)/s),Sr(c));return fr(h,h,Al(Kn(n))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,r){const n=kr(r.lat,r.lng),s=Er([],n),c=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude;t9(n,n,s,mn(1,0)*kt*c);const h=Xr(new Float64Array(16));return ta(h,e.pixelMatrix,e.globeMatrix),fr(n,n,h),new N(n[0],n[1])}pixelsPerMeter(e,r){return mn(1,0)*r}pixelSpaceConversion(e,r,n){const s=Yt(mn(1,45)*r,mn(1,e)*r,n);return this.pixelsPerMeter(e,r)/s}createTileMatrix(e,r,n){const s=e2(Kn(n.canonical));return ta(new Float64Array(16),e.globeMatrix,s)}createInversionMatrix(e,r){const{center:n}=e,s=Xr(new Float64Array(16));return ta(s,s,Al(Kn(r))),Kc(s,s,Ce(n.lng)),Yc(s,s,Ce(n.lat)),Jn(s,s,[e._projectionScaler,e._projectionScaler,1]),Float32Array.from(s)}pointCoordinate(e,r,n,s){return Yh(e,r,n,!0)||new t1(0,0)}pointCoordinate3D(e,r,n){const s=this.pointCoordinate(e,r,n,0);return[s.x,s.y,s.z]}isPointAboveHorizon(e,r){return!Yh(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(s,c){const h=s.cameraToCenterDistance,d=s._centerAltitude*c,_=s._camera,m=s._camera.forward(),b=ia([],Hn([],m,-h),[0,0,d]),T=s.worldSize/(2*Math.PI),S=[0,0,-T],M=s.width/s.height,z=Math.tan(s.fovAboveCenter),B=Hn([],_.up(),z),q=Hn([],_.right(),z*M),H=Er([],ia([],ia([],m,B),q)),se=[];let oe;if(new B3(b,H).closestPointOnSphere(S,T,se)){const le=ia([],se,S),he=yn([],le,b);oe=Math.cos(s.fovAboveCenter)*hl(he)}else{const le=yn([],b,S),he=yn([],S,b);Er(he,he);const de=hl(le)-T;oe=Math.sqrt(de*(de+2*T));const Se=Math.acos(oe/(T+de))-Math.acos(gn(m,he));oe*=Math.cos(Se)}return 1.01*oe}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),n=s0(e.zoom);if(n>0){const s=n2(e,mn(1,e.center.lat)*e.worldSize),c=e.worldSize/(2*Math.PI),h=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Yt(r,s+c*(1-Math.cos(h)),Math.pow(n,10))}return r}upVector(e,r,n){const s=1<<e.z,c=(r/kt+e.x)/s;return kr(Yi((n/kt+e.y)/s),Sr(c),1)}upVectorScale(e){return{metersToTile:n0*x9(Kn(e))}}}function c2(i){const e=i.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new o2(i);case"equirectangular":return new vf(i);case"naturalEarth":return new wf(i);case"equalEarth":return new xf(i);case"winkelTripel":return new Tf(i);case"albers":return r?new l2(i):new yf(i);case"lambertConformalConic":return r?new l2(i):new bf(i);case"globe":return new If(i)}throw new Error(`Invalid projection name: ${i.name}`)}const Sf=Ka.VectorTileFeature.types,Ef=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w9(i,e,r,n,s,c,h,d,_,m,b,T,S){const M=d?Math.min(na,Math.round(d[0])):0,z=d?Math.min(na,Math.round(d[1])):0;i.emplaceBack(e,r,Math.round(32*n),Math.round(32*s),c,h,(M<<1)+(_?1:0),z,16*m,16*b,256*T,256*S)}function T9(i,e,r,n,s,c,h){i.emplaceBack(e,r,n,s,c,h)}function I9(i,e,r,n,s){i.emplaceBack(e,r,n,s),i.emplaceBack(e,r,n,s),i.emplaceBack(e,r,n,s),i.emplaceBack(e,r,n,s)}function Af(i){for(const e of i.sections)if(y(e.text))return!0;return!1}class l0{constructor(e){this.layoutVertexArray=new dn,this.indexArray=new Di,this.programConfigurations=e,this.segments=new Ni,this.dynamicLayoutVertexArray=new _i,this.opacityVertexArray=new vi,this.placedSymbolArray=new mu,this.globeExtVertexArray=new Rn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,n,s){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kd.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Cd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ef,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Md.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||s)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}ct(l0,"SymbolBuffers");class c0{constructor(e,r,n){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new n,this.segments=new Ni,this.collisionVertexArray=new pr,this.collisionVertexArrayExt=new mi}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,zd.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Pd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ct(c0,"CollisionBuffers");class aa{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(h=>h.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Xr([]),this.placementViewportMatrix=Xr([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=W3(this.zoom,r["text-size"]),this.iconSizeData=W3(this.zoom,r["icon-size"]);const n=this.layers[0].layout,s=n.get("symbol-sort-key"),c=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey=c!=="viewport-y"&&s.constantOr(1)!==void 0,this.sortFeaturesByY=(c==="viewport-y"||c==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map(h=>an[h]),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new l0(new Za(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new l0(new Za(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new xu,this.lineVertexArray=new vu,this.symbolInstances=new yu}calculateGlyphDependencies(e,r,n,s,c){for(let h=0;h<e.length;h++)if(r[e.charCodeAt(h)]=!0,s&&c){const d=wl[e.charAt(h)];d&&(r[d.charCodeAt(0)]=!0)}}populate(e,r,n,s){const c=this.layers[0],h=c.layout,d=this.projection.name==="globe",_=h.get("text-font"),m=h.get("text-field"),b=h.get("icon-image"),T=(m.value.kind!=="constant"||m.value.value instanceof hr&&!m.value.value.isEmpty()||m.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),S=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,M=h.get("symbol-sort-key");if(this.features=[],!T&&!S)return;const z=r.iconDependencies,B=r.glyphDependencies,q=r.availableImages,H=new V(this.zoom);for(const{feature:se,id:oe,index:le,sourceLayerIndex:he}of e){const de=c._featureFilter.needGeometry,Se=Xa(se,de);if(!c._featureFilter.filter(H,Se,n))continue;if(de||(Se.geometry=So(se,n,s)),d&&se.type!==1&&n.z<=5){const be=Se.geometry,Pe=1<<n.z,Ue=n.x,je=n.y,at=.98078528056;for(let Fe=0;Fe<be.length;Fe++)be[Fe]=Cp(be[Fe],nt=>nt,(nt,Rt)=>gn(kr(Yi((nt.y/kt+je)/Pe),Sr((nt.x/kt+Ue)/Pe),1),kr(Yi((Rt.y/kt+je)/Pe),Sr((Rt.x/kt+Ue)/Pe),1))<at)}let Ee,Re;if(T){const be=c.getValueAndResolveTokens("text-field",Se,n,q),Pe=hr.factory(be);Af(Pe)&&(this.hasRTLText=!0),(!this.hasRTLText||Q()==="unavailable"||this.hasRTLText&&J.isParsed())&&(Ee=Rd(Pe,c,Se))}if(S){const be=c.getValueAndResolveTokens("icon-image",Se,n,q);Re=be instanceof $r?be:$r.fromString(be)}if(!Ee&&!Re)continue;const Ge=this.sortFeaturesByKey?M.evaluate(Se,{},n):void 0;if(this.features.push({id:oe,text:Ee,icon:Re,index:le,sourceLayerIndex:he,geometry:Se.geometry,properties:se.properties,type:Sf[se.type],sortKey:Ge}),Re&&(z[Re.name]=!0),Ee){const be=_.evaluate(Se,{},n).join(","),Pe=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(an.vertical)>=0;for(const Ue of Ee.sections)if(Ue.image)z[Ue.image.name]=!0;else{const je=Ho(Ee.toString()),at=Ue.fontStack||be,Fe=B[at]=B[at]||{};this.calculateGlyphDependencies(Ue.text,Fe,Pe,this.allowVerticalPlacement,je)}}}h.get("symbol-placement")==="line"&&(this.features=function(se){const oe={},le={},he=[];let de=0;function Se(be){he.push(se[be]),de++}function Ee(be,Pe,Ue){const je=le[be];return delete le[be],le[Pe]=je,he[je].geometry[0].pop(),he[je].geometry[0]=he[je].geometry[0].concat(Ue[0]),je}function Re(be,Pe,Ue){const je=oe[Pe];return delete oe[Pe],oe[be]=je,he[je].geometry[0].shift(),he[je].geometry[0]=Ue[0].concat(he[je].geometry[0]),je}function Ge(be,Pe,Ue){const je=Ue?Pe[0][Pe[0].length-1]:Pe[0][0];return`${be}:${je.x}:${je.y}`}for(let be=0;be<se.length;be++){const Pe=se[be],Ue=Pe.geometry,je=Pe.text?Pe.text.toString():null;if(!je){Se(be);continue}const at=Ge(je,Ue),Fe=Ge(je,Ue,!0);if(at in le&&Fe in oe&&le[at]!==oe[Fe]){const nt=Re(at,Fe,Ue),Rt=Ee(at,Fe,he[nt].geometry);delete oe[at],delete le[Fe],le[Ge(je,he[Rt].geometry,!0)]=Rt,he[nt].geometry=null}else at in le?Ee(at,Fe,Ue):Fe in oe?Re(at,Fe,Ue):(Se(be),oe[at]=de-1,le[Fe]=de-1)}return he.filter(be=>be.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((se,oe)=>se.sortKey-oe.sortKey)}update(e,r,n,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,n,s),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,n,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=c2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const n=this.lineVertexArray.length,s=e.segment;if(s!==void 0){let c=e.dist(r[s+1]),h=e.dist(r[s]);const d={};for(let _=s+1;_<r.length;_++)d[_]={x:r[_].x,y:r[_].y,tileUnitDistanceFromAnchor:c},_<r.length-1&&(c+=r[_+1].dist(r[_]));for(let _=s||0;_>=0;_--)d[_]={x:r[_].x,y:r[_].y,tileUnitDistanceFromAnchor:h},_>0&&(h+=r[_-1].dist(r[_]));for(let _=0;_<r.length;_++){const m=d[_];this.lineVertexArray.emplaceBack(m.x,m.y,m.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,r,n,s,c,h,d,_,m,b,T,S,M,z){const B=e.indexArray,q=e.layoutVertexArray,H=e.globeExtVertexArray,se=e.segments.prepareSegment(4*r.length,q,B,this.canOverlap?h.sortKey:void 0),oe=this.glyphOffsetArray.length,le=se.vertexLength,he=this.allowVerticalPlacement&&d===an.vertical?Math.PI/2:0,de=h.text&&h.text.sections;for(let Ee=0;Ee<r.length;Ee++){const{tl:Re,tr:Ge,bl:be,br:Pe,tex:Ue,pixelOffsetTL:je,pixelOffsetBR:at,minFontScaleX:Fe,minFontScaleY:nt,glyphOffset:Rt,isSDF:$t,sectionIndex:bt}=r[Ee],pt=se.vertexLength,Zt=Rt[1];if(w9(q,m.x,m.y,Re.x,Zt+Re.y,Ue.x,Ue.y,n,$t,je.x,je.y,Fe,nt),w9(q,m.x,m.y,Ge.x,Zt+Ge.y,Ue.x+Ue.w,Ue.y,n,$t,at.x,je.y,Fe,nt),w9(q,m.x,m.y,be.x,Zt+be.y,Ue.x,Ue.y+Ue.h,n,$t,je.x,at.y,Fe,nt),w9(q,m.x,m.y,Pe.x,Zt+Pe.y,Ue.x+Ue.w,Ue.y+Ue.h,n,$t,at.x,at.y,Fe,nt),_){const Ft=_.anchor,yt=_.up;T9(H,Ft.x,Ft.y,Ft.z,yt[0],yt[1],yt[2]),T9(H,Ft.x,Ft.y,Ft.z,yt[0],yt[1],yt[2]),T9(H,Ft.x,Ft.y,Ft.z,yt[0],yt[1],yt[2]),T9(H,Ft.x,Ft.y,Ft.z,yt[0],yt[1],yt[2]),I9(e.dynamicLayoutVertexArray,Ft.x,Ft.y,Ft.z,he)}else I9(e.dynamicLayoutVertexArray,m.x,m.y,m.z,he);B.emplaceBack(pt,pt+1,pt+2),B.emplaceBack(pt+1,pt+2,pt+3),se.vertexLength+=4,se.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),Ee!==r.length-1&&bt===r[Ee+1].sectionIndex||e.programConfigurations.populatePaintArrays(q.length,h,h.index,{},M,z,de&&de[bt])}const Se=_?_.anchor:m;e.placedSymbolArray.emplaceBack(Se.x,Se.y,Se.z,m.x,m.y,oe,this.glyphOffsetArray.length-oe,le,b,T,m.segment,n?n[0]:0,n?n[1]:0,s[0],s[1],d,0,!1,0,S,0)}_commitLayoutVertex(e,r,n,s,c,h,d){e.emplaceBack(r,n,s,c,h,Math.round(d.x),Math.round(d.y))}_addCollisionDebugVertices(e,r,n,s,c,h,d){const _=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),m=_.vertexLength,b=d.tileAnchorX,T=d.tileAnchorY;for(let M=0;M<4;M++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),n.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(n.layoutVertexArray,s,c,h,b,T,new N(e.x1,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,s,c,h,b,T,new N(e.x2,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,s,c,h,b,T,new N(e.x2,e.y2)),this._commitLayoutVertex(n.layoutVertexArray,s,c,h,b,T,new N(e.x1,e.y2)),_.vertexLength+=4;const S=n.indexArray;S.emplaceBack(m,m+1),S.emplaceBack(m+1,m+2),S.emplaceBack(m+2,m+3),S.emplaceBack(m+3,m),_.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,n,s,c,h){for(let d=s;d<c;d++){const _=n.get(d),m=this.getSymbolInstanceTextSize(e,h,r,d);this._addCollisionDebugVertices(_,m,this.textCollisionBox,_.projectedAnchorX,_.projectedAnchorY,_.projectedAnchorZ,h)}}_addIconDebugCollisionBoxes(e,r,n,s,c,h){for(let d=s;d<c;d++){const _=n.get(d),m=this.getSymbolInstanceIconSize(e,r,d);this._addCollisionDebugVertices(_,m,this.iconCollisionBox,_.projectedAnchorX,_.projectedAnchorY,_.projectedAnchorZ,h)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new c0(ri,wh.members,Fr),this.iconCollisionBox=new c0(ri,wh.members,Fr);const n=a1(this.iconSizeData,e),s=a1(this.textSizeData,e);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this._addTextDebugCollisionBoxes(s,e,r,h.textBoxStartIndex,h.textBoxEndIndex,h),this._addTextDebugCollisionBoxes(s,e,r,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h),this._addIconDebugCollisionBoxes(n,e,r,h.iconBoxStartIndex,h.iconBoxEndIndex,h),this._addIconDebugCollisionBoxes(n,e,r,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h)}}getSymbolInstanceTextSize(e,r,n,s){const c=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:s),h=p9(this.textSizeData,e,c)/_r;return this.tilePixelRatio*h}getSymbolInstanceIconSize(e,r,n){const s=this.icon.placedSymbolArray.get(n),c=p9(this.iconSizeData,e,s);return this.tilePixelRatio*c}_commitDebugCollisionVertexUpdate(e,r,n){e.emplaceBack(r,-n,-n),e.emplaceBack(r,n,-n),e.emplaceBack(r,n,n),e.emplaceBack(r,-n,n)}_updateTextDebugCollisionBoxes(e,r,n,s,c,h){for(let d=s;d<c;d++){const _=n.get(d),m=this.getSymbolInstanceTextSize(e,h,r,d);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,m,_.padding)}}_updateIconDebugCollisionBoxes(e,r,n,s,c){for(let h=s;h<c;h++){const d=n.get(h),_=this.getSymbolInstanceIconSize(e,r,h);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,_,d.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=a1(this.iconSizeData,e),s=a1(this.textSizeData,e);for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this._updateTextDebugCollisionBoxes(s,e,r,h.textBoxStartIndex,h.textBoxEndIndex,h),this._updateTextDebugCollisionBoxes(s,e,r,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h),this._updateIconDebugCollisionBoxes(n,e,r,h.iconBoxStartIndex,h.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(n,e,r,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,n,s,c,h,d,_,m){const b={};for(let T=r;T<n;T++){const S=e.get(T);b.textBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},b.textFeatureIndex=S.featureIndex;break}for(let T=s;T<c;T++){const S=e.get(T);b.verticalTextBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},b.verticalTextFeatureIndex=S.featureIndex;break}for(let T=h;T<d;T++){const S=e.get(T);b.iconBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},b.iconFeatureIndex=S.featureIndex;break}for(let T=_;T<m;T++){const S=e.get(T);b.verticalIconBox={x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,padding:S.padding,projectedAnchorX:S.projectedAnchorX,projectedAnchorY:S.projectedAnchorY,projectedAnchorZ:S.projectedAnchorZ,tileAnchorX:S.tileAnchorX,tileAnchorY:S.tileAnchorY},b.verticalIconFeatureIndex=S.featureIndex;break}return b}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const n=e.placedSymbolArray.get(r),s=n.vertexStartIndex+4*n.numGlyphs;for(let c=n.vertexStartIndex;c<s;c+=4)e.indexArray.emplaceBack(c,c+1,c+2),e.indexArray.emplaceBack(c+1,c+2,c+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),n=Math.cos(e),s=[],c=[],h=[];for(let d=0;d<this.symbolInstances.length;++d){h.push(d);const _=this.symbolInstances.get(d);s.push(0|Math.round(r*_.tileAnchorX+n*_.tileAnchorY)),c.push(_.featureIndex)}return h.sort((d,_)=>s[d]-s[_]||c[_]-c[d]),h}addToSortKeyRanges(e,r){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((s,c,h)=>{s>=0&&h.indexOf(s)===c&&this.addIndicesForPlacedSymbol(this.text,s)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ct(aa,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),aa.MAX_GLYPHS=65535,aa.addDynamicAttributes=I9;const kf=new ft({"symbol-placement":new re(me.layout_symbol["symbol-placement"]),"symbol-spacing":new re(me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new re(me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ye(me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new re(me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new re(me.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new re(me.layout_symbol["icon-ignore-placement"]),"icon-optional":new re(me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new re(me.layout_symbol["icon-rotation-alignment"]),"icon-size":new ye(me.layout_symbol["icon-size"]),"icon-text-fit":new re(me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new re(me.layout_symbol["icon-text-fit-padding"]),"icon-image":new ye(me.layout_symbol["icon-image"]),"icon-rotate":new ye(me.layout_symbol["icon-rotate"]),"icon-padding":new re(me.layout_symbol["icon-padding"]),"icon-keep-upright":new re(me.layout_symbol["icon-keep-upright"]),"icon-offset":new ye(me.layout_symbol["icon-offset"]),"icon-anchor":new ye(me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new re(me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new re(me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new re(me.layout_symbol["text-rotation-alignment"]),"text-field":new ye(me.layout_symbol["text-field"]),"text-font":new ye(me.layout_symbol["text-font"]),"text-size":new ye(me.layout_symbol["text-size"]),"text-max-width":new ye(me.layout_symbol["text-max-width"]),"text-line-height":new ye(me.layout_symbol["text-line-height"]),"text-letter-spacing":new ye(me.layout_symbol["text-letter-spacing"]),"text-justify":new ye(me.layout_symbol["text-justify"]),"text-radial-offset":new ye(me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new re(me.layout_symbol["text-variable-anchor"]),"text-anchor":new ye(me.layout_symbol["text-anchor"]),"text-max-angle":new re(me.layout_symbol["text-max-angle"]),"text-writing-mode":new re(me.layout_symbol["text-writing-mode"]),"text-rotate":new ye(me.layout_symbol["text-rotate"]),"text-padding":new re(me.layout_symbol["text-padding"]),"text-keep-upright":new re(me.layout_symbol["text-keep-upright"]),"text-transform":new ye(me.layout_symbol["text-transform"]),"text-offset":new ye(me.layout_symbol["text-offset"]),"text-allow-overlap":new re(me.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new re(me.layout_symbol["text-ignore-placement"]),"text-optional":new re(me.layout_symbol["text-optional"])});var u0={paint:new ft({"icon-opacity":new ye(me.paint_symbol["icon-opacity"]),"icon-color":new ye(me.paint_symbol["icon-color"]),"icon-halo-color":new ye(me.paint_symbol["icon-halo-color"]),"icon-halo-width":new ye(me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ye(me.paint_symbol["icon-halo-blur"]),"icon-translate":new re(me.paint_symbol["icon-translate"]),"icon-translate-anchor":new re(me.paint_symbol["icon-translate-anchor"]),"text-opacity":new ye(me.paint_symbol["text-opacity"]),"text-color":new ye(me.paint_symbol["text-color"],{runtimeType:tn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ye(me.paint_symbol["text-halo-color"]),"text-halo-width":new ye(me.paint_symbol["text-halo-width"]),"text-halo-blur":new ye(me.paint_symbol["text-halo-blur"]),"text-translate":new re(me.paint_symbol["text-translate"]),"text-translate-anchor":new re(me.paint_symbol["text-translate-anchor"])}),layout:kf};class u2{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ba,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ct(u2,"FormatSectionOverride",{omit:["defaultValue"]});class S9 extends On{constructor(e){super(e,u0)}recalculate(e,r){super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const s=[];for(const c of n)s.indexOf(c)<0&&s.push(c);this.layout._values["text-writing-mode"]=s}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,n,s){const c=this.layout.get(e).evaluate(r,{},n,s),h=this._unevaluatedLayout._values[e];return h.isDataDriven()||Os(h.value)||!c?c:function(d,_){return _.replace(/{([^{}]+)}/g,(m,b)=>b in d?String(d[b]):"")}(r.properties,c)}createBucket(e){return new aa(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of u0.paint.overridableProperties){if(!S9.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),n=new u2(r),s=new Bs(n,r.property.specification);let c=null;c=r.value.kind==="constant"||r.value.kind==="source"?new Fs("source",s):new Ra("composite",s,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new we(r.property,c,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,n){return!(!this.layout||r.isDataDriven()||n.isDataDriven())&&S9.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const n=e.get("text-field"),s=u0.paint.properties[r];let c=!1;const h=d=>{for(const _ of d)if(s.overrides&&s.overrides.hasOverride(_))return void(c=!0)};if(n.value.kind==="constant"&&n.value.value instanceof hr)h(n.value.value.sections);else if(n.value.kind==="source"){const d=m=>{c||(m instanceof Ia&&Pi(m.value)===Do?h(m.value.sections):m instanceof Zn?h(m.sections):m.eachChild(d))},_=n.value;_._styleExpression&&d(_._styleExpression.expression)}return c}getProgramConfiguration(e){return new Qo(this,e)}}var Mf={paint:new ft({"background-color":new re(me.paint_background["background-color"]),"background-pattern":new tt(me.paint_background["background-pattern"]),"background-opacity":new re(me.paint_background["background-opacity"])})},Cf={paint:new ft({"raster-opacity":new re(me.paint_raster["raster-opacity"]),"raster-hue-rotate":new re(me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new re(me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new re(me.paint_raster["raster-brightness-max"]),"raster-saturation":new re(me.paint_raster["raster-saturation"]),"raster-contrast":new re(me.paint_raster["raster-contrast"]),"raster-resampling":new re(me.paint_raster["raster-resampling"]),"raster-fade-duration":new re(me.paint_raster["raster-fade-duration"])})};class zf extends On{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var Pf={paint:new ft({"sky-type":new re(me.paint_sky["sky-type"]),"sky-atmosphere-sun":new re(me.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new re(me.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new re(me.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new re(me.paint_sky["sky-gradient-radius"]),"sky-gradient":new De(me.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new re(me.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new re(me.paint_sky["sky-atmosphere-color"]),"sky-opacity":new re(me.paint_sky["sky-opacity"])})};function h0(i,e,r){const n=[0,0,1],s=Hu([]);return Ku(s,s,r?-Ce(i)+Math.PI:Ce(i)),Yu(s,s,-Ce(e)),Wu(n,n,s),Er(n,n)}const Df={circle:class extends On{constructor(i){super(i,Op)}createBucket(i){return new C3(i)}queryRadius(i){const e=i;return i1("circle-radius",this,e)+i1("circle-stroke-width",this,e)+Jc(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,r,n,s,c,h,d){const _=Vu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),m=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return Qu(i,n,c,h,d,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",_,m)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new Qo(this,i)}},heatmap:class extends On{createBucket(i){return new th(i)}constructor(i){super(i,$p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=G3({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return i1("heatmap-radius",this,i)}queryIntersectsFeature(i,e,r,n,s,c,h,d){const _=this.paint.get("heatmap-radius").evaluate(e,r);return Qu(i,n,c,h,d,!0,!0,new N(0,0),_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new Qo(this,i)}},hillshade:class extends On{constructor(i){super(i,Zp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends On{constructor(i){super(i,ld)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(i){return new Qo(this,i)}recalculate(i,e){super.recalculate(i,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new s9(i)}queryRadius(){return Jc(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,r,n,s,c){return!i.queryGeometry.isAboveHorizon&&Ou(Uu(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends On{constructor(i){super(i,vd)}createBucket(i){return new xl(i)}queryRadius(){return Jc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new Qo(this,i)}queryIntersectsFeature(i,e,r,n,s,c,h,d,_){const m=Vu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),b=this.paint.get("fill-extrusion-height").evaluate(e,r),T=this.paint.get("fill-extrusion-base").evaluate(e,r),S=[0,0],M=d&&c.elevation,z=c.elevation?c.elevation.exaggeration():1,B=i.tile.getBucket(this);if(M&&B instanceof xl){const se=B.centroidVertexArray,oe=_+1;if(oe<se.length){const le=se.get(oe);S[0]=le.a_centroid_pos0,S[1]=le.a_centroid_pos1}}if(S[0]===0&&S[1]===1)return!1;c.projection.name==="globe"&&(n=fh([n],[new N(0,0),new N(kt,kt)],i.tileID.canonical).map(se=>se.polygon).flat());const q=function(se,oe,le,he,de,Se,Ee,Re,Ge,be,Pe){return se.projection.name==="globe"?function(Ue,je,at,Fe,nt,Rt,$t,bt,pt,Zt,Ft){const yt=[],Ki=[],Gi=Ue.projection.upVectorScale(Ft,Ue.center.lat,Ue.worldSize).metersToTile,Oi=[0,0,0,1],qt=[0,0,0,1],Qt=(di,hi,bi,ki)=>{di[0]=hi,di[1]=bi,di[2]=ki,di[3]=1},yi=dh();at>0&&(at+=yi),Fe+=yi;for(const di of je){const hi=[],bi=[];for(const ki of di){const sr=ki.x+nt.x,Nr=ki.y+nt.y,Xt=Ue.projection.projectTilePoint(sr,Nr,Ft),Fi=Ue.projection.upVector(Ft,ki.x,ki.y);let vr=at,oi=Fe;if($t){const Mi=yh(sr,Nr,at,Fe,$t,bt,pt,Zt);vr+=Mi.base,oi+=Mi.top}at!==0?Qt(Oi,Xt.x+Fi[0]*Gi*vr,Xt.y+Fi[1]*Gi*vr,Xt.z+Fi[2]*Gi*vr):Qt(Oi,Xt.x,Xt.y,Xt.z),Qt(qt,Xt.x+Fi[0]*Gi*oi,Xt.y+Fi[1]*Gi*oi,Xt.z+Fi[2]*Gi*oi),fr(Oi,Oi,Rt),fr(qt,qt,Rt),hi.push(u9(Oi)),bi.push(u9(qt))}yt.push(hi),Ki.push(bi)}return[yt,Ki]}(se,oe,le,he,de,Se,Ee,Re,Ge,be,Pe):Ee?function(Ue,je,at,Fe,nt,Rt,$t,bt,pt){const Zt=[],Ft=[],yt=[0,0,0,1];for(const Ki of Ue){const Gi=[],Oi=[];for(const qt of Ki){const Qt=qt.x+Fe.x,yi=qt.y+Fe.y,di=yh(Qt,yi,je,at,Rt,$t,bt,pt);yt[0]=Qt,yt[1]=yi,yt[2]=di.base,yt[3]=1,Ya(yt,yt,nt),yt[3]=Math.max(yt[3],1e-5);const hi=u9([yt[0]/yt[3],yt[1]/yt[3],yt[2]/yt[3]]);yt[0]=Qt,yt[1]=yi,yt[2]=di.top,yt[3]=1,Ya(yt,yt,nt),yt[3]=Math.max(yt[3],1e-5);const bi=u9([yt[0]/yt[3],yt[1]/yt[3],yt[2]/yt[3]]);Gi.push(hi),Oi.push(bi)}Zt.push(Gi),Ft.push(Oi)}return[Zt,Ft]}(oe,le,he,de,Se,Ee,Re,Ge,be):function(Ue,je,at,Fe,nt){const Rt=[],$t=[],bt=nt[8]*je,pt=nt[9]*je,Zt=nt[10]*je,Ft=nt[11]*je,yt=nt[8]*at,Ki=nt[9]*at,Gi=nt[10]*at,Oi=nt[11]*at;for(const qt of Ue){const Qt=[],yi=[];for(const di of qt){const hi=di.x+Fe.x,bi=di.y+Fe.y,ki=nt[0]*hi+nt[4]*bi+nt[12],sr=nt[1]*hi+nt[5]*bi+nt[13],Nr=nt[2]*hi+nt[6]*bi+nt[14],Xt=nt[3]*hi+nt[7]*bi+nt[15],Fi=ki+bt,vr=sr+pt,oi=Nr+Zt,Mi=Math.max(Xt+Ft,1e-5),Mr=ki+yt,Ii=sr+Ki,Ui=Nr+Gi,lr=Math.max(Xt+Oi,1e-5),rr=new N(Fi/Mi,vr/Mi);rr.z=oi/Mi,Qt.push(rr);const mr=new N(Mr/lr,Ii/lr);mr.z=Ui/lr,yi.push(mr)}Rt.push(Qt),$t.push(yi)}return[Rt,$t]}(oe,le,he,de,Se)}(c,n,T,b,m,h,M?d:null,S,z,c.center.lat,i.tileID.canonical),H=i.queryGeometry;return function(se,oe,le){let he=1/0;Ou(le,oe)&&(he=gh(le,oe[0]));for(let de=0;de<oe.length;de++){const Se=oe[de],Ee=se[de];for(let Re=0;Re<Se.length-1;Re++){const Ge=Se[Re],be=[Ge,Se[Re+1],Ee[Re+1],Ee[Re],Ge];Bu(le,be)&&(he=Math.min(he,gh(le,be)))}}return he!==1/0&&he}(q[0],q[1],H.isPointQuery()?H.screenBounds:H.screenGeometry)}},line:class extends On{constructor(i){super(i,xh),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ss,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=vh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new h9(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new Qo(this,i)}queryRadius(i){const e=i,r=bh(i1("line-width",this,e),i1("line-gap-width",this,e)),n=i1("line-offset",this,e);return r/2+Math.abs(n)+Jc(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,r,n,s,c){if(i.queryGeometry.isAboveHorizon)return!1;const h=Uu(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),c.angle,i.pixelToTileUnitsFactor),d=i.pixelToTileUnitsFactor/2*bh(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),_=this.paint.get("line-offset").evaluate(e,r);return _&&(n=function(m,b){const T=[],S=new N(0,0);for(let M=0;M<m.length;M++){const z=m[M],B=[];for(let q=0;q<z.length;q++){const H=z[q-1],se=z[q],oe=z[q+1],le=q===0?S:se.sub(H)._unit()._perp(),he=q===z.length-1?S:oe.sub(se)._unit()._perp(),de=le._add(he)._unit();de._mult(1/(de.x*he.x+de.y*he.y)),B.push(de._mult(b)._add(se))}T.push(B)}return T}(n,_*i.pixelToTileUnitsFactor)),function(m,b,T){for(let S=0;S<b.length;S++){const M=b[S];if(m.length>=3){for(let z=0;z<M.length;z++)if(Ja(m,M[z]))return!0}if(Dp(m,M,T))return!0}return!1}(h,n,d)}isTileClipped(){return!0}},symbol:S9,background:class extends On{constructor(i){super(i,Mf)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends On{constructor(i){super(i,Cf)}getProgramIds(){return["raster"]}},sky:class extends On{constructor(i){super(i,Pf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=G3({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const n=this.paint.get("sky-atmosphere-sun"),s=!n,c=i.style.light,h=c.properties.get("position");return s&&c.properties.get("anchor")==="viewport"&&_t("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),s?h0(h.azimuthal,90-h.polar,e):h0(n[0],90-n[1],e)}const r=this.paint.get("sky-gradient-center");return h0(r[0],90-r[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Pl{constructor(e,r,n,s){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(r,s)}update(e,r,n){const{width:s,height:c}=e,{context:h}=this,{gl:d}=h,{HTMLImageElement:_,HTMLCanvasElement:m,HTMLVideoElement:b,ImageData:T,ImageBitmap:S}=Z;if(d.bindTexture(d.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===d.RGBA&&(!r||r.premultiply!==!1)),n||this.size&&this.size[0]===s&&this.size[1]===c){const{x:M,y:z}=n||{x:0,y:0};e instanceof _||e instanceof m||e instanceof b||e instanceof T||S&&e instanceof S?d.texSubImage2D(d.TEXTURE_2D,0,M,z,d.RGBA,d.UNSIGNED_BYTE,e):d.texSubImage2D(d.TEXTURE_2D,0,M,z,s,c,d.RGBA,d.UNSIGNED_BYTE,e.data)}else this.size=[s,c],e instanceof _||e instanceof m||e instanceof b||e instanceof T||S&&e instanceof S?d.texImage2D(d.TEXTURE_2D,0,this.format,this.format,d.UNSIGNED_BYTE,e):d.texImage2D(d.TEXTURE_2D,0,this.format,s,c,0,this.format,d.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&d.generateMipmap(d.TEXTURE_2D)}bind(e,r){const{context:n}=this,{gl:s}=n;s.bindTexture(s.TEXTURE_2D,this.texture),e!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this.useMipmap?e===s.NEAREST?s.NEAREST_MIPMAP_NEAREST:s.LINEAR_MIPMAP_NEAREST:e),this.filter=e),r!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class p0{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new Eo({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const n=this.getKey(e,r);return this.positions[n]}trim(){const e=this.width,r=this.height=Xe(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,n){const s=[];let c=e.length%2==1?-e[e.length-1]*n:0,h=e[0]*n,d=!0;s.push({left:c,right:h,isDash:d,zeroLength:e[0]===0});let _=e[0];for(let m=1;m<e.length;m++){d=!d;const b=e[m];c=_*n,_+=b,h=_*n,s.push({left:c,right:h,isDash:d,zeroLength:b===0})}return s}addRoundDash(e,r,n){const s=r/2;for(let c=-n;c<=n;c++){const h=this.width*(this.nextRow+n+c);let d=0,_=e[d];for(let m=0;m<this.width;m++){m/_.right>1&&(_=e[++d]);const b=Math.abs(m-_.left),T=Math.abs(m-_.right),S=Math.min(b,T);let M;const z=c/n*(s+1);if(_.isDash){const B=s-Math.abs(z);M=Math.sqrt(S*S+B*B)}else M=s-Math.sqrt(S*S+z*z);this.image.data[h+m]=Math.max(0,Math.min(255,M+128))}}}addRegularDash(e,r){for(let _=e.length-1;_>=0;--_){const m=e[_],b=e[_+1];m.zeroLength?e.splice(_,1):b&&b.isDash===m.isDash&&(b.left=m.left,e.splice(_,1))}const n=e[0],s=e[e.length-1];n.isDash===s.isDash&&(n.left=s.left-this.width,s.right=n.right+this.width);const c=this.width*this.nextRow;let h=0,d=e[h];for(let _=0;_<this.width;_++){_/d.right>1&&(d=e[++h]);const m=Math.abs(_-d.left),b=Math.abs(_-d.right),T=Math.min(m,b);this.image.data[c+_]=Math.max(0,Math.min(255,(d.isDash?T:-T)+r+128))}}addDash(e,r){const n=this.getKey(e,r);if(this.positions[n])return this.positions[n];const s=r==="round",c=s?7:0,h=2*c+1;if(this.nextRow+h>this.height)return _t("LineAtlas out of space"),null;e.length===0&&e.push(1);let d=0;for(let b=0;b<e.length;b++)e[b]<0&&(_t("Negative value is found in line dasharray, replacing values with 0"),e[b]=0),d+=e[b];if(d!==0){const b=this.width/d,T=this.getDashRanges(e,this.width,b);s?this.addRoundDash(T,b,c):this.addRegularDash(T,r==="square"?.5*b:0)}const _=this.nextRow+c;this.nextRow+=h;const m={tl:[_,c],br:[d,0]};return this.positions[n]=m,m}}ct(p0,"LineAtlas");class Lf{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Rf{constructor(){this.tasks={},this.taskQueue=[],St(["process"],this),this.invoker=new Lf(this.process),this.nextId=0}add(e,r){const n=this.nextId++,s=function({type:c,isSymbolTile:h,zoom:d}){return d=d||0,c==="message"?0:c!=="maybePrepare"||h?c!=="parseTile"||h?c==="parseTile"&&h?300-d:c==="maybePrepare"&&h?400-d:500:200-d:100-d}(r);if(s===0){Bt();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:e,metadata:r,priority:s,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){Bt();try{if(this.taskQueue=this.taskQueue.filter(n=>!!this.tasks[n]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let s=0;s<this.taskQueue.length;s++){const c=this.tasks[this.taskQueue[s]];c.priority<r&&(r=c.priority,e=s)}if(e===null)return null;const n=this.taskQueue[e];return this.taskQueue.splice(e,1),n}remove(){this.invoker.remove()}}class h2{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const n=e[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Bf=["tile","layer","source","sourceLayer","state"];class p2{constructor(e,r,n,s,c){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=n,this._y=s,this.properties=e.properties,this.id=c}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const r of Bf)this[r]!==void 0&&(e[r]=this[r]);return e}}const xn=32,Qn=33,sa=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,r=0,n=0,s=0,c=0,h=0,d=0;for(1&e?s=c=h=xn:r=n=d=xn;(e>>=1)>1;){const m=r+s>>1,b=n+c>>1;1&e?(s=r,c=n,r=h,n=d):(r=s,n=c,s=h,c=d),h=m,d=b}const _=4*i;sa[_+0]=r,sa[_+1]=n,sa[_+2]=s,sa[_+3]=c}const eo=new Uint16Array(2178),la=new Uint8Array(1089),E9=new Uint16Array(1089);function d2(i){return i===0?-.03125:i===32?.03125:0}var f2=ut([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const _2={type:2,extent:kt,loadGeometry:()=>[[new N(0,0),new N(8193,0),new N(8193,8193),new N(0,8193),new N(0,0)]]};class d0{constructor(e,r,n,s,c){this.tileID=e,this.uid=Ye(),this.uses=0,this.tileSize=r,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=c,this.expiredRequestCount=0,this.state="loading",s&&s.transform&&(this.projection=s.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<zi.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=es(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,n){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(s,c){const h={};if(!c)return h;for(const d of s){const _=d.layerIds.map(m=>c.getLayer(m)).filter(Boolean);if(_.length!==0){d.layers=_,d.stateDependentLayerIds&&(d.stateDependentLayers=d.stateDependentLayerIds.map(m=>_.filter(b=>b.id===m)[0]));for(const m of _)h[m.id]=d}}return h}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const s in this.buckets){const c=this.buckets[s];if(c instanceof aa){if(this.hasSymbolBuckets=!0,!n)break;c.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const s in this.buckets){const c=this.buckets[s];if(c instanceof aa&&c.hasRTLText){this.hasRTLText=!0,J.isLoading()||J.isLoaded()||Q()!=="deferred"||$();break}}this.queryPadding=0;for(const s in this.buckets){const c=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(s).queryRadius(c))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new w3}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const n in this.buckets){const s=this.buckets[n];s.uploadPending()&&s.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pl(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pl(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Pl(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,n,s,c,h,d,_){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:s,pixelPosMatrix:d,transform:h,params:c,tileTransform:this.tileTransform},e,r,n):{}}querySourceFeatures(e,r){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const s=n.loadVTLayers(),c=r?r.sourceLayer:"",h=s._geojsonTileLayer||s[c];if(!h)return;const d=go(r&&r.filter),{z:_,x:m,y:b}=this.tileID.canonical,T={z:_,x:m,y:b};for(let S=0;S<h.length;S++){const M=h.feature(S);if(d.needGeometry){const q=Xa(M,!0);if(!d.filter(new V(this.tileID.overscaledZ),q,this.tileID.canonical))continue}else if(!d.filter(new V(this.tileID.overscaledZ),M))continue;const z=n.getId(M,c),B=new p2(M,_,m,b,z);B.tile=T,e.push(B)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const n=fi(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const n=Date.now();let s=!1;if(this.expirationTime>n)s=!1;else if(r)if(this.expirationTime<r)s=!0;else{const c=this.expirationTime-r;c?this.expirationTime=n+Math.max(c,3e4):s=!0}else s=!0;s?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!r)return;const n=this.latestFeatureIndex.loadVTLayers(),s=r.style.listImages();for(const c in this.buckets){if(!r.style.hasLayer(c))continue;const h=this.buckets[c],d=h.layers[0].sourceLayer||"_geojsonTileLayer",_=n[d],m=e[d];if(!_||!m||Object.keys(m).length===0)continue;if(h.update(m,_,s,this.imageAtlas&&this.imageAtlas.patternPositions||{}),h instanceof h9||h instanceof s9){const T=r.style._getSourceCache(h.layers[0].source);r._terrain&&r._terrain.enabled&&T&&h.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(T.id,this.tileID)}const b=r&&r.style&&r.style.getLayer(c);b&&(this.queryPadding=Math.max(this.queryPadding,b.queryRadius(h)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<zi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=zi.now()+e}setTexture(e,r){const n=r.context,s=n.gl;this.texture=r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Pl(n,e,s.RGBA,{useMipmap:!0}),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),n.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax))}setDependencies(e,r){const n={};for(const s of r)n[s]=!0;this.dependencies[e]=n}hasDependency(e,r){for(const n of e){const s=this.dependencies[n];if(s){for(const c of r)if(s[c])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const n=So(_2,this.tileID.canonical,this.tileTransform)[0],s=new Dt,c=new _n;for(let h=0;h<n.length;h++){const{x:d,y:_}=n[h];s.emplaceBack(d,_),c.emplaceBack(h)}c.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(c),this._tileDebugBuffer=e.createVertexBuffer(s,El.members),this._tileDebugSegments=Ni.simpleSegment(0,0,s.length,c.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const n=So(_2,this.tileID.canonical,this.tileTransform)[0];let s,c;if(this.isRaster){const h=function(d,_){const m=es(d,_),b=Math.pow(2,d.z);for(let q=0;q<Qn;q++)for(let H=0;H<Qn;H++){const se=Sr((d.x+(H+d2(H))/xn)/b),oe=Yi((d.y+(q+d2(q))/xn)/b),le=_.project(se,oe),he=q*Qn+H;eo[2*he+0]=Math.round((le.x*m.scale-m.x)*kt),eo[2*he+1]=Math.round((le.y*m.scale-m.y)*kt)}la.fill(0),E9.fill(0);for(let q=2045;q>=0;q--){const H=4*q,se=sa[H+0],oe=sa[H+1],le=sa[H+2],he=sa[H+3],de=se+le>>1,Se=oe+he>>1,Ee=de+Se-oe,Re=Se+se-de,Ge=oe*Qn+se,be=he*Qn+le,Pe=Se*Qn+de,Ue=Math.hypot((eo[2*Ge+0]+eo[2*be+0])/2-eo[2*Pe+0],(eo[2*Ge+1]+eo[2*be+1])/2-eo[2*Pe+1])>=16;if(la[Pe]=la[Pe]||(Ue?1:0),q<1022){const je=(oe+Re>>1)*Qn+(se+Ee>>1),at=(he+Re>>1)*Qn+(le+Ee>>1);la[Pe]=la[Pe]||la[je]||la[at]}}const T=new Pt,S=new Di;let M=0;function z(q,H){const se=H*Qn+q;return E9[se]===0&&(T.emplaceBack(eo[2*se+0],eo[2*se+1],q*kt/xn,H*kt/xn),E9[se]=++M),E9[se]-1}function B(q,H,se,oe,le,he){const de=q+se>>1,Se=H+oe>>1;if(Math.abs(q-le)+Math.abs(H-he)>1&&la[Se*Qn+de])B(le,he,q,H,de,Se),B(se,oe,le,he,de,Se);else{const Ee=z(q,H),Re=z(se,oe),Ge=z(le,he);S.emplaceBack(Ee,Re,Ge)}}return B(0,0,xn,xn,xn,0),B(xn,xn,0,0,0,xn),{vertices:T,indices:S}}(this.tileID.canonical,r);s=h.vertices,c=h.indices}else{s=new Pt,c=new Di;for(const{x:d,y:_}of n)s.emplaceBack(d,_,0,0);const h=i9(s.int16,void 0,4);for(let d=0;d<h.length;d+=3)c.emplaceBack(h[d],h[d+1],h[d+2])}this._tileBoundsBuffer=e.createVertexBuffer(s,f2.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(c),this._tileBoundsSegments=Ni.simpleSegment(0,0,s.length,c.length)}_makeGlobeTileDebugBuffers(e,r){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!r||r.name!=="globe")return;const n=this.tileID.canonical,s=Al(Kn(n));this._makeGlobeTileDebugBorderBuffer(e,n,s),this._makeGlobeTileDebugTextBuffer(e,n,s)}_makeGlobeTileDebugBorderBuffer(e,r,n){const s=new Dt,c=new _n,h=new vt,d=(m,b,T,S,M)=>{const z=(T-m)/(M-1),B=(S-b)/(M-1),q=s.length;for(let H=0;H<M;H++){const se=m+H*z,oe=b+H*B;s.emplaceBack(se,oe);const le=Qh(se,oe,r),he=fr(le,le,n);h.emplaceBack(he[0],he[1],he[2]),c.emplaceBack(q+H)}},_=kt;d(0,0,_,0,16),d(_,0,_,_,16),d(_,_,0,_,16),d(0,_,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(c),this._tileDebugBuffer=e.createVertexBuffer(s,El.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(h,Hh.members),this._tileDebugSegments=Ni.simpleSegment(0,0,s.length,c.length)}_makeGlobeTileDebugTextBuffer(e,r,n){const s=new Dt,c=new Di,h=new vt,d=25;c.reserve(32),s.reserve(d),h.reserve(d);const _=(m,b)=>d*m+b;for(let m=0;m<d;m++){const b=2048*m;for(let T=0;T<d;T++){const S=2048*T;s.emplaceBack(S,b);const M=Qh(S,b,r),z=fr(M,M,n);h.emplaceBack(z[0],z[1],z[2])}}for(let m=0;m<4;m++)for(let b=0;b<4;b++){const T=_(m,b),S=_(m,b+1),M=_(m+1,b),z=_(m+1,b+1);c.emplaceBack(T,S,M),c.emplaceBack(M,S,z)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(c),this._tileDebugTextBuffer=e.createVertexBuffer(s,El.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(h,Hh.members),this._tileDebugTextSegments=Ni.simpleSegment(0,0,d,32)}}class Of{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){const s=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][s]=this.stateChanges[e][s]||{},He(this.stateChanges[e][s],n),this.deletedStates[e]===null){this.deletedStates[e]={};for(const c in this.state[e])c!==s&&(this.deletedStates[e][c]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][s]===null){this.deletedStates[e][s]={};for(const c in this.state[e][s])n[c]||(this.deletedStates[e][s][c]=null)}else for(const c in n)this.deletedStates[e]&&this.deletedStates[e][s]&&this.deletedStates[e][s][c]===null&&delete this.deletedStates[e][s][c]}removeFeatureState(e,r,n){if(this.deletedStates[e]===null)return;const s=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&r!==void 0)this.deletedStates[e][s]!==null&&(this.deletedStates[e][s]=this.deletedStates[e][s]||{},this.deletedStates[e][s][n]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][s])for(n in this.deletedStates[e][s]={},this.stateChanges[e][s])this.deletedStates[e][s][n]=null;else this.deletedStates[e][s]=null;else this.deletedStates[e]=null}getState(e,r){const n=String(r),s=He({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const c=this.deletedStates[e][r];if(c===null)return{};for(const h in c)delete s[h]}return s}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const n={};for(const s in this.stateChanges){this.state[s]=this.state[s]||{};const c={};for(const h in this.stateChanges[s])this.state[s][h]||(this.state[s][h]={}),He(this.state[s][h],this.stateChanges[s][h]),c[h]=this.state[s][h];n[s]=c}for(const s in this.deletedStates){this.state[s]=this.state[s]||{};const c={};if(this.deletedStates[s]===null)for(const h in this.state[s])c[h]={},this.state[s][h]={};else for(const h in this.deletedStates[s]){if(this.deletedStates[s][h]===null)this.state[s][h]={};else for(const d of Object.keys(this.deletedStates[s][h]))delete this.state[s][h][d];c[h]=this.state[s][h]}n[s]=n[s]||{},He(n[s],c)}if(this.stateChanges={},this.deletedStates={},Object.keys(n).length!==0)for(const s in e)e[s].setFeatureState(n,r)}}class m2{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const n=this.toIdx(e,r);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function g2(i,e,r,n){let s=0,c=Number.MAX_VALUE;for(let h=0;h<3;h++)if(Math.abs(n[h])<1e-15){if(r[h]<i[h]||r[h]>e[h])return null}else{const d=1/n[h];let _=(i[h]-r[h])*d,m=(e[h]-r[h])*d;if(_>m){const b=_;_=m,m=b}if(_>s&&(s=_),m<c&&(c=m),s>c)return null}return s}function y2(i,e,r,n,s,c,h,d,_,m,b){const T=n-i,S=s-e,M=c-r,z=h-i,B=d-e,q=_-r,H=b[1]*q-b[2]*B,se=b[2]*z-b[0]*q,oe=b[0]*B-b[1]*z,le=T*H+S*se+M*oe;if(Math.abs(le)<1e-15)return null;const he=1/le,de=m[0]-i,Se=m[1]-e,Ee=m[2]-r,Re=(de*H+Se*se+Ee*oe)*he;if(Re<0||Re>1)return null;const Ge=Se*M-Ee*S,be=Ee*T-de*M,Pe=de*S-Se*T,Ue=(b[0]*Ge+b[1]*be+b[2]*Pe)*he;return Ue<0||Re+Ue>1?null:(z*Ge+B*be+q*Pe)*he}function x2(i,e,r){return(i-e)/(r-e)}function v2(i,e,r,n,s,c,h,d,_){const m=1<<r,b=c-n,T=h-s,S=(i+1)/m*b+n,M=(e+0)/m*T+s,z=(e+1)/m*T+s;d[0]=(i+0)/m*b+n,d[1]=M,_[0]=S,_[1]=z}class b2{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(c){const h=Math.ceil(Math.log2(c.dim/8)),d=[];let _=Math.ceil(Math.pow(2,h));const m=1/_,b=(M,z,B,q,H)=>{const se=q?1:0,oe=(M+1)*B-se,le=z*B,he=(z+1)*B-se;H[0]=M*B,H[1]=le,H[2]=oe,H[3]=he};let T=new m2(_);const S=[];for(let M=0;M<_*_;M++){b(M%_,Math.floor(M/_),m,!1,S);const z=ca(S[0],S[1],c),B=ca(S[2],S[1],c),q=ca(S[2],S[3],c),H=ca(S[0],S[3],c);T.minimums.push(Math.min(z,B,q,H)),T.maximums.push(Math.max(z,B,q,H)),T.leaves.push(1)}for(d.push(T),_/=2;_>=1;_/=2){const M=d[d.length-1];T=new m2(_);for(let z=0;z<_*_;z++){b(z%_,Math.floor(z/_),2,!0,S);const B=M.getElevation(S[0],S[1]),q=M.getElevation(S[2],S[1]),H=M.getElevation(S[2],S[3]),se=M.getElevation(S[0],S[3]),oe=M.isLeaf(S[0],S[1]),le=M.isLeaf(S[2],S[1]),he=M.isLeaf(S[2],S[3]),de=M.isLeaf(S[0],S[3]),Se=Math.min(B.min,q.min,H.min,se.min),Ee=Math.max(B.max,q.max,H.max,se.max),Re=oe&&le&&he&&de;T.maximums.push(Ee),T.minimums.push(Se),T.leaves.push(Ee-Se<=5&&Re?1:0)}d.push(T)}return d}(this.dem),n=r.length-1,s=r[n];this._addNode(s.minimums[0],s.maximums[0],s.leaves[0]),this._construct(r,0,0,n,0)}raycastRoot(e,r,n,s,c,h,d=1){return g2([e,r,-100],[n,s,this.maximums[0]*d],c,h)}raycast(e,r,n,s,c,h,d=1){if(!this.nodeCount)return null;const _=this.raycastRoot(e,r,n,s,c,h,d);if(_==null)return null;const m=[],b=[],T=[],S=[],M=[{idx:0,t:_,nodex:0,nodey:0,depth:0}];for(;M.length>0;){const{idx:z,t:B,nodex:q,nodey:H,depth:se}=M.pop();if(this.leaves[z]){v2(q,H,se,e,r,n,s,T,S);const le=1<<se,he=(q+0)/le,de=(q+1)/le,Se=(H+0)/le,Ee=(H+1)/le,Re=ca(he,Se,this.dem)*d,Ge=ca(de,Se,this.dem)*d,be=ca(de,Ee,this.dem)*d,Pe=ca(he,Ee,this.dem)*d,Ue=y2(T[0],T[1],Re,S[0],T[1],Ge,S[0],S[1],be,c,h),je=y2(S[0],S[1],be,T[0],S[1],Pe,T[0],T[1],Re,c,h),at=Math.min(Ue!==null?Ue:Number.MAX_VALUE,je!==null?je:Number.MAX_VALUE);if(at!==Number.MAX_VALUE)return at;{const Fe=t9([],c,h,B);if(w2(Re,Ge,Pe,be,x2(Fe[0],T[0],S[0]),x2(Fe[1],T[1],S[1]))>=Fe[2])return B}continue}let oe=0;for(let le=0;le<this._siblingOffset.length;le++){v2((q<<1)+this._siblingOffset[le][0],(H<<1)+this._siblingOffset[le][1],se+1,e,r,n,s,T,S),T[2]=-100,S[2]=this.maximums[this.childOffsets[z]+le]*d;const he=g2(T,S,c,h);if(he!=null){const de=he;m[le]=de;let Se=!1;for(let Ee=0;Ee<oe&&!Se;Ee++)de>=m[b[Ee]]&&(b.splice(Ee,0,le),Se=!0);Se||(b[oe]=le),oe++}}for(let le=0;le<oe;le++){const he=b[le];M.push({idx:this.childOffsets[z]+he,t:m[he],nodex:(q<<1)+this._siblingOffset[he][0],nodey:(H<<1)+this._siblingOffset[he][1],depth:se+1})}}return null}_addNode(e,r,n){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,n,s,c){if(e[s].isLeaf(r,n)===1)return;this.childOffsets[c]||(this.childOffsets[c]=this.nodeCount);const h=s-1,d=e[h];let _=0,m=0;for(let b=0;b<this._siblingOffset.length;b++){const T=2*r+this._siblingOffset[b][0],S=2*n+this._siblingOffset[b][1],M=d.getElevation(T,S),z=d.isLeaf(T,S),B=this._addNode(M.min,M.max,z);z&&(_|=1<<b),m||(m=B)}for(let b=0;b<this._siblingOffset.length;b++)_&1<<b||this._construct(e,2*r+this._siblingOffset[b][0],2*n+this._siblingOffset[b][1],h,m+b)}}function w2(i,e,r,n,s,c){return Yt(Yt(i,r,c),Yt(e,n,c),s)}function ca(i,e,r){const n=r.dim,s=xe(i*n-.5,0,n-1),c=xe(e*n-.5,0,n-1),h=Math.floor(s),d=Math.floor(c),_=Math.min(h+1,n-1),m=Math.min(d+1,n-1);return w2(r.get(h,d),r.get(_,d),r.get(h,m),r.get(_,m),s-h,c-d)}const T2={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class A9{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,n,s=!1,c=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&n!=="mapbox"&&n!=="terrarium")return _t(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const h=this.dim=r.height-2,d=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=n||"mapbox",this.borderReady=s,!s){for(let _=0;_<h;_++)d[this._idx(-1,_)]=d[this._idx(0,_)],d[this._idx(h,_)]=d[this._idx(h-1,_)],d[this._idx(_,-1)]=d[this._idx(_,0)],d[this._idx(_,h)]=d[this._idx(_,h-1)];d[this._idx(-1,-1)]=d[this._idx(0,0)],d[this._idx(h,-1)]=d[this._idx(h-1,0)],d[this._idx(-1,h)]=d[this._idx(0,h-1)],d[this._idx(h,h)]=d[this._idx(h-1,h-1)],c&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new b2(this)}get(e,r,n=!1){n&&(e=xe(e,-1,this.dim),r=xe(r,-1,this.dim));const s=4*this._idx(e,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[s],this.pixels[s+1],this.pixels[s+2])}static getUnpackVector(e){return T2[e]}get unpackVector(){return T2[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}_unpackMapbox(e,r,n){return(256*e*256+256*r+n)/10-1e4}_unpackTerrarium(e,r,n){return 256*e+r+n/256-32768}static pack(e,r){const n=[0,0,0,0],s=A9.getUnpackVector(r);let c=Math.floor((e+s[3])/s[2]);return n[2]=c%256,c=Math.floor(c/256),n[1]=c%256,c=Math.floor(c/256),n[0]=c,n}getPixels(){return new Jr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let s=r*this.dim,c=r*this.dim+this.dim,h=n*this.dim,d=n*this.dim+this.dim;switch(r){case-1:s=c-1;break;case 1:c=s+1}switch(n){case-1:h=d-1;break;case 1:d=h+1}const _=-r*this.dim,m=-n*this.dim;for(let b=h;b<d;b++)for(let T=s;T<c;T++){const S=4*this._idx(T,b),M=4*this._idx(T+_,b+m);this.pixels[S+0]=e.pixels[M+0],this.pixels[S+1]=e.pixels[M+1],this.pixels[S+2]=e.pixels[M+2],this.pixels[S+3]=e.pixels[M+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ct(A9,"DEMData"),ct(b2,"DemMinMaxQuadTree",{omit:["dem"]});class Ff{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,n){const s=e.wrapped().key;this.data[s]===void 0&&(this.data[s]=[]);const c={value:r,timeout:void 0};if(n!==void 0&&(c.timeout=setTimeout(()=>{this.remove(e,c)},n)),this.data[s].push(c),this.order.push(s),this.order.length>this.max){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const n=e.wrapped().key,s=r===void 0?0:this.data[n].indexOf(r),c=this.data[n][s];return this.data[n].splice(s,1),c.timeout&&clearTimeout(c.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(c.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const n in this.data)for(const s of this.data[n])e(s.value)||r.push(s);for(const n of r)this.remove(n.value.tileID,n)}}class f1{constructor(e,r,n){this.func=e,this.mask=r,this.range=n}}f1.ReadOnly=!1,f1.ReadWrite=!0,f1.disabled=new f1(519,f1.ReadOnly,[0,1]);const f0=7680;class _0{constructor(e,r,n,s,c,h){this.test=e,this.ref=r,this.mask=n,this.fail=s,this.depthFail=c,this.pass=h}}_0.disabled=new _0({func:519,mask:0},0,0,f0,f0,f0);class to{constructor(e,r,n){this.blendFunction=e,this.blendColor=r,this.mask=n}}to.Replace=[1,0],to.disabled=new to(to.Replace,Bi.transparent,[!1,!1,!1,!1]),to.unblended=new to(to.Replace,Bi.transparent,[!0,!0,!0,!0]),to.alphaBlended=new to([1,771],Bi.transparent,[!0,!0,!0,!0]);const m0=1029,g0=2305;class Fn{constructor(e,r,n){this.enable=e,this.mode=r,this.frontFace=n}}Fn.disabled=new Fn(!1,m0,g0),Fn.backCCW=new Fn(!0,m0,g0),Fn.backCW=new Fn(!0,m0,2304),Fn.frontCW=new Fn(!0,1028,2304),Fn.frontCCW=new Fn(!0,1028,g0);class ts extends li{constructor(e,r,n){super(),this.id=e,this._onlySymbols=n,r.on("data",s=>{s.dataType==="source"&&s.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&s.dataType==="source"&&s.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new Ff(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Of,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const r in this._tiles){const n=this._tiles[r];this._source.prepareTile(n)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,n.tileID),n.upload(e),n.prepare(this.map.style.imageManager)}else for(const r in this._tiles){const n=this._tiles[r];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return wt(this._tiles).map(e=>e.tileID).sort(I2).map(e=>e.key)}getRenderableIds(e){const r=[];for(const n in this._tiles)this._isIdRenderable(+n,e)&&r.push(this._tiles[n]);return e?r.sort((n,s)=>{const c=n.tileID,h=s.tileID,d=new N(c.canonical.x,c.canonical.y)._rotate(this.transform.angle),_=new N(h.canonical.x,h.canonical.y)._rotate(this.transform.angle);return c.overscaledZ-h.overscaledZ||_.y-d.y||_.x-d.x}).map(n=>n.tileID.key):r.map(n=>n.tileID).sort(I2).map(n=>n.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const n=this._tiles[e];n&&(n.state!=="loading"&&(n.state=r),this._loadTile(n,this._tileLoaded.bind(this,n,e,r)))}_tileLoaded(e,r,n,s){if(s)if(e.state="errored",s.status!==404)this._source.fire(new xi(s,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const c=this.map.painter.terrain;this.update(this.transform,c.getScaledDemTileSize(),!0),c.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=zi.now(),n==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new ti("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let s=0;s<r.length;s++){const c=r[s];if(e.neighboringTiles&&e.neighboringTiles[c]){const h=this.getTileByID(c);n(e,h),n(h,e)}}function n(s,c){if(!s.dem||s.dem.borderReady)return;s.needsHillshadePrepare=!0,s.needsDEMTextureUpload=!0;let h=c.tileID.canonical.x-s.tileID.canonical.x;const d=c.tileID.canonical.y-s.tileID.canonical.y,_=Math.pow(2,s.tileID.canonical.z),m=c.tileID.key;h===0&&d===0||Math.abs(d)>1||(Math.abs(h)>1&&(Math.abs(h+_)===1?h+=_:Math.abs(h-_)===1&&(h-=_)),c.dem&&s.dem&&(s.dem.backfillBorder(c.dem,h,d),s.neighboringTiles&&s.neighboringTiles[m]&&(s.neighboringTiles[m].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,n,s){for(const c in this._tiles){let h=this._tiles[c];if(s[c]||!h.hasData()||h.tileID.overscaledZ<=r||h.tileID.overscaledZ>n)continue;let d=h.tileID;for(;h&&h.tileID.overscaledZ>r+1;){const m=h.tileID.scaledTo(h.tileID.overscaledZ-1);h=this._tiles[m.key],h&&h.hasData()&&(d=m)}let _=d;for(;_.overscaledZ>r;)if(_=_.scaledTo(_.overscaledZ-1),e[_.key]){s[d.key]=d;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=r?n:null}for(let n=e.overscaledZ-1;n>=r;n--){const s=e.scaledTo(n),c=this._getLoadedTile(s);if(c)return c}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const n=Math.ceil(e.width/r)+1,s=Math.ceil(e.height/r)+1,c=Math.floor(n*s*5),h=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,c):c,d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const n={};for(const s in this._tiles){const c=this._tiles[s];c.tileID=c.tileID.unwrapTo(c.tileID.wrap+r),n[c.tileID.key]=c}this._tiles=n;for(const s in this._timers)clearTimeout(this._timers[s]),delete this._timers[s];for(const s in this._tiles)this._setTileReloadTimer(+s,this._tiles[s])}}update(e,r,n){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!n)return;let s;this.updateCacheSize(e,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?s=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new Ar(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(s=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(s=s.filter(d=>this._source.hasTile(d)))):s=[];const c=this._updateRetainedTiles(s);if(S2(this._source.type)&&s.length!==0){const d={},_={},m=Object.keys(c);for(const T of m){const S=c[T],M=this._tiles[T];if(!M||M.fadeEndTime&&M.fadeEndTime<=zi.now())continue;const z=this.findLoadedParent(S,Math.max(S.overscaledZ-ts.maxOverzooming,this._source.minzoom));z&&(this._addTile(z.tileID),d[z.tileID.key]=z.tileID),_[T]=S}const b=s[s.length-1].overscaledZ;for(const T in this._tiles){const S=this._tiles[T];if(c[T]||!S.hasData())continue;let M=S.tileID;for(;M.overscaledZ>b;){M=M.scaledTo(M.overscaledZ-1);const z=this._tiles[M.key];if(z&&z.hasData()&&_[M.key]){c[T]=S.tileID;break}}}for(const T in d)c[T]||(this._coveredTiles[T]=!0,c[T]=d[T])}for(const d in c)this._tiles[d].clearFadeHold();const h=function(d,_){const m=[];for(const b in d)b in _||m.push(b);return m}(this._tiles,c);for(const d of h){const _=this._tiles[d];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(+d)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(e.length===0)return r;const n={},s=e.reduce((m,b)=>Math.min(m,b.overscaledZ),1/0),c=e[0].overscaledZ,h=Math.max(c-ts.maxOverzooming,this._source.minzoom),d=Math.max(c+ts.maxUnderzooming,this._source.minzoom),_={};for(const m of e){const b=this._addTile(m);r[m.key]=m,b.hasData()||s<this._source.maxzoom&&(_[m.key]=m)}this._retainLoadedChildren(_,s,d,r);for(const m of e){let b=this._tiles[m.key];if(b.hasData())continue;if(m.canonical.z>=this._source.maxzoom){const S=m.children(this._source.maxzoom)[0],M=this.getTile(S);if(M&&M.hasData()){r[S.key]=S;continue}}else{const S=m.children(this._source.maxzoom);if(r[S[0].key]&&r[S[1].key]&&r[S[2].key]&&r[S[3].key])continue}let T=b.wasRequested();for(let S=m.overscaledZ-1;S>=h;--S){const M=m.scaledTo(S);if(n[M.key]||(n[M.key]=!0,b=this.getTile(M),!b&&T&&(b=this._addTile(M)),b&&(r[M.key]=M,T=b.wasRequested(),b.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let n,s=this._tiles[e].tileID;for(;s.overscaledZ>0;){if(s.key in this._loadedParentTiles){n=this._loadedParentTiles[s.key];break}r.push(s.key);const c=s.scaledTo(s.overscaledZ-1);if(n=this._getLoadedTile(c),n)break;s=c}for(const c of r)this._loadedParentTiles[c]=n}}_addTile(e){let r=this._tiles[e.key];if(r)return this._source.prepareTile&&this._source.prepareTile(r),r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const n=Boolean(r);if(!n){const s=this.map?this.map.painter:null;r=new d0(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,s,this._isRaster),this._source.prepareTile&&this._source.prepareTile(r)||this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,n||this._source.fire(new ti("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=r.getExpiryTimeout();n&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},n))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,n){const s=[],c=this.transform;if(!c)return s;const h=c.projection.name==="globe",d=qa(c.center.lng);for(const _ in this._tiles){const m=this._tiles[_];if(n&&m.clearQueryDebugViz(),m.holdingForFade())continue;let b;if(h){const T=m.tileID.canonical;if(T.z===0){const S=[Math.abs(xe(d,...Dl(T,-1))-d),Math.abs(xe(d,...Dl(T,1))-d)];b=[0,2*S.indexOf(Math.min(...S))-1]}else{const S=[Math.abs(xe(d,...Dl(T,-1))-d),Math.abs(xe(d,...Dl(T,0))-d),Math.abs(xe(d,...Dl(T,1))-d)];b=[S.indexOf(Math.min(...S))-1]}}else b=[0];for(const T of b){const S=e.containsTile(m,c,r,T);S&&s.push(S)}}return s}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(n=>this._tiles[n].tileID);for(const n of r)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(S2(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=zi.now())return!0}return!1}setFeatureState(e,r,n){this._state.updateState(e=e||"_geojsonTileLayer",r,n)}removeFeatureState(e,r,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,n)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,n){const s=this._tiles[e];s&&s.setDependencies(r,n)}reloadTilesForDependencies(e,r){for(const n in this._tiles)this._tiles[n].hasDependency(e,r)&&this._reloadTile(+n,"reloading");this._cache.filter(n=>!n.hasDependency(e,r))}_preloadTiles(e,r){const n=new Map,s=Array.isArray(e)?e:[e],c=this.map.painter.terrain,h=this.usedForTerrain&&c?c.getScaledDemTileSize():this._source.tileSize;for(const d of s){const _=d.coveringTiles({tileSize:h,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const m of _)n.set(m.key,m);this.usedForTerrain&&d.updateElevation(!1)}gt(Array.from(n.values()),(d,_)=>{const m=new d0(d,this._source.tileSize*d.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(m,b=>{this._source.type==="raster-dem"&&m.dem&&this._backfillDEM(m),_(b,m)})},r)}}function I2(i,e){const r=Math.abs(2*i.wrap)-+(i.wrap<0),n=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||n-r||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function S2(i){return i==="raster"||i==="image"||i==="video"}function Dl(i,e){const r=1<<i.z;return[i.x/r+e,(i.x+1)/r+e]}ts.maxOverzooming=10,ts.maxUnderzooming=3;class k9{constructor(e,r,n){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=n}static create(e,r,n){const s=n||e.findDEMTileFor(r);if(!s||!s.dem)return;const c=s.dem,h=s.tileID,d=1<<r.canonical.z-h.canonical.z;return new k9(s,s.tileSize/kt/d,[(r.canonical.x/d-h.canonical.x)*c.dim,(r.canonical.y/d-h.canonical.y)*c.dim])}tileCoordToPixel(e,r){const n=r*this._scale+this._offset[1],s=Math.floor(e*this._scale+this._offset[0]),c=Math.floor(n);return new N(s,c)}getElevationAt(e,r,n,s){const c=e*this._scale+this._offset[0],h=r*this._scale+this._offset[1],d=Math.floor(c),_=Math.floor(h),m=this._dem;return s=!!s,n?Yt(Yt(m.get(d,_,s),m.get(d,_+1,s),h-_),Yt(m.get(d+1,_,s),m.get(d+1,_+1,s),h-_),c-d):m.get(d,_,s)}getElevationAtPixel(e,r,n){return this._dem.get(e,r,!!n)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*mn(1,e)*this._dem.stride}}class E2{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Jo(kt,16,0),this.featureIndexArray=new wu,this.promoteId=r}insert(e,r,n,s,c,h=0){const d=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,s,c,h);const _=this.grid;for(let m=0;m<r.length;m++){const b=r[m],T=[1/0,1/0,-1/0,-1/0];for(let S=0;S<b.length;S++){const M=b[S];T[0]=Math.min(T[0],M.x),T[1]=Math.min(T[1],M.y),T[2]=Math.max(T[2],M.x),T[3]=Math.max(T[3],M.y)}T[0]<kt&&T[1]<kt&&T[2]>=0&&T[3]>=0&&_.insert(d,T[0],T[1],T[2],T[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ka.VectorTile(new Tl(this.rawTileData)).layers,this.sourceLayerCoder=new h2(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,n,s){this.loadVTLayers();const c=e.params||{},h=go(c.filter),d=e.tileResult,_=e.transform,m=d.bufferedTilespaceBounds,b=this.grid.query(m.min.x,m.min.y,m.max.x,m.max.y,(z,B,q,H)=>Gu(d.bufferedTilespaceGeometry,z,B,q,H));b.sort(Nf);let T=null;_.elevation&&b.length>0&&(T=k9.create(_.elevation,this.tileID));const S={};let M;for(let z=0;z<b.length;z++){const B=b[z];if(B===M)continue;M=B;const q=this.featureIndexArray.get(B);let H=null;this.loadMatchingFeature(S,q,h,c.layers,c.availableImages,r,n,s,(se,oe,le,he=0)=>(H||(H=So(se,this.tileID.canonical,e.tileTransform)),oe.queryIntersectsFeature(d,se,le,H,this.z,e.transform,e.pixelPosMatrix,T,he)))}return S}loadMatchingFeature(e,r,n,s,c,h,d,_,m){const{featureIndex:b,bucketIndex:T,sourceLayerIndex:S,layoutVertexArrayOffset:M}=r,z=this.bucketLayerIDs[T];if(s&&!function(se,oe){for(let le=0;le<se.length;le++)if(oe.indexOf(se[le])>=0)return!0;return!1}(s,z))return;const B=this.sourceLayerCoder.decode(S),q=this.vtLayers[B].feature(b);if(n.needGeometry){const se=Xa(q,!0);if(!n.filter(new V(this.tileID.overscaledZ),se,this.tileID.canonical))return}else if(!n.filter(new V(this.tileID.overscaledZ),q))return;const H=this.getId(q,B);for(let se=0;se<z.length;se++){const oe=z[se];if(s&&s.indexOf(oe)<0)continue;const le=h[oe];if(!le)continue;let he={};H!==void 0&&_&&(he=_.getState(le.sourceLayer||"_geojsonTileLayer",H));const de=He({},d[oe]);de.paint=A2(de.paint,le.paint,q,he,c),de.layout=A2(de.layout,le.layout,q,he,c);const Se=!m||m(q,le,he,M);if(!Se)continue;const Ee=new p2(q,this.z,this.x,this.y,H);Ee.layer=de;let Re=e[oe];Re===void 0&&(Re=e[oe]=[]),Re.push({featureIndex:b,feature:Ee,intersectionZ:Se})}}lookupSymbolFeatures(e,r,n,s,c,h,d,_){const m={};this.loadVTLayers();const b=go(c);for(const T of e)this.loadMatchingFeature(m,{bucketIndex:n,sourceLayerIndex:s,featureIndex:T,layoutVertexArrayOffset:0},b,h,d,_,r);return m}loadFeature(e){const{featureIndex:r,sourceLayerIndex:n}=e;this.loadVTLayers();const s=this.sourceLayerCoder.decode(n),c=this.vtFeatures[s];if(c[r])return c[r];const h=this.vtLayers[s].feature(r);return c[r]=h,h}hasLayer(e){for(const r of this.bucketLayerIDs)for(const n of r)if(e===n)return!0;return!1}getId(e,r){let n=e.id;return this.promoteId&&(n=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof n=="boolean"&&(n=Number(n))),n}}function A2(i,e,r,n,s){return ei(i,(c,h)=>{const d=e instanceof Ze?e.get(h):null;return d&&d.evaluate?d.evaluate(r,n,s):d})}function Nf(i,e){return e-i}ct(E2,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class k2{constructor(e){const r={},n=[];for(const d in e){const _=e[d],m=r[d]={};for(const b in _.glyphs){const T=_.glyphs[+b];if(!T||T.bitmap.width===0||T.bitmap.height===0)continue;const S=T.metrics.localGlyph?2:1,M={x:0,y:0,w:T.bitmap.width+2*S,h:T.bitmap.height+2*S};n.push(M),m[b]=M}}const{w:s,h:c}=J3(n),h=new Eo({width:s||1,height:c||1});for(const d in e){const _=e[d];for(const m in _.glyphs){const b=_.glyphs[+m];if(!b||b.bitmap.width===0||b.bitmap.height===0)continue;const T=r[d][m],S=b.metrics.localGlyph?2:1;Eo.copy(b.bitmap,h,{x:0,y:0},{x:T.x+S,y:T.y+S},b.bitmap)}}this.image=h,this.positions=r}}ct(k2,"GlyphAtlas");class Gf{constructor(e){this.tileID=new Ar(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=es(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,r,n,s,c){this.status="parsing",this.data=e,this.collisionBoxArray=new w3;const h=new h2(Object.keys(e.layers).sort()),d=new E2(this.tileID,this.promoteId);d.bucketLayerIDs=[];const _={},m=new p0(256,256),b={featureIndex:d,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:m,availableImages:n},T=r.familiesBySource[this.source];for(const he in T){const de=e.layers[he];if(!de)continue;let Se=!1,Ee=!1;for(const be of T[he])be[0].type==="symbol"?Se=!0:Ee=!0;if(this.isSymbolTile===!0&&!Se||this.isSymbolTile===!1&&!Ee)continue;de.version===1&&_t(`Vector tile source "${this.source}" layer "${he}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Re=h.encode(he),Ge=[];for(let be=0;be<de.length;be++){const Pe=de.feature(be),Ue=d.getId(Pe,he);Ge.push({feature:Pe,id:Ue,index:be,sourceLayerIndex:Re})}for(const be of T[he]){const Pe=be[0];this.isSymbolTile!==void 0&&Pe.type==="symbol"!==this.isSymbolTile||Pe.minzoom&&this.zoom<Math.floor(Pe.minzoom)||Pe.maxzoom&&this.zoom>=Pe.maxzoom||Pe.visibility!=="none"&&(y0(be,this.zoom,n),(_[Pe.id]=Pe.createBucket({index:d.bucketLayerIDs.length,layers:be,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Re,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:n})).populate(Ge,b,this.tileID.canonical,this.tileTransform),d.bucketLayerIDs.push(be.map(Ue=>Ue.id)))}}let S,M,z,B;m.trim();const q={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},H=ei(b.glyphDependencies,he=>Object.keys(he).map(Number));Object.keys(H).length?s.send("getGlyphs",{uid:this.uid,stacks:H},(he,de)=>{S||(S=he,M=de,le.call(this))},void 0,!1,q):M={};const se=Object.keys(b.iconDependencies);se.length?s.send("getImages",{icons:se,source:this.source,tileID:this.tileID,type:"icons"},(he,de)=>{S||(S=he,z=de,le.call(this))},void 0,!1,q):z={};const oe=Object.keys(b.patternDependencies);function le(){if(S)return c(S);if(M&&z&&B){const he=new k2(M),de=new Mh(z,B);for(const Se in _){const Ee=_[Se];Ee instanceof aa?(y0(Ee.layers,this.zoom,n),lf(Ee,M,he.positions,z,de.iconPositions,this.showCollisionBoxes,n,this.tileID.canonical,this.tileZoom,this.projection)):Ee.hasPattern&&(Ee instanceof h9||Ee instanceof s9||Ee instanceof xl)&&(y0(Ee.layers,this.zoom,n),Ee.addFeatures(b,this.tileID.canonical,de.patternPositions,n,this.tileTransform))}this.status="done",c(null,{buckets:wt(_).filter(Se=>!Se.isEmpty()),featureIndex:d,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:he.image,lineAtlas:m,imageAtlas:de,glyphMap:this.returnDependencies?M:null,iconMap:this.returnDependencies?z:null,glyphPositions:this.returnDependencies?he.positions:null})}}oe.length?s.send("getImages",{icons:oe,source:this.source,tileID:this.tileID,type:"patterns"},(he,de)=>{S||(S=he,B=de,le.call(this))},void 0,!1,q):B={},le.call(this)}}function y0(i,e,r){const n=new V(e);for(const s of i)s.recalculate(n,r)}class M2{constructor(e){this.entries={},this.scheduler=e}request(e,r,n,s){const c=this.entries[e]=this.entries[e]||{callbacks:[]};if(c.result){const[h,d]=c.result;return this.scheduler?this.scheduler.add(()=>{s(h,d)},r):s(h,d),()=>{}}return c.callbacks.push(s),c.cancel||(c.cancel=n((h,d)=>{c.result=[h,d];for(const _ of c.callbacks)this.scheduler?this.scheduler.add(()=>{_(h,d)},r):_(h,d);setTimeout(()=>delete this.entries[e],3e3)})),()=>{c.result||(c.callbacks=c.callbacks.filter(h=>h!==s),c.callbacks.length||(c.cancel(),delete this.entries[e]))}}}function C2(i,e,r){const n=JSON.stringify(i.request);return i.data&&(this.deduped.entries[n]={result:[null,i.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},s=>{const c=pe(i.request,(h,d,_,m)=>{h?s(h):d&&s(null,{vectorTile:r?void 0:new Ka.VectorTile(new Tl(d)),rawData:d,cacheControl:_,expires:m})});return()=>{c.cancel(),s()}},e)}o.ARRAY_TYPE=Wr,o.AUTH_ERR_MSG=Lr,o.Aabb=on,o.Actor=class{constructor(i,e,r){this.target=i,this.parent=e,this.mapId=r,this.callbacks={},this.cancelCallbacks={},St(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Bt()?i:Z,this.scheduler=new Rf}send(i,e,r,n,s=!1,c){const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=c,this.callbacks[h]=r);const d=wi(this.globalScope)?void 0:[];return this.target.postMessage({id:h,type:i,hasCallback:!!r,targetMapId:n,mustQueue:s,sourceMapId:this.mapId,data:Ua(e,d)},d),{cancel:()=>{r&&delete this.callbacks[h],this.target.postMessage({id:h,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(i){const e=i.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const n=this.cancelCallbacks[r];delete this.cancelCallbacks[r],n&&n.cancel()}else if(e.mustQueue||Bt()){const n=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,e),n&&n.metadata||{type:"message"})}else this.processTask(r,e)}processTask(i,e){if(e.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(e.error?r(Va(e.error)):r(null,Va(e.data)))}else{const r=wi(this.globalScope)?void 0:[],n=e.hasCallback?(c,h)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:c?Ua(c):null,data:Ua(h,r)},r)}:c=>{},s=Va(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,s,n);else if(this.parent.getWorkerSource){const c=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,c[0],s.source)[c[1]](s,n)}else n(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=c9,o.Color=Bi,o.ColorMode=to,o.CullFaceMode=Fn,o.DEMData=A9,o.DataConstantProperty=re,o.DedupedRequest=M2,o.DepthMode=f1,o.EXTENT=kt,o.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(!e||i.y<0||i.y>1)return!1;const r=e.getSource().maxzoom,n=1<<r,s=Math.floor(i.x),c=Math.floor((i.x-s)*n),h=Math.floor(i.y*n),d=this.findDEMTileFor(new Ar(r,s,r,c,h));return!(!d||!d.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,r=!0){e==null&&(e=null);const n=this._source();if(!n||i.y<0||i.y>1)return e;const s=n.getSource().maxzoom,c=1<<s,h=Math.floor(i.x),d=i.x-h,_=new Ar(s,h,s,Math.floor(d*c),Math.floor(i.y*c)),m=this.findDEMTileFor(_);if(!m||!m.dem)return e;const b=m.dem,T=1<<m.tileID.canonical.z,S=(d*T-m.tileID.canonical.x)*b.dim,M=(i.y*T-m.tileID.canonical.y)*b.dim,z=Math.floor(S),B=Math.floor(M);return(r?this.exaggeration():1)*Yt(Yt(b.get(z,B),b.get(z,B+1),M-B),Yt(b.get(z+1,B),b.get(z+1,B+1),M-B),S-z)}getAtTileOffset(i,e,r){const n=1<<i.canonical.z;return this.getAtPointOrZero(new t1(i.wrap+(i.canonical.x+e/kt)/n,(i.canonical.y+r/kt)/n))}getAtTileOffsetFunc(i,e,r,n){return s=>{const c=this.getAtTileOffset(i,s.x,s.y),h=n.upVector(i.canonical,s.x,s.y);return Hn(h,h,c*n.upVectorScale(i.canonical,e,r).metersToTile),h}}getForTilePoints(i,e,r,n){const s=k9.create(this,i,n);return!!s&&(e.forEach(c=>{c[2]=this.exaggeration()*s.getElevationAt(c[0],c[1],r)}),!0)}getMinMaxForTile(i){const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const r=e.dem.tree,n=e.tileID,s=1<<i.canonical.z-n.canonical.z;let c=i.canonical.x/s-n.canonical.x,h=i.canonical.y/s-n.canonical.y,d=0;for(let _=0;_<i.canonical.z-n.canonical.z&&!r.leaves[d];_++){c*=2,h*=2;const m=2*Math.floor(h)+Math.floor(c);d=r.childOffsets[d]+m,c%=1,h%=1}return{min:this.exaggeration()*r.minimums[d],max:this.exaggeration()*r.maximums[d]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=xi,o.EvaluationParameters=V,o.Event=ti,o.Evented=li,o.FillExtrusionBucket=xl,o.Frustum=F3,o.FrustumCorners=O3,o.GLOBE_METERS_TO_ECEF=n0,o.GLOBE_RADIUS=Qa,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=6,o.GLOBE_ZOOM_THRESHOLD_MIN=5,o.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_createGrid(i){const e=new Dt,r=new Di,n=65;for(let s=0;s<n;s++)for(let c=0;c<n;c++)e.emplaceBack(c,s);this._gridSegments=[];for(let s=0,c=0;s<p1.length;s++){const h=p1[s];for(let _=0;_<h;_++)for(let m=0;m<64;m++){const b=_*n+m;r.emplaceBack(b+1,b,b+n),r.emplaceBack(b+n,b+n+1,b+1)}const d=64*h*2;this._gridSegments.push(Ni.simpleSegment(0,c,(h+1)*n,d)),c+=d}this._gridBuffer=i.createVertexBuffer(e,El.members),this._gridIndexBuffer=i.createIndexBuffer(r,!0)}_createPoles(i){const e=new Di;for(let s=0;s<=64;s++)e.emplaceBack(0,s+1,s+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const r=new bo,n=new bo;this._poleSegments=[];for(let s=0,c=0;s<5;s++){const h=1<<s,d=512*h/Math.PI/2,_=360/h;r.emplaceBack(0,-d,0,0,0,.5,0),n.emplaceBack(0,-d,0,0,0,.5,1);for(let m=0;m<=64;m++){const b=m/64,T=Yt(0,_,b),[S,M,z]=Kh(_f,mf,T,d);r.emplaceBack(S,M,z,0,0,b,0),n.emplaceBack(S,M,z,0,0,b,1)}this._poleSegments.push(Ni.simpleSegment(c,0,66,64)),c+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(r,Jh,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(n,Jh,!1)}getGridBuffers(i){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[i]]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,e){if(!this._wireframeSegments){const r=new Fr,n=64,s=n+1;this._wireframeSegments=[];for(let c=0,h=0;c<p1.length;c++){const d=p1[c];for(let m=0;m<d;m++)for(let b=0;b<n;b++){const T=m*s+b;r.emplaceBack(T,T+1),r.emplaceBack(T,T+s),r.emplaceBack(T,T+s+1)}const _=d*n*3;this._wireframeSegments.push(Ni.simpleSegment(0,h,(d+1)*s,_)),h+=_}this._wireframeIndexBuffer=i.createIndexBuffer(r)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},o.GlyphManager=u1,o.ImagePosition=H3,o.LineAtlas=p0,o.LngLat=ui,o.LngLatBounds=ea,o.LocalGlyphMode=e0,o.MAX_MERCATOR_LATITUDE=Xn,o.MercatorCoordinate=t1,o.ONE_EM=_r,o.OverscaledTileID=Ar,o.Properties=ft,o.RGBAImage=Jr,o.Ray=B3,o.RequestManager=class{constructor(i,e,r){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_a,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!un(i))return i;const r=Rr(i);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!un(i))return i;const r=Rr(i);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(i,e,r,n){if(!un(i))return i;const s=Rr(i);return s.path=`/v4/${s.authority}.json`,s.params.push("secure"),r&&s.params.push(`language=${r}`),n&&s.params.push(`worldview=${n}`),this._makeAPIURL(s,this._customAccessToken||e)}normalizeSpriteURL(i,e,r,n){const s=Rr(i);return un(i)?(s.path=`/styles/v1${s.path}/sprite${e}${r}`,this._makeAPIURL(s,this._customAccessToken||n)):(s.path+=`${e}${r}`,Mn(s))}normalizeTileURL(i,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!un(i))return i;const n=Rr(i);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&n.authority!=="raster"&&r===512?"@2x":""}${Zi.supported?".webp":"$1"}`),n.authority==="raster"?n.path=`/${Ut.RASTER_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${Ut.TILE_URL_VERSION}${n.path}`);const s=this._customAccessToken||function(c){for(const h of c){const d=h.match(/^access_token=(.*)$/);if(d)return d[1]}return null}(n.params)||Ut.ACCESS_TOKEN;return Ut.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,s)}canonicalizeTileURL(i,e){const r=Rr(i);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return i;let n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+=`raster/${r.path.replace(`/${Ut.RASTER_URL_PREFIX}/`,"")}`:n+=`tiles/${r.path.replace(`/${Ut.TILE_URL_VERSION}/`,"")}`;let s=r.params;return e&&(s=s.filter(c=>!c.match(/^access_token=/))),s.length&&(n+=`?${s.join("&")}`),n}canonicalizeTileset(i,e){const r=!!e&&un(e),n=[];for(const s of i.tiles||[])so(s)?n.push(this.canonicalizeTileURL(s,r)):n.push(s);return n}_makeAPIURL(i,e){const r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=Rr(Ut.API_URL);if(i.protocol=n.protocol,i.authority=n.authority,i.protocol==="http"){const s=i.params.indexOf("secure");s>=0&&i.params.splice(s,1)}if(n.path!=="/"&&(i.path=`${n.path}${i.path}`),!Ut.REQUIRE_ACCESS_TOKEN)return Mn(i);if(e=e||Ut.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return i.params=i.params.filter(s=>s.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),Mn(i)}},o.ResourceType=ie,o.SegmentVector=Ni,o.SourceCache=ts,o.StencilMode=_0,o.StructArrayLayout1ui2=_n,o.StructArrayLayout2f1f2i16=qi,o.StructArrayLayout2i4=Dt,o.StructArrayLayout2ui4=Fr,o.StructArrayLayout3f12=mi,o.StructArrayLayout3ui6=Di,o.StructArrayLayout4i8=Pt,o.StructArrayLayout5f20=Wn,o.Texture=Pl,o.Tile=d0,o.Transitionable=ee,o.Uniform1f=Zc,o.Uniform1i=class extends To{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},o.Uniform2f=class extends To{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},o.Uniform3f=class extends To{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},o.Uniform4f=Mu,o.UniformColor=Cu,o.UniformMatrix2f=class extends To{constructor(i,e){super(i,e),this.current=Tp}set(i){for(let e=0;e<4;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},o.UniformMatrix3f=class extends To{constructor(i,e){super(i,e),this.current=wp}set(i){for(let e=0;e<9;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},o.UniformMatrix4f=class extends To{constructor(i,e){super(i,e),this.current=bp}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},o.UnwrappedTileID=mh,o.ValidationError=lt,o.VectorTileWorkerSource=class extends li{constructor(i,e,r,n,s){super(),this.actor=i,this.layerIndex=e,this.availableImages=r,this.loadVectorData=s||C2,this.loading={},this.loaded={},this.deduped=new M2(i.scheduler),this.isSpriteLoaded=n,this.scheduler=i.scheduler}loadTile(i,e){const r=i.uid,n=i&&i.request,s=n&&n.collectResourceTiming,c=this.loading[r]=new Gf(i);c.abort=this.loadVectorData(i,(h,d)=>{const _=!this.loading[r];if(delete this.loading[r],_||h||!d)return c.status="done",_||(this.loaded[r]=c),e(h);const m=d.rawData,b={};d.expires&&(b.expires=d.expires),d.cacheControl&&(b.cacheControl=d.cacheControl),c.vectorTile=d.vectorTile||new Ka.VectorTile(new Tl(m));const T=()=>{c.parse(c.vectorTile,this.layerIndex,this.availableImages,this.actor,(S,M)=>{if(S||!M)return e(S);const z={};if(s){const B=or(n);B.length>0&&(z.resourceTiming=JSON.parse(JSON.stringify(B)))}e(null,He({rawTileData:m.slice(0)},M,b,z))})};this.isSpriteLoaded?T():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(T,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):T()}),this.loaded=this.loaded||{},this.loaded[r]=c})}reloadTile(i,e){const r=this.loaded,n=i.uid,s=this;if(r&&r[n]){const c=r[n];c.showCollisionBoxes=i.showCollisionBoxes,c.enableTerrain=!!i.enableTerrain,c.projection=i.projection,c.tileTransform=es(i.tileID.canonical,i.projection);const h=(d,_)=>{const m=c.reloadCallback;m&&(delete c.reloadCallback,c.parse(c.vectorTile,s.layerIndex,this.availableImages,s.actor,m)),e(d,_)};c.status==="parsing"?c.reloadCallback=h:c.status==="done"&&(c.vectorTile?c.parse(c.vectorTile,this.layerIndex,this.availableImages,this.actor,h):h())}}abortTile(i,e){const r=i.uid,n=this.loading[r];n&&(n.abort&&n.abort(),delete this.loading[r]),e()}removeTile(i,e){const r=this.loaded,n=i.uid;r&&r[n]&&delete r[n],e()}},o.WritingMode=an,o.ZoomHistory=Pc,o.add=ia,o.addDynamicAttributes=I9,o.adjoint=function(i,e){var r=e[0],n=e[1],s=e[2],c=e[3],h=e[4],d=e[5],_=e[6],m=e[7],b=e[8];return i[0]=h*b-d*m,i[1]=s*m-n*b,i[2]=n*d-s*h,i[3]=d*_-c*b,i[4]=r*b-s*_,i[5]=s*c-r*d,i[6]=c*m-h*_,i[7]=n*_-r*m,i[8]=r*h-n*c,i},o.asyncAll=gt,o.bezier=Oe,o.bindAll=St,o.boundsAttributes=f2,o.bufferConvexPolygon=function(i,e){const r=[];for(let n=0;n<i.length;n++){const s=We(n-1,-1,i.length-1),c=We(n+1,-1,i.length-1),h=i[n],d=i[c],_=i[s].sub(h).unit(),m=d.sub(h).unit(),b=m.angleWithSep(_.x,_.y),T=_.add(m).unit().mult(-1*e/Math.sin(b/2));r.push(h.add(T))}return r},o.cacheEntryPossiblyAdded=function(i){W++,W>ds&&(i.getActor().send("enforceCacheSizeLimit",Po),W=0)},o.calculateGlobeLabelMatrix=function(i,e){const{x:r,y:n}=i.point,s=t2(r,n,i.worldSize/i._projectionScaler,0,0);return ta(s,s,e2(Kn(e)))},o.calculateGlobeMatrix=function(i){const{x:e,y:r}=i.point,{lng:n,lat:s}=i._center;return t2(e,r,i.worldSize,n,s)},o.calculateGlobeMercatorMatrix=function(i){const e=i.worldSize,r=i.point,n=mn(1,i.center.lat)*e,s=i.pixelsPerMeter,c=e/(n/i.pixelsPerMeter),h=Xr(new Float64Array(16));return Ha(h,h,[r.x,r.y,0]),Jn(h,h,[c,c,s]),Float32Array.from(h)},o.circumferenceAtLatitude=E3,o.clamp=xe,o.clearTileCache=function(i){const e=[];for(const r in Tr)e.push(Z.caches.delete(r)),delete Tr[r];i&&Promise.all(e).catch(i).then(()=>i())},o.clipLine=Uh,o.clone=function(i){var e=new Wr(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},o.clone$1=Ri,o.collisionCircleLayout=Dd,o.config=Ut,o.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},o.create=function(){var i=new Wr(16);return Wr!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},o.create$1=ju,o.createExpression=fo,o.createLayout=ut,o.createStyleLayer=function(i){return i.type==="custom"?new zf(i):new Df[i.type](i)},o.cross=R3,o.degToRad=Ce,o.distance=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},o.div=function(i,e,r){return i[0]=e[0]/r[0],i[1]=e[1]/r[1],i[2]=e[2]/r[2],i},o.dot=gn,o.ease=$e,o.easeCubicInOut=Ve,o.emitValidationErrors=Mc,o.endsWith=zt,o.enforceCacheSizeLimit=function(i){for(const e in Tr)X(e),Tr[e].then(r=>{r.keys().then(n=>{for(let s=0;s<n.length-i;s++)r.delete(n[s])})})},o.evaluateSizeForFeature=p9,o.evaluateSizeForZoom=a1,o.evaluateVariableOffset=qh,o.evented=G,o.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},o.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},o.exported=zi,o.exported$1=Zi,o.extend=He,o.extend$1=Br,o.fillExtrusionHeightLift=dh,o.filterObject=si,o.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},o.fromQuat=function(i,e){var r=e[0],n=e[1],s=e[2],c=e[3],h=r+r,d=n+n,_=s+s,m=r*h,b=n*h,T=n*d,S=s*h,M=s*d,z=s*_,B=c*h,q=c*d,H=c*_;return i[0]=1-T-z,i[1]=b+H,i[2]=S-q,i[3]=0,i[4]=b-H,i[5]=1-m-z,i[6]=M+B,i[7]=0,i[8]=S+q,i[9]=M-B,i[10]=1-m-T,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},o.fromRotation=function(i,e){var r=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=r,i[2]=0,i[3]=-r,i[4]=n,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},o.fromScaling=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},o.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Qe[e]},o.getAABBPointSquareDist=function(i,e,r){let n=0;for(let s=0;s<2;++s){const c=r?r[s]:0;i[s]>c&&(n+=(i[s]-c)*(i[s]-c)),e[s]<c&&(n+=(c-e[s])*(c-e[s]))}return n},o.getAnchorAlignment=Q3,o.getAnchorJustification=i0,o.getBounds=function(i){let e=1/0,r=1/0,n=-1/0,s=-1/0;for(const c of i)e=Math.min(e,c.x),r=Math.min(r,c.y),n=Math.max(n,c.x),s=Math.max(s,c.y);return{min:new N(e,r),max:new N(n,s)}},o.getColumn=ji,o.getGridMatrix=function(i,e,r){const[n,s]=e,c=.015625;return[0,(s[1]-n[1])*c,1<<i.z,(s[0]-n[0])/p1[r],0,i.y,n[0],n[1],c]},o.getImage=It,o.getJSON=function(i,e){return _e(He(i,{type:"json"}),e)},o.getLatitudinalLod=function(i){const e=80.051129;i=xe(i,-80.051129,e)/e*90;const r=Math.pow(Math.abs(Math.sin(Ce(i))),3);return Math.round(r*(p1.length-1))},o.getMapSessionAPI=S1,o.getPerformanceMeasurement=or,o.getProjection=c2,o.getRTLTextPluginStatus=Q,o.getReferrer=ge,o.getTilePoint=function(i,{x:e,y:r},n=0){return new N(((e-n)*i.scale-i.x)*kt,(r*i.scale-i.y)*kt)},o.getTileVec3=function(i,e,r=0){return r1(((e.x-r)*i.scale-i.x)*kt,(e.y*i.scale-i.y)*kt,Du(e.z,e.y))},o.getVideo=function(i,e){const r=Z.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let n=0;n<i.length;n++){const s=Z.document.createElement("source");st(i[n])||(r.crossOrigin="Anonymous"),s.src=i[n],r.appendChild(s)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(i){const e=[0,0,0],r=Xr(new Float64Array(16));return ta(r,i.pixelMatrix,i.globeMatrix),fr(e,e,r),new N(e[0],e[1])},o.globeECEFOrigin=function(i,e){const r=[0,0,0];return fr(r,r,Al(Kn(e.canonical))),fr(r,r,i),r},o.globeNormalizeECEF=Al,o.globePixelsToTileUnits=function(i,e){return kt/(512*Math.pow(2,i))*x9(Kn(e))},o.globePoleMatrixForTile=function(i,e,r){const n=Xr(new Float64Array(16)),s=1<<i,c=360*(e/s-.5),h=r.point,d=r.worldSize/(r.tileSize*s);return Ha(n,n,[h.x,h.y,-r.worldSize/Math.PI/2]),Jn(n,n,[d,d,d]),Yc(n,n,Ce(-r._center.lat)),Kc(n,n,Ce(-r._center.lng+c)),Float32Array.from(n)},o.globeTileBounds=Kn,o.globeTileLatLngCorners=a0,o.globeTiltAtLngLat=i2,o.globeToMercatorTransition=s0,o.globeUseCustomAntiAliasing=function(i,e,r){const n=s0(r.zoom),s=i.style.map._antialias,c=!!e.extStandardDerivatives,h=e.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return n===0&&!s&&!h&&c},o.identity=Xr,o.identity$1=Hu,o.invert=function(i,e){var r=e[0],n=e[1],s=e[2],c=e[3],h=e[4],d=e[5],_=e[6],m=e[7],b=e[8],T=e[9],S=e[10],M=e[11],z=e[12],B=e[13],q=e[14],H=e[15],se=r*d-n*h,oe=r*_-s*h,le=r*m-c*h,he=n*_-s*d,de=n*m-c*d,Se=s*m-c*_,Ee=b*B-T*z,Re=b*q-S*z,Ge=b*H-M*z,be=T*q-S*B,Pe=T*H-M*B,Ue=S*H-M*q,je=se*Ue-oe*Pe+le*be+he*Ge-de*Re+Se*Ee;return je?(i[0]=(d*Ue-_*Pe+m*be)*(je=1/je),i[1]=(s*Pe-n*Ue-c*be)*je,i[2]=(B*Se-q*de+H*he)*je,i[3]=(S*de-T*Se-M*he)*je,i[4]=(_*Ge-h*Ue-m*Re)*je,i[5]=(r*Ue-s*Ge+c*Re)*je,i[6]=(q*le-z*Se-H*oe)*je,i[7]=(b*Se-S*le+M*oe)*je,i[8]=(h*Pe-d*Ge+m*Ee)*je,i[9]=(n*Ge-r*Pe-c*Ee)*je,i[10]=(z*de-B*le+H*se)*je,i[11]=(T*le-b*de-M*se)*je,i[12]=(d*Re-h*be-_*Ee)*je,i[13]=(r*be-n*Re+s*Ee)*je,i[14]=(B*oe-z*he-q*se)*je,i[15]=(b*he-T*oe+S*se)*je,i):null},o.isLngLatBehindGlobe=function(i,e){return i2(i,e)>Math.PI/2*1.01},o.isMapAuthenticated=function(i){return $n.has(i)},o.isMapboxURL=un,o.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!wi(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=Yi,o.len=Gp,o.length=hl,o.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},o.loadVectorTile=C2,o.makeRequest=_e,o.mapValue=function(i,e,r,n,s){return xe((i-e)/(r-e)*(s-n)+n,n,s)},o.mercatorXfromLng=qa,o.mercatorYfromLat=Wa,o.mercatorZfromAltitude=mn,o.mul=Fp,o.mul$1=Np,o.multiply=ta,o.multiply$1=function(i,e,r){var n=e[0],s=e[1],c=e[2],h=e[3],d=e[4],_=e[5],m=e[6],b=e[7],T=e[8],S=r[0],M=r[1],z=r[2],B=r[3],q=r[4],H=r[5],se=r[6],oe=r[7],le=r[8];return i[0]=S*n+M*h+z*m,i[1]=S*s+M*d+z*b,i[2]=S*c+M*_+z*T,i[3]=B*n+q*h+H*m,i[4]=B*s+q*d+H*b,i[5]=B*c+q*_+H*T,i[6]=se*n+oe*h+le*m,i[7]=se*s+oe*d+le*b,i[8]=se*c+oe*_+le*T,i},o.multiply$2=qu,o.nextPowerOfTwo=Xe,o.normalize=Er,o.normalize$1=function(i,e){var r=e[0],n=e[1],s=e[2],c=e[3],h=r*r+n*n+s*s+c*c;return h>0&&(h=1/Math.sqrt(h)),i[0]=r*h,i[1]=n*h,i[2]=s*h,i[3]=c*h,i},o.number=Yt,o.ortho=function(i,e,r,n,s,c,h){var d=1/(e-r),_=1/(n-s),m=1/(c-h);return i[0]=-2*d,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*m,i[11]=0,i[12]=(e+r)*d,i[13]=(s+n)*_,i[14]=(h+c)*m,i[15]=1,i},o.pbf=Tl,o.perspective=function(i,e,r,n,s){var c,h=1/Math.tan(e/2);return i[0]=h/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,s!=null&&s!==1/0?(i[10]=(s+n)*(c=1/(n-s)),i[14]=2*s*n*c):(i[10]=-1,i[14]=-2*n),i},o.pick=function(i,e){const r={};for(let n=0;n<e.length;n++){const s=e[n];s in i&&(r[s]=i[s])}return r},o.plugin=J,o.pointGeometry=N,o.polygonContainsPoint=Ja,o.polygonIntersectsBox=Gu,o.polygonIntersectsPolygon=Bu,o.polygonizeBounds=function(i,e,r=0,n=!0){const s=new N(r,r),c=i.sub(s),h=e.add(s),d=[c,new N(h.x,c.y),h,new N(c.x,h.y)];return n&&d.push(c.clone()),d},o.posAttributes=El,o.postMapLoadEvent=hs,o.postTurnstileEvent=ya,o.potpack=J3,o.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},o.radToDeg=ke,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(i){return i({pluginStatus:P,pluginURL:O}),G.on("pluginStateChange",i),i},o.removeAuthState=function(i){$n.delete(i)},o.renderColorRamp=G3,o.resample=Lu,o.rotateX=Yc,o.rotateX$1=Yu,o.rotateY=Kc,o.rotateY$1=Ku,o.rotateZ=function(i,e,r){var n=Math.sin(r),s=Math.cos(r),c=e[0],h=e[1],d=e[2],_=e[3],m=e[4],b=e[5],T=e[6],S=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=c*s+m*n,i[1]=h*s+b*n,i[2]=d*s+T*n,i[3]=_*s+S*n,i[4]=m*s-c*n,i[5]=b*s-h*n,i[6]=T*s-d*n,i[7]=S*s-_*n,i},o.rotateZ$1=function(i,e,r){r*=.5;var n=e[0],s=e[1],c=e[2],h=e[3],d=Math.sin(r),_=Math.cos(r);return i[0]=n*_+s*d,i[1]=s*_-n*d,i[2]=c*_+h*d,i[3]=h*_-c*d,i},o.scale=Jn,o.scale$1=Xu,o.scale$2=Hn,o.scaleAndAdd=t9,o.setCacheLimits=function(i,e){Po=i,ds=e},o.setColumn=function(i,e,r){i[4*e+0]=r[0],i[4*e+1]=r[1],i[4*e+2]=r[2],i[4*e+3]=r[3]},o.setRTLTextPlugin=function(i,e,r=!1){if(P===v||P===w||P===A)throw new Error("setRTLTextPlugin cannot be called multiple times.");O=zi.resolveURL(i),P=v,C=e,j(),r||$()},o.smoothstep=dt,o.spec=me,o.storeAuthState=function(i,e){e?$n.add(i):$n.delete(i)},o.sub=yn,o.subtract=L3,o.symbolSize=Ld,o.tileAABB=function(i,e,r,n,s,c,h,d,_){if(_.name==="globe")return ff(i,e,new c9(r,n,s));const m=es({z:r,x:n,y:s},_);return new on([(c+m.x/m.scale)*e,e*(m.y/m.scale),h],[(c+m.x2/m.scale)*e,e*(m.y2/m.scale),d])},o.tileTransform=es,o.transformMat3=function(i,e,r){var n=e[0],s=e[1],c=e[2];return i[0]=n*r[0]+s*r[3]+c*r[6],i[1]=n*r[1]+s*r[4]+c*r[7],i[2]=n*r[2]+s*r[5]+c*r[8],i},o.transformMat4=fr,o.transformMat4$1=Ya,o.transformQuat=Wu,o.translate=Ha,o.transpose=function(i,e){if(i===e){var r=e[1],n=e[2],s=e[5];i[1]=e[3],i[2]=e[6],i[3]=r,i[5]=e[7],i[6]=n,i[7]=s}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},o.triggerPluginCompletionEvent=U,o.uniqueId=Ye,o.updateGlobeVertexNormal=function(i,e,r,n,s){const c=5*e+2;i.float32[c+0]=r,i.float32[c+1]=n,i.float32[c+2]=s},o.validateCustomStyleLayer=function(i){const e=[],r=i.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},o.validateFilter=i=>nn(Q1(i)),o.validateFog=i=>nn(Sc(i)),o.validateLayer=i=>nn(Tc(i)),o.validateLight=i=>nn(el(i)),o.validateSource=i=>nn(Ic(i)),o.validateStyle=Ac,o.validateTerrain=i=>nn(tl(i)),o.values=wt,o.vectorTile=Ka,o.version=yr,o.warnOnce=_t,o.window=Z,o.wrap=We}),L(["./shared"],function(o){function Z(X){if(typeof X=="number"||typeof X=="boolean"||typeof X=="string"||X==null)return JSON.stringify(X);if(Array.isArray(X)){let R="[";for(const W of X)R+=`${Z(W)},`;return`${R}]`}let D="{";for(const R of Object.keys(X).sort())D+=`${R}:${Z(X[R])},`;return`${D}}`}function ae(X){let D="";for(const R of o.refProperties)D+=`/${Z(X[R])}`;return D}class te{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,R){for(const ie of D)this._layerConfigs[ie.id]=ie,(this._layers[ie.id]=o.createStyleLayer(ie)).compileFilter(),this.keyCache[ie.id]&&delete this.keyCache[ie.id];for(const ie of R)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const W=function(ie,ue){const ge={};for(let pe=0;pe<ie.length;pe++){const ve=ue&&ue[ie[pe].id]||ae(ie[pe]);ue&&(ue[ie[pe].id]=ve);let Be=ge[ve];Be||(Be=ge[ve]=[]),Be.push(ie[pe])}const _e=[];for(const pe in ge)_e.push(ge[pe]);return _e}(o.values(this._layerConfigs),this.keyCache);for(const ie of W){const ue=ie.map(st=>this._layers[st.id]),ge=ue[0];if(ge.visibility==="none")continue;const _e=ge.source||"";let pe=this.familiesBySource[_e];pe||(pe=this.familiesBySource[_e]={});const ve=ge.sourceLayer||"_geojsonTileLayer";let Be=pe[ve];Be||(Be=pe[ve]=[]),Be.push(ue)}}}class N{loadTile(D,R){const{uid:W,encoding:ie,rawImageData:ue,padding:ge,buildQuadTree:_e}=D,pe=o.window.ImageBitmap&&ue instanceof o.window.ImageBitmap?this.getImageData(ue,ge):ue;R(null,new o.DEMData(W,pe,ie,ge<1,_e))}getImageData(D,R){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(D.width,D.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=D.width,this.offscreenCanvas.height=D.height,this.offscreenCanvasContext.drawImage(D,0,0,D.width,D.height);const W=this.offscreenCanvasContext.getImageData(-R,-R,D.width+2*R,D.height+2*R);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),W}}var K=function X(D,R){var W,ie=D&&D.type;if(ie==="FeatureCollection")for(W=0;W<D.features.length;W++)X(D.features[W],R);else if(ie==="GeometryCollection")for(W=0;W<D.geometries.length;W++)X(D.geometries[W],R);else if(ie==="Feature")X(D.geometry,R);else if(ie==="Polygon")fe(D.coordinates,R);else if(ie==="MultiPolygon")for(W=0;W<D.coordinates.length;W++)fe(D.coordinates[W],R);return D};function fe(X,D){if(X.length!==0){Te(X[0],D);for(var R=1;R<X.length;R++)Te(X[R],!D)}}function Te(X,D){for(var R=0,W=0,ie=0,ue=X.length,ge=ue-1;ie<ue;ge=ie++){var _e=(X[ie][0]-X[ge][0])*(X[ge][1]+X[ie][1]),pe=R+_e;W+=Math.abs(R)>=Math.abs(_e)?R-pe+_e:_e-pe+R,R=pe}R+W>=0!=!!D&&X.reverse()}const Ce=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ke{constructor(D){this._feature=D,this.extent=o.EXTENT,this.type=D.type,this.properties=D.tags,"id"in D&&!isNaN(D.id)&&(this.id=parseInt(D.id,10))}loadGeometry(){if(this._feature.type===1){const D=[];for(const R of this._feature.geometry)D.push([new o.pointGeometry(R[0],R[1])]);return D}{const D=[];for(const R of this._feature.geometry){const W=[];for(const ie of R)W.push(new o.pointGeometry(ie[0],ie[1]));D.push(W)}return D}}toGeoJSON(D,R,W){return Ce.call(this,D,R,W)}}class Qe{constructor(D){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=D.length,this._features=D}feature(D){return new ke(this._features[D])}}var Ve=o.vectorTile.VectorTileFeature,Oe=$e;function $e(X,D){this.options=D||{},this.features=X,this.length=X.length}function xe(X,D){this.id=typeof X.id=="number"?X.id:void 0,this.type=X.type,this.rawGeometry=X.type===1?[X.geometry]:X.geometry,this.properties=X.tags,this.extent=D||4096}$e.prototype.feature=function(X){return new xe(this.features[X],this.options.extent)},xe.prototype.loadGeometry=function(){var X=this.rawGeometry;this.geometry=[];for(var D=0;D<X.length;D++){for(var R=X[D],W=[],ie=0;ie<R.length;ie++)W.push(new o.pointGeometry(R[ie][0],R[ie][1]));this.geometry.push(W)}return this.geometry},xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var X=this.geometry,D=1/0,R=-1/0,W=1/0,ie=-1/0,ue=0;ue<X.length;ue++)for(var ge=X[ue],_e=0;_e<ge.length;_e++){var pe=ge[_e];D=Math.min(D,pe.x),R=Math.max(R,pe.x),W=Math.min(W,pe.y),ie=Math.max(ie,pe.y)}return[D,W,R,ie]},xe.prototype.toGeoJSON=Ve.prototype.toGeoJSON;var dt=gt,We=Oe;function gt(X){var D=new o.pbf;return function(R,W){for(var ie in R.layers)W.writeMessage(3,wt,R.layers[ie])}(X,D),D.finish()}function wt(X,D){var R;D.writeVarintField(15,X.version||1),D.writeStringField(1,X.name||""),D.writeVarintField(5,X.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<X.length;R++)W.feature=X.feature(R),D.writeMessage(2,He,W);var ie=W.keys;for(R=0;R<ie.length;R++)D.writeStringField(3,ie[R]);var ue=W.values;for(R=0;R<ue.length;R++)D.writeMessage(4,ze,ue[R])}function He(X,D){var R=X.feature;R.id!==void 0&&D.writeVarintField(1,R.id),D.writeMessage(2,Je,X),D.writeVarintField(3,R.type),D.writeMessage(4,Xe,R)}function Je(X,D){var R=X.feature,W=X.keys,ie=X.values,ue=X.keycache,ge=X.valuecache;for(var _e in R.properties){var pe=R.properties[_e],ve=ue[_e];if(pe!==null){ve===void 0&&(W.push(_e),ue[_e]=ve=W.length-1),D.writeVarint(ve);var Be=typeof pe;Be!=="string"&&Be!=="boolean"&&Be!=="number"&&(pe=JSON.stringify(pe));var st=Be+":"+pe,Ne=ge[st];Ne===void 0&&(ie.push(pe),ge[st]=Ne=ie.length-1),D.writeVarint(Ne)}}}function Ye(X,D){return(D<<3)+(7&X)}function qe(X){return X<<1^X>>31}function Xe(X,D){for(var R=X.loadGeometry(),W=X.type,ie=0,ue=0,ge=R.length,_e=0;_e<ge;_e++){var pe=R[_e],ve=1;W===1&&(ve=pe.length),D.writeVarint(Ye(1,ve));for(var Be=W===3?pe.length-1:pe.length,st=0;st<Be;st++){st===1&&W!==1&&D.writeVarint(Ye(2,Be-1));var Ne=pe[st].x-ie,Tt=pe[st].y-ue;D.writeVarint(qe(Ne)),D.writeVarint(qe(Tt)),ie+=Ne,ue+=Tt}W===3&&D.writeVarint(Ye(7,1))}}function ze(X,D){var R=typeof X;R==="string"?D.writeStringField(1,X):R==="boolean"?D.writeBooleanField(7,X):R==="number"&&(X%1!=0?D.writeDoubleField(3,X):X<0?D.writeSVarintField(6,X):D.writeVarintField(5,X))}function St(X,D,R,W,ie,ue){if(ie-W<=R)return;const ge=W+ie>>1;zt(X,D,ge,W,ie,ue%2),St(X,D,R,W,ge-1,ue+1),St(X,D,R,ge+1,ie,ue+1)}function zt(X,D,R,W,ie,ue){for(;ie>W;){if(ie-W>600){const ve=ie-W+1,Be=R-W+1,st=Math.log(ve),Ne=.5*Math.exp(2*st/3),Tt=.5*Math.sqrt(st*Ne*(ve-Ne)/ve)*(Be-ve/2<0?-1:1);zt(X,D,R,Math.max(W,Math.floor(R-Be*Ne/ve+Tt)),Math.min(ie,Math.floor(R+(ve-Be)*Ne/ve+Tt)),ue)}const ge=D[2*R+ue];let _e=W,pe=ie;for(ei(X,D,W,R),D[2*ie+ue]>ge&&ei(X,D,W,ie);_e<pe;){for(ei(X,D,_e,pe),_e++,pe--;D[2*_e+ue]<ge;)_e++;for(;D[2*pe+ue]>ge;)pe--}D[2*W+ue]===ge?ei(X,D,W,pe):(pe++,ei(X,D,pe,ie)),pe<=R&&(W=pe+1),R<=pe&&(ie=pe-1)}}function ei(X,D,R,W){si(X,R,W),si(D,2*R,2*W),si(D,2*R+1,2*W+1)}function si(X,D,R){const W=X[D];X[D]=X[R],X[R]=W}function Ri(X,D,R,W){const ie=X-R,ue=D-W;return ie*ie+ue*ue}dt.fromVectorTileJs=gt,dt.fromGeojsonVt=function(X,D){D=D||{};var R={};for(var W in X)R[W]=new Oe(X[W].features,D),R[W].name=W,R[W].version=D.version,R[W].extent=D.extent;return gt({layers:R})},dt.GeoJSONWrapper=We;const mt=X=>X[0],_t=X=>X[1];class xt{constructor(D,R=mt,W=_t,ie=64,ue=Float64Array){this.nodeSize=ie,this.points=D;const ge=D.length<65536?Uint16Array:Uint32Array,_e=this.ids=new ge(D.length),pe=this.coords=new ue(2*D.length);for(let ve=0;ve<D.length;ve++)_e[ve]=ve,pe[2*ve]=R(D[ve]),pe[2*ve+1]=W(D[ve]);St(_e,pe,ie,0,_e.length-1,0)}range(D,R,W,ie){return function(ue,ge,_e,pe,ve,Be,st){const Ne=[0,ue.length-1,0],Tt=[];let Et,It;for(;Ne.length;){const Mt=Ne.pop(),Vt=Ne.pop(),ti=Ne.pop();if(Vt-ti<=st){for(let me=ti;me<=Vt;me++)Et=ge[2*me],It=ge[2*me+1],Et>=_e&&Et<=ve&&It>=pe&&It<=Be&&Tt.push(ue[me]);continue}const xi=Math.floor((ti+Vt)/2);Et=ge[2*xi],It=ge[2*xi+1],Et>=_e&&Et<=ve&&It>=pe&&It<=Be&&Tt.push(ue[xi]);const li=(Mt+1)%2;(Mt===0?_e<=Et:pe<=It)&&(Ne.push(ti),Ne.push(xi-1),Ne.push(li)),(Mt===0?ve>=Et:Be>=It)&&(Ne.push(xi+1),Ne.push(Vt),Ne.push(li))}return Tt}(this.ids,this.coords,D,R,W,ie,this.nodeSize)}within(D,R,W){return function(ie,ue,ge,_e,pe,ve){const Be=[0,ie.length-1,0],st=[],Ne=pe*pe;for(;Be.length;){const Tt=Be.pop(),Et=Be.pop(),It=Be.pop();if(Et-It<=ve){for(let li=It;li<=Et;li++)Ri(ue[2*li],ue[2*li+1],ge,_e)<=Ne&&st.push(ie[li]);continue}const Mt=Math.floor((It+Et)/2),Vt=ue[2*Mt],ti=ue[2*Mt+1];Ri(Vt,ti,ge,_e)<=Ne&&st.push(ie[Mt]);const xi=(Tt+1)%2;(Tt===0?ge-pe<=Vt:_e-pe<=ti)&&(Be.push(It),Be.push(Mt-1),Be.push(xi)),(Tt===0?ge+pe>=Vt:_e+pe>=ti)&&(Be.push(Mt+1),Be.push(Et),Be.push(xi))}return st}(this.ids,this.coords,D,R,W,this.nodeSize)}}const Ht={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:X=>X},Bt=Math.fround||(fi=new Float32Array(1),X=>(fi[0]=+X,fi[0]));var fi;class ni{constructor(D){this.options=er(Object.create(Ht),D),this.trees=new Array(this.options.maxZoom+1)}load(D){const{log:R,minZoom:W,maxZoom:ie,nodeSize:ue}=this.options;R&&console.time("total time");const ge=`prepare ${D.length} points`;R&&console.time(ge),this.points=D;let _e=[];for(let pe=0;pe<D.length;pe++)D[pe].geometry&&_e.push(Ji(D[pe],pe));this.trees[ie+1]=new xt(_e,br,$i,ue,Float32Array),R&&console.timeEnd(ge);for(let pe=ie;pe>=W;pe--){const ve=+Date.now();_e=this._cluster(_e,pe),this.trees[pe]=new xt(_e,br,$i,ue,Float32Array),R&&console.log("z%d: %d clusters in %dms",pe,_e.length,+Date.now()-ve)}return R&&console.timeEnd("total time"),this}getClusters(D,R){let W=((D[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,D[1]));let ue=D[2]===180?180:((D[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)W=-180,ue=180;else if(W>ue){const Be=this.getClusters([W,ie,180,ge],R),st=this.getClusters([-180,ie,ue,ge],R);return Be.concat(st)}const _e=this.trees[this._limitZoom(R)],pe=_e.range(or(W),yr(ge),or(ue),yr(ie)),ve=[];for(const Be of pe){const st=_e.points[Be];ve.push(st.numPoints?ji(st):this.points[st.index])}return ve}getChildren(D){const R=this._getOriginId(D),W=this._getOriginZoom(D),ie="No cluster with the specified id.",ue=this.trees[W];if(!ue)throw new Error(ie);const ge=ue.points[R];if(!ge)throw new Error(ie);const _e=this.options.radius/(this.options.extent*Math.pow(2,W-1)),pe=ue.within(ge.x,ge.y,_e),ve=[];for(const Be of pe){const st=ue.points[Be];st.parentId===D&&ve.push(st.numPoints?ji(st):this.points[st.index])}if(ve.length===0)throw new Error(ie);return ve}getLeaves(D,R,W){const ie=[];return this._appendLeaves(ie,D,R=R||10,W=W||0,0),ie}getTile(D,R,W){const ie=this.trees[this._limitZoom(D)],ue=Math.pow(2,D),{extent:ge,radius:_e}=this.options,pe=_e/ge,ve=(W-pe)/ue,Be=(W+1+pe)/ue,st={features:[]};return this._addTileFeatures(ie.range((R-pe)/ue,ve,(R+1+pe)/ue,Be),ie.points,R,W,ue,st),R===0&&this._addTileFeatures(ie.range(1-pe/ue,ve,1,Be),ie.points,ue,W,ue,st),R===ue-1&&this._addTileFeatures(ie.range(0,ve,pe/ue,Be),ie.points,-1,W,ue,st),st.features.length?st:null}getClusterExpansionZoom(D){let R=this._getOriginZoom(D)-1;for(;R<=this.options.maxZoom;){const W=this.getChildren(D);if(R++,W.length!==1)break;D=W[0].properties.cluster_id}return R}_appendLeaves(D,R,W,ie,ue){const ge=this.getChildren(R);for(const _e of ge){const pe=_e.properties;if(pe&&pe.cluster?ue+pe.point_count<=ie?ue+=pe.point_count:ue=this._appendLeaves(D,pe.cluster_id,W,ie,ue):ue<ie?ue++:D.push(_e),D.length===W)break}return ue}_addTileFeatures(D,R,W,ie,ue,ge){for(const _e of D){const pe=R[_e],ve=pe.numPoints;let Be,st,Ne;if(ve)Be=gr(pe),st=pe.x,Ne=pe.y;else{const It=this.points[pe.index];Be=It.properties,st=or(It.geometry.coordinates[0]),Ne=yr(It.geometry.coordinates[1])}const Tt={type:1,geometry:[[Math.round(this.options.extent*(st*ue-W)),Math.round(this.options.extent*(Ne*ue-ie))]],tags:Be};let Et;ve?Et=pe.id:this.options.generateId?Et=pe.index:this.points[pe.index].id&&(Et=this.points[pe.index].id),Et!==void 0&&(Tt.id=Et),ge.features.push(Tt)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(+D,this.options.maxZoom+1))}_cluster(D,R){const W=[],{radius:ie,extent:ue,reduce:ge,minPoints:_e}=this.options,pe=ie/(ue*Math.pow(2,R));for(let ve=0;ve<D.length;ve++){const Be=D[ve];if(Be.zoom<=R)continue;Be.zoom=R;const st=this.trees[R+1],Ne=st.within(Be.x,Be.y,pe),Tt=Be.numPoints||1;let Et=Tt;for(const It of Ne){const Mt=st.points[It];Mt.zoom>R&&(Et+=Mt.numPoints||1)}if(Et>Tt&&Et>=_e){let It=Be.x*Tt,Mt=Be.y*Tt,Vt=ge&&Tt>1?this._map(Be,!0):null;const ti=(ve<<5)+(R+1)+this.points.length;for(const xi of Ne){const li=st.points[xi];if(li.zoom<=R)continue;li.zoom=R;const me=li.numPoints||1;It+=li.x*me,Mt+=li.y*me,li.parentId=ti,ge&&(Vt||(Vt=this._map(Be,!0)),ge(Vt,this._map(li)))}Be.parentId=ti,W.push(wi(It/Et,Mt/Et,ti,Et,Vt))}else if(W.push(Be),Et>1)for(const It of Ne){const Mt=st.points[It];Mt.zoom<=R||(Mt.zoom=R,W.push(Mt))}}return W}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,R){if(D.numPoints)return R?er({},D.properties):D.properties;const W=this.points[D.index].properties,ie=this.options.map(W);return R&&ie===W?er({},ie):ie}}function wi(X,D,R,W,ie){return{x:Bt(X),y:Bt(D),zoom:1/0,id:R,parentId:-1,numPoints:W,properties:ie}}function Ji(X,D){const[R,W]=X.geometry.coordinates;return{x:Bt(or(R)),y:Bt(yr(W)),zoom:1/0,index:D,parentId:-1}}function ji(X){return{type:"Feature",id:X.id,properties:gr(X),geometry:{type:"Point",coordinates:[(D=X.x,360*(D-.5)),Lt(X.y)]}};var D}function gr(X){const D=X.numPoints,R=D>=1e4?`${Math.round(D/1e3)}k`:D>=1e3?Math.round(D/100)/10+"k":D;return er(er({},X.properties),{cluster:!0,cluster_id:X.id,point_count:D,point_count_abbreviated:R})}function or(X){return X/360+.5}function yr(X){const D=Math.sin(X*Math.PI/180),R=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return R<0?0:R>1?1:R}function Lt(X){const D=(180-360*X)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function er(X,D){for(const R in D)X[R]=D[R];return X}function br(X){return X.x}function $i(X){return X.y}function zi(X,D,R,W){for(var ie,ue=W,ge=R-D>>1,_e=R-D,pe=X[D],ve=X[D+1],Be=X[R],st=X[R+1],Ne=D+3;Ne<R;Ne+=3){var Tt=ur(X[Ne],X[Ne+1],pe,ve,Be,st);if(Tt>ue)ie=Ne,ue=Tt;else if(Tt===ue){var Et=Math.abs(Ne-ge);Et<_e&&(ie=Ne,_e=Et)}}ue>W&&(ie-D>3&&zi(X,D,ie,W),X[ie+2]=ue,R-ie>3&&zi(X,ie,R,W))}function ur(X,D,R,W,ie,ue){var ge=ie-R,_e=ue-W;if(ge!==0||_e!==0){var pe=((X-R)*ge+(D-W)*_e)/(ge*ge+_e*_e);pe>1?(R=ie,W=ue):pe>0&&(R+=ge*pe,W+=_e*pe)}return(ge=X-R)*ge+(_e=D-W)*_e}function Ut(X,D,R,W){var ie={id:X===void 0?null:X,type:D,geometry:R,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var ge=ue.geometry,_e=ue.type;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")Zi(ue,ge);else if(_e==="Polygon"||_e==="MultiLineString")for(var pe=0;pe<ge.length;pe++)Zi(ue,ge[pe]);else if(_e==="MultiPolygon")for(pe=0;pe<ge.length;pe++)for(var ve=0;ve<ge[pe].length;ve++)Zi(ue,ge[pe][ve])}(ie),ie}function Zi(X,D){for(var R=0;R<D.length;R+=3)X.minX=Math.min(X.minX,D[R]),X.minY=Math.min(X.minY,D[R+1]),X.maxX=Math.max(X.maxX,D[R]),X.maxY=Math.max(X.maxY,D[R+1])}function wr(X,D,R,W){if(D.geometry){var ie=D.geometry.coordinates,ue=D.geometry.type,ge=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2),_e=[],pe=D.id;if(R.promoteId?pe=D.properties[R.promoteId]:R.generateId&&(pe=W||0),ue==="Point")kn(ie,_e);else if(ue==="MultiPoint")for(var ve=0;ve<ie.length;ve++)kn(ie[ve],_e);else if(ue==="LineString")ao(ie,_e,ge,!1);else if(ue==="MultiLineString"){if(R.lineMetrics){for(ve=0;ve<ie.length;ve++)ao(ie[ve],_e=[],ge,!1),X.push(Ut(pe,"LineString",_e,D.properties));return}zo(ie,_e,ge,!1)}else if(ue==="Polygon")zo(ie,_e,ge,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(ve=0;ve<D.geometry.geometries.length;ve++)wr(X,{id:pe,geometry:D.geometry.geometries[ve],properties:D.properties},R,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ve=0;ve<ie.length;ve++){var Be=[];zo(ie[ve],Be,ge,!0),_e.push(Be)}}X.push(Ut(pe,ue,_e,D.properties))}}function kn(X,D){D.push(fa(X[0])),D.push(_a(X[1])),D.push(0)}function ao(X,D,R,W){for(var ie,ue,ge=0,_e=0;_e<X.length;_e++){var pe=fa(X[_e][0]),ve=_a(X[_e][1]);D.push(pe),D.push(ve),D.push(0),_e>0&&(ge+=W?(ie*ve-pe*ue)/2:Math.sqrt(Math.pow(pe-ie,2)+Math.pow(ve-ue,2))),ie=pe,ue=ve}var Be=D.length-3;D[2]=1,zi(D,0,Be,R),D[Be+2]=1,D.size=Math.abs(ge),D.start=0,D.end=D.size}function zo(X,D,R,W){for(var ie=0;ie<X.length;ie++){var ue=[];ao(X[ie],ue,R,W),D.push(ue)}}function fa(X){return X/360+.5}function _a(X){var D=Math.sin(X*Math.PI/180),R=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return R<0?0:R>1?1:R}function Lr(X,D,R,W,ie,ue,ge,_e){if(W/=D,ue>=(R/=D)&&ge<W)return X;if(ge<R||ue>=W)return null;for(var pe=[],ve=0;ve<X.length;ve++){var Be=X[ve],st=Be.geometry,Ne=Be.type,Tt=ie===0?Be.minX:Be.minY,Et=ie===0?Be.maxX:Be.maxY;if(Tt>=R&&Et<W)pe.push(Be);else if(!(Et<R||Tt>=W)){var It=[];if(Ne==="Point"||Ne==="MultiPoint")un(st,It,R,W,ie);else if(Ne==="LineString")so(st,It,R,W,ie,!1,_e.lineMetrics);else if(Ne==="MultiLineString")Rr(st,It,R,W,ie,!1);else if(Ne==="Polygon")Rr(st,It,R,W,ie,!0);else if(Ne==="MultiPolygon")for(var Mt=0;Mt<st.length;Mt++){var Vt=[];Rr(st[Mt],Vt,R,W,ie,!0),Vt.length&&It.push(Vt)}if(It.length){if(_e.lineMetrics&&Ne==="LineString"){for(Mt=0;Mt<It.length;Mt++)pe.push(Ut(Be.id,Ne,It[Mt],Be.tags));continue}Ne!=="LineString"&&Ne!=="MultiLineString"||(It.length===1?(Ne="LineString",It=It[0]):Ne="MultiLineString"),Ne!=="Point"&&Ne!=="MultiPoint"||(Ne=It.length===3?"Point":"MultiPoint"),pe.push(Ut(Be.id,Ne,It,Be.tags))}}}return pe.length?pe:null}function un(X,D,R,W,ie){for(var ue=0;ue<X.length;ue+=3){var ge=X[ue+ie];ge>=R&&ge<=W&&(D.push(X[ue]),D.push(X[ue+1]),D.push(X[ue+2]))}}function so(X,D,R,W,ie,ue,ge){for(var _e,pe,ve=cs(X),Be=ie===0?us:ma,st=X.start,Ne=0;Ne<X.length-3;Ne+=3){var Tt=X[Ne],Et=X[Ne+1],It=X[Ne+2],Mt=X[Ne+3],Vt=X[Ne+4],ti=ie===0?Tt:Et,xi=ie===0?Mt:Vt,li=!1;ge&&(_e=Math.sqrt(Math.pow(Tt-Mt,2)+Math.pow(Et-Vt,2))),ti<R?xi>R&&(pe=Be(ve,Tt,Et,Mt,Vt,R),ge&&(ve.start=st+_e*pe)):ti>W?xi<W&&(pe=Be(ve,Tt,Et,Mt,Vt,W),ge&&(ve.start=st+_e*pe)):Mn(ve,Tt,Et,It),xi<R&&ti>=R&&(pe=Be(ve,Tt,Et,Mt,Vt,R),li=!0),xi>W&&ti<=W&&(pe=Be(ve,Tt,Et,Mt,Vt,W),li=!0),!ue&&li&&(ge&&(ve.end=st+_e*pe),D.push(ve),ve=cs(X)),ge&&(st+=_e)}var me=X.length-3;Tt=X[me],Et=X[me+1],It=X[me+2],(ti=ie===0?Tt:Et)>=R&&ti<=W&&Mn(ve,Tt,Et,It),me=ve.length-3,ue&&me>=3&&(ve[me]!==ve[0]||ve[me+1]!==ve[1])&&Mn(ve,ve[0],ve[1],ve[2]),ve.length&&D.push(ve)}function cs(X){var D=[];return D.size=X.size,D.start=X.start,D.end=X.end,D}function Rr(X,D,R,W,ie,ue){for(var ge=0;ge<X.length;ge++)so(X[ge],D,R,W,ie,ue,!1)}function Mn(X,D,R,W){X.push(D),X.push(R),X.push(W)}function us(X,D,R,W,ie,ue){var ge=(ue-D)/(W-D);return X.push(ue),X.push(R+(ie-R)*ge),X.push(1),ge}function ma(X,D,R,W,ie,ue){var ge=(ue-R)/(ie-R);return X.push(D+(W-D)*ge),X.push(ue),X.push(1),ge}function ga(X,D){for(var R=[],W=0;W<X.length;W++){var ie,ue=X[W],ge=ue.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")ie=ya(ue.geometry,D);else if(ge==="MultiLineString"||ge==="Polygon"){ie=[];for(var _e=0;_e<ue.geometry.length;_e++)ie.push(ya(ue.geometry[_e],D))}else if(ge==="MultiPolygon")for(ie=[],_e=0;_e<ue.geometry.length;_e++){for(var pe=[],ve=0;ve<ue.geometry[_e].length;ve++)pe.push(ya(ue.geometry[_e][ve],D));ie.push(pe)}R.push(Ut(ue.id,ge,ie,ue.tags))}return R}function ya(X,D){var R=[];R.size=X.size,X.start!==void 0&&(R.start=X.start,R.end=X.end);for(var W=0;W<X.length;W+=3)R.push(X[W]+D,X[W+1],X[W+2]);return R}function xa(X,D){if(X.transformed)return X;var R,W,ie,ue=1<<X.z,ge=X.x,_e=X.y;for(R=0;R<X.features.length;R++){var pe=X.features[R],ve=pe.geometry,Be=pe.type;if(pe.geometry=[],Be===1)for(W=0;W<ve.length;W+=2)pe.geometry.push(hs(ve[W],ve[W+1],D,ue,ge,_e));else for(W=0;W<ve.length;W++){var st=[];for(ie=0;ie<ve[W].length;ie+=2)st.push(hs(ve[W][ie],ve[W][ie+1],D,ue,ge,_e));pe.geometry.push(st)}}return X.transformed=!0,X}function hs(X,D,R,W,ie,ue){return[Math.round(R*(X*W-ie)),Math.round(R*(D*W-ue))]}function ps(X,D,R,W,ie){for(var ue=D===ie.maxZoom?0:ie.tolerance/((1<<D)*ie.extent),ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:R,y:W,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},_e=0;_e<X.length;_e++){ge.numFeatures++,S1(ge,X[_e],ue,ie);var pe=X[_e].minX,ve=X[_e].minY,Be=X[_e].maxX,st=X[_e].maxY;pe<ge.minX&&(ge.minX=pe),ve<ge.minY&&(ge.minY=ve),Be>ge.maxX&&(ge.maxX=Be),st>ge.maxY&&(ge.maxY=st)}return ge}function S1(X,D,R,W){var ie=D.geometry,ue=D.type,ge=[];if(ue==="Point"||ue==="MultiPoint")for(var _e=0;_e<ie.length;_e+=3)ge.push(ie[_e]),ge.push(ie[_e+1]),X.numPoints++,X.numSimplified++;else if(ue==="LineString")$n(ge,ie,X,R,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(_e=0;_e<ie.length;_e++)$n(ge,ie[_e],X,R,ue==="Polygon",_e===0);else if(ue==="MultiPolygon")for(var pe=0;pe<ie.length;pe++){var ve=ie[pe];for(_e=0;_e<ve.length;_e++)$n(ge,ve[_e],X,R,!0,_e===0)}if(ge.length){var Be=D.tags||null;if(ue==="LineString"&&W.lineMetrics){for(var st in Be={},D.tags)Be[st]=D.tags[st];Be.mapbox_clip_start=ie.start/ie.size,Be.mapbox_clip_end=ie.end/ie.size}var Ne={geometry:ge,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:Be};D.id!==null&&(Ne.id=D.id),X.features.push(Ne)}}function $n(X,D,R,W,ie,ue){var ge=W*W;if(W>0&&D.size<(ie?ge:W))R.numPoints+=D.length/3;else{for(var _e=[],pe=0;pe<D.length;pe+=3)(W===0||D[pe+2]>ge)&&(R.numSimplified++,_e.push(D[pe]),_e.push(D[pe+1])),R.numPoints++;ie&&function(ve,Be){for(var st=0,Ne=0,Tt=ve.length,Et=Tt-2;Ne<Tt;Et=Ne,Ne+=2)st+=(ve[Ne]-ve[Et])*(ve[Ne+1]+ve[Et+1]);if(st>0===Be)for(Ne=0,Tt=ve.length;Ne<Tt/2;Ne+=2){var It=ve[Ne],Mt=ve[Ne+1];ve[Ne]=ve[Tt-2-Ne],ve[Ne+1]=ve[Tt-1-Ne],ve[Tt-2-Ne]=It,ve[Tt-1-Ne]=Mt}}(_e,ue),X.push(_e)}}function Cn(X,D){var R=(D=this.options=function(ie,ue){for(var ge in ue)ie[ge]=ue[ge];return ie}(Object.create(this.options),D)).debug;if(R&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function(ie,ue){var ge=[];if(ie.type==="FeatureCollection")for(var _e=0;_e<ie.features.length;_e++)wr(ge,ie.features[_e],ue,_e);else wr(ge,ie.type==="Feature"?ie:{geometry:ie},ue);return ge}(X,D);this.tiles={},this.tileCoords=[],R&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(W=function(ie,ue){var ge=ue.buffer/ue.extent,_e=ie,pe=Lr(ie,1,-1-ge,ge,0,-1,2,ue),ve=Lr(ie,1,1-ge,2+ge,0,-1,2,ue);return(pe||ve)&&(_e=Lr(ie,1,-ge,1+ge,0,-1,2,ue)||[],pe&&(_e=ga(pe,1).concat(_e)),ve&&(_e=_e.concat(ga(ve,-1)))),_e}(W,D)).length&&this.splitTile(W,0,0,0),R&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Po(X,D,R){return 32*((1<<X)*R+D)+X}function ds(X,D){const R=X.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);const W=this._geoJSONIndex.getTile(R.z,R.x,R.y);if(!W)return D(null,null);const ie=new Qe(W.features);let ue=dt(ie);ue.byteOffset===0&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),D(null,{vectorTile:ie,rawData:ue.buffer})}Cn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Cn.prototype.splitTile=function(X,D,R,W,ie,ue,ge){for(var _e=[X,D,R,W],pe=this.options,ve=pe.debug;_e.length;){W=_e.pop(),R=_e.pop(),D=_e.pop(),X=_e.pop();var Be=1<<D,st=Po(D,R,W),Ne=this.tiles[st];if(!Ne&&(ve>1&&console.time("creation"),Ne=this.tiles[st]=ps(X,D,R,W,pe),this.tileCoords.push({z:D,x:R,y:W}),ve)){ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,R,W,Ne.numFeatures,Ne.numPoints,Ne.numSimplified),console.timeEnd("creation"));var Tt="z"+D;this.stats[Tt]=(this.stats[Tt]||0)+1,this.total++}if(Ne.source=X,ie){if(D===pe.maxZoom||D===ie)continue;var Et=1<<ie-D;if(R!==Math.floor(ue/Et)||W!==Math.floor(ge/Et))continue}else if(D===pe.indexMaxZoom||Ne.numPoints<=pe.indexMaxPoints)continue;if(Ne.source=null,X.length!==0){ve>1&&console.time("clipping");var It,Mt,Vt,ti,xi,li,me=.5*pe.buffer/pe.extent,Br=.5-me,Si=.5+me,Ur=1+me;It=Mt=Vt=ti=null,xi=Lr(X,Be,R-me,R+Si,0,Ne.minX,Ne.maxX,pe),li=Lr(X,Be,R+Br,R+Ur,0,Ne.minX,Ne.maxX,pe),X=null,xi&&(It=Lr(xi,Be,W-me,W+Si,1,Ne.minY,Ne.maxY,pe),Mt=Lr(xi,Be,W+Br,W+Ur,1,Ne.minY,Ne.maxY,pe),xi=null),li&&(Vt=Lr(li,Be,W-me,W+Si,1,Ne.minY,Ne.maxY,pe),ti=Lr(li,Be,W+Br,W+Ur,1,Ne.minY,Ne.maxY,pe),li=null),ve>1&&console.timeEnd("clipping"),_e.push(It||[],D+1,2*R,2*W),_e.push(Mt||[],D+1,2*R,2*W+1),_e.push(Vt||[],D+1,2*R+1,2*W),_e.push(ti||[],D+1,2*R+1,2*W+1)}}},Cn.prototype.getTile=function(X,D,R){var W=this.options,ie=W.extent,ue=W.debug;if(X<0||X>24)return null;var ge=1<<X,_e=Po(X,D=(D%ge+ge)%ge,R);if(this.tiles[_e])return xa(this.tiles[_e],ie);ue>1&&console.log("drilling down to z%d-%d-%d",X,D,R);for(var pe,ve=X,Be=D,st=R;!pe&&ve>0;)ve--,Be=Math.floor(Be/2),st=Math.floor(st/2),pe=this.tiles[Po(ve,Be,st)];return pe&&pe.source?(ue>1&&console.log("found parent tile z%d-%d-%d",ve,Be,st),ue>1&&console.time("drilling down"),this.splitTile(pe.source,ve,Be,st,X,D,R),ue>1&&console.timeEnd("drilling down"),this.tiles[_e]?xa(this.tiles[_e],ie):null):null};class Tr extends o.VectorTileWorkerSource{constructor(D,R,W,ie,ue){super(D,R,W,ie,ds),ue&&(this.loadGeoJSON=ue)}loadData(D,R){const W=D&&D.request,ie=W&&W.collectResourceTiming;this.loadGeoJSON(D,(ue,ge)=>{if(ue||!ge)return R(ue);if(typeof ge!="object")return R(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));{K(ge,!0);try{if(D.filter){const pe=o.createExpression(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(pe.result==="error")throw new Error(pe.value.map(Be=>`${Be.key}: ${Be.message}`).join(", "));const ve=ge.features.filter(Be=>pe.value.evaluate({zoom:0},Be));ge={type:"FeatureCollection",features:ve}}this._geoJSONIndex=D.cluster?new ni(function({superclusterOptions:pe,clusterProperties:ve}){if(!ve||!pe)return pe;const Be={},st={},Ne={accumulated:null,zoom:0},Tt={properties:null},Et=Object.keys(ve);for(const It of Et){const[Mt,Vt]=ve[It],ti=o.createExpression(Vt),xi=o.createExpression(typeof Mt=="string"?[Mt,["accumulated"],["get",It]]:Mt);Be[It]=ti.value,st[It]=xi.value}return pe.map=It=>{Tt.properties=It;const Mt={};for(const Vt of Et)Mt[Vt]=Be[Vt].evaluate(Ne,Tt);return Mt},pe.reduce=(It,Mt)=>{Tt.properties=Mt;for(const Vt of Et)Ne.accumulated=It[Vt],It[Vt]=st[Vt].evaluate(Ne,Tt)},pe}(D)).load(ge.features):function(pe,ve){return new Cn(pe,ve)}(ge,D.geojsonVtOptions)}catch(pe){return R(pe)}this.loaded={};const _e={};if(ie){const pe=o.getPerformanceMeasurement(W);pe&&(_e.resourceTiming={},_e.resourceTiming[D.source]=JSON.parse(JSON.stringify(pe)))}R(null,_e)}})}reloadTile(D,R){const W=this.loaded;return W&&W[D.uid]?super.reloadTile(D,R):this.loadTile(D,R)}loadGeoJSON(D,R){if(D.request)o.getJSON(D.request,R);else{if(typeof D.data!="string")return R(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));try{return R(null,JSON.parse(D.data))}catch{return R(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(D,R){try{R(null,this._geoJSONIndex.getClusterExpansionZoom(D.clusterId))}catch(W){R(W)}}getClusterChildren(D,R){try{R(null,this._geoJSONIndex.getChildren(D.clusterId))}catch(W){R(W)}}getClusterLeaves(D,R){try{R(null,this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset))}catch(W){R(W)}}}class va{constructor(D){this.self=D,this.actor=new o.Actor(D,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Tr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(R,W)=>{if(this.workerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.workerSourceTypes[R]=W},this.self.registerRTLTextPlugin=R=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=R.applyArabicShaping,o.plugin.processBidirectionalText=R.processBidirectionalText,o.plugin.processStyledBidirectionalText=R.processStyledBidirectionalText}}clearCaches(D,R,W){delete this.layerIndexes[D],delete this.availableImages[D],delete this.workerSources[D],delete this.demWorkerSources[D],W()}checkIfReady(D,R,W){W()}setReferrer(D,R){this.referrer=R}spriteLoaded(D,R){this.isSpriteLoaded[D]=R;for(const W in this.workerSources[D]){const ie=this.workerSources[D][W];for(const ue in ie)ie[ue]instanceof o.VectorTileWorkerSource&&(ie[ue].isSpriteLoaded=R,ie[ue].fire(new o.Event("isSpriteLoaded")))}}setImages(D,R,W){this.availableImages[D]=R;for(const ie in this.workerSources[D]){const ue=this.workerSources[D][ie];for(const ge in ue)ue[ge].availableImages=R}W()}enableTerrain(D,R,W){this.terrain=R,W()}setProjection(D,R){this.projections[D]=o.getProjection(R)}setLayers(D,R,W){this.getLayerIndex(D).replace(R),W()}updateLayers(D,R,W){this.getLayerIndex(D).update(R.layers,R.removedIds),W()}loadTile(D,R,W){const ie=this.enableTerrain?o.extend({enableTerrain:this.terrain},R):R;ie.projection=this.projections[D]||this.defaultProjection,this.getWorkerSource(D,R.type,R.source).loadTile(ie,W)}loadDEMTile(D,R,W){const ie=this.enableTerrain?o.extend({buildQuadTree:this.terrain},R):R;this.getDEMWorkerSource(D,R.source).loadTile(ie,W)}reloadTile(D,R,W){const ie=this.enableTerrain?o.extend({enableTerrain:this.terrain},R):R;ie.projection=this.projections[D]||this.defaultProjection,this.getWorkerSource(D,R.type,R.source).reloadTile(ie,W)}abortTile(D,R,W){this.getWorkerSource(D,R.type,R.source).abortTile(R,W)}removeTile(D,R,W){this.getWorkerSource(D,R.type,R.source).removeTile(R,W)}removeSource(D,R,W){if(!this.workerSources[D]||!this.workerSources[D][R.type]||!this.workerSources[D][R.type][R.source])return;const ie=this.workerSources[D][R.type][R.source];delete this.workerSources[D][R.type][R.source],ie.removeSource!==void 0?ie.removeSource(R,W):W()}loadWorkerSource(D,R,W){try{this.self.importScripts(R.url),W()}catch(ie){W(ie.toString())}}syncRTLPluginState(D,R,W){try{o.plugin.setState(R);const ie=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&ie!=null){this.self.importScripts(ie);const ue=o.plugin.isParsed();W(ue?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ie}`),ue)}}catch(ie){W(ie.toString())}}getAvailableImages(D){let R=this.availableImages[D];return R||(R=[]),R}getLayerIndex(D){let R=this.layerIndexes[D];return R||(R=this.layerIndexes[D]=new te),R}getWorkerSource(D,R,W){return this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][R]||(this.workerSources[D][R]={}),this.workerSources[D][R][W]||(this.workerSources[D][R][W]=new this.workerSourceTypes[R]({send:(ie,ue,ge,_e,pe,ve)=>{this.actor.send(ie,ue,ge,D,pe,ve)},scheduler:this.actor.scheduler},this.getLayerIndex(D),this.getAvailableImages(D),this.isSpriteLoaded[D])),this.workerSources[D][R][W]}getDEMWorkerSource(D,R){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][R]||(this.demWorkerSources[D][R]=new N),this.demWorkerSources[D][R]}enforceCacheSizeLimit(D,R){o.enforceCacheSizeLimit(R)}getWorkerPerformanceMetrics(D,R,W){W(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new va(self)),va}),L(["./shared"],function(o){function Z(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let a=0;a<l.length;a++)if(!Z(l[a],t[a]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const a in l)if(!Z(l[a],t[a]))return!1;return!0}return l===t}var ae=te;function te(l){return!function(t){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var u,p,f=new Blob([""],{type:"text/javascript"}),y=URL.createObjectURL(f);try{p=new Worker(y),u=!0}catch{u=!1}return p&&p.terminate(),URL.revokeObjectURL(y),u}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var u=document.createElement("canvas");u.width=u.height=1;var p=u.getContext("2d");if(!p)return!1;var f=p.getImageData(0,0,1,1);return f&&f.width===u.width}()?(N[a=t&&t.failIfMajorPerformanceCaveat]===void 0&&(N[a]=function(u){var p,f=function(y){var v=document.createElement("canvas"),w=Object.create(te.webGLContextAttributes);return w.failIfMajorPerformanceCaveat=y,v.getContext("webgl",w)||v.getContext("experimental-webgl",w)}(u);if(!f)return!1;try{p=f.createShader(f.VERTEX_SHADER)}catch{return!1}return!(!p||f.isContextLost())&&(f.shaderSource(p,"void main() {}"),f.compileShader(p),f.getShaderParameter(p,f.COMPILE_STATUS)===!0)}(a)),N[a]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var a}(l)}var N={};function K(l,t,a){const u=o.window.document.createElement(l);return t!==void 0&&(u.className=t),a&&a.appendChild(u),u}function fe(l,t,a){const u=o.window.document.createElementNS("http://www.w3.org/2000/svg",l);for(const p of Object.keys(t))u.setAttributeNS(null,p,t[p]);return a&&a.appendChild(u),u}te.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Te=o.window.document&&o.window.document.documentElement.style,Ce=Te&&Te.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ke;function Qe(){Te&&Ce&&(ke=Te[Ce],Te[Ce]="none")}function Ve(){Te&&Ce&&(Te[Ce]=ke)}function Oe(l){l.preventDefault(),l.stopPropagation(),o.window.removeEventListener("click",Oe,!0)}function $e(){o.window.addEventListener("click",Oe,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",Oe,!0)},0)}function xe(l,t){const a=l.getBoundingClientRect();return gt(l,a,t)}function dt(l,t){const a=l.getBoundingClientRect(),u=[];for(let p=0;p<t.length;p++)u.push(gt(l,a,t[p]));return u}function We(l){return o.window.InstallTrigger!==void 0&&l.button===2&&l.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button}function gt(l,t,a){const u=l.offsetWidth===t.width?1:l.offsetWidth/t.width;return new o.pointGeometry((a.clientX-t.left)*u,(a.clientY-t.top)*u)}function wt(l,t){var a=t[0],u=t[1],p=t[2],f=t[3],y=a*f-p*u;return y?(l[0]=f*(y=1/y),l[1]=-u*y,l[2]=-p*y,l[3]=a*y,l):null}function He(l){const{userImage:t}=l;return!!(t&&t.render&&t.render())&&(l.data.replace(new Uint8Array(t.data.buffer)),!0)}class Je extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,callback:u}of this.requestors)this._notify(a,u);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,a){this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let u=!0;return this._validateStretch(a.stretchX,a.data&&a.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),u=!1),this._validateStretch(a.stretchY,a.data&&a.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),u=!1),this._validateContent(a.content,a)||(this.fire(new o.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),u=!1),u}_validateStretch(t,a){if(!t)return!0;let u=0;for(const p of t){if(p[0]<u||p[1]<p[0]||a<p[1])return!1;u=p[1]}return!0}_validateContent(t,a){return!(t&&(t.length!==4||t[0]<0||a.data.width<t[0]||t[1]<0||a.data.height<t[1]||t[2]<0||a.data.width<t[2]||t[3]<0||a.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,a){a.version=this.images[t].version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,a){let u=!0;if(!this.isLoaded())for(const p of t)this.images[p]||(u=!1);this.isLoaded()||u?this._notify(t,a):this.requestors.push({ids:t,callback:a})}_notify(t,a){const u={};for(const p of t){this.images[p]||this.fire(new o.Event("styleimagemissing",{id:p}));const f=this.images[p];f?u[p]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,hasRenderCallback:Boolean(f.userImage&&f.userImage.render)}:o.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}a(null,u)}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],u=this.getImage(t);if(!u)return null;if(a&&a.position.version===u.version)return a.position;if(a)a.position.version=u.version;else{const p={w:u.data.width+2,h:u.data.height+2,x:0,y:0},f=new o.ImagePosition(p,u);this.patterns[t]={bin:p,position:f}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const f in this.patterns)t.push(this.patterns[f].bin);const{w:a,h:u}=o.potpack(t),p=this.atlasImage;p.resize({width:a||1,height:u||1});for(const f in this.patterns){const{bin:y}=this.patterns[f],v=y.x+1,w=y.y+1,A=this.images[f].data,C=A.width,P=A.height;o.RGBAImage.copy(A,p,{x:0,y:0},{x:v,y:w},{width:C,height:P}),o.RGBAImage.copy(A,p,{x:0,y:P-1},{x:v,y:w-1},{width:C,height:1}),o.RGBAImage.copy(A,p,{x:0,y:0},{x:v,y:w+P},{width:C,height:1}),o.RGBAImage.copy(A,p,{x:C-1,y:0},{x:v-1,y:w},{width:1,height:P}),o.RGBAImage.copy(A,p,{x:0,y:0},{x:v+C,y:w},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const u=this.images[a];He(u)&&this.updateImage(a,u)}}}const Ye=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(l,t){return function([a,u,p]){const f=o.degToRad(u+90),y=o.degToRad(p);return{x:a*Math.cos(f)*Math.sin(y),y:a*Math.sin(f)*Math.sin(y),z:a*Math.cos(y),azimuthal:u,polar:p}}(l.expression.evaluate(t))}interpolate(l,t,a){return{x:o.number(l.x,t.x,a),y:o.number(l.y,t.y,a),z:o.number(l.z,t.z,a),azimuthal:o.number(l.azimuthal,t.azimuthal,a),polar:o.number(l.polar,t.polar,a)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),qe="-transition";class Xe extends o.Evented{constructor(t){super(),this._transitionable=new o.Transitionable(Ye),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(o.validateLight,t,a))for(const u in t){const p=t[u];o.endsWith(u,qe)?this._transitionable.setTransition(u.slice(0,-qe.length),p):this._transitionable.setValue(u,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,u){return(!u||u.validate!==!1)&&o.emitValidationErrors(this,t.call(o.validateStyle,o.extend({value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const ze=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),St="-transition";class zt extends o.Evented{constructor(t,a){super(),this._transitionable=new o.Transitionable(ze),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a}get(){return this._transitionable.serialize()}set(t){for(const a in t){const u=t[a];o.endsWith(a,St)?this._transitionable.setTransition(a.slice(0,-St.length),u):this._transitionable.setValue(a,u)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function ei(l,t,a,u){const p=o.smoothstep(45,65,a),[f,y]=si(l,u),v=o.length(t);let w=1-Math.min(1,Math.exp((v-f)/(y-f)*-6));return w*=w*w,w=Math.min(1,1.00747*w),w*p*l.alpha}function si(l,t){const a=.5/Math.tan(.5*t);return[l.range[0]+a,l.range[1]+a]}const Ri=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])}),mt="-transition";class _t extends o.Evented{constructor(t,a){super(),this._transitionable=new o.Transitionable(Ri),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=a}get state(){const t=this._transform,a=t.projection.name==="globe",u=o.globeToMercatorTransition(t.zoom),p=this.properties.get("range"),f=[.5,3];return{range:a?[o.number(f[0],p[0],u),o.number(f[1],p[1],u)]:p,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,a={}){if(!this._validate(o.validateFog,t,a)){for(const u of Object.keys(o.spec.fog))t&&t[u]===void 0&&(t[u]=o.spec.fog[u].default);for(const u in t){const p=t[u];o.endsWith(u,mt)?this._transitionable.setTransition(u.slice(0,-mt.length),p):this._transitionable.setValue(u,p)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const a=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,t))*a.a}getOpacityAtLatLng(t,a){return this._transform.projection.supportsFog?function(u,p,f){const y=o.MercatorCoordinate.fromLngLat(p),v=f.elevation?f.elevation.getAtPointOrZero(y):0,w=[y.x,y.y,v];return o.transformMat4(w,w,f.mercatorFogMatrix),ei(u,w,f.pitch,f._fov)}(this.state,t,a):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?si(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,u){return(!u||u.validate!==!1)&&o.emitValidationErrors(this,t.call(o.validateStyle,o.extend({value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class xt{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const u=this.workerPool.acquire(this.id);for(let p=0;p<u.length;p++){const f=new xt.Actor(u[p],a,this.id);f.name=`Worker ${p}`,this.actors.push(f)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,a,u){o.asyncAll(this.actors,(p,f)=>{p.send(t,a,f)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ht(l,t,a){return t*(o.EXTENT/(l.tileSize*Math.pow(2,a-l.tileID.overscaledZ)))}xt.Actor=o.Actor;class Bt{constructor(t,a,u,p){this.screenBounds=t,this.cameraPoint=a,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=u,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,p)}static createFromScreenPoints(t,a){let u,p;if(t instanceof o.pointGeometry||typeof t[0]=="number"){const f=o.pointGeometry.convert(t);u=[o.pointGeometry.convert(t)],p=a.isPointAboveHorizon(f)}else{const f=o.pointGeometry.convert(t[0]),y=o.pointGeometry.convert(t[1]);u=[f,y],p=o.polygonizeBounds(f,y).every(v=>a.isPointAboveHorizon(v))}return new Bt(u,a.getCameraPoint(),p,a)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const a=this.screenBounds[0],u=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],p=o.polygonizeBounds(a,u,0,!1);return this.cameraPoint.y>u.y&&(this.cameraPoint.x>a.x&&this.cameraPoint.x<u.x?p.splice(3,0,this.cameraPoint):this.cameraPoint.x>=u.x?p[2]=this.cameraPoint:this.cameraPoint.x<=a.x&&(p[3]=this.cameraPoint)),o.bufferConvexPolygon(p,t)}bufferedCameraGeometryGlobe(t){const a=this.screenBounds[0],u=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],p=o.polygonizeBounds(a,u,t),f=this.cameraPoint.clone();switch(3*((f.y>a.y)+(f.y>u.y))+((f.x>a.x)+(f.x>u.x))){case 0:p[0]=f,p[4]=f.clone();break;case 1:p.splice(1,0,f);break;case 2:p[1]=f;break;case 3:p.splice(4,0,f);break;case 5:p.splice(2,0,f);break;case 6:p[3]=f;break;case 7:p.splice(3,0,f);break;case 8:p[2]=f}return p}containsTile(t,a,u,p=0){const f=t.queryPadding/a._projectionScaler+1,y=u?this._bufferedCameraMercator(f,a):this._bufferedScreenMercator(f,a);let v=t.tileID.wrap+(y.unwrapped?p:0);const w=y.polygon.map(Q=>o.getTilePoint(t.tileTransform,Q,v));if(!o.polygonIntersectsBox(w,0,0,o.EXTENT,o.EXTENT))return;v=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?p:0);const A=this.screenGeometryMercator.polygon.map(Q=>o.getTileVec3(t.tileTransform,Q,v)),C=A.map(Q=>new o.pointGeometry(Q[0],Q[1])),P=a.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),O=o.getTileVec3(t.tileTransform,P,v),U=A.map(Q=>{const $=o.sub(Q,Q,O);return o.normalize($,$),new o.Ray(O,$)}),j=Ht(t,1,a.zoom)*a._projectionScaler;return{queryGeometry:this,tilespaceGeometry:C,tilespaceRays:U,bufferedTilespaceGeometry:w,bufferedTilespaceBounds:(G=o.getBounds(w),G.min.x=o.clamp(G.min.x,0,o.EXTENT),G.min.y=o.clamp(G.min.y,0,o.EXTENT),G.max.x=o.clamp(G.max.x,0,o.EXTENT),G.max.y=o.clamp(G.max.y,0,o.EXTENT),G),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:j};var G}_bufferedScreenMercator(t,a){const u=wi(t);if(this._screenRaycastCache[u])return this._screenRaycastCache[u];{let p;return p=a.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),a):{polygon:this.bufferedScreenGeometry(t).map(f=>a.pointCoordinate3D(f)),unwrapped:!0},this._screenRaycastCache[u]=p,p}}_bufferedCameraMercator(t,a){const u=wi(t);if(this._cameraRaycastCache[u])return this._cameraRaycastCache[u];{let p;return p=a.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),a):{polygon:this.bufferedCameraGeometry(t).map(f=>a.pointCoordinate3D(f)),unwrapped:!0},this._cameraRaycastCache[u]=p,p}}_projectAndResample(t,a){const u=function(f,y){const v=o.multiply([],y.pixelMatrix,y.globeMatrix),w=[0,-o.GLOBE_RADIUS,0,1],A=[0,o.GLOBE_RADIUS,0,1],C=[0,0,0,1];o.transformMat4$1(w,w,v),o.transformMat4$1(A,A,v),o.transformMat4$1(C,C,v);const P=new o.pointGeometry(w[0]/w[3],w[1]/w[3]),O=new o.pointGeometry(A[0]/A[3],A[1]/A[3]),U=o.polygonContainsPoint(f,P)&&w[3]<C[3],j=o.polygonContainsPoint(f,O)&&A[3]<C[3];if(!U&&!j)return null;const G=function(ce,Ie,Ae){for(let we=1;we<ce.length;we++){const Ze=ni(Ie.pointCoordinate3D(ce[we-1]).x),re=ni(Ie.pointCoordinate3D(ce[we]).x);if(Ae<0){if(Ze<re)return{idx:we,t:-Ze/(re-1-Ze)}}else if(re<Ze)return{idx:we,t:(1-Ze)/(re+1-Ze)}}return null}(f,y,U?-1:1);if(!G)return null;const{idx:Q,t:$}=G;let J=Q>1?fi(f.slice(0,Q),y):[],V=Q<f.length?fi(f.slice(Q),y):[];J=J.map(ce=>new o.pointGeometry(ni(ce.x),ce.y)),V=V.map(ce=>new o.pointGeometry(ni(ce.x),ce.y));const ne=[...J];ne.length===0&&ne.push(V[V.length-1]);const Y=o.number(ne[ne.length-1].y,(V.length===0?J[0]:V[0]).y,$);let ee;return ee=U?[new o.pointGeometry(0,Y),new o.pointGeometry(0,0),new o.pointGeometry(1,0),new o.pointGeometry(1,Y)]:[new o.pointGeometry(1,Y),new o.pointGeometry(1,1),new o.pointGeometry(0,1),new o.pointGeometry(0,Y)],ne.push(...ee),V.length===0?ne.push(J[0]):ne.push(...V),{polygon:ne.map(ce=>new o.MercatorCoordinate(ce.x,ce.y)),unwrapped:!1}}(t,a);if(u)return u;const p=function(f,y){let v=!1,w=-1/0,A=0;for(let P=0;P<f.length-1;P++)f[P].x>w&&(w=f[P].x,A=P);for(let P=0;P<f.length-1;P++){const O=(A+P)%(f.length-1),U=f[O],j=f[O+1];Math.abs(U.x-j.x)>.5&&(U.x<j.x?(U.x+=1,O===0&&(f[f.length-1].x+=1)):(j.x+=1,O+1===f.length-1&&(f[0].x+=1)),v=!0)}const C=o.mercatorXfromLng(y.center.lng);return v&&C<Math.abs(C-1)&&f.forEach(P=>{P.x-=1}),{polygon:f,unwrapped:v}}(fi(t,a).map(f=>new o.pointGeometry(ni(f.x),f.y)),a);return{polygon:p.polygon.map(f=>new o.MercatorCoordinate(f.x,f.y)),unwrapped:p.unwrapped}}}function fi(l,t){return o.resample(l,a=>{const u=t.pointCoordinate3D(a);a.x=u.x,a.y=u.y},1/256)}function ni(l){return l<0?1+l%1:l%1}function wi(l){return 100*l|0}function Ji(l,t,a,u,p){const f=function(y,v){if(y)return p(y);if(v){const w=o.pick(o.extend(v,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);v.vector_layers&&(w.vectorLayers=v.vector_layers,w.vectorLayerIds=w.vectorLayers.map(A=>A.id)),v.language_options&&(w.languageOptions=v.language_options),v.language&&v.language[v.id]&&(w.language=v.language[v.id]),v.worldview_options&&(w.worldviewOptions=v.worldview_options),v.worldview?w.worldview=v.worldview[v.id]:v.worldview_default&&(w.worldview=v.worldview_default),w.tiles=t.canonicalizeTileset(w,l.url),p(null,w)}};return l.url?o.getJSON(t.transformRequest(t.normalizeSourceURL(l.url,null,a,u),o.ResourceType.Source),f):o.exported.frame(()=>f(null,l))}class ji{constructor(t,a,u){this.bounds=o.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=u||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),u=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*a),p=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*a),f=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*a),y=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*a);return t.x>=u&&t.x<f&&t.y>=p&&t.y<y}}class gr{constructor(t,a,u){this.context=t;const p=t.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(u),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||a.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const or={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class yr{constructor(t,a,u,p){this.length=a.length,this.attributes=u,this.itemSize=a.bytesPerElement,this.dynamicDraw=p,this.context=t;const f=t.gl;this.buffer=f.createBuffer(),t.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||a.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let u=0;u<this.attributes.length;u++){const p=a.attributes[this.attributes[u].name];p!==void 0&&t.enableVertexAttribArray(p)}}setVertexAttribPointers(t,a,u){for(let p=0;p<this.attributes.length;p++){const f=this.attributes[p],y=a.attributes[f.name];y!==void 0&&t.vertexAttribPointer(y,f.components,t[or[f.type]],!1,this.itemSize,f.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Lt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class er extends Lt{getDefault(){return o.Color.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class br extends Lt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class $i extends Lt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class zi extends Lt{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ur extends Lt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ut extends Lt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Zi extends Lt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class wr extends Lt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class kn extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class ao extends Lt{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class zo extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class fa extends Lt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class _a extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Lr extends Lt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class un extends Lt{getDefault(){return o.Color.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class so extends Lt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class cs extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class Rr extends Lt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Mn extends Lt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class us extends Lt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class ma extends Lt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ga extends Lt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ya extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class xa extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class hs extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ps extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class S1 extends Lt{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class $n extends Lt{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class Cn extends Lt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Po extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class ds extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Tr extends Lt{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class va extends Tr{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class X extends Tr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,this.attachment(),a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class D extends X{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class R{constructor(t,a,u,p){this.context=t,this.width=a,this.height=u;const f=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new va(t,f),p&&(this.depthAttachment=new X(t,f))}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const u=this.depthAttachment.get();u&&t.deleteRenderbuffer(u)}t.deleteFramebuffer(this.framebuffer)}}class W{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new er(this),this.clearDepth=new br(this),this.clearStencil=new $i(this),this.colorMask=new zi(this),this.depthMask=new ur(this),this.stencilMask=new Ut(this),this.stencilFunc=new Zi(this),this.stencilOp=new wr(this),this.stencilTest=new kn(this),this.depthRange=new ao(this),this.depthTest=new zo(this),this.depthFunc=new fa(this),this.blend=new _a(this),this.blendFunc=new Lr(this),this.blendColor=new un(this),this.blendEquation=new so(this),this.cullFace=new cs(this),this.cullFaceSide=new Rr(this),this.frontFace=new Mn(this),this.program=new us(this),this.activeTexture=new ma(this),this.viewport=new ga(this),this.bindFramebuffer=new ya(this),this.bindRenderbuffer=new xa(this),this.bindTexture=new hs(this),this.bindVertexBuffer=new ps(this),this.bindElementBuffer=new S1(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $n(this),this.pixelStoreUnpack=new Cn(this),this.pixelStoreUnpackPremultiplyAlpha=new Po(this),this.pixelStoreUnpackFlipY=new ds(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t.getExtension("OES_standard_derivatives"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new gr(this,t,a)}createVertexBuffer(t,a,u){return new yr(this,t,a,u)}createRenderbuffer(t,a,u){const p=this.gl,f=p.createRenderbuffer();return this.bindRenderbuffer.set(f),p.renderbufferStorage(p.RENDERBUFFER,t,a,u),this.bindRenderbuffer.set(null),f}createFramebuffer(t,a,u){return new R(this,t,a,u)}clear({color:t,depth:a,stencil:u}){const p=this.gl;let f=0;t&&(f|=p.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(f|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),u!==void 0&&(f|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),p.clear(f)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Z(t.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ie extends o.Evented{constructor(t,a,u,p){super(),this.id=t,this.dispatcher=u,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},a),o.extend(this,o.pick(a,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ji(this._options,this.map._requestManager,null,null,(t,a)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new o.ErrorEvent(t)):a&&(o.extend(this,a),a.bounds&&(this.tileBounds=new ji(a.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(a.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,a){const u=o.exported.devicePixelRatio>=2,p=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),u,this.tileSize);t.request=o.getImage(this.map._requestManager.transformRequest(p,o.ResourceType.Tile),(f,y,v,w)=>(delete t.request,t.aborted?(t.state="unloaded",a(null)):f?(t.state="errored",a(f)):y?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:v,expires:w}),t.setTexture(y,this.map.painter),t.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void a(null)):a(null)))}static loadTileData(t,a,u){t.setTexture(a,u)}static unloadTileData(t,a){t.texture&&a.saveTileTexture(t.texture)}abortTile(t,a){t.request&&(t.request.cancel(),delete t.request),a()}unloadTile(t,a){t.texture&&this.map.painter.saveTileTexture(t.texture),a()}hasTransition(){return!1}}let ue;function ge(l,t,a,u,p,f,y,v){const w=[l,a,p,t,u,f,1,1,1],A=[y,v,1],C=o.adjoint([],w),[P,O,U]=o.transformMat3(A,A,o.transpose(C,C));return o.multiply$1(w,[P,0,0,0,O,0,0,0,U],w)}class _e extends o.Evented{constructor(t,a,u,p){super(),this.id=t,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=a}load(t,a){this._loaded=a||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(u,p)=>{if(this._loaded=!0,u)this.fire(new o.ErrorEvent(u));else if(p){const{HTMLImageElement:f}=o.window;this.image=p instanceof f?o.exported.getImageData(p):p,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const a=t.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(u){let p=1/0,f=1/0,y=-1/0,v=-1/0;for(const P of u)p=Math.min(p,P.x),f=Math.min(f,P.y),y=Math.max(y,P.x),v=Math.max(v,P.y);const w=Math.max(y-p,v-f),A=Math.max(0,Math.floor(-Math.log(w)/Math.LN2)),C=Math.pow(2,A);return new o.CanonicalTileID(A,Math.floor((p+y)/2*C),Math.floor((f+v)/2*C))}(a),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const w in this.tiles){const A=this.tiles[w];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}if(this._boundsArray)return;const a=o.tileTransform(this.tileID,this.map.transform.projection),[u,p,f,y]=this.coordinates.map(w=>{const A=a.projection.project(w[0],w[1]);return o.getTilePoint(a,A)._round()});this.perspectiveTransform=function(w,A,C,P,O,U,j,G,Q,$){const J=ge(0,0,w,0,0,A,w,A),V=ge(C,P,O,U,j,G,Q,$);return o.multiply$1(V,o.adjoint(J,J),V),[V[6]/V[8]*w/o.EXTENT,V[7]/V[8]*A/o.EXTENT]}(this.width,this.height,u.x,u.y,p.x,p.y,y.x,y.y,f.x,f.y);const v=this._boundsArray=new o.StructArrayLayout4i8;v.emplaceBack(u.x,u.y,0,0),v.emplaceBack(p.x,p.y,o.EXTENT,0),v.emplaceBack(y.x,y.y,0,o.EXTENT),v.emplaceBack(f.x,f.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(v,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.texture?this.texture.update(this.image):(this.texture=new o.Texture(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE)),this._prepareData(t)}loadTile(t,a){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},a(null)):(t.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const pe={vector:class extends o.Evented{constructor(l,t,a,u){if(super(),this.id=l,this.dispatcher=a,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(t,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(l){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const t=this.language||this.map._language,a=this.worldview||this.map._worldview;this._tileJSONRequest=Ji(this._options,this.map._requestManager,t,a,(u,p)=>{this._tileJSONRequest=null,this._loaded=!0,u?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${t}`),a&&a.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${a}`),this.fire(new o.ErrorEvent(u))):p&&(o.extend(this,p),p.bounds&&(this.tileBounds=new ji(p.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(p.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(u)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load(()=>{const t=this.map.style._getSourceCaches(this.id);for(const a of t)a.clearTiles()})}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}_setLanguage(l){return l===this.language||this.setSourceProperty(()=>{this.language=l}),this}_setWorldview(l){return l===this.worldview?this:this.worldviewOptions&&l&&!this.worldviewOptions[l]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${l}".`),this):(this.setSourceProperty(()=>{this.worldview=l}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(l,t){const a=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(a,o.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(u.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=t:l.request=l.actor.send("reloadTile",u,p.bind(this));else if(l.actor=this._tileWorkers[a]=this._tileWorkers[a]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",u,p.bind(this),void 0,!0);else{const f=o.loadVectorTile.call({deduped:this._deduped},u,(y,v)=>{y||!v?p.call(this,y):(u.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},l.actor&&l.actor.send("loadTile",u,p.bind(this),void 0,!0))},!0);l.request={cancel:f}}function p(f,y){return delete l.request,l.aborted?t(null):f&&f.status!==404?t(f):(y&&y.resourceTiming&&(l.resourceTiming=y.resourceTiming),this.map._refreshExpiredTiles&&y&&l.setExpiryData(y),l.loadVectorData(y,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),t(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:ie,"raster-dem":class extends ie{constructor(l,t,a,u){super(l,t,a,u),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(l,t){const a=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function u(p,f){p&&(l.state="errored",t(p)),f&&(l.dem=f,l.dem.onDeserialize(),l.needsHillshadePrepare=!0,l.needsDEMTextureUpload=!0,l.state="loaded",t(null))}l.request=o.getImage(this.map._requestManager.transformRequest(a,o.ResourceType.Tile),function(p,f,y,v){if(delete l.request,l.aborted)l.state="unloaded",t(null);else if(p)l.state="errored",t(p);else if(f){this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:y,expires:v});const w=o.window.ImageBitmap&&f instanceof o.window.ImageBitmap&&(ue==null&&(ue=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),ue),A=1-(f.width-o.prevPowerOfTwo(f.width))/2;A<1||l.neighboringTiles||(l.neighboringTiles=this._getNeighboringTiles(l.tileID));const C=w?f:o.exported.getImageData(f,A),P={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:C,encoding:this.encoding,padding:A};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",P,u.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(l){const t=l.canonical,a=Math.pow(2,t.z),u=(t.x-1+a)%a,p=t.x===0?l.wrap-1:l.wrap,f=(t.x+1+a)%a,y=t.x+1===a?l.wrap+1:l.wrap,v={};return v[new o.OverscaledTileID(l.overscaledZ,p,t.z,u,t.y).key]={backfilled:!1},v[new o.OverscaledTileID(l.overscaledZ,y,t.z,f,t.y).key]={backfilled:!1},t.y>0&&(v[new o.OverscaledTileID(l.overscaledZ,p,t.z,u,t.y-1).key]={backfilled:!1},v[new o.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},v[new o.OverscaledTileID(l.overscaledZ,y,t.z,f,t.y-1).key]={backfilled:!1}),t.y+1<a&&(v[new o.OverscaledTileID(l.overscaledZ,p,t.z,u,t.y+1).key]={backfilled:!1},v[new o.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},v[new o.OverscaledTileID(l.overscaledZ,y,t.z,f,t.y+1).key]={backfilled:!1}),v}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded"}},geojson:class extends o.Evented{constructor(l,t,a,u){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=a.getActor(),this.setEventedParent(u),this._data=t.data,this._options=o.extend({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const p=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*p,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*p,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:o.EXTENT,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*p,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(l){this.map=l,this.setData(this._data)}setData(l){return this._data=l,this._updateWorkerData(),this}getClusterExpansionZoom(l,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},t),this}getClusterChildren(l,t){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},t),this}getClusterLeaves(l,t,a,u){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:t,offset:a},u),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const l=o.extend({},this.workerOptions),t=this._data;typeof t=="string"?(l.request=this.map._requestManager.transformRequest(o.exported.resolveURL(t),o.ResourceType.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(a,u)=>{if(this._loaded=!0,this._pendingLoad=null,a)this.fire(new o.ErrorEvent(a));else{const p={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&u&&u.resourceTiming&&u.resourceTiming[this.id]&&(p.resourceTiming=u.resourceTiming[this.id]),this.fire(new o.Event("data",p)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(l,t){const a=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(a,{type:this.type,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(u,p)=>(delete l.request,l.unloadVectorData(),l.aborted?t(null):u?t(u):(l.loadVectorData(p,this.map.painter,a==="reloadTile"),t(null))),void 0,a==="loadTile")}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends _e{constructor(l,t,a,u){super(l,t,a,u),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const t of l.urls)this.urls.push(this.map._requestManager.transformRequest(t,o.ResourceType.Source).url);o.getVideo(this.urls,(t,a)=>{this._loaded=!0,t?this.fire(new o.ErrorEvent(t)):a&&(this.video=a,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const t=this.video.seekable;l<t.start(0)||l>t.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,t=l.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(l,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(l)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:_e,canvas:class extends _e{constructor(l,t,a,u){super(l,t,a,u),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(f=>typeof f!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}},custom:class extends o.Evented{constructor(l,t,a,u){super(),this.id=l,this.type="custom",this._dataType="raster",this._dispatcher=a,this._implementation=t,this.setEventedParent(u),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ji(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(l){this._map=l,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(l),this.load()}onRemove(l){this._implementation.onRemove&&this._implementation.onRemove(l)}hasTile(l){if(this._implementation.hasTile){const{x:t,y:a,z:u}=l.canonical;return this._implementation.hasTile({x:t,y:a,z:u})}return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,t){const{x:a,y:u,z:p}=l.tileID.canonical,f=new o.window.AbortController,y=this._implementation.loadTile({x:a,y:u,z:p},{signal:f.signal});if(!y)return this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null);y.cancel=()=>f.abort(),l.request=y.then(function(v){return delete l.request,l.aborted?(l.state="unloaded",t(null)):v?function(w){return w instanceof o.window.ImageData||w instanceof o.window.ImageBitmap||w instanceof o.window.HTMLCanvasElement}(v)?(this.loadTileData(l,v),l.state="loaded",void t(null)):(l.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null))}.bind(this)).catch(v=>{v.code!==20&&(l.state="errored",t(v))})}loadTileData(l,t){ie.loadTileData(l,t,this._map.painter)}unloadTileData(l){ie.unloadTileData(l,this._map.painter)}prepareTile(l){if(!this._implementation.prepareTile)return null;const{x:t,y:a,z:u}=l.tileID.canonical,p=this._implementation.prepareTile({x:t,y:a,z:u});return p?(this.loadTileData(l,p),l.state="loaded",p):null}unloadTile(l,t){if(this.unloadTileData(l),this._implementation.unloadTile){const{x:a,y:u,z:p}=l.tileID.canonical;this._implementation.unloadTile({x:a,y:u,z:p})}t()}abortTile(l,t){l.request&&l.request.cancel&&(l.request.cancel(),delete l.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(l=>({x:l.canonical.x,y:l.canonical.y,z:l.canonical.z}))}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ve=function(l,t,a,u){const p=new pe[t.type](l,t,a,u);if(p.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${p.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],p),p};function Be(l,t){const a=o.identity([]);return o.scale(a,a,[.5*l.width,.5*-l.height,1]),o.translate(a,a,[1,-1,0]),o.multiply(a,a,l.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(a)}function st(l,t,a,u,p,f,y,v=!1){const w=l.tilesIn(u,y,v);w.sort(Tt);const A=[];for(const P of w)A.push({wrappedTileID:P.tile.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,a,l._state,P,p,f,Be(l.transform,P.tile.tileID),v)});const C=function(P){const O={},U={};for(const j of P){const G=j.queryResults,Q=j.wrappedTileID,$=U[Q]=U[Q]||{};for(const J in G){const V=G[J],ne=$[J]=$[J]||{},Y=O[J]=O[J]||[];for(const ee of V)ne[ee.featureIndex]||(ne[ee.featureIndex]=!0,Y.push(ee))}}return O}(A);for(const P in C)C[P].forEach(O=>{const U=O.feature,j=U.layer;j&&j.type!=="background"&&j.type!=="sky"&&(U.source=j.source,j["source-layer"]&&(U.sourceLayer=j["source-layer"]),U.state=U.id!==void 0?l.getFeatureState(j["source-layer"],U.id):{})});return C}function Ne(l,t){const a=l.getRenderableIds().map(f=>l.getTileByID(f)),u=[],p={};for(let f=0;f<a.length;f++){const y=a[f],v=y.tileID.canonical.key;p[v]||(p[v]=!0,y.querySourceFeatures(u,t))}return u}function Tt(l,t){const a=l.tileID,u=t.tileID;return a.overscaledZ-u.overscaledZ||a.canonical.y-u.canonical.y||a.wrap-u.wrap||a.canonical.x-u.canonical.x}function Et(){return Ho.workerClass!=null?new Ho.workerClass:new o.window.Worker(Ho.workerUrl)}const It="mapboxgl_preloaded_worker_pool";class Mt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Mt.workerCount;)this.workers.push(new Et);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}let Vt;function ti(){return Vt||(Vt=new Mt),Vt}function xi(l,t){const a={};for(const u in l)u!=="ref"&&(a[u]=l[u]);return o.refProperties.forEach(u=>{u in t&&(a[u]=t[u])}),a}function li(l){l=l.slice();const t=Object.create(null);for(let a=0;a<l.length;a++)t[l[a].id]=l[a];for(let a=0;a<l.length;a++)"ref"in l[a]&&(l[a]=xi(l[a],t[l[a].ref]));return l}Mt.workerCount=2;const me={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Br(l,t,a){a.push({command:me.addSource,args:[l,t[l]]})}function Si(l,t,a){t.push({command:me.removeSource,args:[l]}),a[l]=!0}function Ur(l,t,a,u){Si(l,a,u),Br(l,t,a)}function i3(l,t,a){let u;for(u in l[a])if(l[a].hasOwnProperty(u)&&u!=="data"&&!Z(l[a][u],t[a][u]))return!1;for(u in t[a])if(t[a].hasOwnProperty(u)&&u!=="data"&&!Z(l[a][u],t[a][u]))return!1;return!0}function Or(l,t,a,u,p,f){let y;for(y in t=t||{},l=l||{})l.hasOwnProperty(y)&&(Z(l[y],t[y])||a.push({command:f,args:[u,y,t[y],p]}));for(y in t)t.hasOwnProperty(y)&&!l.hasOwnProperty(y)&&(Z(l[y],t[y])||a.push({command:f,args:[u,y,t[y],p]}))}function fs(l){return l.id}function Jl(l,t){return l[t.id]=t,l}class ba{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=o.clamp(t,0,1);let a=1,u=this._distances[a];const p=t*this.paddedLength+this.padding;for(;u<p&&a<this._distances.length;)u=this._distances[++a];const f=a-1,y=this._distances[f],v=u-y,w=v>0?(p-y)/v:0;return this.points[f].mult(1-w).add(this.points[a].mult(w))}}class ot{constructor(t,a,u){const p=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(t/u),this.yCellCount=Math.ceil(a/u);for(let y=0;y<this.xCellCount*this.yCellCount;y++)p.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,u,p,f){this._forEachCell(a,u,p,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(f)}insertCircle(t,a,u,p){this._forEachCell(a-p,u-p,a+p,u+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(u),this.circles.push(p)}_insertBoxCell(t,a,u,p,f,y){this.boxCells[f].push(y)}_insertCircleCell(t,a,u,p,f,y){this.circleCells[f].push(y)}_query(t,a,u,p,f,y){if(u<0||t>this.width||p<0||a>this.height)return!f&&[];const v=[];if(t<=0&&a<=0&&this.width<=u&&this.height<=p){if(f)return!0;for(let w=0;w<this.boxKeys.length;w++)v.push({key:this.boxKeys[w],x1:this.bboxes[4*w],y1:this.bboxes[4*w+1],x2:this.bboxes[4*w+2],y2:this.bboxes[4*w+3]});for(let w=0;w<this.circleKeys.length;w++){const A=this.circles[3*w],C=this.circles[3*w+1],P=this.circles[3*w+2];v.push({key:this.circleKeys[w],x1:A-P,y1:C-P,x2:A+P,y2:C+P})}return y?v.filter(y):v}return this._forEachCell(t,a,u,p,this._queryCell,v,{hitTest:f,seenUids:{box:{},circle:{}}},y),f?v.length>0:v}_queryCircle(t,a,u,p,f){const y=t-u,v=t+u,w=a-u,A=a+u;if(v<0||y>this.width||A<0||w>this.height)return!p&&[];const C=[];return this._forEachCell(y,w,v,A,this._queryCellCircle,C,{hitTest:p,circle:{x:t,y:a,radius:u},seenUids:{box:{},circle:{}}},f),p?C.length>0:C}query(t,a,u,p,f){return this._query(t,a,u,p,!1,f)}hitTest(t,a,u,p,f){return this._query(t,a,u,p,!0,f)}hitTestCircle(t,a,u,p){return this._queryCircle(t,a,u,!0,p)}_queryCell(t,a,u,p,f,y,v,w){const A=v.seenUids,C=this.boxCells[f];if(C!==null){const O=this.bboxes;for(const U of C)if(!A.box[U]){A.box[U]=!0;const j=4*U;if(t<=O[j+2]&&a<=O[j+3]&&u>=O[j+0]&&p>=O[j+1]&&(!w||w(this.boxKeys[U]))){if(v.hitTest)return y.push(!0),!0;y.push({key:this.boxKeys[U],x1:O[j],y1:O[j+1],x2:O[j+2],y2:O[j+3]})}}}const P=this.circleCells[f];if(P!==null){const O=this.circles;for(const U of P)if(!A.circle[U]){A.circle[U]=!0;const j=3*U;if(this._circleAndRectCollide(O[j],O[j+1],O[j+2],t,a,u,p)&&(!w||w(this.circleKeys[U]))){if(v.hitTest)return y.push(!0),!0;{const G=O[j],Q=O[j+1],$=O[j+2];y.push({key:this.circleKeys[U],x1:G-$,y1:Q-$,x2:G+$,y2:Q+$})}}}}}_queryCellCircle(t,a,u,p,f,y,v,w){const A=v.circle,C=v.seenUids,P=this.boxCells[f];if(P!==null){const U=this.bboxes;for(const j of P)if(!C.box[j]){C.box[j]=!0;const G=4*j;if(this._circleAndRectCollide(A.x,A.y,A.radius,U[G+0],U[G+1],U[G+2],U[G+3])&&(!w||w(this.boxKeys[j])))return y.push(!0),!0}}const O=this.circleCells[f];if(O!==null){const U=this.circles;for(const j of O)if(!C.circle[j]){C.circle[j]=!0;const G=3*j;if(this._circlesCollide(U[G],U[G+1],U[G+2],A.x,A.y,A.radius)&&(!w||w(this.circleKeys[j])))return y.push(!0),!0}}}_forEachCell(t,a,u,p,f,y,v,w){const A=this._convertToXCellCoord(t),C=this._convertToYCellCoord(a),P=this._convertToXCellCoord(u),O=this._convertToYCellCoord(p);for(let U=A;U<=P;U++)for(let j=C;j<=O;j++)if(f.call(this,t,a,u,p,this.xCellCount*j+U,y,v,w))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,u,p,f,y){const v=p-t,w=f-a,A=u+y;return A*A>v*v+w*w}_circleAndRectCollide(t,a,u,p,f,y,v){const w=(y-p)/2,A=Math.abs(t-(p+w));if(A>w+u)return!1;const C=(v-f)/2,P=Math.abs(a-(f+C));if(P>C+u)return!1;if(A<=w||P<=C)return!0;const O=A-w,U=P-C;return O*O+U*U<=u*u}}const Wt=Math.tan(85*Math.PI/180);function jt(l,t,a,u,p,f,y){const v=o.create();if(a)if(f.name==="globe"){const w=o.calculateGlobeLabelMatrix(p,t);o.multiply(v,v,w)}else{const w=wt([],y);v[0]=w[0],v[1]=w[1],v[4]=w[2],v[5]=w[3],u||o.rotateZ(v,v,p.angle)}else o.multiply(v,p.labelPlaneMatrix,l);return v}function tn(l,t,a,u,p,f,y){const v=jt(l,t,a,u,p,f,y);return f.name==="globe"&&a||(v[2]=v[6]=v[10]=v[14]=0),v}function lo(l,t,a,u,p,f,y){if(a){if(f.name==="globe"){const v=jt(l,t,a,u,p,f,y);return o.invert(v,v),o.multiply(v,l,v),v}{const v=o.clone(l),w=o.identity([]);return w[0]=y[0],w[1]=y[1],w[4]=y[2],w[5]=y[3],o.multiply(v,v,w),u||o.rotateZ(v,v,-p.angle),v}}return p.glCoordMatrix}function Ot(l,t,a=0){const u=[l.x,l.y,a,1];a?o.transformMat4$1(u,u,t):Bi(u,u,t);const p=u[3];return{point:[u[0]/p,u[1]/p,u[2]/p],signedDistanceFromCamera:p}}function zn(l,t){const a=[l[0],l[1],l[2],1];o.transformMat4$1(a,a,t);const u=a[3];return{point:[a[0]/u,a[1]/u,a[2]/u],signedDistanceFromCamera:u}}function Do(l,t){return Math.min(.5+l/t*.5,1.5)}function wa(l,t){const a=l[0]/l[3],u=l[1]/l[3];return a>=-t[0]&&a<=t[0]&&u>=-t[1]&&u<=t[1]}function Vr(l,t,a,u,p,f,y,v,w,A){const C=a.transform,P=u?l.textSizeData:l.iconSizeData,O=o.evaluateSizeForZoom(P,a.transform.zoom),U=C.projection.name==="globe",j=[256/a.width*2+1,256/a.height*2+1],G=u?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;G.clear();let Q=null;U&&(Q=u?l.text.globeExtVertexArray:l.icon.globeExtVertexArray);const $=l.lineVertexArray,J=u?l.text.placedSymbolArray:l.icon.placedSymbolArray,V=a.transform.width/a.transform.height;let ne=!1;for(let Y=0;Y<J.length;Y++){const ee=J.get(Y);if(ee.writingMode!==o.WritingMode.vertical||ne||Y!==0&&J.get(Y-1).writingMode===o.WritingMode.horizontal||(ne=!0),(ee.hidden||ee.writingMode===o.WritingMode.vertical)&&!ne){Hi(ee.numGlyphs,G);continue}ne=!1;const ce=new o.pointGeometry(ee.tileAnchorX,ee.tileAnchorY),Ie=w?w(ce):[0,0,0],Ae=C.projection.projectTilePoint(ce.x,ce.y,A.canonical),we=[Ae.x+Ie[0],Ae.y+Ie[1],Ae.z+Ie[2]],Ze=[...we,1];if(o.transformMat4$1(Ze,Ze,t),!wa(Ze,j)){Hi(ee.numGlyphs,G);continue}const re=Do(a.transform.cameraToCenterDistance,Ze[3]),ye=o.evaluateSizeForFeature(P,O,ee),Le=y?ye/re:ye*re,tt=Ot(new o.pointGeometry(we[0],we[1]),p,we[2]);if(tt.signedDistanceFromCamera<=0){Hi(ee.numGlyphs,G);continue}let De={};const ft=y?null:w,Ke=Lo(ee,Le,!1,v,t,p,f,l.glyphOffsetArray,$,G,Q,tt.point,ce,De,V,ft,C.projection,A,y);ne=Ke.useVertical,ft&&Ke.needsFlipping&&(De={}),(Ke.notEnoughRoom||ne||Ke.needsFlipping&&Lo(ee,Le,!0,v,t,p,f,l.glyphOffsetArray,$,G,Q,tt.point,ce,De,V,ft,C.projection,A,y).notEnoughRoom)&&Hi(ee.numGlyphs,G)}u?(l.text.dynamicLayoutVertexBuffer.updateData(G),Q&&l.text.globeExtVertexBuffer.updateData(Q)):(l.icon.dynamicLayoutVertexBuffer.updateData(G),Q&&l.icon.globeExtVertexBuffer.updateData(Q))}function Ei(l,t,a,u,p,f,y,v,w,A,C,P,O,U,j,G){const Q=v.glyphStartIndex+v.numGlyphs,$=v.lineStartIndex,J=v.lineStartIndex+v.lineLength,V=t.getoffsetX(v.glyphStartIndex),ne=t.getoffsetX(Q-1),Y=Bo(l*V,a,u,p,f,y,v.segment,$,J,w,A,C,P,O,!0,U,j,G);if(!Y)return null;const ee=Bo(l*ne,a,u,p,f,y,v.segment,$,J,w,A,C,P,O,!0,U,j,G);return ee?{first:Y,last:ee}:null}function Hl(l,t,a,u){return l.writingMode===o.WritingMode.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*u?{useVertical:!0}:l.writingMode===o.WritingMode.vertical?t.y<a.y?{needsFlipping:!0}:null:l.flipState!==0&&function(p,f,y){const v=(f.x-p.x)*y;return v===0||Math.abs((f.y-p.y)/v)>Wt}(t,a,u)?l.flipState===1?{needsFlipping:!0}:null:t.x>a.x?{needsFlipping:!0}:null}function Lo(l,t,a,u,p,f,y,v,w,A,C,P,O,U,j,G,Q,$,J){const V=t/24,ne=l.lineOffsetX*V,Y=l.lineOffsetY*V;let ee;if(l.numGlyphs>1){const ce=l.glyphStartIndex+l.numGlyphs,Ie=l.lineStartIndex,Ae=l.lineStartIndex+l.lineLength,we=Ei(V,v,ne,Y,a,P,O,l,w,f,U,G,!1,Q,$,J);if(!we)return{notEnoughRoom:!0};const Ze=zn(we.first.point,y).point,re=zn(we.last.point,y).point,ye=new o.pointGeometry(Ze[0],Ze[1]),Le=new o.pointGeometry(re[0],re[1]);if(u&&!a){const tt=Hl(l,ye,Le,j);if(l.flipState=tt&&tt.needsFlipping?1:2,tt)return tt}ee=[we.first];for(let tt=l.glyphStartIndex+1;tt<ce-1;tt++)ee.push(Bo(V*v.getoffsetX(tt),ne,Y,a,P,O,l.segment,Ie,Ae,w,f,U,G,!1,!1,Q,$,J));ee.push(we.last)}else{if(u&&!a){const Ie=Ot(O,p).point,Ae=l.lineStartIndex+l.segment+1,we=new o.pointGeometry(w.getx(Ae),w.gety(Ae)),Ze=Ot(we,p),re=Ze.signedDistanceFromCamera>0?Ze.point:Ro(O,we,Ie,1,p,void 0,Q,$.canonical),ye=Hl(l,new o.pointGeometry(Ie[0],Ie[1]),new o.pointGeometry(re[0],re[1]),j);if(l.flipState=ye&&ye.needsFlipping?1:2,ye)return ye}const ce=Bo(V*v.getoffsetX(l.glyphStartIndex),ne,Y,a,P,O,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,w,f,U,G,!1,!1,Q,$,J);if(!ce)return{notEnoughRoom:!0};ee=[ce]}if(C)for(const ce of ee)o.updateGlobeVertexNormal(C,A.length+0,ce.up[0],ce.up[1],ce.up[2]),o.updateGlobeVertexNormal(C,A.length+1,ce.up[0],ce.up[1],ce.up[2]),o.updateGlobeVertexNormal(C,A.length+2,ce.up[0],ce.up[1],ce.up[2]),o.updateGlobeVertexNormal(C,A.length+3,ce.up[0],ce.up[1],ce.up[2]),o.addDynamicAttributes(A,ce.point[0],ce.point[1],ce.point[2],ce.angle);else for(const ce of ee)o.addDynamicAttributes(A,ce.point[0],ce.point[1],ce.point[2],ce.angle);return{}}function _s(l,t,a,u,p){const f=u.projectTilePoint(l.x,l.y,t);if(!p)return Ot(f,a,f.z);const y=p(l);return Ot(new o.pointGeometry(f.x+y[0],f.y+y[1]),a,f.z+y[2])}function Ro(l,t,a,u,p,f,y,v){const w=_s(l.add(l.sub(t)._unit()),v,p,y,f).point,A=o.sub([],a,w);return o.scaleAndAdd([],a,A,u/o.length(A))}function Bo(l,t,a,u,p,f,y,v,w,A,C,P,O,U,j,G,Q,$){const J=u?l-t:l+t;let V=J>0?1:-1,ne=0;u&&(V*=-1,ne=Math.PI),V<0&&(ne+=Math.PI);let Y=V>0?v+y:v+y+1,ee=p,ce=p,Ie=0,Ae=0;const we=Math.abs(J),Ze=[],re=[];let ye=f;const Le=()=>{const vt=Y-V;return Ie===0?f:new o.pointGeometry(A.getx(vt),A.gety(vt))},tt=()=>Ro(Le(),ye,ce,we-Ie+1,C,O,G,Q.canonical);for(;Ie+Ae<=we;){if(Y+=V,Y<v||Y>=w)return null;if(ce=ee,Ze.push(ee),U&&re.push(ye||Le()),ee=P[Y],ee===void 0){ye=new o.pointGeometry(A.getx(Y),A.gety(Y));const vt=_s(ye,Q.canonical,C,G,O);ee=vt.signedDistanceFromCamera>0?P[Y]=vt.point:tt()}else ye=null;Ie+=Ae,Ae=o.distance(ce,ee)}ye=ye||new o.pointGeometry(A.getx(Y),A.gety(Y));const De=Le();j&&O&&(P[Y]=ee=P[Y]===void 0?ee:tt(),Ae=o.distance(ce,ee));const ft=(we-Ie)/Ae,Ke=ye.sub(De).mult(ft)._add(De),it=o.sub([],ee,ce),rt=o.scaleAndAdd([],ce,it,ft);let et=[0,0,1],ut=it[0],Ct=it[1];if($&&(et=G.upVector(Q.canonical,Ke.x,Ke.y),et[0]!==0||et[1]!==0||et[2]!==1)){const vt=[1,0,0],Pt=[0,1,0];vt[0]=et[2],vt[1]=0,vt[2]=-et[0],o.cross(Pt,et,vt),o.normalize(vt,vt),o.normalize(Pt,Pt),ut=o.dot(it,vt),Ct=o.dot(it,Pt)}if(a){const vt=o.cross([],et,it);o.normalize(vt,vt),o.scaleAndAdd(rt,rt,vt,a*V)}const Dt=ne+Math.atan2(Ct,ut);return Ze.push(rt),U&&re.push(Ke),{point:rt,angle:Dt,path:Ze,tilePath:re,up:et}}const Yl=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Hi(l,t){for(let a=0;a<l;a++){const u=t.length;t.resize(u+4),t.float32.set(Yl,4*u)}}function Bi(l,t,a){const u=t[0],p=t[1];return l[0]=a[0]*u+a[4]*p+a[12],l[1]=a[1]*u+a[5]*p+a[13],l[3]=a[3]*u+a[7]*p+a[15],l}const jr=100;class E1{constructor(t,a,u=new ot(t.width+200,t.height+200,25),p=new ot(t.width+200,t.height+200,25)){this.transform=t,this.grid=u,this.ignoredGrid=p,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+jr,this.screenBottomBoundary=t.height+jr,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=a}placeCollisionBox(t,a,u,p,f,y,v,w){let A=u.projectedAnchorX,C=u.projectedAnchorY,P=u.projectedAnchorZ;const O=u.elevation,U=u.tileID;if(O&&U){const Y=t.getProjection().upVector(U.canonical,u.tileAnchorX,u.tileAnchorY),ee=t.getProjection().upVectorScale(U.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;A+=Y[0]*O*ee,C+=Y[1]*O*ee,P+=Y[2]*O*ee}const j=this.projectAndGetPerspectiveRatio(v,[A,C,P],u.tileID,t.projection.name==="globe"||!!O||this.transform.pitch>0,t.getProjection()),G=y*j.perspectiveRatio,Q=(u.x1*a+p.x-u.padding)*G+j.point.x,$=(u.y1*a+p.y-u.padding)*G+j.point.y,J=(u.x2*a+p.x+u.padding)*G+j.point.x,V=(u.y2*a+p.y+u.padding)*G+j.point.y,ne=j.perspectiveRatio<=.55||j.occluded;return!this.isInsideGrid(Q,$,J,V)||!f&&this.grid.hitTest(Q,$,J,V,w)||ne?{box:[],offscreen:!1,occluded:j.occluded}:{box:[Q,$,J,V],offscreen:this.isOffscreen(Q,$,J,V),occluded:!1}}placeCollisionCircles(t,a,u,p,f,y,v,w,A,C,P,O,U,j,G){const Q=[],$=this.transform.elevation,J=$?$.getAtTileOffsetFunc(G,this.transform.center.lat,this.transform.worldSize,t.getProjection()):De=>[0,0,0],V=new o.pointGeometry(u.tileAnchorX,u.tileAnchorY),ne=t.getProjection().projectTilePoint(u.tileAnchorX,u.tileAnchorY,G.canonical),Y=J(V),ee=[ne.x+Y[0],ne.y+Y[1],ne.z+Y[2]],ce=t.projection.name==="globe",Ie=this.projectAndGetPerspectiveRatio(v,[ee[0],ee[1],ee[2]],G,ce||!!$||this.transform.pitch>0,t.getProjection()),{perspectiveRatio:Ae}=Ie,we=(P?y/Ae:y*Ae)/o.ONE_EM,Ze=Ot(new o.pointGeometry(ee[0],ee[1]),w,ee[2]).point,re=Ie.signedDistanceFromCamera>0?Ei(we,f,u.lineOffsetX*we,u.lineOffsetY*we,!1,Ze,V,u,p,w,{},$&&!P?J:null,P&&!!$,t.getProjection(),G,P):null;let ye=!1,Le=!1,tt=!0;if(re&&!Ie.occluded){const De=.5*U*Ae+j,ft=new o.pointGeometry(-100,-100),Ke=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),it=new ba,rt=re.first,et=re.last;let ut=[];for(let vt=rt.path.length-1;vt>=1;vt--)ut.push(rt.path[vt]);for(let vt=1;vt<et.path.length;vt++)ut.push(et.path[vt]);const Ct=2.5*De;if(A){const vt=ut.map($&&!ce?(Pt,ci)=>{const _i=J(ci<rt.path.length-1?rt.tilePath[rt.path.length-1-ci]:et.tilePath[ci-rt.path.length+2]);return Pt[2]=_i[2],zn(Pt,A)}:Pt=>zn(Pt,A));ut=vt.some(Pt=>Pt.signedDistanceFromCamera<=0)?[]:vt.map(Pt=>Pt.point)}let Dt=[];if(ut.length>0){const vt=ut.map(pi=>new o.pointGeometry(pi[0],pi[1]));let Pt=1/0,ci=-1/0,_i=1/0,Ti=-1/0;for(let pi=0;pi<vt.length;pi++)Pt=Math.min(Pt,vt[pi].x),_i=Math.min(_i,vt[pi].y),ci=Math.max(ci,vt[pi].x),Ti=Math.max(Ti,vt[pi].y);Dt=Pt>=ft.x&&ci<=Ke.x&&_i>=ft.y&&Ti<=Ke.y?[vt]:ci<ft.x||Pt>Ke.x||Ti<ft.y||_i>Ke.y?[]:o.clipLine([vt],ft.x,ft.y,Ke.x,Ke.y)}for(const vt of Dt){it.reset(vt,.25*De);let Pt=0;Pt=it.length<=.5*De?1:Math.ceil(it.paddedLength/Ct)+1;for(let ci=0;ci<Pt;ci++){const _i=ci/Math.max(Pt-1,1),Ti=it.lerp(_i),pi=Ti.x+jr,Ir=Ti.y+jr;Q.push(pi,Ir,De,0);const dn=pi-De,Rn=Ir-De,vi=pi+De,Ai=Ir+De;if(tt=tt&&this.isOffscreen(dn,Rn,vi,Ai),Le=Le||this.isInsideGrid(dn,Rn,vi,Ai),!a&&this.grid.hitTestCircle(pi,Ir,De,O)&&(ye=!0,!C))return{circles:[],offscreen:!1,collisionDetected:ye,occluded:!1}}}}return{circles:!C&&ye||!Le?[]:Q,offscreen:tt,collisionDetected:ye,occluded:Ie.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let u=1/0,p=1/0,f=-1/0,y=-1/0;for(const C of t){const P=new o.pointGeometry(C.x+jr,C.y+jr);u=Math.min(u,P.x),p=Math.min(p,P.y),f=Math.max(f,P.x),y=Math.max(y,P.y),a.push(P)}const v=this.grid.query(u,p,f,y).concat(this.ignoredGrid.query(u,p,f,y)),w={},A={};for(const C of v){const P=C.key;if(w[P.bucketInstanceId]===void 0&&(w[P.bucketInstanceId]={}),w[P.bucketInstanceId][P.featureIndex])continue;const O=[new o.pointGeometry(C.x1,C.y1),new o.pointGeometry(C.x2,C.y1),new o.pointGeometry(C.x2,C.y2),new o.pointGeometry(C.x1,C.y2)];o.polygonIntersectsPolygon(a,O)&&(w[P.bucketInstanceId][P.featureIndex]=!0,A[P.bucketInstanceId]===void 0&&(A[P.bucketInstanceId]=[]),A[P.bucketInstanceId].push(P.featureIndex))}return A}insertCollisionBox(t,a,u,p,f){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:p,collisionGroupID:f},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,u,p,f){const y=a?this.ignoredGrid:this.grid,v={bucketInstanceId:u,featureIndex:p,collisionGroupID:f};for(let w=0;w<t.length;w+=4)y.insertCircle(v,t[w],t[w+1],t[w+2])}projectAndGetPerspectiveRatio(t,a,u,p,f){const y=[a[0],a[1],a[2],1];let v=!1;if(a[2]||this.transform.pitch>0){o.transformMat4$1(y,y,t);const w=f.name==="globe";this.fogState&&u&&!w&&(v=function(A,C,P,O,U,j){const G=j.calculateFogTileMatrix(U),Q=[C,P,O];return o.transformMat4(Q,Q,G),ei(A,Q,j.pitch,j._fov)}(this.fogState,a[0],a[1],a[2],u.toUnwrapped(),this.transform)>.9)}else Bi(y,y,t);return{point:new o.pointGeometry((y[0]/y[3]+1)/2*this.transform.width+jr,(-y[1]/y[3]+1)/2*this.transform.height+jr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(f)/y[3]*.5,1.5),signedDistanceFromCamera:y[3],occluded:p&&y[2]>y[3]||v}}isOffscreen(t,a,u,p){return u<jr||t>=this.screenRightBoundary||p<jr||a>this.screenBottomBoundary}isInsideGrid(t,a,u,p){return u>=0&&t<this.gridRightBoundary&&p>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=o.identity([]);return o.translate(t,t,[-100,-100,0]),t}}function hr(l,t,a){const u=t.createTileMatrix(l,l.worldSize,a.toUnwrapped());return o.multiply(new Float32Array(16),l.projMatrix,u)}function $r(l,t,a){if(t.projection.name===a.projection.name)return l.projMatrix;const u=a.clone();return u.setProjection(t.projection),hr(u,t.getProjection(),l)}function ms(l,t,a){return t.name===a.projection.name?l.projMatrix:hr(a,t,l)}class Ta{constructor(t,a,u,p){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):p&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Pi{constructor(t,a,u,p,f,y=!1){this.text=new Ta(t?t.text:null,a,u,f),this.icon=new Ta(t?t.icon:null,a,p,f),this.clipped=y}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class co{constructor(t,a,u,p=!1){this.text=t,this.icon=a,this.skipFade=u,this.clipped=p}}class A1{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Ia{constructor(t,a,u,p,f){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=u,this.bucketIndex=p,this.tileID=f}}class ar{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:u=>u.collisionGroupID===a}}return this.collisionGroups[t]}}function gs(l,t,a,u,p){const{horizontalAlign:f,verticalAlign:y}=o.getAnchorAlignment(l),v=-(f-.5)*t,w=-(y-.5)*a,A=o.evaluateVariableOffset(l,u);return new o.pointGeometry(v+A[0]*p,w+A[1]*p)}function Sa(l,t,a,u,p){const f=new o.pointGeometry(l,t);return a&&f._rotate(u?p:-p),f}class Pn{constructor(t,a,u,p,f){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new E1(this.transform,f),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new ar(u),this.collisionCircleArrays={},this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,a,u,p){const f=u.getBucket(a),y=u.latestFeatureIndex;if(!f||!y||a.id!==f.layerIds[0])return;const v=f.layers[0].layout,w=u.collisionBoxArray,A=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),C=u.tileSize/o.EXTENT,P=u.tileID.toUnwrapped();this.transform.setProjection(f.projection);const O=(U=u.tileID,j=f.getProjection(),G=this.transform,j.name===this.projection?G.calculateProjMatrix(U.toUnwrapped()):hr(G,j,U));var U,j,G;const Q=v.get("text-pitch-alignment")==="map",$=v.get("text-rotation-alignment")==="map";a.compileFilter();const J=a.dynamicFilter(),V=a.dynamicFilterNeedsFeature(),ne=this.transform.calculatePixelsToTileUnitsMatrix(u),Y=tn(O,u.tileID.canonical,Q,$,this.transform,f.getProjection(),ne);let ee=null;if(Q){const Ae=lo(O,u.tileID.canonical,Q,$,this.transform,f.getProjection(),ne);ee=o.multiply([],this.transform.labelPlaneMatrix,Ae)}let ce=null;J&&u.latestFeatureIndex&&(ce={unwrappedTileID:P,dynamicFilter:J,dynamicFilterNeedsFeature:V,featureIndex:u.latestFeatureIndex}),this.retainedQueryData[f.bucketInstanceId]=new Ia(f.bucketInstanceId,y,f.sourceLayerIndex,f.index,u.tileID);const Ie={bucket:f,layout:v,posMatrix:O,textLabelPlaneMatrix:Y,labelToScreenMatrix:ee,clippingData:ce,scale:A,textPixelRatio:C,holdingForFade:u.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(f.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(f.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(p)for(const Ae of f.sortKeyRanges){const{sortKey:we,symbolInstanceStart:Ze,symbolInstanceEnd:re}=Ae;t.push({sortKey:we,symbolInstanceStart:Ze,symbolInstanceEnd:re,parameters:Ie})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:Ie})}attemptAnchorPlacement(t,a,u,p,f,y,v,w,A,C,P,O,U,j,G,Q,$,J){const V=[O.textOffset0,O.textOffset1],ne=gs(t,u,p,V,f),Y=this.collisionIndex.placeCollisionBox(j,f,a,Sa(ne.x,ne.y,y,v,this.transform.angle),P,w,A,C.predicate);if((!Q||this.collisionIndex.placeCollisionBox(j,j.getSymbolInstanceIconSize(J,this.transform.zoom,U),Q,Sa(ne.x,ne.y,y,v,this.transform.angle),P,w,A,C.predicate).box.length!==0)&&Y.box.length>0){let ee;return this.prevPlacement&&this.prevPlacement.variableOffsets[O.crossTileID]&&this.prevPlacement.placements[O.crossTileID]&&this.prevPlacement.placements[O.crossTileID].text&&(ee=this.prevPlacement.variableOffsets[O.crossTileID].anchor),this.variableOffsets[O.crossTileID]={textOffset:V,width:u,height:p,anchor:t,textScale:f,prevAnchor:ee},this.markUsedJustification(j,t,O,G),j.allowVerticalPlacement&&(this.markUsedOrientation(j,G,O),this.placedOrientations[O.crossTileID]=G),{shift:ne,placedGlyphBoxes:Y}}}placeLayerBucketPart(t,a,u,p){const{bucket:f,layout:y,posMatrix:v,textLabelPlaneMatrix:w,labelToScreenMatrix:A,clippingData:C,textPixelRatio:P,holdingForFade:O,collisionBoxArray:U,partiallyEvaluatedTextSize:j,partiallyEvaluatedIconSize:G,collisionGroup:Q}=t.parameters,$=y.get("text-optional"),J=y.get("icon-optional"),V=y.get("text-allow-overlap"),ne=y.get("icon-allow-overlap"),Y=y.get("text-rotation-alignment")==="map",ee=y.get("text-pitch-alignment")==="map",ce=y.get("icon-text-fit")!=="none",Ie=y.get("symbol-z-order")==="viewport-y";this.transform.setProjection(f.projection);let Ae=V&&(ne||!f.hasIconData()||J),we=ne&&(V||!f.hasTextData()||$);!f.collisionArrays&&U&&f.deserializeCollisionBoxes(U),u&&p&&f.updateCollisionDebugBuffers(this.transform.zoom,U);const Ze=(re,ye,Le)=>{if(C){const vi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ai=null;if(C.dynamicFilterNeedsFeature){const ri=this.retainedQueryData[f.bucketInstanceId];Ai=C.featureIndex.loadFeature({featureIndex:re.featureIndex,bucketIndex:ri.bucketIndex,sourceLayerIndex:ri.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,C.dynamicFilter)(vi,Ai,this.retainedQueryData[f.bucketInstanceId].tileID.canonical,new o.pointGeometry(re.tileAnchorX,re.tileAnchorY),this.transform.calculateDistanceTileData(C.unwrappedTileID)))return this.placements[re.crossTileID]=new co(!1,!1,!1,!0),void(a[re.crossTileID]=!0)}if(a[re.crossTileID])return;if(O)return void(this.placements[re.crossTileID]=new co(!1,!1,!1));let tt=!1,De=!1,ft=!0,Ke=!1,it=!1,rt=null,et={box:null,offscreen:null,occluded:null},ut={box:null,offscreen:null,occluded:null},Ct=null,Dt=null,vt=null,Pt=0,ci=0,_i=0;Le.textFeatureIndex?Pt=Le.textFeatureIndex:re.useRuntimeCollisionCircles&&(Pt=re.featureIndex),Le.verticalTextFeatureIndex&&(ci=Le.verticalTextFeatureIndex);const Ti=vi=>{vi.tileID=this.retainedQueryData[f.bucketInstanceId].tileID,(this.transform.elevation||vi.elevation)&&(vi.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[f.bucketInstanceId].tileID,vi.tileAnchorX,vi.tileAnchorY):0)},pi=Le.textBox;if(pi){Ti(pi);const vi=ri=>{let qi=o.WritingMode.horizontal;if(f.allowVerticalPlacement&&!ri&&this.prevPlacement){const pr=this.prevPlacement.placedOrientations[re.crossTileID];pr&&(this.placedOrientations[re.crossTileID]=pr,qi=pr,this.markUsedOrientation(f,qi,re))}return qi},Ai=(ri,qi)=>{if(f.allowVerticalPlacement&&re.numVerticalGlyphVertices>0&&Le.verticalTextBox){for(const pr of f.writingModes)if(pr===o.WritingMode.vertical?(et=qi(),ut=et):et=ri(),et&&et.box&&et.box.length)break}else et=ri()};if(y.get("text-variable-anchor")){let ri=y.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[re.crossTileID]){const mi=this.prevPlacement.variableOffsets[re.crossTileID];ri.indexOf(mi.anchor)>0&&(ri=ri.filter(Di=>Di!==mi.anchor),ri.unshift(mi.anchor))}const qi=(mi,Di,vo)=>{const fn=f.getSymbolInstanceTextSize(j,re,this.transform.zoom,ye),Yo=(mi.x2-mi.x1)*fn+2*mi.padding,bo=(mi.y2-mi.y1)*fn+2*mi.padding,Wn=ce&&!ne?Di:null;Wn&&Ti(Wn);let dr={box:[],offscreen:!1,occluded:!1};const Fr=V?2*ri.length:ri.length;for(let _n=0;_n<Fr;++_n){const wo=this.attemptAnchorPlacement(ri[_n%ri.length],mi,Yo,bo,fn,Y,ee,P,v,Q,_n>=ri.length,re,ye,f,vo,Wn,j,G);if(wo&&(dr=wo.placedGlyphBoxes,dr&&dr.box&&dr.box.length)){tt=!0,rt=wo.shift;break}}return dr};Ai(()=>qi(pi,Le.iconBox,o.WritingMode.horizontal),()=>{const mi=Le.verticalTextBox;return mi&&Ti(mi),f.allowVerticalPlacement&&!(et&&et.box&&et.box.length)&&re.numVerticalGlyphVertices>0&&mi?qi(mi,Le.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),et&&(tt=et.box,ft=et.offscreen,Ke=et.occluded);const pr=vi(et&&et.box);if(!tt&&this.prevPlacement){const mi=this.prevPlacement.variableOffsets[re.crossTileID];mi&&(this.variableOffsets[re.crossTileID]=mi,this.markUsedJustification(f,mi.anchor,re,pr))}}else{const ri=(qi,pr)=>{const mi=f.getSymbolInstanceTextSize(j,re,this.transform.zoom,ye),Di=this.collisionIndex.placeCollisionBox(f,mi,qi,new o.pointGeometry(0,0),V,P,v,Q.predicate);return Di&&Di.box&&Di.box.length&&(this.markUsedOrientation(f,pr,re),this.placedOrientations[re.crossTileID]=pr),Di};Ai(()=>ri(pi,o.WritingMode.horizontal),()=>{const qi=Le.verticalTextBox;return f.allowVerticalPlacement&&re.numVerticalGlyphVertices>0&&qi?(Ti(qi),ri(qi,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),vi(et&&et.box&&et.box.length)}}if(Ct=et,tt=Ct&&Ct.box&&Ct.box.length>0,ft=Ct&&Ct.offscreen,Ke=Ct&&Ct.occluded,re.useRuntimeCollisionCircles){const vi=f.text.placedSymbolArray.get(re.centerJustifiedTextSymbolIndex>=0?re.centerJustifiedTextSymbolIndex:re.verticalPlacedTextSymbolIndex),Ai=o.evaluateSizeForFeature(f.textSizeData,j,vi),ri=y.get("text-padding");Dt=this.collisionIndex.placeCollisionCircles(f,V,vi,f.lineVertexArray,f.glyphOffsetArray,Ai,v,w,A,u,ee,Q.predicate,re.collisionCircleDiameter*Ai/o.ONE_EM,ri,this.retainedQueryData[f.bucketInstanceId].tileID),tt=V||Dt.circles.length>0&&!Dt.collisionDetected,ft=ft&&Dt.offscreen,Ke=Dt.occluded}if(Le.iconFeatureIndex&&(_i=Le.iconFeatureIndex),Le.iconBox){const vi=Ai=>{Ti(Ai);const ri=ce&&rt?Sa(rt.x,rt.y,Y,ee,this.transform.angle):new o.pointGeometry(0,0),qi=f.getSymbolInstanceIconSize(G,this.transform.zoom,ye);return this.collisionIndex.placeCollisionBox(f,qi,Ai,ri,ne,P,v,Q.predicate)};ut&&ut.box&&ut.box.length&&Le.verticalIconBox?(vt=vi(Le.verticalIconBox),De=vt.box.length>0):(vt=vi(Le.iconBox),De=vt.box.length>0),ft=ft&&vt.offscreen,it=vt.occluded}const Ir=$||re.numHorizontalGlyphVertices===0&&re.numVerticalGlyphVertices===0,dn=J||re.numIconVertices===0;if(Ir||dn?dn?Ir||(De=De&&tt):tt=De&&tt:De=tt=De&&tt,tt&&Ct&&Ct.box&&this.collisionIndex.insertCollisionBox(Ct.box,y.get("text-ignore-placement"),f.bucketInstanceId,ut&&ut.box&&ci?ci:Pt,Q.ID),De&&vt&&this.collisionIndex.insertCollisionBox(vt.box,y.get("icon-ignore-placement"),f.bucketInstanceId,_i,Q.ID),Dt&&(tt&&this.collisionIndex.insertCollisionCircles(Dt.circles,y.get("text-ignore-placement"),f.bucketInstanceId,Pt,Q.ID),u)){const vi=f.bucketInstanceId;let Ai=this.collisionCircleArrays[vi];Ai===void 0&&(Ai=this.collisionCircleArrays[vi]=new A1);for(let ri=0;ri<Dt.circles.length;ri+=4)Ai.circles.push(Dt.circles[ri+0]),Ai.circles.push(Dt.circles[ri+1]),Ai.circles.push(Dt.circles[ri+2]),Ai.circles.push(Dt.collisionDetected?1:0)}const Rn=f.projection.name!=="globe";Ae=Ae&&(Rn||!Ke),we=we&&(Rn||!it),this.placements[re.crossTileID]=new co(tt||Ae,De||we,ft||f.justReloaded),a[re.crossTileID]=!0};if(Ie){const re=f.getSortedSymbolIndexes(this.transform.angle);for(let ye=re.length-1;ye>=0;--ye){const Le=re[ye];Ze(f.symbolInstances.get(Le),Le,f.collisionArrays[Le])}}else for(let re=t.symbolInstanceStart;re<t.symbolInstanceEnd;re++)Ze(f.symbolInstances.get(re),re,f.collisionArrays[re]);if(u&&f.bucketInstanceId in this.collisionCircleArrays){const re=this.collisionCircleArrays[f.bucketInstanceId];o.invert(re.invProjMatrix,v),re.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}markUsedJustification(t,a,u,p){let f;f=p===o.WritingMode.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(a)];const y=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const v of y)v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=f>=0&&v!==f?0:u.crossTileID)}markUsedOrientation(t,a,u){const p=a===o.WritingMode.horizontal||a===o.WritingMode.horizontalOnly?a:0,f=a===o.WritingMode.vertical?a:0,y=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const v of y)t.text.placedSymbolArray.get(v).placedOrientation=p;u.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=f)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let u=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const p=a?a.symbolFadeChange(t):1,f=a?a.opacities:{},y=a?a.variableOffsets:{},v=a?a.placedOrientations:{};for(const w in this.placements){const A=this.placements[w],C=f[w];C?(this.opacities[w]=new Pi(C,p,A.text,A.icon,null,A.clipped),u=u||A.text!==C.text.placed||A.icon!==C.icon.placed):(this.opacities[w]=new Pi(null,p,A.text,A.icon,A.skipFade,A.clipped),u=u||A.text||A.icon)}for(const w in f){const A=f[w];if(!this.opacities[w]){const C=new Pi(A,p,!1,!1);C.isHidden()||(this.opacities[w]=C,u=u||A.text.placed||A.icon.placed)}}for(const w in y)this.variableOffsets[w]||!this.opacities[w]||this.opacities[w].isHidden()||(this.variableOffsets[w]=y[w]);for(const w in v)this.placedOrientations[w]||!this.opacities[w]||this.opacities[w].isHidden()||(this.placedOrientations[w]=v[w]);u?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const u={};for(const p of a){const f=p.getBucket(t);f&&p.latestFeatureIndex&&t.id===f.layerIds[0]&&this.updateBucketOpacities(f,u,p.collisionBoxArray)}}updateBucketOpacities(t,a,u){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const p=t.layers[0].layout,f=!!t.layers[0].dynamicFilter(),y=new Pi(null,0,!1,!1,!0),v=p.get("text-allow-overlap"),w=p.get("icon-allow-overlap"),A=p.get("text-variable-anchor"),C=p.get("text-rotation-alignment")==="map",P=p.get("text-pitch-alignment")==="map",O=p.get("icon-text-fit")!=="none",U=new Pi(null,0,v&&(w||!t.hasIconData()||p.get("icon-optional")),w&&(v||!t.hasTextData()||p.get("text-optional")),!0);!t.collisionArrays&&u&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(u);const j=(Q,$,J)=>{for(let V=0;V<$/4;V++)Q.opacityVertexArray.emplaceBack(J)};let G=0;for(let Q=0;Q<t.symbolInstances.length;Q++){const $=t.symbolInstances.get(Q),{numHorizontalGlyphVertices:J,numVerticalGlyphVertices:V,crossTileID:ne}=$;let Y=this.opacities[ne];a[ne]?Y=y:Y||(Y=U,this.opacities[ne]=Y),a[ne]=!0;const ee=J>0||V>0,ce=$.numIconVertices>0,Ie=this.placedOrientations[$.crossTileID],Ae=Ie===o.WritingMode.vertical,we=Ie===o.WritingMode.horizontal||Ie===o.WritingMode.horizontalOnly;if(!ee&&!ce||Y.isHidden()||G++,ee){const Ze=Dn(Y.text);j(t.text,J,Ae?uo:Ze),j(t.text,V,we?uo:Ze);const re=Y.text.isHidden();[$.rightJustifiedTextSymbolIndex,$.centerJustifiedTextSymbolIndex,$.leftJustifiedTextSymbolIndex].forEach(tt=>{tt>=0&&(t.text.placedSymbolArray.get(tt).hidden=re||Ae?1:0)}),$.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get($.verticalPlacedTextSymbolIndex).hidden=re||we?1:0);const ye=this.variableOffsets[$.crossTileID];ye&&this.markUsedJustification(t,ye.anchor,$,Ie);const Le=this.placedOrientations[$.crossTileID];Le&&(this.markUsedJustification(t,"left",$,Le),this.markUsedOrientation(t,Le,$))}if(ce){const Ze=Dn(Y.icon);$.placedIconSymbolIndex>=0&&(j(t.icon,$.numIconVertices,Ae?uo:Ze),t.icon.placedSymbolArray.get($.placedIconSymbolIndex).hidden=Y.icon.isHidden()),$.verticalPlacedIconSymbolIndex>=0&&(j(t.icon,$.numVerticalIconVertices,we?uo:Ze),t.icon.placedSymbolArray.get($.verticalPlacedIconSymbolIndex).hidden=Y.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ze=t.collisionArrays[Q];if(Ze){let re=new o.pointGeometry(0,0),ye=!0;if(Ze.textBox||Ze.verticalTextBox){if(A){const tt=this.variableOffsets[ne];tt?(re=gs(tt.anchor,tt.width,tt.height,tt.textOffset,tt.textScale),C&&re._rotate(P?this.transform.angle:-this.transform.angle)):ye=!1}f&&(ye=!Y.clipped),Ze.textBox&&Zn(t.textCollisionBox.collisionVertexArray,Y.text.placed,!ye||Ae,re.x,re.y),Ze.verticalTextBox&&Zn(t.textCollisionBox.collisionVertexArray,Y.text.placed,!ye||we,re.x,re.y)}const Le=ye&&Boolean(!we&&Ze.verticalIconBox);Ze.iconBox&&Zn(t.iconCollisionBox.collisionVertexArray,Y.icon.placed,Le,O?re.x:0,O?re.y:0),Ze.verticalIconBox&&Zn(t.iconCollisionBox.collisionVertexArray,Y.icon.placed,!Le,O?re.x:0,O?re.y:0)}}}if(t.fullyClipped=G===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const Q=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=Q.invProjMatrix,t.placementViewportMatrix=Q.viewportMatrix,t.collisionCircleArray=Q.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const u=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*u>t}setStale(){this.stale=!0}}function Zn(l,t,a,u,p){l.emplaceBack(t?1:0,a?1:0,u||0,p||0),l.emplaceBack(t?1:0,a?1:0,u||0,p||0),l.emplaceBack(t?1:0,a?1:0,u||0,p||0),l.emplaceBack(t?1:0,a?1:0,u||0,p||0)}const ys=Math.pow(2,25),r3=Math.pow(2,24),k1=Math.pow(2,17),Oo=Math.pow(2,16),n3=Math.pow(2,9),Kl=Math.pow(2,8),Fo=Math.pow(2,1);function Dn(l){if(l.opacity===0&&!l.placed)return 0;if(l.opacity===1&&l.placed)return 4294967295;const t=l.placed?1:0,a=Math.floor(127*l.opacity);return a*ys+t*r3+a*k1+t*Oo+a*n3+t*Kl+a*Fo+t}const uo=0;class qn{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,u,p,f){const y=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(y,p,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((v,w)=>v.sortKey-w.sortKey));this._currentPartIndex<y.length;){const v=y[this._currentPartIndex];if(a.placeLayerBucketPart(v,this._seenCrossTileIDs,u,v.symbolInstanceStart===0),this._currentPartIndex++,f())return!0}return!1}}class M1{constructor(t,a,u,p,f,y,v,w){this.placement=new Pn(t,f,y,v,w),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(t,a,u){const p=o.exported.now(),f=()=>{const y=o.exported.now()-p;return!this._forceFullPlacement&&y>2};for(;this._currentPlacementIndex>=0;){const y=a[t[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=v)&&(!y.maxzoom||y.maxzoom>v)){if(this._inProgressLayer||(this._inProgressLayer=new qn(y)),this._inProgressLayer.continuePlacement(u[y.source],this.placement,this._showCollisionBoxes,y,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const xs=512/o.EXTENT/2;class o3{constructor(t,a,u){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=u;for(let p=0;p<a.length;p++){const f=a.get(p),y=f.key;this.indexedSymbolInstances[y]||(this.indexedSymbolInstances[y]=[]),this.indexedSymbolInstances[y].push({crossTileID:f.crossTileID,coord:this.getScaledCoordinates(f,t)})}}getScaledCoordinates(t,a){const u=xs/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*o.EXTENT+t.tileAnchorX)*u),y:Math.floor((a.canonical.y*o.EXTENT+t.tileAnchorY)*u)}}findMatches(t,a,u){const p=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let f=0;f<t.length;f++){const y=t.get(f);if(y.crossTileID)continue;const v=this.indexedSymbolInstances[y.key];if(!v)continue;const w=this.getScaledCoordinates(y,a);for(const A of v)if(Math.abs(A.coord.x-w.x)<=p&&Math.abs(A.coord.y-w.y)<=p&&!u[A.crossTileID]){u[A.crossTileID]=!0,y.crossTileID=A.crossTileID;break}}}}class a3{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class C1{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const u in this.indexes){const p=this.indexes[u],f={};for(const y in p){const v=p[y];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),f[v.tileID.key]=v}this.indexes[u]=f}this.lng=t}addBucket(t,a,u){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let f=0;f<a.symbolInstances.length;f++)a.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const p=this.usedCrossTileIDs[t.overscaledZ];for(const f in this.indexes){const y=this.indexes[f];if(Number(f)>t.overscaledZ)for(const v in y){const w=y[v];w.tileID.isChildOf(t)&&w.findMatches(a.symbolInstances,t,p)}else{const v=y[t.scaledTo(Number(f)).key];v&&v.findMatches(a.symbolInstances,t,p)}}for(let f=0;f<a.symbolInstances.length;f++){const y=a.symbolInstances.get(f);y.crossTileID||(y.crossTileID=u.generate(),p[y.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new o3(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const u in a.indexedSymbolInstances)for(const p of a.indexedSymbolInstances[u])delete this.usedCrossTileIDs[t][p.crossTileID]}removeStaleBuckets(t){let a=!1;for(const u in this.indexes){const p=this.indexes[u];for(const f in p)t[p[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,p[f]),delete p[f],a=!0)}return a}}class Ql{constructor(){this.layerIndexes={},this.crossTileIDs=new a3,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,u,p){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new C1);let y=!1;const v={};p.name!=="globe"&&f.handleWrapJump(u);for(const w of a){const A=w.getBucket(t);A&&t.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(w.tileID,A,this.crossTileIDs)&&(y=!0),v[A.bucketInstanceId]=!0)}return f.removeStaleBuckets(v)&&(y=!0),y}pruneUnusedLayers(t){const a={};t.forEach(u=>{a[u]=!0});for(const u in this.layerIndexes)a[u]||delete this.layerIndexes[u]}}const Ea=(l,t)=>o.emitValidationErrors(l,t&&t.filter(a=>a.identifier!=="source.canvas")),s3=o.pick(me,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ec=o.pick(me,["setCenter","setZoom","setBearing","setPitch"]),l3={version:8,layers:[],sources:{}},z1={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class rn extends o.Evented{constructor(t,a={}){super(),this.map=t,this.dispatcher=new xt(ti(),this),this.imageManager=new Je,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(t._requestManager,a.localFontFamily?o.LocalGlyphMode.all:a.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,a.localFontFamily||a.localIdeographFontFamily),this.lineAtlas=new o.LineAtlas(256,512),this.crossTileSymbolIndex=new Ql,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const u=this;this._rtlTextPluginCallback=rn.registerForPluginStateChange(p=>{u.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(f,y)=>{if(o.triggerPluginCompletionEvent(f),y&&y.every(v=>v))for(const v in u._sourceCaches){const w=u._sourceCaches[v],A=w.getSource().type;A!=="vector"&&A!=="geojson"||w.reload()}})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const f=this.getSource(p.sourceId);if(f&&f.vectorLayerIds)for(const y in this._layers){const v=this._layers[y];v.source===f.id&&this._validateLayer(v)}})}loadURL(t,a={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const u=typeof a.validate=="boolean"?a.validate:!o.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,a.accessToken);const p=this.map._requestManager.transformRequest(t,o.ResourceType.Style);this._request=o.getJSON(p,(f,y)=>{this._request=null,f?this.fire(new o.ErrorEvent(f)):y&&this._load(y,u)})}loadJSON(t,a={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(t,a.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(l3,!1)}_updateLayerCount(t,a){const u=a?1:-1;t.is3D()&&(this._num3DLayers+=u),t.type==="circle"&&(this._numCircleLayers+=u),t.type==="symbol"&&(this._numSymbolLayers+=u)}_load(t,a){if(a&&Ea(this,o.validateStyle(t)))return;this._loaded=!0,this.stylesheet=o.clone$1(t),this._updateMapProjection();for(const p in t.sources)this.addSource(p,t.sources[p],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const u=li(this.stylesheet.layers);this._order=u.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of u)p=o.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize(),this._updateLayerCount(p,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Xe(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(t){this._spriteRequest=function(a,u,p){let f,y,v;const w=o.exported.devicePixelRatio>1?"@2x":"";let A=o.getJSON(u.transformRequest(u.normalizeSpriteURL(a,w,".json"),o.ResourceType.SpriteJSON),(O,U)=>{A=null,v||(v=O,f=U,P())}),C=o.getImage(u.transformRequest(u.normalizeSpriteURL(a,w,".png"),o.ResourceType.SpriteImage),(O,U)=>{C=null,v||(v=O,y=U,P())});function P(){if(v)p(v);else if(f&&y){const O=o.exported.getImageData(y),U={};for(const j in f){const{width:G,height:Q,x:$,y:J,sdf:V,pixelRatio:ne,stretchX:Y,stretchY:ee,content:ce}=f[j],Ie=new o.RGBAImage({width:G,height:Q});o.RGBAImage.copy(O,Ie,{x:$,y:J},{x:0,y:0},{width:G,height:Q}),U[j]={data:Ie,pixelRatio:ne,sdf:V,stretchX:Y,stretchY:ee,content:ce}}p(null,U)}}return{cancel(){A&&(A.cancel(),A=null),C&&(C.cancel(),C=null)}}}(t,this.map._requestManager,(a,u)=>{if(this._spriteRequest=null,a)this.fire(new o.ErrorEvent(a));else if(u)for(const p in u)this.imageManager.addImage(p,u[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(t){const a=this.getSource(t.source);if(!a)return;const u=t.sourceLayer;u&&(a.type==="geojson"||a.vectorLayerIds&&a.vectorLayerIds.indexOf(u)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${u}" does not exist on source "${a.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const a=[];for(const u of t){const p=this._layers[u];p.type!=="custom"&&a.push(p.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&z1[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const a=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);(p.length||f.length)&&this._updateWorkerLayers(p,f);for(const y in this._updatedSources){const v=this._updatedSources[y];v==="reload"?this._reloadSource(y):v==="clear"&&this._clearSource(y)}this._updateTilesForChangedImages();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const u={};for(const p in this._sourceCaches){const f=this._sourceCaches[p];u[p]=f.used,f.used=!1}for(const p of this._order){const f=this._layers[p];if(f.recalculate(t,this._availableImages),!f.isHidden(t.zoom)){const v=this._getLayerSourceCache(f);v&&(v.used=!0)}const y=this.map.painter;if(y){const v=f.getProgramIds();if(!v)continue;const w=f.getProgramConfiguration(t.zoom);for(const A of v)y.useProgram(A,w)}}for(const p in u){const f=this._sourceCaches[p];u[p]!==f.used&&f.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:f.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),a&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this._sourceCaches)this._sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(t){if(this._checkLoaded(),Ea(this,o.validateStyle(t)))return!1;(t=o.clone$1(t)).layers=li(t.layers);const a=function(p,f){if(!p)return[{command:me.setStyle,args:[f]}];let y=[];try{if(!Z(p.version,f.version))return[{command:me.setStyle,args:[f]}];Z(p.center,f.center)||y.push({command:me.setCenter,args:[f.center]}),Z(p.zoom,f.zoom)||y.push({command:me.setZoom,args:[f.zoom]}),Z(p.bearing,f.bearing)||y.push({command:me.setBearing,args:[f.bearing]}),Z(p.pitch,f.pitch)||y.push({command:me.setPitch,args:[f.pitch]}),Z(p.sprite,f.sprite)||y.push({command:me.setSprite,args:[f.sprite]}),Z(p.glyphs,f.glyphs)||y.push({command:me.setGlyphs,args:[f.glyphs]}),Z(p.transition,f.transition)||y.push({command:me.setTransition,args:[f.transition]}),Z(p.light,f.light)||y.push({command:me.setLight,args:[f.light]}),Z(p.fog,f.fog)||y.push({command:me.setFog,args:[f.fog]}),Z(p.projection,f.projection)||y.push({command:me.setProjection,args:[f.projection]});const v={},w=[];(function(P,O,U,j){let G;for(G in O=O||{},P=P||{})P.hasOwnProperty(G)&&(O.hasOwnProperty(G)||Si(G,U,j));for(G in O)O.hasOwnProperty(G)&&(P.hasOwnProperty(G)?Z(P[G],O[G])||(P[G].type==="geojson"&&O[G].type==="geojson"&&i3(P,O,G)?U.push({command:me.setGeoJSONSourceData,args:[G,O[G].data]}):Ur(G,O,U,j)):Br(G,O,U))})(p.sources,f.sources,w,v);const A=[];p.layers&&p.layers.forEach(P=>{P.source&&v[P.source]?y.push({command:me.removeLayer,args:[P.id]}):A.push(P)});let C=p.terrain;C&&v[C.source]&&(y.push({command:me.setTerrain,args:[void 0]}),C=void 0),y=y.concat(w),Z(C,f.terrain)||y.push({command:me.setTerrain,args:[f.terrain]}),function(P,O,U){O=O||[];const j=(P=P||[]).map(fs),G=O.map(fs),Q=P.reduce(Jl,{}),$=O.reduce(Jl,{}),J=j.slice(),V=Object.create(null);let ne,Y,ee,ce,Ie,Ae,we;for(ne=0,Y=0;ne<j.length;ne++)ee=j[ne],$.hasOwnProperty(ee)?Y++:(U.push({command:me.removeLayer,args:[ee]}),J.splice(J.indexOf(ee,Y),1));for(ne=0,Y=0;ne<G.length;ne++)ee=G[G.length-1-ne],J[J.length-1-ne]!==ee&&(Q.hasOwnProperty(ee)?(U.push({command:me.removeLayer,args:[ee]}),J.splice(J.lastIndexOf(ee,J.length-Y),1)):Y++,Ae=J[J.length-ne],U.push({command:me.addLayer,args:[$[ee],Ae]}),J.splice(J.length-ne,0,ee),V[ee]=!0);for(ne=0;ne<G.length;ne++)if(ee=G[ne],ce=Q[ee],Ie=$[ee],!V[ee]&&!Z(ce,Ie))if(Z(ce.source,Ie.source)&&Z(ce["source-layer"],Ie["source-layer"])&&Z(ce.type,Ie.type)){for(we in Or(ce.layout,Ie.layout,U,ee,null,me.setLayoutProperty),Or(ce.paint,Ie.paint,U,ee,null,me.setPaintProperty),Z(ce.filter,Ie.filter)||U.push({command:me.setFilter,args:[ee,Ie.filter]}),Z(ce.minzoom,Ie.minzoom)&&Z(ce.maxzoom,Ie.maxzoom)||U.push({command:me.setLayerZoomRange,args:[ee,Ie.minzoom,Ie.maxzoom]}),ce)ce.hasOwnProperty(we)&&we!=="layout"&&we!=="paint"&&we!=="filter"&&we!=="metadata"&&we!=="minzoom"&&we!=="maxzoom"&&(we.indexOf("paint.")===0?Or(ce[we],Ie[we],U,ee,we.slice(6),me.setPaintProperty):Z(ce[we],Ie[we])||U.push({command:me.setLayerProperty,args:[ee,we,Ie[we]]}));for(we in Ie)Ie.hasOwnProperty(we)&&!ce.hasOwnProperty(we)&&we!=="layout"&&we!=="paint"&&we!=="filter"&&we!=="metadata"&&we!=="minzoom"&&we!=="maxzoom"&&(we.indexOf("paint.")===0?Or(ce[we],Ie[we],U,ee,we.slice(6),me.setPaintProperty):Z(ce[we],Ie[we])||U.push({command:me.setLayerProperty,args:[ee,we,Ie[we]]}))}else U.push({command:me.removeLayer,args:[ee]}),Ae=J[J.lastIndexOf(ee)+1],U.push({command:me.addLayer,args:[Ie,Ae]})}(A,f.layers,y)}catch(v){console.warn("Unable to compute style diff:",v),y=[{command:me.setStyle,args:[f]}]}return y}(this.serialize(),t).filter(p=>!(p.command in ec));if(a.length===0)return!1;const u=a.filter(p=>!(p.command in s3));if(u.length>0)throw new Error(`Unimplemented: ${u.map(p=>p.command).join(", ")}.`);return a.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=t,this._updateMapProjection(),!0}addImage(t,a){return this.getImage(t)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,a),this._afterImageUpdated(t),this)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,a,u={}){if(this._checkLoaded(),this.getSource(t)!==void 0)throw new Error("There is already a source with this ID");if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(o.validateSource,`sources.${t}`,a,null,u))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const p=ve(t,a,this.dispatcher,this);p.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:p.serialize(),sourceId:t}));const f=y=>{const v=(y?"symbol:":"other:")+t,w=this._sourceCaches[v]=new o.SourceCache(v,p,y);(y?this._symbolSourceCaches:this._otherSourceCaches)[t]=w,w.style=this,w.onAdd(this.map)};f(!1),a.type!=="vector"&&a.type!=="geojson"||f(!0),p.onAdd&&p.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const a=this.getSource(t);if(!a)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===t)return this.fire(new o.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${p}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new o.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const u=this._getSourceCaches(t);for(const p of u)delete this._sourceCaches[p.id],delete this._updatedSources[p.id],p.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:p.getSource().id})),p.setEventedParent(null),p.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],a.setEventedParent(null),a.onRemove&&a.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,a){this._checkLoaded(),this.getSource(t).setData(a),this._changed=!0}getSource(t){const a=this._getSourceCache(t);return a&&a.getSource()}addLayer(t,a,u={}){this._checkLoaded();const p=t.id;if(this.getLayer(p))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${p}" already exists on this map`)));let f;if(t.type==="custom"){if(Ea(this,o.validateCustomStyleLayer(t)))return;f=o.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(p,t.source),t=o.clone$1(t),t=o.extend(t,{source:p})),this._validate(o.validateLayer,`layers.${p}`,t,{arrayIndex:-1},u))return;f=o.createStyleLayer(t),this._validateLayer(f),f.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[f.id]=f.serialize(),this._updateLayerCount(f,!0)}const y=a?this._order.indexOf(a):this._order.length;if(a&&y===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${a}" does not exist on this map.`)));this._order.splice(y,0,p),this._layerOrderChanged=!0,this._layers[p]=f;const v=this._getLayerSourceCache(f);if(this._removedLayers[p]&&f.source&&v&&f.type!=="custom"){const w=this._removedLayers[p];delete this._removedLayers[p],w.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",v.pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const u=this._order.indexOf(t);this._order.splice(u,1);const p=a?this._order.indexOf(a):this._order.length;a&&p===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${a}" does not exist on this map.`))):(this._order.splice(p,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));a.setEventedParent(null),this._updateLayerCount(a,!1);const u=this._order.indexOf(t);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const a in this._layers)if(this._layers[a].type===t)return!0;return!1}setLayerZoomRange(t,a,u){this._checkLoaded();const p=this.getLayer(t);p?p.minzoom===a&&p.maxzoom===u||(a!=null&&(p.minzoom=a),u!=null&&(p.maxzoom=u),this._updateLayer(p)):this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,a,u={}){this._checkLoaded();const p=this.getLayer(t);if(p){if(!Z(p.filter,a))return a==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(o.validateFilter,`layers.${p.id}.filter`,a,{layerType:p.type},u)||(p.filter=o.clone$1(a),this._updateLayer(p)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const a=this.getLayer(t);return a&&o.clone$1(a.filter)}setLayoutProperty(t,a,u,p={}){this._checkLoaded();const f=this.getLayer(t);f?Z(f.getLayoutProperty(a),u)||(f.setLayoutProperty(a,u,p),this._updateLayer(f)):this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,a){const u=this.getLayer(t);if(u)return u.getLayoutProperty(a);this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,a,u,p={}){this._checkLoaded();const f=this.getLayer(t);f?Z(f.getPaintProperty(a),u)||(f.setPaintProperty(a,u,p)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,a){const u=this.getLayer(t);return u&&u.getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const u=t.source,p=t.sourceLayer,f=this.getSource(u);if(!f)return void this.fire(new o.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const y=f.type;if(y==="geojson"&&p)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(y==="vector"&&!p)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const v=this._getSourceCaches(u);for(const w of v)w.setFeatureState(p,t.id,a)}removeFeatureState(t,a){this._checkLoaded();const u=t.source,p=this.getSource(u);if(!p)return void this.fire(new o.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const f=p.type,y=f==="vector"?t.sourceLayer:void 0;if(f==="vector"&&!y)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(a&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const v=this._getSourceCaches(u);for(const w of v)w.removeFeatureState(y,t.id,a)}getFeatureState(t){this._checkLoaded();const a=t.source,u=t.sourceLayer,p=this.getSource(a);if(p){if(p.type!=="vector"||u)return t.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(a)[0].getFeatureState(u,t.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const a in this._sourceCaches){const u=this._sourceCaches[a].getSource();t[u.id]||(t[u.id]=u.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},a=>a!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0;const a=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&a&&a.getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",a.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const a=y=>this._layers[y].type==="fill-extrusion",u={},p=[];for(let y=this._order.length-1;y>=0;y--){const v=this._order[y];if(a(v)){u[v]=y;for(const w of t){const A=w[v];if(A)for(const C of A)p.push(C)}}}p.sort((y,v)=>v.intersectionZ-y.intersectionZ);const f=[];for(let y=this._order.length-1;y>=0;y--){const v=this._order[y];if(a(v))for(let w=p.length-1;w>=0;w--){const A=p[w].feature;if(u[A.layer.id]<y)break;f.push(A),p.pop()}else for(const w of t){const A=w[v];if(A)for(const C of A)f.push(C.feature)}}return f}queryRenderedFeatures(t,a,u){a&&a.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",a.filter,null,a);const p={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const w of a.layers){const A=this._layers[w];if(!A)return this.fire(new o.ErrorEvent(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];p[A.source]=!0}}const f=[];a.availableImages=this._availableImages;const y=a&&a.layers?a.layers.some(w=>{const A=this.getLayer(w);return A&&A.is3D()}):this.has3DLayers(),v=Bt.createFromScreenPoints(t,u);for(const w in this._sourceCaches){const A=this._sourceCaches[w].getSource().id;a.layers&&!p[A]||f.push(st(this._sourceCaches[w],this._layers,this._serializedLayers,v,a,u,y,!!this.map._showQueryGeometry))}return this.placement&&f.push(function(w,A,C,P,O,U,j){const G={},Q=U.queryRenderedSymbols(P),$=[];for(const J of Object.keys(Q).map(Number))$.push(j[J]);$.sort(Tt);for(const J of $){const V=J.featureIndex.lookupSymbolFeatures(Q[J.bucketInstanceId],A,J.bucketIndex,J.sourceLayerIndex,O.filter,O.layers,O.availableImages,w);for(const ne in V){const Y=G[ne]=G[ne]||[],ee=V[ne];ee.sort((ce,Ie)=>{const Ae=J.featureSortOrder;if(Ae){const we=Ae.indexOf(ce.featureIndex);return Ae.indexOf(Ie.featureIndex)-we}return Ie.featureIndex-ce.featureIndex});for(const ce of ee)Y.push(ce)}}for(const J in G)G[J].forEach(V=>{const ne=V.feature,Y=C(w[J]).getFeatureState(ne.layer["source-layer"],ne.id);ne.source=ne.layer.source,ne.layer["source-layer"]&&(ne.sourceLayer=ne.layer["source-layer"]),ne.state=Y});return G}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),v.screenGeometry,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(t,a){a&&a.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",a.filter,null,a);const u=this._getSourceCaches(t);let p=[];for(const f of u)p=p.concat(Ne(f,a));return p}addSourceType(t,a,u){return rn.getSourceType(t)?u(new Error(`A source type called "${t}" already exists.`)):(rn.setSourceType(t,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:a.workerSourceURL},u):u(null,null))}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const u=this.light.getLight();let p=!1;for(const y in t)if(!Z(t[y],u[y])){p=!0;break}if(!p)return;const f=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(t,a),this.light.updateTransitions(f)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,a=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(a===1){if(typeof t.source=="object"){const u="terrain-dem-src";this.addSource(u,t.source),t=o.clone$1(t),t=o.extend(t,{source:u})}if(this._validate(o.validateTerrain,"terrain",t))return}if(!this.terrain||this.terrain&&a!==this.terrain.drapeRenderMode)this._createTerrain(t,a);else{const u=this.terrain,p=u.get();for(const f of Object.keys(o.spec.terrain))!t.hasOwnProperty(f)&&o.spec.terrain[f].default&&(t[f]=o.spec.terrain[f].default);for(const f in t)if(!Z(t[f],p[f])){u.set(t),this.stylesheet.terrain=t;const y=this._setTransitionParameters({duration:0});u.updateTransitions(y);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const a=this.fog=new _t(t,this.map.transform);this.stylesheet.fog=t;const u=this._setTransitionParameters({duration:0});a.updateTransitions(u)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const a=this.fog,u=a.get();Object.keys(t).length===0&&a.set(t);for(const p in t)if(!Z(t[p],u[p])){a.set(t),this.stylesheet.fog=t;const f=this._setTransitionParameters({duration:0});a.updateTransitions(f);break}}else this._createFog(t);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:o.exported.now(),transition:o.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(u=>this.isLayerDraped(this._layers[u])),a=this._order.filter(u=>!this.isLayerDraped(this._layers[u]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...a)}_createTerrain(t,a){const u=this.terrain=new zt(t,a);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const p=this._setTransitionParameters({duration:0});u.updateTransitions(p)}_force3DLayerUpdate(){for(const t in this._layers){const a=this._layers[t];a.type==="fill-extrusion"&&this._updateLayer(a)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const a=this._layers[t];a.type==="symbol"&&this._updateLayer(a)}}_validate(t,a,u,p,f={}){return(!f||f.validate!==!1)&&Ea(this,t.call(o.validateStyle,o.extend({key:a,style:this.serialize(),value:u,styleSpec:o.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const a=this._getSourceCaches(t);for(const u of a)u.clearTiles()}_reloadSource(t){const a=this._getSourceCaches(t);for(const u of a)u.resume(),u.reload()}_updateSources(t){for(const a in this._sourceCaches)this._sourceCaches[a].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const a=this._sourceCaches[t];a.resume(),a.reload()}}_updatePlacement(t,a,u,p,f=!1){let y=!1,v=!1;const w={};for(const A of this._order){const C=this._layers[A];if(C.type!=="symbol")continue;if(!w[C.source]){const O=this._getLayerSourceCache(C);if(!O)continue;w[C.source]=O.getRenderableIds(!0).map(U=>O.getTileByID(U)).sort((U,j)=>j.tileID.overscaledZ-U.tileID.overscaledZ||(U.tileID.isLessThan(j.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(C,w[C.source],t.center.lng,t.projection);y=y||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),f=f||this._layerOrderChanged||u===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(f||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),t.zoom))&&(this.pauseablePlacement=new M1(t,this._order,f,a,u,p,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,w),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),v=!0),y&&this.pauseablePlacement.placement.setStale()),v||y)for(const A of this._order){const C=this._layers[A];C.type==="symbol"&&this.placement.updateLayerOpacities(C,w[C.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a,u){this.imageManager.getImages(a.icons,u),this._updateTilesForChangedImages();const p=f=>{f&&f.setDependencies(a.tileID.key,a.type,a.icons)};p(this._otherSourceCaches[a.source]),p(this._symbolSourceCaches[a.source])}getGlyphs(t,a,u){this.glyphManager.getGlyphs(a.stacks,u)}getResource(t,a,u){return o.makeRequest(a,u)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const a=[];return this._otherSourceCaches[t]&&a.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&a.push(this._symbolSourceCaches[t]),a}_isSourceCacheLoaded(t){const a=this._getSourceCaches(t);return a.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):a.every(u=>u.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}rn.getSourceType=function(l){return pe[l]},rn.setSourceType=function(l,t){pe[l]=t},rn.registerForPluginStateChange=o.registerForPluginStateChange;var P1=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,D1="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Aa={},Ln={};Aa=ii("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),Ln=ii(`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const vs=ii(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),No=P1,Go=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var bs={background:ii(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ii(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:ii(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ii("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ii(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ii(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ii("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ii("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ii("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:ii(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:ii(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ii(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ii(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ii(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:ii(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:ii(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ii(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ii(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:ii(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:ii(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:ii(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:ii(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:ii(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:ii(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:ii(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ii(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,D1),skyboxGradient:ii(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,D1),skyboxCapture:ii(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ii(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
vec4 color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector.xyz*height;vec4 globe=u_globe_matrix*vec4(globe_pos,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ii(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);
#ifdef PROJECTION_GLOBE_VIEW
float globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
float horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function ii(l,t,a){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,f=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y=l.match(p),v=t.match(p),w=P1.match(p);let A=v?v.concat(y):y;a||(Aa.staticUniforms&&(A=Aa.staticUniforms.concat(A)),Ln.staticUniforms&&(A=Ln.staticUniforms.concat(A))),A&&(A=A.concat(w));const C={};return{fragmentSource:l=l.replace(u,(P,O,U,j,G)=>(C[G]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${G}
varying ${U} ${j} ${G};
#else
uniform ${U} ${j} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${U} ${j} ${G} = u_${G};
#endif
`)),vertexSource:t=t.replace(u,(P,O,U,j,G)=>{const Q=j==="float"?"vec2":"vec4",$=G.match(/color/)?"color":Q;return C[G]?O==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${U} ${Q} a_${G};
varying ${U} ${j} ${G};
#else
uniform ${U} ${j} u_${G};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${U} ${j} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${$}(a_${G}, u_${G}_t);
#else
    ${U} ${j} ${G} = u_${G};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${U} ${Q} a_${G};
#else
uniform ${U} ${j} u_${G};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${U} ${j} ${G} = a_${G};
#else
    ${U} ${j} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${U} ${j} ${G} = unpack_mix_${$}(a_${G}, u_${G}_t);
#else
    ${U} ${j} ${G} = u_${G};
#endif
`}),staticAttributes:f,staticUniforms:A}}class tc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,u,p,f,y,v,w,A){this.context=t;let C=this.boundPaintVertexBuffers.length!==p.length;for(let P=0;!C&&P<p.length;P++)this.boundPaintVertexBuffers[P]!==p[P]&&(C=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===u&&!C&&this.boundIndexBuffer===f&&this.boundVertexOffset===y&&this.boundDynamicVertexBuffer===v&&this.boundDynamicVertexBuffer2===w&&this.boundDynamicVertexBuffer3===A?(t.bindVertexArrayOES.set(this.vao),v&&v.bind(),f&&f.dynamicDraw&&f.bind(),w&&w.bind(),A&&A.bind()):this.freshBind(a,u,p,f,y,v,w,A)}freshBind(t,a,u,p,f,y,v,w){let A;const C=t.numAttributes,P=this.context,O=P.gl;if(P.extVertexArrayObject)this.vao&&this.destroy(),this.vao=P.extVertexArrayObject.createVertexArrayOES(),P.bindVertexArrayOES.set(this.vao),A=0,this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=p,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=v,this.boundDynamicVertexBuffer3=w;else{A=P.currentNumAttributes||0;for(let U=C;U<A;U++)O.disableVertexAttribArray(U)}a.enableAttributes(O,t);for(const U of u)U.enableAttributes(O,t);y&&y.enableAttributes(O,t),v&&v.enableAttributes(O,t),w&&w.enableAttributes(O,t),a.bind(),a.setVertexAttribPointers(O,t,f);for(const U of u)U.bind(),U.setVertexAttribPointers(O,t,f);y&&(y.bind(),y.setVertexAttribPointers(O,t,f)),p&&p.bind(),v&&(v.bind(),v.setVertexAttribPointers(O,t,f)),w&&(w.bind(),w.setVertexAttribPointers(O,t,f)),P.currentNumAttributes=C}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function L1(l,t){const a=Math.pow(2,t.canonical.z),u=t.canonical.y;return[new o.MercatorCoordinate(0,u/a).toLngLat().lat,new o.MercatorCoordinate(0,(u+1)/a).toLngLat().lat]}function ic(l,t,a,u,p,f,y){const v=l.context,w=v.gl,A=a.fbo;if(!A)return;l.prepareDrawTile();const C=l.useProgram("hillshade");v.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,A.colorAttachment.get());const P=((G,Q,$,J)=>{const V=$.paint.get("hillshade-shadow-color"),ne=$.paint.get("hillshade-highlight-color"),Y=$.paint.get("hillshade-accent-color");let ee=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(ee-=G.transform.angle);const ce=!G.options.moving;return{u_matrix:J||G.transform.calculateProjMatrix(Q.tileID.toUnwrapped(),ce),u_image:0,u_latrange:L1(0,Q.tileID),u_light:[$.paint.get("hillshade-exaggeration"),ee],u_shadow:V,u_highlight:ne,u_accent:Y}})(l,a,u,l.terrain?t.projMatrix:null);l.prepareDrawProgram(v,C,t.toUnwrapped());const{tileBoundsBuffer:O,tileBoundsIndexBuffer:U,tileBoundsSegments:j}=l.getTileBoundsBuffers(a);C.draw(v,w.TRIANGLES,p,f,y,o.CullFaceMode.disabled,P,u.id,O,U,j)}function ws(l,t,a){if(!t.needsDEMTextureUpload)return;const u=l.context,p=u.gl;u.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||l.getTileTexture(a.stride);const f=a.getPixels();t.demTexture?t.demTexture.update(f,{premultiply:!1}):t.demTexture=new o.Texture(u,f,p.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function Ts(l,t,a,u,p,f){const y=l.context,v=y.gl;if(!t.dem)return;const w=t.dem;if(y.activeTexture.set(v.TEXTURE1),ws(l,t,w),!t.demTexture)return;t.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const A=w.dim;y.activeTexture.set(v.TEXTURE0);let C=t.fbo;if(!C){const j=new o.Texture(y,{width:A,height:A,data:null},v.RGBA);j.bind(v.LINEAR,v.CLAMP_TO_EDGE),C=t.fbo=y.createFramebuffer(A,A,!0),C.colorAttachment.set(j.texture)}y.bindFramebuffer.set(C.framebuffer),y.viewport.set([0,0,A,A]);const{tileBoundsBuffer:P,tileBoundsIndexBuffer:O,tileBoundsSegments:U}=l.getMercatorTileBoundsBuffers();l.useProgram("hillshadePrepare").draw(y,v.TRIANGLES,u,p,f,o.CullFaceMode.disabled,((j,G)=>{const Q=G.stride,$=o.create();return o.ortho($,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate($,$,[0,-o.EXTENT,0]),{u_matrix:$,u_image:1,u_dimension:[Q,Q],u_zoom:j.overscaledZ,u_unpack:G.unpackVector}})(t.tileID,w),a.id,P,O,U),t.needsHillshadePrepare=!1}const Is=(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image0:new o.Uniform1i(l,t.u_image0),u_skirt_height:new o.Uniform1f(l,t.u_skirt_height)}),Ss=(l,t)=>({u_matrix:l,u_image0:0,u_skirt_height:t}),Yt=(l,t,a,u,p,f,y,v,w,A,C,P,O,U)=>({u_proj_matrix:Float32Array.from(l),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(u),u_merc_matrix:a,u_zoom_transition:p,u_merc_center:f,u_image0:0,u_frustum_tl:y,u_frustum_tr:v,u_frustum_br:w,u_frustum_bl:A,u_globe_pos:C,u_globe_radius:P,u_viewport:O,u_grid_matrix:U?Float32Array.from(U):new Float32Array(9)});function ka(l,t){return l!=null&&t!=null&&!(!l.hasData()||!t.hasData())&&l.demTexture!=null&&t.demTexture!=null&&l.tileID.key!==t.tileID.key}const ho=new class{constructor(){this.operations={}}newMorphing(l,t,a,u,p){if(l in this.operations){const f=this.operations[l];f.to.tileID.key!==a.tileID.key&&(f.queued=a)}else this.operations[l]={startTime:u,phase:0,duration:p,from:t,to:a,queued:null}}getMorphValuesForProxy(l){if(!(l in this.operations))return null;const t=this.operations[l];return{from:t.from,to:t.to,phase:t.phase}}update(l){for(const t in this.operations){const a=this.operations[t];for(a.phase=(l-a.startTime)/a.duration;a.phase>=1||!this._validOp(a);)if(!this._nextOp(a,l)){delete this.operations[t];break}}}_nextOp(l,t){return!!l.queued&&(l.from=l.to,l.to=l.queued,l.queued=null,l.phase=0,l.startTime=t,!0)}_validOp(l){return l.from.hasData()&&l.to.hasData()}},Ma={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function rc(l,t){const a=1<<l.z;return!t&&(l.x===0||l.x===a-1)||l.y===0||l.y===a-1}const Ca=l=>({u_matrix:l});function R1(l,t,a,u,p){if(p>0){const f=o.exported.now(),y=(f-l.timeAdded)/p,v=t?(f-t.timeAdded)/p:-1,w=a.getSource(),A=u.coveringZoomLevel({tileSize:w.tileSize,roundZoom:w.roundZoom}),C=!t||Math.abs(t.tileID.overscaledZ-A)>Math.abs(l.tileID.overscaledZ-A),P=C&&l.refreshedUponExpiration?1:o.clamp(C?y:1-v,0,1);return l.refreshedUponExpiration&&y>=1&&(l.refreshedUponExpiration=!1),t?{opacity:1,mix:1-P}:{opacity:P,mix:0}}return{opacity:1,mix:0}}class c3 extends o.SourceCache{constructor(t){const a={type:"raster-dem",maxzoom:t.transform.maxZoom},u=new xt(ti(),null),p=ve("mock-dem",a,u,t.style);super("mock-dem",p,!1),p.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,a){t.state="loaded",a(null)}}class u3 extends o.SourceCache{constructor(t){const a=ve("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new xt(ti(),null),t.style);super("proxy",a,!1),a.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,a,u){if(t.freezeTileCoverage)return;this.transform=t;const p=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((f,y)=>{if(f[y.key]="",!this._tiles[y.key]){const v=new o.Tile(y,this._source.tileSize*y.overscaleFactor(),t.tileZoom);v.state="loaded",this._tiles[y.key]=v}return f},{});for(const f in this._tiles)f in p||(this.freeFBO(f),this._tiles[f].unloadVectorData(),delete this._tiles[f])}freeFBO(t){const a=this.proxyCachedFBO[t];if(a!==void 0){const u=Object.values(a);this.renderCachePool.push(...u),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Es extends o.OverscaledTileID{constructor(t,a,u){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=a,this.projMatrix=u}}class B1 extends o.Elevation{constructor(t,a){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[u,p,f]=function(w){const A=new o.StructArrayLayout4i8,C=new o.StructArrayLayout3ui6,P=131;A.reserve(17161),C.reserve(33800);const O=o.EXTENT/128,U=o.EXTENT+O/2,j=U+O;for(let Q=-O;Q<j;Q+=O)for(let $=-O;$<j;$+=O){const J=$<0||$>U||Q<0||Q>U?24575:0,V=o.clamp(Math.round($),0,o.EXTENT),ne=o.clamp(Math.round(Q),0,o.EXTENT);A.emplaceBack(V+J,ne,V,ne)}const G=(Q,$)=>{const J=$*P+Q;C.emplaceBack(J+1,J,J+P),C.emplaceBack(J+P,J+P+1,J+1)};for(let Q=1;Q<129;Q++)for(let $=1;$<129;$++)G($,Q);return[0,129].forEach(Q=>{for(let $=0;$<130;$++)G($,Q),G(Q,$)}),[A,C,32768]}(),y=t.context;this.gridBuffer=y.createVertexBuffer(u,o.boundsAttributes.members),this.gridIndexBuffer=y.createIndexBuffer(p),this.gridSegments=o.SegmentVector.simpleSegment(0,0,u.length,p.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,u.length,f),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new u3(a.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,0,o.EXTENT,0,o.EXTENT,0,1);const v=y.gl;this._overlapStencilMode=new o.StencilMode({func:v.GEQUAL,mask:255},0,255,v.KEEP,v.KEEP,v.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=a,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new c3(a.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(t,a,u){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const p=t.terrain.properties;this.sourceCache=t.terrain.drapeRenderMode===0?this._mockSourceCache:t._getSourceCache(p.get("source")),this._exaggeration=p.get("exaggeration");const f=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const y=this.getScaledDemTileSize();this.sourceCache.update(a,y,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,f(),this._initializing=!0),f(),a.updateElevation(!u),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(a),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||t.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const a=this.proxySourceCache,u=this.painter.transform;this._initializing&&(this._initializing=u._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(u.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const p=this.proxyCoords=a.getIds().map(w=>{const A=a.getTileByID(w).tileID;return A.projMatrix=u.calculateProjMatrix(A.toUnwrapped()),A});(function(w,A){const C=A.transform.pointCoordinate(A.transform.getCameraPoint()),P=new o.pointGeometry(C.x,C.y);w.sort((O,U)=>{if(U.overscaledZ-O.overscaledZ)return U.overscaledZ-O.overscaledZ;const j=new o.pointGeometry(O.canonical.x+(1<<O.canonical.z)*O.wrap,O.canonical.y),G=new o.pointGeometry(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),Q=P.mult(1<<O.canonical.z);return Q.x-=.5,Q.y-=.5,Q.distSqr(j)-Q.distSqr(G)})})(p,this.painter),this._previousZoom=u.zoom;const f=this.proxyToSource||{};this.proxyToSource={},p.forEach(w=>{this.proxyToSource[w.key]={}}),this.terrainTileForTile={};const y=this._style._sourceCaches;for(const w in y){const A=y[w];if(!A.used||(A!==this.sourceCache&&this.resetTileLookupCache(A.id),this._setupProxiedCoordsForOrtho(A,t[w],f),A.usedForTerrain))continue;const C=t[w];A.getSource().reparseOverscaled&&this._assignTerrainTiles(C)}this.proxiedCoords[a.id]=p.map(w=>new Es(w,w.key,this.orthoMatrix)),this._assignTerrainTiles(p),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(f),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const v={};this._visibleDemTiles=[];for(const w of this.proxyCoords){const A=this.terrainTileForTile[w.key];if(!A)continue;const C=A.tileID.key;C in v||(this._visibleDemTiles.push(A),v[C]=C)}}_assignTerrainTiles(t){this._initializing||t.forEach(a=>{if(this.terrainTileForTile[a.key])return;const u=this._findTileCoveringTileID(a,this.sourceCache);u&&(this.terrainTileForTile[a.key]=u)})}_prepareDEMTextures(){const t=this.painter.context,a=t.gl;for(const u in this.terrainTileForTile){const p=this.terrainTileForTile[u],f=p.dem;!f||p.demTexture&&!p.needsDEMTextureUpload||(t.activeTexture.set(a.TEXTURE1),ws(this.painter,p,f))}}_prepareDemTileUniforms(t,a,u,p){if(!a||a.demTexture==null)return!1;const f=t.tileID.canonical,y=Math.pow(2,a.tileID.canonical.z-f.z),v=p||"";return u[`u_dem_tl${v}`]=[f.x*y%1,f.y*y%1],u[`u_dem_scale${v}`]=y,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,a=t.gl;if(!this._emptyDepthBufferTexture){const u=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(t,u,a.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const a=this._visibleDemTiles.reduce((u,p)=>{if(!p.dem)return u;const f=p.dem.tree.minimums[0];return f>0&&t++,u+f},0);return t?a/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,a=t.gl;t.activeTexture.set(a.TEXTURE2);const u=this._getLoadedAreaMinimum(),p=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(u,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let f=this._emptyDEMTexture;return f?f.update(p,{premultiply:!1}):f=this._emptyDEMTexture=new o.Texture(t,p,a.RGBA,{premultiply:!1}),f}setupElevationDraw(t,a,u){const p=this.painter.context,f=p.gl,y=(v=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(v),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var v;y.u_dem_size=this.sourceCache.getSource().tileSize,y.u_exaggeration=this.exaggeration();const w=this.painter.transform,A=w.projection,C=t.tileID.canonical;y.u_tile_tl_up=A.upVector(C,0,0),y.u_tile_tr_up=A.upVector(C,o.EXTENT,0),y.u_tile_br_up=A.upVector(C,o.EXTENT,o.EXTENT),y.u_tile_bl_up=A.upVector(C,0,o.EXTENT),y.u_tile_up_scale=u&&u.useDenormalizedUpVectorScale?o.GLOBE_METERS_TO_ECEF:A.upVectorScale(C,w.center.lat,w.worldSize).metersToTile;let P=null,O=null,U=1;if(u&&u.morphing&&this._useVertexMorphing){const j=u.morphing.srcDemTile,G=u.morphing.dstDemTile;U=u.morphing.phase,j&&G&&(this._prepareDemTileUniforms(t,j,y,"_prev")&&(O=j),this._prepareDemTileUniforms(t,G,y)&&(P=G))}if(O&&P?(p.activeTexture.set(f.TEXTURE2),P.demTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE,f.NEAREST),p.activeTexture.set(f.TEXTURE4),O.demTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE,f.NEAREST),y.u_dem_lerp=U):(P=this.terrainTileForTile[t.tileID.key],p.activeTexture.set(f.TEXTURE2),(this._prepareDemTileUniforms(t,P,y)?P.demTexture:this.emptyDEMTexture).bind(f.NEAREST,f.CLAMP_TO_EDGE)),p.activeTexture.set(f.TEXTURE3),u&&u.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE),this._depthFBO&&(y.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE),y.u_depth_size_inv=[1,1]),u&&u.useMeterToDem&&P){const j=(1<<P.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;y.u_meter_to_dem=j}u&&u.labelPlaneMatrixInv&&(y.u_label_plane_matrix_inv=u.labelPlaneMatrixInv),a.setTerrainUniformValues(p,y)}renderToBackBuffer(t){const a=this.painter,u=this.painter.context;t.length!==0&&(u.bindFramebuffer.set(null),u.viewport.set([0,0,a.width,a.height]),a.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(p,f,y,v,w){if(p.transform.projection.name==="globe")(function(A,C,P,O,U){const j=A.context,G=j.gl;let Q,$;const J=A.options.showTerrainWireframe?2:0,V=A.transform,ne=o.globeUseCustomAntiAliasing(A,j,V),Y=(re,ye)=>{if($===re)return;const Le=[Ma[re],"PROJECTION_GLOBE_VIEW"];ne&&Le.push("CUSTOM_ANTIALIASING"),ye&&Le.push(Ma[J]),Q=A.useProgram("globeRaster",null,Le),$=re},ee=A.colorModeForRenderPass(),ce=new o.DepthMode(G.LEQUAL,o.DepthMode.ReadWrite,A.depthRangeFor3D);ho.update(U);const Ie=o.calculateGlobeMercatorMatrix(V),Ae=[o.mercatorXfromLng(V.center.lng),o.mercatorYfromLat(V.center.lat)],we=A.globeSharedBuffers,Ze=[V.width*o.exported.devicePixelRatio,V.height*o.exported.devicePixelRatio];if((J?[!1,!0]:[!1]).forEach(re=>{$=-1;const ye=re?G.LINES:G.TRIANGLES;for(const Le of O){const tt=P.getTile(Le),De=o.StencilMode.disabled,ft=C.prevTerrainTileForTile[Le.key],Ke=C.terrainTileForTile[Le.key];ka(ft,Ke)&&ho.newMorphing(Le.key,ft,Ke,U,250),j.activeTexture.set(G.TEXTURE0),tt.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const it=ho.getMorphValuesForProxy(Le.key),rt=it?1:0,et={useDenormalizedUpVectorScale:!0};it&&o.extend$1(et,{morphing:{srcDemTile:it.from,dstDemTile:it.to,phase:o.easeCubicInOut(it.phase)}});const ut=Float32Array.from(V.globeMatrix),Ct=o.globeTileLatLngCorners(Le.canonical),Dt=o.getLatitudinalLod((Ct[0][0]+Ct[1][0])/2),vt=o.getGridMatrix(Le.canonical,Ct,Dt),Pt=o.globeNormalizeECEF(o.globeTileBounds(Le.canonical)),ci=Yt(V.projMatrix,ut,Ie,Pt,o.globeToMercatorTransition(V.zoom),Ae,V.frustumCorners.TL,V.frustumCorners.TR,V.frustumCorners.BR,V.frustumCorners.BL,V.globeCenterInViewSpace,V.globeRadius,Ze,vt);if(Y(rt,re),C.setupElevationDraw(tt,Q,et),A.prepareDrawProgram(j,Q,Le.toUnwrapped()),we){const[_i,Ti,pi]=re?we.getWirefameBuffers(A.context,Dt):we.getGridBuffers(Dt);Q.draw(j,ye,ce,De,ee,o.CullFaceMode.backCCW,ci,"globe_raster",_i,Ti,pi)}}}),we){const re=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ne&&re.push("CUSTOM_ANTIALIASING"),Q=A.useProgram("globeRaster",null,re);for(const ye of O){const{x:Le,y:tt,z:De}=ye.canonical,ft=tt===0,Ke=tt===(1<<De)-1,[it,rt,et,ut]=we.getPoleBuffers(De);if(ut&&(ft||Ke)){const Ct=P.getTile(ye);j.activeTexture.set(G.TEXTURE0),Ct.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);let Dt=o.globePoleMatrixForTile(De,Le,V);const vt=o.globeNormalizeECEF(o.globeTileBounds(ye.canonical)),Pt=(ci,_i)=>ci.draw(j,G.TRIANGLES,ce,o.StencilMode.disabled,ee,o.CullFaceMode.disabled,Yt(V.projMatrix,Dt,Dt,vt,0,Ae,V.frustumCorners.TL,V.frustumCorners.TR,V.frustumCorners.BR,V.frustumCorners.BL,V.globeCenterInViewSpace,V.globeRadius,Ze),"globe_pole_raster",_i,et,ut);C.setupElevationDraw(Ct,Q,{}),A.prepareDrawProgram(j,Q,ye.toUnwrapped()),ft&&Pt(Q,it),Ke&&(Dt=o.scale(o.create(),Dt,[1,-1,1]),Pt(Q,rt))}}}})(p,f,y,v,w);else{const A=p.context,C=A.gl;let P,O;const U=p.options.showTerrainWireframe?2:0,j=(V,ne)=>{if(O===V)return;const Y=[Ma[V]];ne&&Y.push(Ma[U]),P=p.useProgram("terrainRaster",null,Y),O=V},G=p.colorModeForRenderPass(),Q=new o.DepthMode(C.LEQUAL,o.DepthMode.ReadWrite,p.depthRangeFor3D);ho.update(w);const $=p.transform,J=6*Math.pow(1.5,22-$.zoom)*f.exaggeration();(U?[!1,!0]:[!1]).forEach(V=>{O=-1;const ne=V?C.LINES:C.TRIANGLES,[Y,ee]=V?f.getWirefameBuffer():[f.gridIndexBuffer,f.gridSegments];for(const ce of v){const Ie=y.getTile(ce),Ae=o.StencilMode.disabled,we=f.prevTerrainTileForTile[ce.key],Ze=f.terrainTileForTile[ce.key];ka(we,Ze)&&ho.newMorphing(ce.key,we,Ze,w,250),A.activeTexture.set(C.TEXTURE0),Ie.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST);const re=ho.getMorphValuesForProxy(ce.key),ye=re?1:0;let Le;re&&(Le={morphing:{srcDemTile:re.from,dstDemTile:re.to,phase:o.easeCubicInOut(re.phase)}});const tt=Ss(ce.projMatrix,rc(ce.canonical,$.renderWorldCopies)?J/10:J);j(ye,V),f.setupElevationDraw(Ie,P,Le),p.prepareDrawProgram(A,P,ce.toUnwrapped()),P.draw(A,ne,Q,Ae,G,o.CullFaceMode.backCCW,tt,"terrain_raster",f.gridBuffer,Y,ee)}})}}(a,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,a.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const a=this.painter,u=this.painter.context,p=this.proxySourceCache,f=this.proxiedCoords[p.id],y=this._drapedRenderBatches.shift(),v=[],w=a.style.order;let A=0;for(const C of f){const P=p.getTileByID(C.proxyTileKey),O=p.proxyCachedFBO[C.key]?p.proxyCachedFBO[C.key][t]:void 0,U=O!==void 0?p.renderCache[O]:this.pool[A++],j=O!==void 0;if(P.texture=U.tex,j&&!U.dirty){v.push(P.tileID);continue}let G;u.bindFramebuffer.set(U.fb.framebuffer),this.renderedToTile=!1,U.dirty&&(u.clear({color:o.Color.transparent,stencil:0}),U.dirty=!1);for(let Q=y.start;Q<=y.end;++Q){const $=a.style._layers[w[Q]];if($.isHidden(a.transform.zoom))continue;const J=a.style._getLayerSourceCache($),V=J?this.proxyToSource[C.key][J.id]:[C];if(!V)continue;const ne=V;u.viewport.set([0,0,U.fb.width,U.fb.height]),G!==(J?J.id:null)&&(this._setupStencil(U,V,$,J),G=J?J.id:null),a.renderLayer(a,J,$,ne)}this.renderedToTile?(U.dirty=!0,v.push(P.tileID)):j||--A,A===5&&(A=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,u.bindFramebuffer.set(null),u.viewport.set([0,0,a.width,a.height]),y.end+1}postRender(){}renderCacheEfficiency(t){const a=t.order.length;if(a===0)return{efficiency:100};let u,p=0,f=0,y=!1;for(let v=0;v<a;++v){const w=t._layers[t.order[v]];this._style.isLayerDraped(w)?(y&&++p,++f):y||(y=!0,u=w.id)}return f===0?{efficiency:100}:{efficiency:100*(1-p/f),firstUndrapedLayer:u}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(a=>a.dem).forEach(a=>{t=Math.min(t,a.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,a,u){if(!this._visibleDemTiles)return null;const p=this._visibleDemTiles.filter(f=>f.dem).map(f=>{const y=f.tileID,v=Math.pow(2,y.overscaledZ),{x:w,y:A}=y.canonical,C=w/v,P=(w+1)/v,O=A/v,U=(A+1)/v;return{minx:C,miny:O,maxx:P,maxy:U,t:f.dem.tree.raycastRoot(C,O,P,U,t,a,u),tile:f}});p.sort((f,y)=>(f.t!==null?f.t:Number.MAX_VALUE)-(y.t!==null?y.t:Number.MAX_VALUE));for(const f of p){if(f.t==null)return null;const y=f.tile.dem.tree.raycast(f.minx,f.miny,f.maxx,f.maxy,t,a,u);if(y!=null)return y}return null}_createFBO(){const t=this.painter.context,a=t.gl,u=this.drapeBufferSize;t.activeTexture.set(a.TEXTURE0);const p=new o.Texture(t,{width:u[0],height:u[1],data:null},a.RGBA);p.bind(a.LINEAR,a.CLAMP_TO_EDGE);const f=t.createFramebuffer(u[0],u[1],!1);return f.colorAttachment.set(p.texture),f.depthAttachment=new D(t,f.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,u[0],u[1]),this._stencilRef=0,f.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):f.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&a.texParameterf(a.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:f,tex:p,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const a=this._style._layers[t],u=a.isHidden(this.painter.transform.zoom),p=a.getCrossfadeParameters(),f=!!p&&p.t!==1,y=a.hasTransition();return a.type!=="custom"&&!u&&(f||y)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const a in this._style._sourceCaches)if(this._style._sourceCaches[a]._source instanceof ie){t=!0;break}if(t)for(let a=0;a<this._style.order.length;++a){const u=this._style._layers[this._style.order[a]],p=u.isHidden(this.painter.transform.zoom),f=this._style._getLayerSourceCache(u);if(u.type!=="raster"||p||!f)continue;const y=u.paint.get("raster-fade-duration");for(const v of this.proxyCoords){const w=this.proxyToSource[v.key][f.id];if(w)for(const A of w){const C=R1(f.getTile(A),f.findLoadedParent(A,0),f,this.painter.transform,y);(C.opacity!==1||C.mix!==0)&&this._clearRenderCacheForTile(f.id,A)}}}}_setupDrapedRenderBatches(){const t=this._style.order,a=t.length;if(a===0)return;const u=[];let p,f=0,y=this._style._layers[t[f]];for(;!this._style.isLayerDraped(y)&&y.isHidden(this.painter.transform.zoom)&&++f<a;)y=this._style._layers[t[f]];for(;f<a;++f){const v=this._style._layers[t[f]];v.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(v)?p===void 0&&(p=f):p!==void 0&&(u.push({start:p,end:f-1}),p=void 0))}p!==void 0&&u.push({start:p,end:f-1}),this._drapedRenderBatches=u}_setupRenderCache(t){const a=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,a.renderCache.length>a.renderCachePool.length){const y=Object.values(a.proxyCachedFBO);a.proxyCachedFBO={};for(let v=0;v<y.length;++v){const w=Object.values(y[v]);a.renderCachePool.push(...w)}}return}this._clearRasterFadeFromRenderCache();const u=this.proxyCoords,p=this._tilesDirty;for(let y=u.length-1;y>=0;y--){const v=u[y];if(a.getTileByID(v.key),a.proxyCachedFBO[v.key]!==void 0){const w=t[v.key],A=this.proxyToSource[v.key];let C=0;for(const P in A){const O=A[P],U=w[P];if(!U||U.length!==O.length||O.some((j,G)=>j!==U[G]||p[P]&&p[P].hasOwnProperty(j.key))){C=-1;break}++C}for(const P in a.proxyCachedFBO[v.key])a.renderCache[a.proxyCachedFBO[v.key][P]].dirty=C<0||C!==Object.values(w).length}}const f=[...this._drapedRenderBatches];f.sort((y,v)=>v.end-v.start-(y.end-y.start));for(const y of f)for(const v of u){if(a.proxyCachedFBO[v.key])continue;let w=a.renderCachePool.pop();w===void 0&&a.renderCache.length<50&&(w=a.renderCache.length,a.renderCache.push(this._createFBO())),w!==void 0&&(a.proxyCachedFBO[v.key]={},a.proxyCachedFBO[v.key][y.start]=w,a.renderCache[w].dirty=!0)}this._tilesDirty={}}_setupStencil(t,a,u,p){if(!p||!this._sourceTilesOverlap[p.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const f=this.painter.context,y=f.gl;if(a.length<=1)return void(this._overlapStencilType=!1);let v;if(u.isTileClipped())v=a.length,this._overlapStencilMode.test={func:y.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(a[0].overscaledZ>a[a.length-1].overscaledZ))return void(this._overlapStencilType=!1);v=1,this._overlapStencilMode.test={func:y.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+v>255&&(f.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=v,this._overlapStencilMode.ref=this._stencilRef,u.isTileClipped()&&this._renderTileClippingMasks(a,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(t,a){const u=this.painter,p=this.painter.context,f=p.gl;u._tileClippingMaskIDs={},p.setColorMode(o.ColorMode.disabled),p.setDepthMode(o.DepthMode.disabled);const y=u.useProgram("clippingMask");for(const v of t){const w=u._tileClippingMaskIDs[v.key]=--a;y.draw(p,f.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:f.ALWAYS,mask:0},w,255,f.KEEP,f.KEEP,f.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Ca(v.projMatrix),"$clipping",u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments)}}pointCoordinate(t){const a=this.painter.transform;if(t.x<0||t.x>a.width||t.y<0||t.y>a.height)return null;const u=[t.x,t.y,1,1];o.transformMat4$1(u,u,a.pixelMatrixInverse),o.scale$1(u,u,1/u[3]),u[0]/=a.worldSize,u[1]/=a.worldSize;const p=a._camera.position,f=o.mercatorZfromAltitude(1,a.center.lat),y=[p[0],p[1],p[2]/f,0],v=o.subtract([],u.slice(0,3),y);o.normalize(v,v);const w=this.raycast(y,v,this._exaggeration);return w!==null&&w?(o.scaleAndAdd(y,y,v,w),y[3]=y[2],y[2]*=f,y):null}drawDepth(){const t=this.painter,a=t.context,u=this.proxySourceCache,p=Math.ceil(t.width),f=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===p&&this._depthFBO.height===f||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const y=a.gl,v=a.createFramebuffer(p,f,!0);a.activeTexture.set(y.TEXTURE0);const w=new o.Texture(a,{width:p,height:f,data:null},y.RGBA);w.bind(y.NEAREST,y.CLAMP_TO_EDGE),v.colorAttachment.set(w.texture);const A=a.createRenderbuffer(a.gl.DEPTH_COMPONENT16,p,f);v.depthAttachment.set(A),this._depthFBO=v,this._depthTexture=w}a.bindFramebuffer.set(this._depthFBO.framebuffer),a.viewport.set([0,0,p,f]),function(y,v,w,A){if(y.transform.projection.name==="globe")return;const C=y.context,P=C.gl;C.clear({depth:1});const O=y.useProgram("terrainDepth"),U=new o.DepthMode(P.LESS,o.DepthMode.ReadWrite,y.depthRangeFor3D);for(const j of A){const G=w.getTile(j),Q=Ss(j.projMatrix,0);v.setupElevationDraw(G,O),O.draw(C,P.TRIANGLES,U,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,Q,"terrain_depth",v.gridBuffer,v.gridIndexBuffer,v.gridNoSkirtSegments)}}(t,this,u,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,a,u){if(t.getSource()instanceof _e)return this._setupProxiedCoordsForImageSource(t,a,u);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const p=this.proxiedCoords[t.id]=[],f=this.proxyCoords;for(let v=0;v<f.length;v++){const w=f[v],A=this._findTileCoveringTileID(w,t);if(A){const C=this._createProxiedId(w,A,u[w.key]&&u[w.key][t.id]);p.push(C),this.proxyToSource[w.key][t.id]=[C]}}let y=!1;for(let v=0;v<a.length;v++){const w=t.getTile(a[v]);if(!w||!w.hasData())continue;const A=this._findTileCoveringTileID(w.tileID,this.proxySourceCache);if(A&&A.tileID.canonical.z!==w.tileID.canonical.z){const C=this.proxyToSource[A.tileID.key][t.id],P=this._createProxiedId(A.tileID,w,u[A.tileID.key]&&u[A.tileID.key][t.id]);C?C.splice(C.length-1,0,P):this.proxyToSource[A.tileID.key][t.id]=[P],p.push(P),y=!0}}this._sourceTilesOverlap[t.id]=y}_setupProxiedCoordsForImageSource(t,a,u){if(!t.getSource().loaded())return;const p=this.proxiedCoords[t.id]=[],f=this.proxyCoords,y=t.getSource(),v=new o.pointGeometry(y.tileID.x,y.tileID.y)._div(1<<y.tileID.z),w=y.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((C,P)=>(C.min.x=Math.min(C.min.x,P.x-v.x),C.min.y=Math.min(C.min.y,P.y-v.y),C.max.x=Math.max(C.max.x,P.x-v.x),C.max.y=Math.max(C.max.y,P.y-v.y),C),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),A=(C,P)=>{const O=C.wrap+C.canonical.x/(1<<C.canonical.z),U=C.canonical.y/(1<<C.canonical.z),j=o.EXTENT/(1<<C.canonical.z),G=P.wrap+P.canonical.x/(1<<P.canonical.z),Q=P.canonical.y/(1<<P.canonical.z);return O+j<G+w.min.x||O>G+w.max.x||U+j<Q+w.min.y||U>Q+w.max.y};for(let C=0;C<f.length;C++){const P=f[C];for(let O=0;O<a.length;O++){const U=t.getTile(a[O]);if(!U||!U.hasData()||A(P,U.tileID))continue;const j=this._createProxiedId(P,U,u[P.key]&&u[P.key][t.id]),G=this.proxyToSource[P.key][t.id];G?G.push(j):this.proxyToSource[P.key][t.id]=[j],p.push(j)}}}_createProxiedId(t,a,u){let p=this.orthoMatrix;if(u){const f=u.find(y=>y.key===a.tileID.key);if(f)return f}if(a.tileID.key!==t.key){const f=t.canonical.z-a.tileID.canonical.z;let y,v,w;p=o.create();const A=a.tileID.wrap-t.wrap<<t.overscaledZ;f>0?(y=o.EXTENT>>f,v=y*((a.tileID.canonical.x<<f)-t.canonical.x+A),w=y*((a.tileID.canonical.y<<f)-t.canonical.y)):(y=o.EXTENT<<-f,v=o.EXTENT*(a.tileID.canonical.x-(t.canonical.x+A<<-f)),w=o.EXTENT*(a.tileID.canonical.y-(t.canonical.y<<-f))),o.ortho(p,0,y,0,y,0,1),o.translate(p,p,[v,w,0])}return new Es(a.tileID,t.key,p)}_findTileCoveringTileID(t,a){let u=a.getTile(t);if(u&&u.hasData())return u;const p=this._findCoveringTileCache[a.id],f=p[t.key];if(u=f?a.getTileByID(f):null,u&&u.hasData()||f===null)return u;let y=u?u.tileID:t,v=y.overscaledZ;const w=a.getSource().minzoom,A=[];if(!f){const P=a.getSource().maxzoom;if(t.canonical.z>=P){const O=t.canonical.z-P;a.getSource().reparseOverscaled?(v=Math.max(t.canonical.z+2,a.transform.tileZoom),y=new o.OverscaledTileID(v,t.wrap,P,t.canonical.x>>O,t.canonical.y>>O)):O!==0&&(v=P,y=new o.OverscaledTileID(v,t.wrap,P,t.canonical.x>>O,t.canonical.y>>O))}y.key!==t.key&&(A.push(y.key),u=a.getTile(y))}const C=P=>{A.forEach(O=>{p[O]=P}),A.length=0};for(v-=1;v>=w&&(!u||!u.hasData());v--){u&&C(u.tileID.key);const P=y.calculateScaledKey(v);if(u=a.getTileByID(P),u&&u.hasData())break;const O=p[P];if(O===null)break;O===void 0?A.push(P):u=a.getTileByID(O)}return C(u?u.tileID.key:null),u&&u.hasData()?u:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,a){let u=this._tilesDirty[t];u||(u=this._tilesDirty[t]={}),u[a.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(a){let u=0;const p=new o.StructArrayLayout2ui4,f=131;for(let y=1;y<129;y++){for(let v=1;v<129;v++)u=y*f+v,p.emplaceBack(u,u+1),p.emplaceBack(u,u+f),p.emplaceBack(u+1,u+f),y===128&&p.emplaceBack(u+f,u+f+1);p.emplaceBack(u+1,u+1+f)}return p}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function As(l){const t=[];for(let a=0;a<l.length;a++){if(l[a]===null)continue;const u=l[a].split(" ");t.push(u.pop())}return t}class ks{static cacheKey(t,a,u){let p=`${t}${u?u.cacheKey:""}`;for(const f of a)p+=`/${f}`;return p}constructor(t,a,u,p,f,y){const v=t.gl;this.program=v.createProgram();const w=As(u.staticAttributes),A=p?p.getBinderAttributes():[],C=w.concat(A),P=u.staticUniforms?As(u.staticUniforms):[],O=p?p.getBinderUniforms():[],U=P.concat(O),j=[];for(const Y of U)j.indexOf(Y)<0&&j.push(Y);let G=p?p.defines():[];G=G.concat(y.map(Y=>`#define ${Y}`));const Q=G.concat(t.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(Go):Go,Go,No,vs.fragmentSource,Ln.fragmentSource,u.fragmentSource).join(`
`),$=G.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,No,vs.vertexSource,Ln.vertexSource,Aa.vertexSource,u.vertexSource).join(`
`),J=v.createShader(v.FRAGMENT_SHADER);if(v.isContextLost())return void(this.failedToCreate=!0);v.shaderSource(J,Q),v.compileShader(J),v.attachShader(this.program,J);const V=v.createShader(v.VERTEX_SHADER);if(v.isContextLost())return void(this.failedToCreate=!0);v.shaderSource(V,$),v.compileShader(V),v.attachShader(this.program,V),this.attributes={};const ne={};this.numAttributes=C.length;for(let Y=0;Y<this.numAttributes;Y++)C[Y]&&(v.bindAttribLocation(this.program,Y,C[Y]),this.attributes[C[Y]]=Y);v.linkProgram(this.program),v.deleteShader(V),v.deleteShader(J);for(let Y=0;Y<j.length;Y++){const ee=j[Y];if(ee&&!ne[ee]){const ce=v.getUniformLocation(this.program,ee);ce&&(ne[ee]=ce)}}this.fixedUniforms=f(t,ne),this.binderUniforms=p?p.getUniforms(t,ne):[],y.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((Y,ee)=>({u_dem:new o.Uniform1i(Y,ee.u_dem),u_dem_prev:new o.Uniform1i(Y,ee.u_dem_prev),u_dem_unpack:new o.Uniform4f(Y,ee.u_dem_unpack),u_dem_tl:new o.Uniform2f(Y,ee.u_dem_tl),u_dem_scale:new o.Uniform1f(Y,ee.u_dem_scale),u_dem_tl_prev:new o.Uniform2f(Y,ee.u_dem_tl_prev),u_dem_scale_prev:new o.Uniform1f(Y,ee.u_dem_scale_prev),u_dem_size:new o.Uniform1f(Y,ee.u_dem_size),u_dem_lerp:new o.Uniform1f(Y,ee.u_dem_lerp),u_exaggeration:new o.Uniform1f(Y,ee.u_exaggeration),u_depth:new o.Uniform1i(Y,ee.u_depth),u_depth_size_inv:new o.Uniform2f(Y,ee.u_depth_size_inv),u_meter_to_dem:new o.Uniform1f(Y,ee.u_meter_to_dem),u_label_plane_matrix_inv:new o.UniformMatrix4f(Y,ee.u_label_plane_matrix_inv),u_tile_tl_up:new o.Uniform3f(Y,ee.u_tile_tl_up),u_tile_tr_up:new o.Uniform3f(Y,ee.u_tile_tr_up),u_tile_br_up:new o.Uniform3f(Y,ee.u_tile_br_up),u_tile_bl_up:new o.Uniform3f(Y,ee.u_tile_bl_up),u_tile_up_scale:new o.Uniform1f(Y,ee.u_tile_up_scale)}))(t,ne)),y.indexOf("FOG")!==-1&&(this.fogUniforms=((Y,ee)=>({u_fog_matrix:new o.UniformMatrix4f(Y,ee.u_fog_matrix),u_fog_range:new o.Uniform2f(Y,ee.u_fog_range),u_fog_color:new o.Uniform4f(Y,ee.u_fog_color),u_fog_horizon_blend:new o.Uniform1f(Y,ee.u_fog_horizon_blend),u_fog_temporal_offset:new o.Uniform1f(Y,ee.u_fog_temporal_offset),u_frustum_tl:new o.Uniform3f(Y,ee.u_frustum_tl),u_frustum_tr:new o.Uniform3f(Y,ee.u_frustum_tr),u_frustum_br:new o.Uniform3f(Y,ee.u_frustum_br),u_frustum_bl:new o.Uniform3f(Y,ee.u_frustum_bl),u_globe_pos:new o.Uniform3f(Y,ee.u_globe_pos),u_globe_radius:new o.Uniform1f(Y,ee.u_globe_radius),u_globe_transition:new o.Uniform1f(Y,ee.u_globe_transition),u_is_globe:new o.Uniform1i(Y,ee.u_is_globe),u_viewport:new o.Uniform2f(Y,ee.u_viewport)}))(t,ne))}setTerrainUniformValues(t,a){if(!this.terrainUniforms)return;const u=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const p in a)u[p].set(a[p])}}setFogUniformValues(t,a){if(!this.fogUniforms)return;const u=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const p in a)u[p].location&&u[p].set(a[p])}}draw(t,a,u,p,f,y,v,w,A,C,P,O,U,j,G,Q,$){const J=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(u),t.setStencilMode(p),t.setColorMode(f),t.setCullFace(y);for(const ne of Object.keys(this.fixedUniforms))this.fixedUniforms[ne].set(v[ne]);j&&j.setUniforms(t,this.binderUniforms,O,{zoom:U});const V={[J.LINES]:2,[J.TRIANGLES]:3,[J.LINE_STRIP]:1}[a];for(const ne of P.get()){const Y=ne.vaos||(ne.vaos={});(Y[w]||(Y[w]=new tc)).bind(t,this,A,j?j.getPaintVertexBuffers():[],C,ne.vertexOffset,G,Q,$),J.drawElements(a,ne.primitiveLength*V,J.UNSIGNED_SHORT,ne.primitiveOffset*V*2)}}}function O1(l,t,a){const u=1/Ht(a,1,t.transform.tileZoom),p=Math.pow(2,a.tileID.overscaledZ),f=a.tileSize*Math.pow(2,t.transform.tileZoom)/p,y=f*(a.tileID.canonical.x+a.tileID.wrap*p),v=f*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[u,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[y>>16,v>>16],u_pixel_coord_lower:[65535&y,65535&v]}}const nc=o.create(),oc=(l,t,a,u,p,f,y,v,w)=>{const A=t.style.light,C=A.properties.get("position"),P=[C.x,C.y,C.z],O=o.create$1();A.properties.get("anchor")==="viewport"&&(o.fromRotation(O,-t.transform.angle),o.transformMat3(P,P,O));const U=A.properties.get("color"),j=t.transform,G={u_matrix:l,u_lightpos:P,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+a,u_opacity:u,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:nc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return j.projection.name==="globe"&&(G.u_tile_id=[p.canonical.x,p.canonical.y,1<<p.canonical.z],G.u_zoom_transition=y,G.u_inv_rot_matrix=w,G.u_merc_center=v,G.u_up_dir=j.projection.upVector(new o.CanonicalTileID(0,0,0),v[0]*o.EXTENT,v[1]*o.EXTENT),G.u_height_lift=f),G},za=(l,t,a,u,p,f,y,v,w,A,C)=>{const P=oc(l,t,a,u,p,v,w,A,C),O={u_height_factor:-Math.pow(2,p.overscaledZ)/y.tileSize/8};return o.extend(P,O1(f,t,y),O)},Uo=l=>({u_matrix:l}),F1=(l,t,a,u)=>o.extend(Uo(l),O1(a,t,u)),Ms=(l,t)=>({u_matrix:l,u_world:t}),N1=(l,t,a,u,p)=>o.extend(F1(l,t,a,u),{u_world:p}),hn=o.create(),G1=(l,t,a,u,p,f)=>{const y=l.transform,v=y.projection.name==="globe";let w;if(f.paint.get("circle-pitch-alignment")==="map")if(v){const C=o.globePixelsToTileUnits(y.zoom,t.canonical)*y._projectionScaler;w=Float32Array.from([C,0,0,C])}else w=y.calculatePixelsToTileUnitsMatrix(a);else w=new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]);const A={u_camera_to_center_distance:y.cameraToCenterDistance,u_matrix:l.translatePosMatrix(t.projMatrix,a,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:w,u_inv_rot_matrix:hn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(v){A.u_inv_rot_matrix=u,A.u_merc_center=p,A.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],A.u_zoom_transition=o.globeToMercatorTransition(y.zoom);const C=p[0]*o.EXTENT,P=p[1]*o.EXTENT;A.u_up_dir=y.projection.upVector(new o.CanonicalTileID(0,0,0),C,P)}return A},ac=l=>{const t=[];return l.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t},U1=(l,t,a,u)=>{const p=o.EXTENT/a.tileSize;return{u_matrix:l,u_camera_to_center_distance:t.getCameraToCenterDistance(u),u_extrude_scale:[t.pixelsToGLUnits[0]/p,t.pixelsToGLUnits[1]/p]}},V1=(l,t,a=1)=>({u_matrix:l,u_color:t,u_overlay:0,u_overlay_scale:a}),j1=o.create(),h3=(l,t,a,u,p,f,y)=>{const v=l.transform,w=v.projection.name==="globe",A=w?o.globePixelsToTileUnits(v.zoom,t.canonical)*v._projectionScaler:Ht(a,1,f),C={u_matrix:t.projMatrix,u_extrude_scale:A,u_intensity:y,u_inv_rot_matrix:j1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(w){C.u_inv_rot_matrix=u,C.u_merc_center=p,C.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],C.u_zoom_transition=o.globeToMercatorTransition(v.zoom);const P=p[0]*o.EXTENT,O=p[1]*o.EXTENT;C.u_up_dir=v.projection.upVector(new o.CanonicalTileID(0,0,0),P,O)}return C},$1=(l,t,a,u,p,f,y,v)=>{const w=l.transform,A=w.calculatePixelsToTileUnitsMatrix(t),C={u_matrix:sc(l,t,a,p),u_pixels_to_tile_units:A,u_device_pixel_ratio:y,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:v};if(Cs(a)){const P=Pa(t,l.transform);C.u_texsize=t.lineAtlasTexture.size,C.u_scale=[P,u.fromScale,u.toScale],C.u_mix=u.t}return C},p3=(l,t,a,u,p,f)=>{const y=l.transform,v=Pa(t,y);return{u_matrix:sc(l,t,a,p),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:y.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:f,u_image:0,u_scale:[v,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Pa(l,t){return 1/Ht(l,1,t.tileZoom)}function sc(l,t,a,u){return l.translatePosMatrix(u||t.tileID.projMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}function Cs(l){const t=l.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const d3=(l,t,a,u,p,f)=>{return{u_matrix:l,u_tl_parent:t,u_scale_parent:a,u_fade_t:u.mix,u_opacity:u.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(v=p.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(y=p.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Z1(p.paint.get("raster-hue-rotate")),u_perspective_transform:f};var y,v};function Z1(l){l*=Math.PI/180;const t=Math.sin(l),a=Math.cos(l);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const lc=o.create(),Da=(l,t,a,u,p,f,y,v,w,A,C,P,O,U,j,G)=>{const Q=p.transform,$={u_is_size_zoom_constant:+(l==="constant"||l==="source"),u_is_size_feature_constant:+(l==="constant"||l==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_rotate_symbol:+a,u_aspect_ratio:Q.width/Q.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:y,u_coord_matrix:v,u_is_text:+w,u_pitch_with_map:+u,u_texsize:A,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:lc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:lc,u_up_vector:[0,-1,0]};return G.name==="globe"&&($.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],$.u_zoom_transition=P,$.u_inv_rot_matrix=U,$.u_merc_center=O,$.u_camera_forward=Q._camera.forward(),$.u_ecef_origin=o.globeECEFOrigin(Q.globeMatrix,C.toUnwrapped()),$.u_tile_matrix=Float32Array.from(Q.globeMatrix),$.u_up_vector=j),$},cc=(l,t,a,u,p,f,y,v,w,A,C,P,O,U,j,G,Q)=>o.extend(Da(l,t,a,u,p,f,y,v,w,A,P,O,U,j,G,Q),{u_gamma_scale:u?p.transform.cameraToCenterDistance*Math.cos(p.terrain?0:p.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+C}),uc=(l,t,a,u,p,f,y,v,w,A,C,P,O,U,j,G)=>o.extend(cc(l,t,a,u,p,f,y,v,!0,w,!0,C,P,O,U,j,G),{u_texsize_icon:A,u_texture_icon:1}),hc=(l,t,a)=>({u_matrix:l,u_opacity:t,u_color:a}),Vo=(l,t,a,u,p,f)=>o.extend(function(y,v,w,A){const C=w.imageManager.getPattern(y.from.toString()),P=w.imageManager.getPattern(y.to.toString()),{width:O,height:U}=w.imageManager.getPixelSize(),j=Math.pow(2,A.tileID.overscaledZ),G=A.tileSize*Math.pow(2,w.transform.tileZoom)/j,Q=G*(A.tileID.canonical.x+A.tileID.wrap*j),$=G*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:C.tl,u_pattern_br_a:C.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[O,U],u_mix:v.t,u_pattern_size_a:C.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/Ht(A,1,w.transform.tileZoom),u_pixel_coord_upper:[Q>>16,$>>16],u_pixel_coord_lower:[65535&Q,65535&$]}}(u,f,a,p),{u_matrix:l,u_opacity:t}),f3={fillExtrusion:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_lightpos:new o.Uniform3f(l,t.u_lightpos),u_lightintensity:new o.Uniform1f(l,t.u_lightintensity),u_lightcolor:new o.Uniform3f(l,t.u_lightcolor),u_vertical_gradient:new o.Uniform1f(l,t.u_vertical_gradient),u_opacity:new o.Uniform1f(l,t.u_opacity),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_up_dir:new o.Uniform3f(l,t.u_up_dir),u_height_lift:new o.Uniform1f(l,t.u_height_lift)}),fillExtrusionPattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_lightpos:new o.Uniform3f(l,t.u_lightpos),u_lightintensity:new o.Uniform1f(l,t.u_lightintensity),u_lightcolor:new o.Uniform3f(l,t.u_lightcolor),u_vertical_gradient:new o.Uniform1f(l,t.u_vertical_gradient),u_height_factor:new o.Uniform1f(l,t.u_height_factor),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_up_dir:new o.Uniform3f(l,t.u_up_dir),u_height_lift:new o.Uniform1f(l,t.u_height_lift),u_image:new o.Uniform1i(l,t.u_image),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade),u_opacity:new o.Uniform1f(l,t.u_opacity)}),fill:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix)}),fillPattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image:new o.Uniform1i(l,t.u_image),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade)}),fillOutline:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_world:new o.Uniform2f(l,t.u_world)}),fillOutlinePattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_world:new o.Uniform2f(l,t.u_world),u_image:new o.Uniform1i(l,t.u_image),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade)}),circle:(l,t)=>({u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_extrude_scale:new o.UniformMatrix2f(l,t.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_up_dir:new o.Uniform3f(l,t.u_up_dir)}),collisionBox:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_extrude_scale:new o.Uniform2f(l,t.u_extrude_scale)}),collisionCircle:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_inv_matrix:new o.UniformMatrix4f(l,t.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(l,t.u_viewport_size)}),debug:(l,t)=>({u_color:new o.UniformColor(l,t.u_color),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_overlay:new o.Uniform1i(l,t.u_overlay),u_overlay_scale:new o.Uniform1f(l,t.u_overlay_scale)}),clippingMask:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix)}),heatmap:(l,t)=>({u_extrude_scale:new o.Uniform1f(l,t.u_extrude_scale),u_intensity:new o.Uniform1f(l,t.u_intensity),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_up_dir:new o.Uniform3f(l,t.u_up_dir)}),heatmapTexture:(l,t)=>({u_image:new o.Uniform1i(l,t.u_image),u_color_ramp:new o.Uniform1i(l,t.u_color_ramp),u_opacity:new o.Uniform1f(l,t.u_opacity)}),hillshade:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image:new o.Uniform1i(l,t.u_image),u_latrange:new o.Uniform2f(l,t.u_latrange),u_light:new o.Uniform2f(l,t.u_light),u_shadow:new o.UniformColor(l,t.u_shadow),u_highlight:new o.UniformColor(l,t.u_highlight),u_accent:new o.UniformColor(l,t.u_accent)}),hillshadePrepare:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_image:new o.Uniform1i(l,t.u_image),u_dimension:new o.Uniform2f(l,t.u_dimension),u_zoom:new o.Uniform1f(l,t.u_zoom),u_unpack:new o.Uniform4f(l,t.u_unpack)}),line:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_pixels_to_tile_units:new o.UniformMatrix2f(l,t.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(l,t.u_units_to_pixels),u_dash_image:new o.Uniform1i(l,t.u_dash_image),u_gradient_image:new o.Uniform1i(l,t.u_gradient_image),u_image_height:new o.Uniform1f(l,t.u_image_height),u_texsize:new o.Uniform2f(l,t.u_texsize),u_scale:new o.Uniform3f(l,t.u_scale),u_mix:new o.Uniform1f(l,t.u_mix),u_alpha_discard_threshold:new o.Uniform1f(l,t.u_alpha_discard_threshold),u_trim_offset:new o.Uniform2f(l,t.u_trim_offset)}),linePattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_texsize:new o.Uniform2f(l,t.u_texsize),u_pixels_to_tile_units:new o.UniformMatrix2f(l,t.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_image:new o.Uniform1i(l,t.u_image),u_units_to_pixels:new o.Uniform2f(l,t.u_units_to_pixels),u_scale:new o.Uniform3f(l,t.u_scale),u_fade:new o.Uniform1f(l,t.u_fade),u_alpha_discard_threshold:new o.Uniform1f(l,t.u_alpha_discard_threshold)}),raster:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_tl_parent:new o.Uniform2f(l,t.u_tl_parent),u_scale_parent:new o.Uniform1f(l,t.u_scale_parent),u_fade_t:new o.Uniform1f(l,t.u_fade_t),u_opacity:new o.Uniform1f(l,t.u_opacity),u_image0:new o.Uniform1i(l,t.u_image0),u_image1:new o.Uniform1i(l,t.u_image1),u_brightness_low:new o.Uniform1f(l,t.u_brightness_low),u_brightness_high:new o.Uniform1f(l,t.u_brightness_high),u_saturation_factor:new o.Uniform1f(l,t.u_saturation_factor),u_contrast_factor:new o.Uniform1f(l,t.u_contrast_factor),u_spin_weights:new o.Uniform3f(l,t.u_spin_weights),u_perspective_transform:new o.Uniform2f(l,t.u_perspective_transform)}),symbolIcon:(l,t)=>({u_is_size_zoom_constant:new o.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,t.u_size_t),u_size:new o.Uniform1f(l,t.u_size),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,t.u_fade_change),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new o.Uniform1i(l,t.u_is_text),u_pitch_with_map:new o.Uniform1i(l,t.u_pitch_with_map),u_texsize:new o.Uniform2f(l,t.u_texsize),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_camera_forward:new o.Uniform3f(l,t.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(l,t.u_tile_matrix),u_up_vector:new o.Uniform3f(l,t.u_up_vector),u_ecef_origin:new o.Uniform3f(l,t.u_ecef_origin),u_texture:new o.Uniform1i(l,t.u_texture)}),symbolSDF:(l,t)=>({u_is_size_zoom_constant:new o.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,t.u_size_t),u_size:new o.Uniform1f(l,t.u_size),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,t.u_fade_change),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new o.Uniform1i(l,t.u_is_text),u_pitch_with_map:new o.Uniform1i(l,t.u_pitch_with_map),u_texsize:new o.Uniform2f(l,t.u_texsize),u_texture:new o.Uniform1i(l,t.u_texture),u_gamma_scale:new o.Uniform1f(l,t.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_tile_id:new o.Uniform3f(l,t.u_tile_id),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(l,t.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_camera_forward:new o.Uniform3f(l,t.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(l,t.u_tile_matrix),u_up_vector:new o.Uniform3f(l,t.u_up_vector),u_ecef_origin:new o.Uniform3f(l,t.u_ecef_origin),u_is_halo:new o.Uniform1i(l,t.u_is_halo)}),symbolTextAndIcon:(l,t)=>({u_is_size_zoom_constant:new o.Uniform1i(l,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,t.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,t.u_size_t),u_size:new o.Uniform1f(l,t.u_size),u_camera_to_center_distance:new o.Uniform1f(l,t.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(l,t.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,t.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,t.u_fade_change),u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,t.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,t.u_coord_matrix),u_is_text:new o.Uniform1i(l,t.u_is_text),u_pitch_with_map:new o.Uniform1i(l,t.u_pitch_with_map),u_texsize:new o.Uniform2f(l,t.u_texsize),u_texsize_icon:new o.Uniform2f(l,t.u_texsize_icon),u_texture:new o.Uniform1i(l,t.u_texture),u_texture_icon:new o.Uniform1i(l,t.u_texture_icon),u_gamma_scale:new o.Uniform1f(l,t.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(l,t.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(l,t.u_is_halo)}),background:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_opacity:new o.Uniform1f(l,t.u_opacity),u_color:new o.UniformColor(l,t.u_color)}),backgroundPattern:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_opacity:new o.Uniform1f(l,t.u_opacity),u_image:new o.Uniform1i(l,t.u_image),u_pattern_tl_a:new o.Uniform2f(l,t.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(l,t.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(l,t.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(l,t.u_pattern_br_b),u_texsize:new o.Uniform2f(l,t.u_texsize),u_mix:new o.Uniform1f(l,t.u_mix),u_pattern_size_a:new o.Uniform2f(l,t.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(l,t.u_pattern_size_b),u_scale_a:new o.Uniform1f(l,t.u_scale_a),u_scale_b:new o.Uniform1f(l,t.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(l,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,t.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(l,t.u_tile_units_to_pixels)}),terrainRaster:Is,terrainDepth:Is,skybox:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_sun_direction:new o.Uniform3f(l,t.u_sun_direction),u_cubemap:new o.Uniform1i(l,t.u_cubemap),u_opacity:new o.Uniform1f(l,t.u_opacity),u_temporal_offset:new o.Uniform1f(l,t.u_temporal_offset)}),skyboxGradient:(l,t)=>({u_matrix:new o.UniformMatrix4f(l,t.u_matrix),u_color_ramp:new o.Uniform1i(l,t.u_color_ramp),u_center_direction:new o.Uniform3f(l,t.u_center_direction),u_radius:new o.Uniform1f(l,t.u_radius),u_opacity:new o.Uniform1f(l,t.u_opacity),u_temporal_offset:new o.Uniform1f(l,t.u_temporal_offset)}),skyboxCapture:(l,t)=>({u_matrix_3f:new o.UniformMatrix3f(l,t.u_matrix_3f),u_sun_direction:new o.Uniform3f(l,t.u_sun_direction),u_sun_intensity:new o.Uniform1f(l,t.u_sun_intensity),u_color_tint_r:new o.Uniform4f(l,t.u_color_tint_r),u_color_tint_m:new o.Uniform4f(l,t.u_color_tint_m),u_luminance:new o.Uniform1f(l,t.u_luminance)}),globeRaster:(l,t)=>({u_proj_matrix:new o.UniformMatrix4f(l,t.u_proj_matrix),u_globe_matrix:new o.UniformMatrix4f(l,t.u_globe_matrix),u_normalize_matrix:new o.UniformMatrix4f(l,t.u_normalize_matrix),u_merc_matrix:new o.UniformMatrix4f(l,t.u_merc_matrix),u_zoom_transition:new o.Uniform1f(l,t.u_zoom_transition),u_merc_center:new o.Uniform2f(l,t.u_merc_center),u_image0:new o.Uniform1i(l,t.u_image0),u_grid_matrix:new o.UniformMatrix3f(l,t.u_grid_matrix),u_frustum_tl:new o.Uniform3f(l,t.u_frustum_tl),u_frustum_tr:new o.Uniform3f(l,t.u_frustum_tr),u_frustum_br:new o.Uniform3f(l,t.u_frustum_br),u_frustum_bl:new o.Uniform3f(l,t.u_frustum_bl),u_globe_pos:new o.Uniform3f(l,t.u_globe_pos),u_globe_radius:new o.Uniform1f(l,t.u_globe_radius),u_viewport:new o.Uniform2f(l,t.u_viewport)}),globeAtmosphere:(l,t)=>({u_frustum_tl:new o.Uniform3f(l,t.u_frustum_tl),u_frustum_tr:new o.Uniform3f(l,t.u_frustum_tr),u_frustum_br:new o.Uniform3f(l,t.u_frustum_br),u_frustum_bl:new o.Uniform3f(l,t.u_frustum_bl),u_horizon:new o.Uniform1f(l,t.u_horizon),u_transition:new o.Uniform1f(l,t.u_transition),u_fadeout_range:new o.Uniform1f(l,t.u_fadeout_range),u_color:new o.Uniform4f(l,t.u_color),u_high_color:new o.Uniform4f(l,t.u_high_color),u_space_color:new o.Uniform4f(l,t.u_space_color),u_star_intensity:new o.Uniform1f(l,t.u_star_intensity),u_star_density:new o.Uniform1f(l,t.u_star_density),u_star_size:new o.Uniform1f(l,t.u_star_size),u_temporal_offset:new o.Uniform1f(l,t.u_temporal_offset),u_horizon_angle:new o.Uniform1f(l,t.u_horizon_angle),u_rotation_matrix:new o.UniformMatrix4f(l,t.u_rotation_matrix)})};let zs;function pc(l,t,a,u,p,f,y){const v=l.context,w=v.gl,A=l.transform,C=l.useProgram("collisionBox"),P=[];let O=0,U=0;for(let ne=0;ne<u.length;ne++){const Y=u[ne],ee=t.getTile(Y),ce=ee.getBucket(a);if(!ce)continue;const Ie=$r(Y,ce,A);let Ae=Ie;p[0]===0&&p[1]===0||(Ae=l.translatePosMatrix(Ie,ee,p,f));const we=y?ce.textCollisionBox:ce.iconCollisionBox,Ze=ce.collisionCircleArray;if(Ze.length>0){const re=o.create(),ye=Ae;o.mul(re,ce.placementInvProjMatrix,A.glCoordMatrix),o.mul(re,re,ce.placementViewportMatrix),P.push({circleArray:Ze,circleOffset:U,transform:ye,invTransform:re,projection:ce.getProjection()}),O+=Ze.length/4,U=O}we&&(l.terrain&&l.terrain.setupElevationDraw(ee,C),C.draw(v,w.LINES,o.DepthMode.disabled,o.StencilMode.disabled,l.colorModeForRenderPass(),o.CullFaceMode.disabled,U1(Ae,A,ee,ce.getProjection()),a.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,null,A.zoom,null,we.collisionVertexBuffer,we.collisionVertexBufferExt))}if(!y||!P.length)return;const j=l.useProgram("collisionCircle"),G=new o.StructArrayLayout2f1f2i16;G.resize(4*O),G._trim();let Q=0;for(const ne of P)for(let Y=0;Y<ne.circleArray.length/4;Y++){const ee=4*Y,ce=ne.circleArray[ee+0],Ie=ne.circleArray[ee+1],Ae=ne.circleArray[ee+2],we=ne.circleArray[ee+3];G.emplace(Q++,ce,Ie,Ae,we,0),G.emplace(Q++,ce,Ie,Ae,we,1),G.emplace(Q++,ce,Ie,Ae,we,2),G.emplace(Q++,ce,Ie,Ae,we,3)}(!zs||zs.length<2*O)&&(zs=function(ne){const Y=2*ne,ee=new o.StructArrayLayout3ui6;ee.resize(Y),ee._trim();for(let ce=0;ce<Y;ce++){const Ie=6*ce;ee.uint16[Ie+0]=4*ce+0,ee.uint16[Ie+1]=4*ce+1,ee.uint16[Ie+2]=4*ce+2,ee.uint16[Ie+3]=4*ce+2,ee.uint16[Ie+4]=4*ce+3,ee.uint16[Ie+5]=4*ce+0}return ee}(O));const $=v.createIndexBuffer(zs,!0),J=v.createVertexBuffer(G,o.collisionCircleLayout.members,!0);for(const ne of P){const Y={u_matrix:ne.transform,u_inv_matrix:ne.invTransform,u_camera_to_center_distance:(V=A).getCameraToCenterDistance(ne.projection),u_viewport_size:[V.width,V.height]};j.draw(v,w.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,l.colorModeForRenderPass(),o.CullFaceMode.disabled,Y,a.id,J,$,o.SegmentVector.simpleSegment(0,2*ne.circleOffset,ne.circleArray.length,ne.circleArray.length/2),null,A.zoom)}var V;J.destroy(),$.destroy()}const dc=o.create();function _3(l,t,a,u,p,f){const{horizontalAlign:y,verticalAlign:v}=o.getAnchorAlignment(l),w=-(y-.5)*t,A=-(v-.5)*a,C=o.evaluateVariableOffset(l,u);return new o.pointGeometry((w/p+C[0])*f,(A/p+C[1])*f)}function m3(l,t,a,u,p,f,y,v,w,A,C){const P=l.text.placedSymbolArray,O=l.text.dynamicLayoutVertexArray,U=l.icon.dynamicLayoutVertexArray,j={},G=ms(v,l.getProjection(),f),Q=f.elevation,$=l.getProjection().upVectorScale(v.canonical,f.center.lat,f.worldSize);O.clear();for(let J=0;J<P.length;J++){const V=P.get(J),ne=l.allowVerticalPlacement&&!V.placedOrientation,Y=V.hidden||!V.crossTileID||ne?null:u[V.crossTileID];if(Y){const ee=new o.pointGeometry(V.tileAnchorX,V.tileAnchorY),ce=l.getProjection().upVector(v.canonical,ee.x,ee.y),Ie=Q?Q.getAtTileOffset(v,ee.x,ee.y):0,Ae=zn([V.projectedAnchorX+Ie*ce[0]*$.metersToTile,V.projectedAnchorY+Ie*ce[1]*$.metersToTile,V.projectedAnchorZ+Ie*ce[2]*$.metersToTile],a?G:y),we=Do(f.getCameraToCenterDistance(l.getProjection()),Ae.signedDistanceFromCamera);let Ze=p.evaluateSizeForFeature(l.textSizeData,A,V)*we/o.ONE_EM;a&&(Ze*=l.tilePixelRatio/w);const{width:re,height:ye,anchor:Le,textOffset:tt,textScale:De}=Y,ft=_3(Le,re,ye,tt,De,Ze);let Ke;if(a){const rt=ee.add(ft),{x:et,y:ut,z:Ct}=l.getProjection().projectTilePoint(rt.x,rt.y,v.canonical);Ke=zn([et+Ie*ce[0]*$.metersToTile,ut+Ie*ce[1]*$.metersToTile,Ct+Ie*ce[2]*$.metersToTile],y).point}else{const rt=t?ft.rotate(-f.angle):ft;Ke=[Ae.point[0]+rt.x,Ae.point[1]+rt.y,0]}const it=l.allowVerticalPlacement&&V.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let rt=0;rt<V.numGlyphs;rt++)o.addDynamicAttributes(O,Ke[0],Ke[1],Ke[2],it);C&&V.associatedIconIndex>=0&&(j[V.associatedIconIndex]={shiftedAnchor:Ke,angle:it})}else Hi(V.numGlyphs,O)}if(C){U.clear();const J=l.icon.placedSymbolArray;for(let V=0;V<J.length;V++){const ne=J.get(V);if(ne.hidden)Hi(ne.numGlyphs,U);else{const Y=j[V];if(Y)for(let ee=0;ee<ne.numGlyphs;ee++)o.addDynamicAttributes(U,Y.shiftedAnchor[0],Y.shiftedAnchor[1],Y.shiftedAnchor[2],Y.angle);else Hi(ne.numGlyphs,U)}}l.icon.dynamicLayoutVertexBuffer.updateData(U)}l.text.dynamicLayoutVertexBuffer.updateData(O)}function q1(l,t,a){return a.iconsInText&&t?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function Ps(l,t,a,u,p,f,y,v,w,A,C,P){const O=l.context,U=O.gl,j=l.transform,G=v==="map",Q=w==="map",$=G&&a.layout.get("symbol-placement")!=="point",J=G&&!Q&&!$,V=a.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ne=!1;const Y=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),ee=[o.mercatorXfromLng(j.center.lng),o.mercatorYfromLat(j.center.lat)],ce=a.layout.get("text-variable-anchor"),Ie=j.projection.name==="globe",Ae=[],we=[0,-1,0];let Ze=we;!Ie&&!j.mercatorFromTransition||G||(Ze=function(re){const ye=re._camera.getWorldToCamera(re.worldSize,1),Le=o.multiply([],ye,re.globeMatrix);o.invert(Le,Le);const tt=[0,0,0],De=[0,1,0,0];return o.transformMat4$1(De,De,Le),tt[0]=De[0],tt[1]=De[1],tt[2]=De[2],o.normalize(tt,tt),tt}(j));for(const re of u){const ye=t.getTile(re),Le=ye.getBucket(a);if(!Le||Le.projection.name==="mercator"&&Ie)continue;const tt=p?Le.text:Le.icon;if(!tt||Le.fullyClipped||!tt.segments.get().length)continue;const De=tt.programConfigurations.get(a.id),ft=p||Le.sdfIcons,Ke=p?Le.textSizeData:Le.iconSizeData,it=Q||j.pitch!==0,rt=o.evaluateSizeForZoom(Ke,j.zoom);let et,ut,Ct,Dt,vt=[0,0],Pt=null;if(p){if(ut=ye.glyphAtlasTexture,Ct=U.LINEAR,et=ye.glyphAtlasTexture.size,Le.iconsInText){vt=ye.imageAtlasTexture.size,Pt=ye.imageAtlasTexture;const dr=Ke.kind==="composite"||Ke.kind==="camera";Dt=it||l.options.rotating||l.options.zooming||dr?U.LINEAR:U.NEAREST}}else{const dr=a.layout.get("icon-size").constantOr(0)!==1||Le.iconsNeedLinear;ut=ye.imageAtlasTexture,Ct=ft||l.options.rotating||l.options.zooming||dr||it?U.LINEAR:U.NEAREST,et=ye.imageAtlasTexture.size}const ci=Le.projection.name==="globe",_i=ci?Ze:we,Ti=ci?o.globeToMercatorTransition(j.zoom):0,pi=ms(re,Le.getProjection(),j),Ir=j.calculatePixelsToTileUnitsMatrix(ye),dn=jt(pi,ye.tileID.canonical,Q,G,j,Le.getProjection(),Ir),Rn=l.terrain&&Q&&$?o.invert(o.create(),dn):dc,vi=lo(pi,ye.tileID.canonical,Q,G,j,Le.getProjection(),Ir),Ai=ce&&Le.hasTextData(),ri=a.layout.get("icon-text-fit")!=="none"&&Ai&&Le.hasIconData();if($){const dr=j.elevation,Fr=dr?dr.getAtTileOffsetFunc(re,j.center.lat,j.worldSize,Le.getProjection()):wo=>[0,0,0],_n=tn(pi,ye.tileID.canonical,Q,G,j,Le.getProjection(),Ir);Vr(Le,pi,l,p,_n,vi,Q,A,Fr,re)}const qi=$||p&&ce||ri,pr=l.translatePosMatrix(pi,ye,f,y),mi=qi?dc:dn,Di=l.translatePosMatrix(vi,ye,f,y,!0),vo=Le.getProjection().createInversionMatrix(j,re.canonical),fn=[];l.terrain&&Q&&fn.push("PITCH_WITH_MAP_TERRAIN"),ci&&fn.push("PROJECTION_GLOBE_VIEW"),qi&&fn.push("PROJECTED_POS_ON_VIEWPORT");const Yo=ft&&a.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let bo;bo=ft?Le.iconsInText?uc(Ke.kind,rt,J,Q,l,pr,mi,Di,et,vt,re,Ti,ee,vo,_i,Le.getProjection()):cc(Ke.kind,rt,J,Q,l,pr,mi,Di,p,et,!0,re,Ti,ee,vo,_i,Le.getProjection()):Da(Ke.kind,rt,J,Q,l,pr,mi,Di,p,et,re,Ti,ee,vo,_i,Le.getProjection());const Wn={program:l.useProgram(q1(ft,p,Le),De,fn),buffers:tt,uniformValues:bo,atlasTexture:ut,atlasTextureIcon:Pt,atlasInterpolation:Ct,atlasInterpolationIcon:Dt,isSDF:ft,hasHalo:Yo,tile:ye,labelPlaneMatrixInv:Rn};if(V&&Le.canOverlap){ne=!0;const dr=tt.segments.get();for(const Fr of dr)Ae.push({segments:new o.SegmentVector([Fr]),sortKey:Fr.sortKey,state:Wn})}else Ae.push({segments:tt.segments,sortKey:0,state:Wn})}ne&&Ae.sort((re,ye)=>re.sortKey-ye.sortKey);for(const re of Ae){const ye=re.state;if(l.terrain&&l.terrain.setupElevationDraw(ye.tile,ye.program,{useDepthForOcclusion:!Ie,labelPlaneMatrixInv:ye.labelPlaneMatrixInv}),O.activeTexture.set(U.TEXTURE0),ye.atlasTexture.bind(ye.atlasInterpolation,U.CLAMP_TO_EDGE),ye.atlasTextureIcon&&(O.activeTexture.set(U.TEXTURE1),ye.atlasTextureIcon&&ye.atlasTextureIcon.bind(ye.atlasInterpolationIcon,U.CLAMP_TO_EDGE)),ye.isSDF){const Le=ye.uniformValues;ye.hasHalo&&(Le.u_is_halo=1,W1(ye.buffers,re.segments,a,l,ye.program,Y,C,P,Le)),Le.u_is_halo=0}W1(ye.buffers,re.segments,a,l,ye.program,Y,C,P,ye.uniformValues)}}function W1(l,t,a,u,p,f,y,v,w){const A=u.context;p.draw(A,A.gl.TRIANGLES,f,y,v,o.CullFaceMode.disabled,w,a.id,l.layoutVertexBuffer,l.indexBuffer,t,a.paint,u.transform.zoom,l.programConfigurations.get(a.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer,l.globeExtVertexBuffer)}function X1(l,t,a,u,p,f,y){const v=l.context.gl,w=a.paint.get("fill-pattern"),A=w&&w.constantOr(1),C=a.getCrossfadeParameters();let P,O,U,j,G;y?(O=A&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=v.LINES):(O=A?"fillPattern":"fill",P=v.TRIANGLES);for(const Q of u){const $=t.getTile(Q);if(A&&!$.patternsLoaded())continue;const J=$.getBucket(a);if(!J)continue;l.prepareDrawTile();const V=J.programConfigurations.get(a.id),ne=l.useProgram(O,V);A&&(l.context.activeTexture.set(v.TEXTURE0),$.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),V.updatePaintBuffers(C));const Y=w.constantOr(null);if(Y&&$.imageAtlas){const ce=$.imageAtlas,Ie=ce.patternPositions[Y.to.toString()],Ae=ce.patternPositions[Y.from.toString()];Ie&&Ae&&V.setConstantPatternPositions(Ie,Ae)}const ee=l.translatePosMatrix(Q.projMatrix,$,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(y){j=J.indexBuffer2,G=J.segments2;const ce=l.terrain&&l.terrain.renderingToTexture?l.terrain.drapeBufferSize:[v.drawingBufferWidth,v.drawingBufferHeight];U=O==="fillOutlinePattern"&&A?N1(ee,l,C,$,ce):Ms(ee,ce)}else j=J.indexBuffer,G=J.segments,U=A?F1(ee,l,C,$):Uo(ee);l.prepareDrawProgram(l.context,ne,Q.toUnwrapped()),ne.draw(l.context,P,p,l.stencilModeForClipping(Q),f,o.CullFaceMode.disabled,U,a.id,J.layoutVertexBuffer,j,G,a.paint,l.transform.zoom,V)}}function Ds(l,t,a,u,p,f,y){const v=l.context,w=v.gl,A=l.transform,C=a.paint.get("fill-extrusion-pattern"),P=C.constantOr(1),O=a.getCrossfadeParameters(),U=a.paint.get("fill-extrusion-opacity"),j=A.projection.name==="globe"?o.fillExtrusionHeightLift():0,G=A.projection.name==="globe",Q=G?o.globeToMercatorTransition(A.zoom):0,$=[o.mercatorXfromLng(A.center.lng),o.mercatorYfromLat(A.center.lat)],J=[];G&&J.push("PROJECTION_GLOBE_VIEW");for(const V of u){const ne=t.getTile(V),Y=ne.getBucket(a);if(!Y||Y.projection.name!==A.projection.name)continue;const ee=Y.programConfigurations.get(a.id),ce=l.useProgram(P?"fillExtrusionPattern":"fillExtrusion",ee,J);if(l.terrain){const ye=l.terrain;if(l.style.terrainSetForDrapingOnly())ye.setupElevationDraw(ne,ce,{useMeterToDem:!0});else{if(!Y.enableTerrain)continue;if(ye.setupElevationDraw(ne,ce,{useMeterToDem:!0}),J1(v,t,V,Y,a,ye),!Y.centroidVertexBuffer){const Le=ce.attributes.a_centroid_pos;Le!==void 0&&w.vertexAttrib2f(Le,0,0)}}}P&&(l.context.activeTexture.set(w.TEXTURE0),ne.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),ee.updatePaintBuffers(O));const Ie=C.constantOr(null);if(Ie&&ne.imageAtlas){const ye=ne.imageAtlas,Le=ye.patternPositions[Ie.to.toString()],tt=ye.patternPositions[Ie.from.toString()];Le&&tt&&ee.setConstantPatternPositions(Le,tt)}const Ae=l.translatePosMatrix(V.projMatrix,ne,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),we=A.projection.createInversionMatrix(A,V.canonical),Ze=a.paint.get("fill-extrusion-vertical-gradient"),re=P?za(Ae,l,Ze,U,V,O,ne,j,Q,$,we):oc(Ae,l,Ze,U,V,j,Q,$,we);l.prepareDrawProgram(v,ce,V.toUnwrapped()),ce.draw(v,v.gl.TRIANGLES,p,f,y,o.CullFaceMode.backCCW,re,a.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,a.paint,l.transform.zoom,ee,l.terrain?Y.centroidVertexBuffer:null,G?Y.layoutVertexExtBuffer:null)}}function J1(l,t,a,u,p,f){const y=[$=>{let J=$.canonical.x-1,V=$.wrap;return J<0&&(J=(1<<$.canonical.z)-1,V--),new o.OverscaledTileID($.overscaledZ,V,$.canonical.z,J,$.canonical.y)},$=>{let J=$.canonical.x+1,V=$.wrap;return J===1<<$.canonical.z&&(J=0,V++),new o.OverscaledTileID($.overscaledZ,V,$.canonical.z,J,$.canonical.y)},$=>new o.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,($.canonical.y===0?1<<$.canonical.z:$.canonical.y)-1),$=>new o.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y===(1<<$.canonical.z)-1?0:$.canonical.y+1)],v=$=>{const J=t.getSource().minzoom,V=Y=>{const ee=t.getTileByID(Y);if(ee&&ee.hasData())return ee.getBucket(p)},ne=[0,-1,1];for(const Y of ne){if($.overscaledZ+Y<J)continue;const ee=V($.calculateScaledKey($.overscaledZ+Y));if(ee)return ee}},w=[0,0,0],A=($,J)=>(w[0]=Math.min($.min.y,J.min.y),w[1]=Math.max($.max.y,J.max.y),w[2]=o.EXTENT-J.min.x>$.max.x?J.min.x-o.EXTENT:$.max.x,w),C=($,J)=>(w[0]=Math.min($.min.x,J.min.x),w[1]=Math.max($.max.x,J.max.x),w[2]=o.EXTENT-J.min.y>$.max.y?J.min.y-o.EXTENT:$.max.y,w),P=[($,J)=>A($,J),($,J)=>A(J,$),($,J)=>C($,J),($,J)=>C(J,$)],O=new o.pointGeometry(0,0);let U,j,G;const Q=($,J,V,ne,Y)=>{const ee=[[ne?V:$,ne?$:V,0],[ne?V:J,ne?J:V,0]],ce=Y<0?o.EXTENT+Y:Y,Ie=[ne?ce:($+J)/2,ne?($+J)/2:ce,0];return V===0&&Y<0||V!==0&&Y>0?f.getForTilePoints(G,[Ie],!0,j):ee.push(Ie),f.getForTilePoints(a,ee,!0,U),Math.max(ee[0][2],ee[1][2],Ie[2])/f.exaggeration()};for(let $=0;$<4;$++){const J=($<2?1:5)-$,V=u.borders[$];if(V.length===0)continue;const ne=G=y[$](a),Y=v(ne);if(!(Y&&Y instanceof o.FillExtrusionBucket&&Y.enableTerrain)||u.borderDoneWithNeighborZ[$]===Y.canonical.z&&Y.borderDoneWithNeighborZ[J]===u.canonical.z||(j=f.findDEMTileFor(ne),!j||!j.dem))continue;if(!U){const Ae=f.findDEMTileFor(a);if(!Ae||!Ae.dem)return;U=Ae}const ee=Y.borders[J];let ce=0;const Ie=Y.borderDoneWithNeighborZ[J]!==u.canonical.z;if(u.canonical.z===Y.canonical.z){for(let Ae=0;Ae<V.length;Ae++){const we=u.featuresOnBorder[V[Ae]],Ze=we.borders[$];let re;for(;ce<ee.length&&(re=Y.featuresOnBorder[ee[ce]],!(re.borders[J][1]>Ze[0]+3));)Ie&&Y.encodeCentroid(void 0,re,!1),ce++;if(re&&ce<ee.length){const ye=ce;let Le=0;for(;!(re.borders[J][0]>Ze[1]-3)&&(Le++,++ce!==ee.length);)re=Y.featuresOnBorder[ee[ce]];if(re=Y.featuresOnBorder[ee[ye]],we.intersectsCount()>1||re.intersectsCount()>1||Le!==1){Le!==1&&(ce=ye),u.encodeCentroid(void 0,we,!1),Ie&&Y.encodeCentroid(void 0,re,!1);continue}const tt=P[$](we,re),De=$%2?o.EXTENT-1:0;O.x=Q(tt[0],Math.min(o.EXTENT-1,tt[1]),De,$<2,tt[2]),O.y=0,u.encodeCentroid(O,we,!1),Ie&&Y.encodeCentroid(O,re,!1)}else u.encodeCentroid(void 0,we,!1)}u.borderDoneWithNeighborZ[$]=Y.canonical.z,u.needsCentroidUpdate=!0,Ie&&(Y.borderDoneWithNeighborZ[J]=u.canonical.z,Y.needsCentroidUpdate=!0)}else{for(const Ae of V)u.encodeCentroid(void 0,u.featuresOnBorder[Ae],!1);if(Ie){for(const Ae of ee)Y.encodeCentroid(void 0,Y.featuresOnBorder[Ae],!1);Y.borderDoneWithNeighborZ[J]=u.canonical.z,Y.needsCentroidUpdate=!0}u.borderDoneWithNeighborZ[$]=Y.canonical.z,u.needsCentroidUpdate=!0}}(u.needsCentroidUpdate||!u.centroidVertexBuffer&&u.centroidVertexArray.length!==0)&&u.uploadCentroid(l)}const po=new o.Color(1,0,0,1),La=new o.Color(0,1,0,1),fc=new o.Color(0,0,1,1),jo=new o.Color(1,0,1,1),$o=new o.Color(0,1,1,1);function H1(l,t,a,u){Kt(l,0,t+a/2,l.transform.width,a,u)}function Ls(l,t,a,u){Kt(l,t-a/2,0,a,l.transform.height,u)}function Kt(l,t,a,u,p,f){const y=l.context,v=y.gl;v.enable(v.SCISSOR_TEST),v.scissor(t*o.exported.devicePixelRatio,a*o.exported.devicePixelRatio,u*o.exported.devicePixelRatio,p*o.exported.devicePixelRatio),y.clear({color:f}),v.disable(v.SCISSOR_TEST)}function Rs(l,t,a){const u=l.context,p=u.gl,f=l.transform.projection.name==="globe",y=a.projMatrix,v=l.useProgram("debug",null,f?["PROJECTION_GLOBE_VIEW"]:null),w=t.getTileByID(a.key);l.terrain&&l.terrain.setupElevationDraw(w,v);const A=o.DepthMode.disabled,C=o.StencilMode.disabled,P=l.colorModeForRenderPass(),O="$debug";u.activeTexture.set(p.TEXTURE0),l.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),f?w._makeGlobeTileDebugBuffers(l.context,l.transform.projection):w._makeDebugTileBoundsBuffers(l.context,l.transform.projection);const U=w._tileDebugBuffer||l.debugBuffer,j=w._tileDebugIndexBuffer||l.debugIndexBuffer,G=w._tileDebugSegments||l.debugSegments;v.draw(u,p.LINE_STRIP,A,C,P,o.CullFaceMode.disabled,V1(y,o.Color.red),O,U,j,G,null,null,null,w._globeTileDebugBorderBuffer);const Q=w.latestRawTileData,$=Math.floor((Q&&Q.byteLength||0)/1024),J=t.getTile(a).tileSize,V=512/Math.min(J,512)*(a.overscaledZ/l.transform.zoom)*.5;let ne=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ne+=` => ${a.overscaledZ}`),function(Ie,Ae){Ie.initDebugOverlayCanvas();const we=Ie.debugOverlayCanvas,Ze=Ie.context.gl,re=Ie.debugOverlayCanvas.getContext("2d");re.clearRect(0,0,we.width,we.height),re.shadowColor="white",re.shadowBlur=2,re.lineWidth=1.5,re.strokeStyle="white",re.textBaseline="top",re.font="bold 36px Open Sans, sans-serif",re.fillText(Ae,5,5),re.strokeText(Ae,5,5),Ie.debugOverlayTexture.update(we),Ie.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(l,`${ne} ${$}kb`);const Y=w._tileDebugTextBuffer||l.debugBuffer,ee=w._tileDebugTextIndexBuffer||l.quadTriangleIndexBuffer,ce=w._tileDebugTextSegments||l.debugSegments;v.draw(u,p.TRIANGLES,A,C,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,V1(y,o.Color.transparent,V),O,Y,ee,ce,null,null,null,w._globeTileDebugTextBuffer)}const g3=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:_c}=g3;function Zr(l,t,a,u){l.emplaceBack(t,a,u)}class mc{constructor(t){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Zr(this.vertexArray,-1,-1,1),Zr(this.vertexArray,1,-1,1),Zr(this.vertexArray,-1,1,1),Zr(this.vertexArray,1,1,1),Zr(this.vertexArray,-1,-1,-1),Zr(this.vertexArray,1,-1,-1),Zr(this.vertexArray,-1,1,-1),Zr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,_c),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function Zo(l,t,a,u,p,f){const y=l.gl,v=t.paint.get("sky-atmosphere-color"),w=t.paint.get("sky-atmosphere-halo-color"),A=t.paint.get("sky-atmosphere-sun-intensity"),C=((P,O,U,j,G)=>({u_matrix_3f:P,u_sun_direction:O,u_sun_intensity:U,u_color_tint_r:[j.r,j.g,j.b,j.a],u_color_tint_m:[G.r,G.g,G.b,G.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),u),p,A,v,w);y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_CUBE_MAP_POSITIVE_X+f,t.skyboxTexture,0),a.draw(l,y.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,C,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const gc=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class y3{constructor(t){const a=new o.StructArrayLayout5f20;a.emplaceBack(-1,1,1,0,0),a.emplaceBack(1,1,1,1,0),a.emplaceBack(1,-1,1,1,1),a.emplaceBack(-1,-1,1,0,1);const u=new o.StructArrayLayout3ui6;u.emplaceBack(0,1,2),u.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(a,gc.members),this.indexBuffer=t.createIndexBuffer(u),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Bs={symbol:function(l,t,a,u,p){if(l.renderPass!=="translucent")return;const f=o.StencilMode.disabled,y=l.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(v,w,A,C,P,O,U){const j=w.transform,G=P==="map",Q=O==="map";for(const $ of v){const J=C.getTile($),V=J.getBucket(A);if(!V||!V.text||!V.text.segments.get().length)continue;const ne=o.evaluateSizeForZoom(V.textSizeData,j.zoom),Y=ms($,V.getProjection(),j),ee=j.calculatePixelsToTileUnitsMatrix(J),ce=jt(Y,J.tileID.canonical,Q,G,j,V.getProjection(),ee),Ie=A.layout.get("icon-text-fit")!=="none"&&V.hasIconData();if(ne){const Ae=Math.pow(2,j.zoom-J.tileID.overscaledZ);m3(V,G,Q,U,o.symbolSize,j,ce,$,Ae,ne,Ie)}}}(u,l,a,t,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),p),a.paint.get("icon-opacity").constantOr(1)!==0&&Ps(l,t,a,u,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),f,y),a.paint.get("text-opacity").constantOr(1)!==0&&Ps(l,t,a,u,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),f,y),t.map.showCollisionBoxes&&(pc(l,t,a,u,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),pc(l,t,a,u,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))},circle:function(l,t,a,u){if(l.renderPass!=="translucent")return;const p=a.paint.get("circle-opacity"),f=a.paint.get("circle-stroke-width"),y=a.paint.get("circle-stroke-opacity"),v=a.layout.get("circle-sort-key").constantOr(1)!==void 0;if(p.constantOr(1)===0&&(f.constantOr(1)===0||y.constantOr(1)===0))return;const w=l.context,A=w.gl,C=l.transform,P=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),O=o.StencilMode.disabled,U=l.colorModeForRenderPass(),j=C.projection.name==="globe",G=[o.mercatorXfromLng(C.center.lng),o.mercatorYfromLat(C.center.lat)],Q=[];for(let J=0;J<u.length;J++){const V=u[J],ne=t.getTile(V),Y=ne.getBucket(a);if(!Y||Y.projection.name!==C.projection.name)continue;const ee=Y.programConfigurations.get(a.id),ce=ac(a);j&&ce.push("PROJECTION_GLOBE_VIEW");const Ie=l.useProgram("circle",ee,ce),Ae=Y.layoutVertexBuffer,we=Y.globeExtVertexBuffer,Ze=Y.indexBuffer,re=C.projection.createInversionMatrix(C,V.canonical),ye={programConfiguration:ee,program:Ie,layoutVertexBuffer:Ae,globeExtVertexBuffer:we,indexBuffer:Ze,uniformValues:G1(l,V,ne,re,G,a),tile:ne};if(v){const Le=Y.segments.get();for(const tt of Le)Q.push({segments:new o.SegmentVector([tt]),sortKey:tt.sortKey,state:ye})}else Q.push({segments:Y.segments,sortKey:0,state:ye})}v&&Q.sort((J,V)=>J.sortKey-V.sortKey);const $={useDepthForOcclusion:!j};for(const J of Q){const{programConfiguration:V,program:ne,layoutVertexBuffer:Y,globeExtVertexBuffer:ee,indexBuffer:ce,uniformValues:Ie,tile:Ae}=J.state,we=J.segments;l.terrain&&l.terrain.setupElevationDraw(Ae,ne,$),l.prepareDrawProgram(w,ne,Ae.tileID.toUnwrapped()),ne.draw(w,A.TRIANGLES,P,O,U,o.CullFaceMode.disabled,Ie,a.id,Y,ce,we,a.paint,C.zoom,V,j?ee:null)}},heatmap:function(l,t,a,u){if(a.paint.get("heatmap-opacity")!==0)if(l.renderPass==="offscreen"){const p=l.context,f=p.gl,y=o.StencilMode.disabled,v=new o.ColorMode([f.ONE,f.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(U,j,G,Q){const $=U.gl,J=j.width*Q,V=j.height*Q;U.activeTexture.set($.TEXTURE1),U.viewport.set([0,0,J,V]);let ne=G.heatmapFbo;if(!ne||ne&&(ne.width!==J||ne.height!==V)){ne&&ne.destroy();const Y=$.createTexture();$.bindTexture($.TEXTURE_2D,Y),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),ne=G.heatmapFbo=U.createFramebuffer(J,V,!1),function(ee,ce,Ie,Ae,we,Ze){const re=ee.gl;re.texImage2D(re.TEXTURE_2D,0,re.RGBA,we,Ze,0,re.RGBA,ee.extRenderToTextureHalfFloat?ee.extTextureHalfFloat.HALF_FLOAT_OES:re.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Ie)}(U,0,Y,ne,J,V)}else $.bindTexture($.TEXTURE_2D,ne.colorAttachment.get()),U.bindFramebuffer.set(ne.framebuffer)})(p,l,a,l.transform.projection.name==="globe"?.5:.25),p.clear({color:o.Color.transparent});const w=l.transform,A=w.projection.name==="globe",C=A?["PROJECTION_GLOBE_VIEW"]:null,P=A?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,O=[o.mercatorXfromLng(w.center.lng),o.mercatorYfromLat(w.center.lat)];for(let U=0;U<u.length;U++){const j=u[U];if(t.hasRenderableParent(j))continue;const G=t.getTile(j),Q=G.getBucket(a);if(!Q||Q.projection.name!==w.projection.name)continue;const $=Q.programConfigurations.get(a.id),J=l.useProgram("heatmap",$,C),{zoom:V}=l.transform;l.terrain&&l.terrain.setupElevationDraw(G,J),l.prepareDrawProgram(p,J,j.toUnwrapped());const ne=w.projection.createInversionMatrix(w,j.canonical);J.draw(p,f.TRIANGLES,o.DepthMode.disabled,y,v,P,h3(l,j,G,ne,O,V,a.paint.get("heatmap-intensity")),a.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,a.paint,l.transform.zoom,$,A?Q.globeExtVertexBuffer:null)}p.viewport.set([0,0,l.width,l.height])}else l.renderPass==="translucent"&&(l.context.setColorMode(l.colorModeForRenderPass()),function(p,f){const y=p.context,v=y.gl,w=f.heatmapFbo;if(!w)return;y.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,w.colorAttachment.get()),y.activeTexture.set(v.TEXTURE1);let A=f.colorRampTexture;A||(A=f.colorRampTexture=new o.Texture(y,f.colorRamp,v.RGBA)),A.bind(v.LINEAR,v.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(y,v.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,p.colorModeForRenderPass(),o.CullFaceMode.disabled,((C,P,O,U)=>({u_image:0,u_color_ramp:1,u_opacity:P.paint.get("heatmap-opacity")}))(0,f),f.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,f.paint,p.transform.zoom)}(l,a))},line:function(l,t,a,u){if(l.renderPass!=="translucent")return;const p=a.paint.get("line-opacity"),f=a.paint.get("line-width");if(p.constantOr(1)===0||f.constantOr(1)===0)return;const y=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),v=l.colorModeForRenderPass(),w=l.terrain&&l.terrain.renderingToTexture?1:o.exported.devicePixelRatio,A=a.paint.get("line-dasharray"),C=A.constantOr(1),P=a.layout.get("line-cap"),O=a.paint.get("line-pattern"),U=O.constantOr(1),j=a.paint.get("line-gradient"),G=a.getCrossfadeParameters(),Q=U?"linePattern":"line",$=l.context,J=$.gl,V=(Y=>{const ee=[];Cs(Y)&&ee.push("RENDER_LINE_DASH"),Y.paint.get("line-gradient")&&ee.push("RENDER_LINE_GRADIENT");const ce=Y.paint.get("line-trim-offset");ce[0]===0&&ce[1]===0||ee.push("RENDER_LINE_TRIM_OFFSET");const Ie=Y.paint.get("line-pattern").constantOr(1),Ae=Y.paint.get("line-opacity").constantOr(1)!==1;return!Ie&&Ae&&ee.push("RENDER_LINE_ALPHA_DISCARD"),ee})(a);let ne=V.includes("RENDER_LINE_ALPHA_DISCARD");l.terrain&&l.terrain.clipOrMaskOverlapStencilType()&&(ne=!1);for(const Y of u){const ee=t.getTile(Y);if(U&&!ee.patternsLoaded())continue;const ce=ee.getBucket(a);if(!ce)continue;l.prepareDrawTile();const Ie=ce.programConfigurations.get(a.id),Ae=l.useProgram(Q,Ie,V),we=O.constantOr(null);if(we&&ee.imageAtlas){const Ke=ee.imageAtlas,it=Ke.patternPositions[we.to.toString()],rt=Ke.patternPositions[we.from.toString()];it&&rt&&Ie.setConstantPatternPositions(it,rt)}const Ze=A.constantOr(null),re=P.constantOr(null);if(!U&&Ze&&re&&ee.lineAtlas){const Ke=ee.lineAtlas,it=Ke.getDash(Ze.to,re),rt=Ke.getDash(Ze.from,re);it&&rt&&Ie.setConstantPatternPositions(it,rt)}let[ye,Le]=a.paint.get("line-trim-offset");(re==="round"||re==="square")&&ye!==Le&&(ye===0&&(ye-=1),Le===1&&(Le+=1));const tt=l.terrain?Y.projMatrix:null,De=U?p3(l,ee,a,G,tt,w):$1(l,ee,a,G,tt,ce.lineClipsArray.length,w,[ye,Le]);if(j){const Ke=ce.gradients[a.id];let it=Ke.texture;if(a.gradientVersion!==Ke.version){let rt=256;if(a.stepInterpolant){const et=t.getSource().maxzoom,ut=Y.canonical.z===et?Math.ceil(1<<l.transform.maxZoom-Y.canonical.z):1;rt=o.clamp(o.nextPowerOfTwo(ce.maxLineLength/o.EXTENT*1024*ut),256,$.maxTextureSize)}Ke.gradient=o.renderColorRamp({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:rt,image:Ke.gradient||void 0,clips:ce.lineClipsArray}),Ke.texture?Ke.texture.update(Ke.gradient):Ke.texture=new o.Texture($,Ke.gradient,J.RGBA),Ke.version=a.gradientVersion,it=Ke.texture}$.activeTexture.set(J.TEXTURE1),it.bind(a.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}C&&($.activeTexture.set(J.TEXTURE0),ee.lineAtlasTexture.bind(J.LINEAR,J.REPEAT),Ie.updatePaintBuffers(G)),U&&($.activeTexture.set(J.TEXTURE0),ee.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Ie.updatePaintBuffers(G)),l.prepareDrawProgram($,Ae,Y.toUnwrapped());const ft=Ke=>{Ae.draw($,J.TRIANGLES,y,Ke,v,o.CullFaceMode.disabled,De,a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,a.paint,l.transform.zoom,Ie,ce.layoutVertexBuffer2)};if(ne){const Ke=l.stencilModeForClipping(Y).ref;Ke===0&&l.terrain&&$.clear({stencil:0});const it={func:J.EQUAL,mask:255};De.u_alpha_discard_threshold=.8,ft(new o.StencilMode(it,Ke,255,J.KEEP,J.KEEP,J.INVERT)),De.u_alpha_discard_threshold=0,ft(new o.StencilMode(it,Ke,255,J.KEEP,J.KEEP,J.KEEP))}else ft(l.stencilModeForClipping(Y))}ne&&(l.resetStencilClippingMasks(),l.terrain&&$.clear({stencil:0}))},fill:function(l,t,a,u){const p=a.paint.get("fill-color"),f=a.paint.get("fill-opacity");if(f.constantOr(1)===0)return;const y=l.colorModeForRenderPass(),v=a.paint.get("fill-pattern"),w=l.opaquePassEnabledForLayer()&&!v.constantOr(1)&&p.constantOr(o.Color.transparent).a===1&&f.constantOr(0)===1?"opaque":"translucent";if(l.renderPass===w){const A=l.depthModeForSublayer(1,l.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);X1(l,t,a,u,A,y,!1)}if(l.renderPass==="translucent"&&a.paint.get("fill-antialias")){const A=l.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);X1(l,t,a,u,A,y,!0)}},"fill-extrusion":function(l,t,a,u){const p=a.paint.get("fill-extrusion-opacity");if(p!==0&&l.renderPass==="translucent"){const f=new o.DepthMode(l.context.gl.LEQUAL,o.DepthMode.ReadWrite,l.depthRangeFor3D);if(p!==1||a.paint.get("fill-extrusion-pattern").constantOr(1))Ds(l,t,a,u,f,o.StencilMode.disabled,o.ColorMode.disabled),Ds(l,t,a,u,f,l.stencilModeFor3D(),l.colorModeForRenderPass()),l.resetStencilClippingMasks();else{const y=l.colorModeForRenderPass();Ds(l,t,a,u,f,o.StencilMode.disabled,y)}}},hillshade:function(l,t,a,u){if(l.renderPass!=="offscreen"&&l.renderPass!=="translucent")return;const p=l.context,f=l.depthModeForSublayer(0,o.DepthMode.ReadOnly),y=l.colorModeForRenderPass(),v=l.terrain&&l.terrain.renderingToTexture,[w,A]=l.renderPass!=="translucent"||v?[{},u]:l.stencilConfigForOverlap(u);for(const C of A){const P=t.getTile(C);if(P.needsHillshadePrepare&&l.renderPass==="offscreen")Ts(l,P,a,f,o.StencilMode.disabled,y);else if(l.renderPass==="translucent"){const O=v&&l.terrain?l.terrain.stencilModeForRTTOverlap(C):w[C.overscaledZ];ic(l,C,P,a,f,O,y)}}p.viewport.set([0,0,l.width,l.height]),l.resetStencilClippingMasks()},raster:function(l,t,a,u,p,f){if(l.renderPass!=="translucent"||a.paint.get("raster-opacity")===0||!u.length)return;const y=l.context,v=y.gl,w=t.getSource(),A=l.useProgram("raster"),C=l.colorModeForRenderPass(),P=l.terrain&&l.terrain.renderingToTexture,[O,U]=w instanceof _e||P?[{},u]:l.stencilConfigForOverlap(u),j=U[U.length-1].overscaledZ,G=!l.options.moving;for(const Q of U){const $=P?o.DepthMode.disabled:l.depthModeForSublayer(Q.overscaledZ-j,a.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,v.LESS),J=Q.toUnwrapped(),V=t.getTile(Q);if(P&&(!V||!V.hasData()))continue;const ne=P?Q.projMatrix:l.transform.calculateProjMatrix(J,G),Y=l.terrain&&P?l.terrain.stencilModeForRTTOverlap(Q):O[Q.overscaledZ],ee=f?0:a.paint.get("raster-fade-duration");V.registerFadeDuration(ee);const ce=t.findLoadedParent(Q,0),Ie=R1(V,ce,t,l.transform,ee);let Ae,we;l.terrain&&l.terrain.prepareDrawTile();const Ze=a.paint.get("raster-resampling")==="nearest"?v.NEAREST:v.LINEAR;y.activeTexture.set(v.TEXTURE0),V.texture.bind(Ze,v.CLAMP_TO_EDGE),y.activeTexture.set(v.TEXTURE1),ce?(ce.texture.bind(Ze,v.CLAMP_TO_EDGE),Ae=Math.pow(2,ce.tileID.overscaledZ-V.tileID.overscaledZ),we=[V.tileID.canonical.x*Ae%1,V.tileID.canonical.y*Ae%1]):V.texture.bind(Ze,v.CLAMP_TO_EDGE);const re=d3(ne,we||[0,0],Ae||1,Ie,a,w instanceof _e?w.perspectiveTransform:[0,0]);if(l.prepareDrawProgram(y,A,J),w instanceof _e)w.boundsBuffer&&w.boundsSegments&&A.draw(y,v.TRIANGLES,$,o.StencilMode.disabled,C,o.CullFaceMode.disabled,re,a.id,w.boundsBuffer,l.quadTriangleIndexBuffer,w.boundsSegments);else{const{tileBoundsBuffer:ye,tileBoundsIndexBuffer:Le,tileBoundsSegments:tt}=l.getTileBoundsBuffers(V);A.draw(y,v.TRIANGLES,$,Y,C,o.CullFaceMode.disabled,re,a.id,ye,Le,tt)}}l.resetStencilClippingMasks()},background:function(l,t,a,u){const p=a.paint.get("background-color"),f=a.paint.get("background-opacity");if(f===0)return;const y=l.context,v=y.gl,w=l.transform,A=w.tileSize,C=a.paint.get("background-pattern");if(l.isPatternMissing(C))return;const P=!C&&p.a===1&&f===1&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass!==P)return;const O=o.StencilMode.disabled,U=l.depthModeForSublayer(0,P==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),j=l.colorModeForRenderPass(),G=l.useProgram(C?"backgroundPattern":"background");let Q,$=u;$||(Q=l.getBackgroundTiles(),$=Object.values(Q).map(V=>V.tileID)),C&&(y.activeTexture.set(v.TEXTURE0),l.imageManager.bind(l.context));const J=a.getCrossfadeParameters();for(const V of $){const ne=V.toUnwrapped(),Y=u?V.projMatrix:l.transform.calculateProjMatrix(ne);l.prepareDrawTile();const ee=t?t.getTile(V):Q?Q[V.key]:new o.Tile(V,A,w.zoom,l),ce=C?Vo(Y,f,l,C,{tileID:V,tileSize:A},J):hc(Y,f,p);l.prepareDrawProgram(y,G,ne);const{tileBoundsBuffer:Ie,tileBoundsIndexBuffer:Ae,tileBoundsSegments:we}=l.getTileBoundsBuffers(ee);G.draw(y,v.TRIANGLES,U,O,j,o.CullFaceMode.disabled,ce,a.id,Ie,Ae,we)}},sky:function(l,t,a){const u=l.transform,p=u.projection.name==="mercator"||u.projection.name==="globe"?1:o.smoothstep(7,8,u.zoom),f=a.paint.get("sky-opacity")*p;if(f===0)return;const y=l.context,v=a.paint.get("sky-type"),w=new o.DepthMode(y.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),A=l.frameCounter/1e3%1;v==="atmosphere"?l.renderPass==="offscreen"?a.needsSkyboxCapture(l)&&(function(C,P,O,U){const j=C.context,G=j.gl;let Q=P.skyboxFbo;if(!Q){Q=P.skyboxFbo=j.createFramebuffer(32,32,!1),P.skyboxGeometry=new mc(j),P.skyboxTexture=j.gl.createTexture(),G.bindTexture(G.TEXTURE_CUBE_MAP,P.skyboxTexture),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR);for(let ne=0;ne<6;++ne)G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+ne,0,G.RGBA,32,32,0,G.RGBA,G.UNSIGNED_BYTE,null)}j.bindFramebuffer.set(Q.framebuffer),j.viewport.set([0,0,32,32]);const $=P.getCenter(C,!0),J=C.useProgram("skyboxCapture"),V=new Float64Array(16);o.identity(V),o.rotateY(V,V,.5*-Math.PI),Zo(j,P,J,V,$,0),o.identity(V),o.rotateY(V,V,.5*Math.PI),Zo(j,P,J,V,$,1),o.identity(V),o.rotateX(V,V,.5*-Math.PI),Zo(j,P,J,V,$,2),o.identity(V),o.rotateX(V,V,.5*Math.PI),Zo(j,P,J,V,$,3),o.identity(V),Zo(j,P,J,V,$,4),o.identity(V),o.rotateY(V,V,Math.PI),Zo(j,P,J,V,$,5),j.viewport.set([0,0,C.width,C.height])}(l,a),a.markSkyboxValid(l)):l.renderPass==="sky"&&function(C,P,O,U,j){const G=C.context,Q=G.gl,$=C.transform,J=C.useProgram("skybox");G.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_CUBE_MAP,P.skyboxTexture);const V=((ne,Y,ee,ce,Ie)=>({u_matrix:ne,u_sun_direction:Y,u_cubemap:0,u_opacity:ce,u_temporal_offset:Ie}))($.skyboxMatrix,P.getCenter(C,!1),0,U,j);C.prepareDrawProgram(G,J),J.draw(G,Q.TRIANGLES,O,o.StencilMode.disabled,C.colorModeForRenderPass(),o.CullFaceMode.backCW,V,"skybox",P.skyboxGeometry.vertexBuffer,P.skyboxGeometry.indexBuffer,P.skyboxGeometry.segment)}(l,a,w,f,A):v==="gradient"&&l.renderPass==="sky"&&function(C,P,O,U,j){const G=C.context,Q=G.gl,$=C.transform,J=C.useProgram("skyboxGradient");P.skyboxGeometry||(P.skyboxGeometry=new mc(G)),G.activeTexture.set(Q.TEXTURE0);let V=P.colorRampTexture;V||(V=P.colorRampTexture=new o.Texture(G,P.colorRamp,Q.RGBA)),V.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const ne=((Y,ee,ce,Ie,Ae)=>({u_matrix:Y,u_color_ramp:0,u_center_direction:ee,u_radius:o.degToRad(ce),u_opacity:Ie,u_temporal_offset:Ae}))($.skyboxMatrix,P.getCenter(C,!1),P.paint.get("sky-gradient-radius"),U,j);C.prepareDrawProgram(G,J),J.draw(G,Q.TRIANGLES,O,o.StencilMode.disabled,C.colorModeForRenderPass(),o.CullFaceMode.backCW,ne,"skyboxGradient",P.skyboxGeometry.vertexBuffer,P.skyboxGeometry.indexBuffer,P.skyboxGeometry.segment)}(l,a,w,f,A)},debug:function(l,t,a){for(let u=0;u<a.length;u++)Rs(l,t,a[u])},custom:function(l,t,a){const u=l.context,p=a.implementation;if(l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes("custom"))o.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(l.renderPass==="offscreen"){const f=p.prerender;f&&(l.setCustomLayerDefaults(),u.setColorMode(l.colorModeForRenderPass()),f.call(p,u.gl,l.transform.customLayerMatrix()),u.setDirty(),l.setBaseState())}else if(l.renderPass==="translucent"){l.setCustomLayerDefaults(),u.setColorMode(l.colorModeForRenderPass()),u.setStencilMode(o.StencilMode.disabled);const f=p.renderingMode==="3d"?new o.DepthMode(l.context.gl.LEQUAL,o.DepthMode.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,o.DepthMode.ReadOnly);u.setDepthMode(f),p.render(u.gl,l.transform.customLayerMatrix()),u.setDirty(),l.setBaseState(),u.bindFramebuffer.set(null)}}};class Os{constructor(t,a){this.context=new W(t),this.transform=a,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ql,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(t,a){const u=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(u||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new B1(this,t));const p=this._terrain;this.transform.elevation=u?p:null,p.update(t,this.transform,a)}_updateFog(t){const a=t.fog;if(!a||this.transform.projection.name==="globe"||a.getOpacity(this.transform.pitch)<1||a.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[u,p]=a.getFovAdjustedRange(this.transform._fov);if(u>p)return void(this.transform.fogCullDistSq=null);const f=u+.78*(p-u);this.transform.fogCullDistSq=f*f}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,a){if(this.width=t*o.exported.devicePixelRatio,this.height=a*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style.order)this.style._layers[u].resize()}setup(){const t=this.context,a=new o.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(o.EXTENT,0),a.emplaceBack(0,o.EXTENT),a.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(a,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const u=new o.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(o.EXTENT,0),u.emplaceBack(0,o.EXTENT),u.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=t.createVertexBuffer(u,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const p=new o.StructArrayLayout2i4;p.emplaceBack(-1,-1),p.emplaceBack(1,-1),p.emplaceBack(-1,1),p.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(p,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const f=new o.StructArrayLayout4i8;f.emplaceBack(0,0,0,0),f.emplaceBack(o.EXTENT,0,o.EXTENT,0),f.emplaceBack(0,o.EXTENT,0,o.EXTENT),f.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(f,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const y=new o.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(y);const v=new o.StructArrayLayout1ui2;for(const A of[0,1,3,2,0])v.emplaceBack(A);this.debugIndexBuffer=t.createIndexBuffer(v),this.emptyTexture=new o.Texture(t,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=o.create();const w=this.context.gl;this.stencilClearMode=new o.StencilMode({func:w.ALWAYS,mask:0},0,255,w.ZERO,w.ZERO,w.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new y3(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,a.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Ca(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,a,u){if(!a||this.currentStencilSource===a.id||!t.isTileClipped()||!u||u.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let v=!1;for(const w of u)if(this._tileClippingMaskIDs[w.key]===void 0){v=!0;break}if(!v)return}this.currentStencilSource=a.id;const p=this.context,f=p.gl;this.nextStencilID+u.length>256&&this.clearStencil(),p.setColorMode(o.ColorMode.disabled),p.setDepthMode(o.DepthMode.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const v of u){const w=a.getTile(v),A=this._tileClippingMaskIDs[v.key]=this.nextStencilID++,{tileBoundsBuffer:C,tileBoundsIndexBuffer:P,tileBoundsSegments:O}=this.getTileBoundsBuffers(w);y.draw(p,f.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:f.ALWAYS,mask:0},A,255,f.KEEP,f.KEEP,f.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Ca(v.projMatrix),"$clipping",C,P,O)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new o.StencilMode({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const a=this.context.gl;return new o.StencilMode({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,u=t.sort((y,v)=>v.overscaledZ-y.overscaledZ),p=u[u.length-1].overscaledZ,f=u[0].overscaledZ-p+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const y={};for(let v=0;v<f;v++)y[v+p]=new o.StencilMode({func:a.GEQUAL,mask:255},v+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=f,[y,u]}return[{[p]:o.StencilMode.disabled},u]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([t.CONSTANT_COLOR,t.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(t,a,u){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new o.DepthMode(u||this.context.gl.LEQUAL,a,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const u=this.style.order,p=this.style._sourceCaches;for(const w in p){const A=p[w];A.used&&A.prepare(this.context)}const f={},y={},v={};for(const w in p){const A=p[w];f[w]=A.getVisibleCoordinates(),y[w]=f[w].slice().reverse(),v[w]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let w=0;w<u.length;w++)if(this.style._layers[u[w]].is3D()){this.opaquePassCutoff=w;break}if(this.terrain&&(this.terrain.updateTileBinding(v),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),o.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const w of u){const A=this.style._layers[w],C=t._getLayerSourceCache(A);if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const P=C?y[C.id]:void 0;(A.type==="custom"||A.isSky()||P&&P.length)&&this.renderLayer(this,C,A,P)}if(this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:a.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const w=this.style._layers[u[this.currentLayer]],A=t._getLayerSourceCache(w);if(w.isSky())continue;const C=A?y[A.id]:void 0;this._renderTileClippingMasks(w,A,C),this.renderLayer(this,A,w,C)}if(this.style.fog&&this.transform.projection.supportsFog&&function(w,A){const C=w.context,P=C.gl,O=w.transform,U=new o.DepthMode(P.LEQUAL,o.DepthMode.ReadOnly,[0,1]),j=w.useProgram("globeAtmosphere",null,O.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),G=o.globeToMercatorTransition(O.zoom),Q=A.properties.get("color").toArray01(),$=A.properties.get("high-color").toArray01(),J=A.properties.get("space-color").toArray01PremultipliedAlpha(),V=o.identity$1([]);o.rotateY$1(V,V,-o.degToRad(O._center.lng)),o.rotateX$1(V,V,o.degToRad(O._center.lat)),o.rotateZ$1(V,V,O.angle),o.rotateX$1(V,V,-O._pitch);const ne=o.fromQuat(new Float32Array(16),V),Y=o.mapValue(A.properties.get("star-intensity"),0,1,0,.25),ee=5e-4,ce=o.mapValue(A.properties.get("horizon-blend"),0,1,ee,.25),Ie=o.globeUseCustomAntiAliasing(w,C,O)&&ce===ee?O.worldSize/(2*Math.PI*1.025)-1:O.globeRadius,Ae=w.frameCounter/1e3%1,we=o.length(O.globeCenterInViewSpace),Ze=Math.sqrt(Math.pow(we,2)-Math.pow(Ie,2)),re=Math.acos(Ze/we),ye=((tt,De,ft,Ke,it,rt,et,ut,Ct,Dt,vt,Pt,ci,_i)=>({u_frustum_tl:tt,u_frustum_tr:De,u_frustum_br:ft,u_frustum_bl:Ke,u_horizon:it,u_transition:rt,u_fadeout_range:et,u_color:ut,u_high_color:Ct,u_space_color:Dt,u_star_intensity:vt,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Pt,u_horizon_angle:ci,u_rotation_matrix:_i}))(O.frustumCorners.TL,O.frustumCorners.TR,O.frustumCorners.BR,O.frustumCorners.BL,O.frustumCorners.horizon,G,ce,Q,$,J,Y,Ae,re,ne);w.prepareDrawProgram(C,j);const Le=w.atmosphereBuffer;Le&&j.draw(C,P.TRIANGLES,U,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,ye,"skybox",Le.vertexBuffer,Le.indexBuffer,Le.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const w=this.style._layers[u[this.currentLayer]],A=t._getLayerSourceCache(w);w.isSky()&&this.renderLayer(this,A,w,A?y[A.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;){const w=this.style._layers[u[this.currentLayer]],A=t._getLayerSourceCache(w);if(w.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(w)){if(w.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const C=A?(w.type==="symbol"?v:y)[A.id]:void 0;this._renderTileClippingMasks(w,A,A?f[A.id]:void 0),this.renderLayer(this,A,w,C),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let w=null;o.values(this.style._layers).forEach(A=>{const C=t._getLayerSourceCache(A);C&&!A.isHidden(this.transform.zoom)&&(!w||w.getSource().maxzoom<C.getSource().maxzoom)&&(w=C)}),w&&this.options.showTileBoundaries&&Bs.debug(this,w,w.getVisibleCoordinates())}this.options.showPadding&&function(w){const A=w.transform.padding;H1(w,w.transform.height-(A.top||0),3,po),H1(w,A.bottom||0,3,La),Ls(w,A.left||0,3,fc),Ls(w,w.transform.width-(A.right||0),3,jo);const C=w.transform.centerPoint;(function(P,O,U,j){Kt(P,O-1,U-10,2,20,j),Kt(P,O-10,U-1,20,2,j)})(w,C.x,w.transform.height-C.y,$o)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}}renderLayer(t,a,u,p){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="sky"||u.type==="custom"||p&&p.length)&&(this.id=u.id,this.gpuTimingStart(u),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(u.type)||Bs[u.type](t,a,u,p,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),u.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,u.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,a=t.createQueryEXT();this.deferredRenderGpuTimeQueries.push(a),t.beginQueryEXT(t.TIME_ELAPSED_EXT,a)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const a={};for(const u in t){const p=t[u],f=this.context.extTimerQuery,y=f.getQueryObjectEXT(p.query,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(p.query),a[u]=y}return a}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const a=this.context.extTimerQuery;let u=0;for(const p of t)u+=a.getQueryObjectEXT(p,a.QUERY_RESULT_EXT)/1e6,a.deleteQueryEXT(p);return u}translatePosMatrix(t,a,u,p,f){if(!u[0]&&!u[1])return t;const y=f?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(y){const A=Math.sin(y),C=Math.cos(y);u=[u[0]*C-u[1]*A,u[0]*A+u[1]*C]}const v=[f?u[0]:Ht(a,u[0],this.transform.zoom),f?u[1]:Ht(a,u[1],this.transform.zoom),0],w=new Float32Array(16);return o.translate(w,t,v),w}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),u=this.imageManager.getPattern(t.to.toString());return!a||!u}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,a=this.style&&this.style.fog,u=[];return this.terrain&&!this.terrain.renderingToTexture&&u.push("TERRAIN"),a&&!t&&a.getOpacity(this.transform.pitch)!==0&&u.push("FOG"),t&&u.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&u.push("OVERDRAW_INSPECTOR"),u}useProgram(t,a,u){this.cache=this.cache||{};const p=u||[],f=this.currentGlobalDefines().concat(p),y=ks.cacheKey(t,f,a);return this.cache[y]||(this.cache[y]=new ks(this.context,t,bs[t],a,f3[t],f)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,a,u){if(this.terrain&&this.terrain.renderingToTexture)return;const p=this.style.fog;if(p){const f=p.getOpacity(this.transform.pitch),y=((v,w,A,C,P,O,U,j,G,Q,$)=>{const J=v.transform,V=w.properties.get("color").toArray01();V[3]=C;const ne=v.frameCounter/1e3%1;return{u_fog_matrix:A?J.calculateFogTileMatrix(A):v.identityMat,u_fog_range:w.getFovAdjustedRange(J._fov),u_fog_color:V,u_fog_horizon_blend:w.properties.get("horizon-blend"),u_fog_temporal_offset:ne,u_frustum_tl:P,u_frustum_tr:O,u_frustum_br:U,u_frustum_bl:j,u_globe_pos:G,u_globe_radius:Q,u_viewport:$,u_globe_transition:o.globeToMercatorTransition(J.zoom),u_is_globe:+(J.projection.name==="globe")}})(this,p,u,f,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);a.setFogUniformValues(t,y)}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),a}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,a=this._backgroundTiles={},u=this.transform.coveringTiles({tileSize:512});for(const p of u)a[p.key]=t[p.key]||new o.Tile(p,512,this.transform.tileZoom,this);return a}clearBackgroundTiles(){this._backgroundTiles={}}}class fo{constructor(t=0,a=0,u=0,p=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(u)||u<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=u,this.right=p}interpolate(t,a,u){return a.top!=null&&t.top!=null&&(this.top=o.number(t.top,a.top,u)),a.bottom!=null&&t.bottom!=null&&(this.bottom=o.number(t.bottom,a.bottom,u)),a.left!=null&&t.left!=null&&(this.left=o.number(t.left,a.left,u)),a.right!=null&&t.right!=null&&(this.right=o.number(t.right,a.right,u)),this}getCenter(t,a){const u=o.clamp((this.left+t-this.right)/2,0,t),p=o.clamp((this.top+a-this.bottom)/2,0,a);return new o.pointGeometry(u,p)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new fo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fs(l,t){const a=o.getColumn(l,3);o.fromQuat(l,t),o.setColumn(l,3,a)}function Ra(l,t){const a=o.identity$1([]);return o.rotateZ$1(a,a,-t),o.rotateX$1(a,a,-l),a}function Ns(l,t){const a=[l[0],l[1],0],u=[t[0],t[1],0];if(o.length(a)>=1e-15){const y=o.normalize([],a);o.scale$2(u,y,o.dot(u,y)),t[0]=u[0],t[1]=u[1]}const p=o.cross([],t,l);if(o.len(p)<1e-15)return null;const f=Math.atan2(-p[1],p[0]);return Ra(Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2]),f)}class Ba{constructor(t,a){this.position=t,this.orientation=a}get position(){return this._position}set position(t){if(t){const a=t instanceof o.MercatorCoordinate?t:new o.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(a.x=o.wrap(a.x,0,1)),this._position=a}else this._position=null}lookAtPoint(t,a){if(this.orientation=null,!this.position)return;const u=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(t)):0,p=this.position,f=o.MercatorCoordinate.fromLngLat(t,u),y=[f.x-p.x,f.y-p.y,f.z-p.z];a||(a=[0,0,1]),a[2]=Math.abs(a[2]),this.orientation=Ns(y,a)}setPitchBearing(t,a){this.orientation=Ra(o.degToRad(t),o.degToRad(-a))}}class qo{constructor(t,a){this._transform=o.identity([]),this.orientation=a,this.position=t}get mercatorPosition(){const t=this.position;return new o.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=o.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var a;t&&o.setColumn(this._transform,3,[(a=t)[0],a[1],a[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||o.identity$1([]),t&&Fs(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),a=this.right();return{bearing:Math.atan2(-a[1],a[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,a){this._orientation=Ra(t,a),Fs(this._transform,this._orientation)}forward(){const t=o.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=o.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=o.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,a){const u=new Float64Array(16);return o.invert(u,this.getWorldToCamera(t,a)),u}getWorldToCameraPosition(t,a,u){const p=this.position;o.scale$2(p,p,-t);const f=new Float64Array(16);return o.fromScaling(f,[u,u,u]),o.translate(f,f,p),f[10]*=a,f}getWorldToCamera(t,a){const u=new Float64Array(16),p=new Float64Array(4),f=this.position;return o.conjugate(p,this._orientation),o.scale$2(f,f,-t),o.fromQuat(u,p),o.translate(u,u,f),u[1]*=-1,u[5]*=-1,u[9]*=-1,u[13]*=-1,u[8]*=a,u[9]*=a,u[10]*=a,u[11]*=a,u}getCameraToClipPerspective(t,a,u,p){const f=new Float64Array(16);return o.perspective(f,t,a,u,p),f}getDistanceToElevation(t){const a=t===0?0:o.mercatorZfromAltitude(t,this.position[1]),u=this.forward();return(a-this.position[2])/u[2]}clone(){return new qo([...this.position],[...this.orientation])}}function lt(l,t){const a=Oa(l.projection,l.zoom,l.width,l.height),u=function(f,y,v,w,A){const C=new o.LngLat(v.lng-180*_o,v.lat),P=new o.LngLat(v.lng+180*_o,v.lat),O=f.project(C.lng,C.lat),U=f.project(P.lng,P.lat),j=-Math.atan2(U.y-O.y,U.x-O.x),G=o.MercatorCoordinate.fromLngLat(v);G.y=o.clamp(G.y,-.999975,.999975);const Q=G.toLngLat(),$=f.project(Q.lng,Q.lat),J=o.MercatorCoordinate.fromLngLat(Q);J.x+=_o;const V=J.toLngLat(),ne=f.project(V.lng,V.lat),Y=mo(ne.x-$.x,ne.y-$.y,j),ee=o.MercatorCoordinate.fromLngLat(Q);ee.y+=_o;const ce=ee.toLngLat(),Ie=f.project(ce.lng,ce.lat),Ae=mo(Ie.x-$.x,Ie.y-$.y,j),we=Math.abs(Y.x)/Math.abs(Ae.y),Ze=o.identity([]);o.rotateZ(Ze,Ze,-j*(1-(A?0:w)));const re=o.identity([]);return o.scale(re,re,[1,1-(1-we)*w,1]),re[4]=-Ae.x/Ae.y*w,o.rotateZ(re,re,j),o.multiply(re,Ze,re),re}(l.projection,0,l.center,a,t),p=qr(l);return o.scale(u,u,[p,p,1]),u}function qr(l){const t=l.projection,a=Oa(l.projection,l.zoom,l.width,l.height),u=Y1(t,l.center),p=Y1(t,o.LngLat.convert(t.center));return Math.pow(2,u*a+(1-a)*p)}function Oa(l,t,a,u,p=1/0){const f=l.range;if(!f)return 0;const y=Math.min(p,Math.max(a,u)),v=Math.log(y/1024)/Math.LN2;return o.smoothstep(f[0]+v,f[1]+v,t)}const _o=1/4e4;function Y1(l,t){const a=o.clamp(t.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),u=new o.LngLat(t.lng-180*_o,a),p=new o.LngLat(t.lng+180*_o,a),f=l.project(u.lng,a),y=l.project(p.lng,a),v=o.MercatorCoordinate.fromLngLat(u),w=o.MercatorCoordinate.fromLngLat(p),A=y.x-f.x,C=y.y-f.y,P=w.x-v.x,O=w.y-v.y,U=Math.sqrt((P*P+O*O)/(A*A+C*C));return Math.log(U)/Math.LN2}function mo(l,t,a){const u=Math.cos(a),p=Math.sin(a);return{x:l*u-t*p,y:l*p+t*u}}class Gs{constructor(t,a,u,p,f,y,v){this.tileSize=512,this._renderWorldCopies=f===void 0||f,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=u==null?0:u,this._maxPitch=p==null?60:p,this.setProjection(y),this.setMaxBounds(v),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new fo,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new qo,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const t=new Gs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){const a=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||a)&&this._updateCameraOnTerrain(),(t||a)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const a=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const u=!Z(a,this.getProjection());return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const a=-t*Math.PI/180;var u;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=(u=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u),function(p,f,y){var v=f[0],w=f[1],A=f[2],C=f[3],P=Math.sin(y),O=Math.cos(y);p[0]=v*O+A*P,p[1]=w*O+C*P,p[2]=v*-P+A*O,p[3]=w*-P+C*O}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=o.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._setZoom(a),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,a=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],u=this.horizonLineFromTop();let p=0,f=0;for(let y=0;y<a.length;y++){const v=new o.pointGeometry(a[y][0]*this.width,u+a[y][1]*(this.height-u)),w=t.pointCoordinate(v);if(!w)continue;const A=1/Math.hypot(w[0]-this._camera.position[0],w[1]-this._camera.position[1]);p+=w[3]*A,f+=A}return f===0?NaN:p/f}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,a=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),u=this.pixelsPerMeter/this.worldSize*a,p=this._mercatorZfromZoom(t),f=this._mercatorZfromZoom(this._maxZoom),y=Math.max(p-u,f);this._setZoom(this._zoomFromMercatorZ(y))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const a=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let u;u=t.z<this._camera.position[2]?[a.x,a.y,a.z]:[t.x,t.y,t.z];const p=o.length(o.sub([],this._camera.position,u));return o.clamp(this._zoomFromMercatorZ(p),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let a=!1;if(t.orientation&&!o.exactEquals(t.orientation,this._camera.orientation)&&(a=this._setCameraOrientation(t.orientation)),t.position){const u=[t.position.x,t.position.y,t.position.z];o.exactEquals$1(u,this._camera.position)||(this._setCameraPosition(u),a=!0)}a&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,a=new Ba;return a.position=new o.MercatorCoordinate(t[0],t[1],t[2]),a.orientation=this._camera.orientation,a._elevation=this.elevation,a._renderWorldCopies=this.renderWorldCopies,a}_setCameraOrientation(t){if(!o.length$1(t))return!1;o.normalize$1(t,t);const a=o.transformQuat([],[0,0,-1],t),u=o.transformQuat([],[0,-1,0],t);if(u[2]<0)return!1;const p=Ns(a,u);return!!p&&(this._camera.orientation=p,!0)}_setCameraPosition(t){const a=this.zoomScale(this.minZoom)*this.tileSize,u=this.zoomScale(this.maxZoom)*this.tileSize,p=this.cameraToCenterDistance;t[2]=o.clamp(t[2],p/u,p/a),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,u){this._unmodified=!1,this._edgeInsets.interpolate(t,a,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new o.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const u=this.pointCoordinate(new o.pointGeometry(0,0)),p=this.pointCoordinate(new o.pointGeometry(this.width,0)),f=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),y=this.pointCoordinate(new o.pointGeometry(0,this.height)),v=Math.floor(Math.min(u.x,p.x,f.x,y.x)),w=Math.floor(Math.max(u.x,p.x,f.x,y.x)),A=1;for(let C=v-A;C<=w+A;C++)C!==0&&a.push(new o.UnwrappedTileID(C,t))}return a}coveringTiles(t){let a=this.coveringZoomLevel(t);const u=a,p=this.elevation&&!t.isTerrainDEM,f=this.projection.name==="mercator";if(t.minzoom!==void 0&&a<t.minzoom)return[];t.maxzoom!==void 0&&a>t.maxzoom&&(a=t.maxzoom);const y=this.locationCoordinate(this.center),v=this.center.lat,w=1<<a,A=[w*y.x,w*y.y,0],C=this.projection.name==="globe",P=!C,O=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,P),U=C?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),j=w*o.mercatorZfromAltitude(1,this.center.lat),G=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),Q=[w*U.x,w*U.y,G*(P?1:j)],$=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),J=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?a:0,V=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ne=t.isTerrainDEM?-V:this._elevation?this._elevation.getMinElevationBelowMSL():0,Y=this.projection.isReprojectedInTileSpace?qr(this):1,ee=De=>{const Ke=new o.MercatorCoordinate(De.x+25e-6,De.y,De.z),it=new o.MercatorCoordinate(De.x,De.y+25e-6,De.z),rt=De.toLngLat(),et=Ke.toLngLat(),ut=it.toLngLat(),Ct=this.locationCoordinate(rt),Dt=this.locationCoordinate(et),vt=this.locationCoordinate(ut),Pt=Math.hypot(Dt.x-Ct.x,Dt.y-Ct.y),ci=Math.hypot(vt.x-Ct.x,vt.y-Ct.y);return Math.sqrt(Pt*ci)*Y/25e-6},ce=De=>{const ft=V,Ke=ne;return{aabb:o.tileAABB(this,w,0,0,0,De,Ke,ft,this.projection),zoom:0,x:0,y:0,minZ:Ke,maxZ:ft,wrap:De,fullyVisible:!1}},Ie=[];let Ae=[];const we=a,Ze=t.reparseOverscaled?u:a,re=De=>De*De,ye=re((G-this._centerAltitude)*j),Le=De=>{if(!this._elevation||!De.tileID||!f)return;const ft=this._elevation.getMinMaxForTile(De.tileID),Ke=De.aabb;ft?(Ke.min[2]=ft.min,Ke.max[2]=ft.max,Ke.center[2]=(Ke.min[2]+Ke.max[2])/2):(De.shouldSplit=tt(De),De.shouldSplit||(Ke.min[2]=Ke.max[2]=Ke.center[2]=this._centerAltitude))},tt=De=>{if(De.zoom<J)return!0;if(De.zoom===we)return!1;if(De.shouldSplit!=null)return De.shouldSplit;const ft=De.aabb.distanceX(Q),Ke=De.aabb.distanceY(Q);let it=ye,rt=1;if(C){it=re(De.aabb.distanceZ(Q));const ut=Math.pow(2,De.zoom),Ct=o.latFromMercatorY((De.y+1)/ut),Dt=o.latFromMercatorY(De.y/ut),vt=Math.min(Math.max(v,Ct),Dt),Pt=o.circumferenceAtLatitude(vt)/o.circumferenceAtLatitude(v);if(rt=vt===v?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Pt/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&De.zoom===we-1&&Pt>=.9)return!0}else if(p&&(it=re(De.aabb.distanceZ(Q)*j)),this.projection.isReprojectedInTileSpace&&u<=5){const ut=Math.pow(2,De.zoom),Ct=ee(new o.MercatorCoordinate((De.x+.5)/ut,(De.y+.5)/ut));rt=Ct>.85?1:Ct}const et=ft*ft+Ke*Ke+it;return et<re((1<<we-De.zoom)*$*rt*((ut,Ct)=>{if(Ct*re(.707)<ut)return 1;const Dt=Math.sqrt(Ct/ut);return Dt/(1.4144271570014144+(Math.pow(1.1,Dt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(it,ye),et))};if(this.renderWorldCopies)for(let De=1;De<=3;De++)Ie.push(ce(-De)),Ie.push(ce(De));for(Ie.push(ce(0));Ie.length>0;){const De=Ie.pop(),ft=De.x,Ke=De.y;let it=De.fullyVisible;if(!it){const rt=De.aabb.intersects(O);if(rt===0)continue;it=rt===2}if(De.zoom!==we&&tt(De))for(let rt=0;rt<4;rt++){const et=(ft<<1)+rt%2,ut=(Ke<<1)+(rt>>1),Ct={aabb:f?De.aabb.quadrant(rt):o.tileAABB(this,w,De.zoom+1,et,ut,De.wrap,De.minZ,De.maxZ,this.projection),zoom:De.zoom+1,x:et,y:ut,wrap:De.wrap,fullyVisible:it,tileID:void 0,shouldSplit:void 0,minZ:De.minZ,maxZ:De.maxZ};p&&!C&&(Ct.tileID=new o.OverscaledTileID(De.zoom+1===we?Ze:De.zoom+1,De.wrap,De.zoom+1,et,ut),Le(Ct)),Ie.push(Ct)}else{const rt=De.zoom===we?Ze:De.zoom;if(t.minzoom&&t.minzoom>rt)continue;const et=A[0]-(.5+ft+(De.wrap<<De.zoom))*(1<<a-De.zoom),ut=A[1]-.5-Ke,Ct=De.tileID?De.tileID:new o.OverscaledTileID(rt,De.wrap,De.zoom,ft,Ke);Ae.push({tileID:Ct,distanceSq:et*et+ut*ut})}}if(this.fogCullDistSq){const De=this.fogCullDistSq,ft=this.horizonLineFromTop();Ae=Ae.filter(Ke=>{const it=[0,0,0,1],rt=[o.EXTENT,o.EXTENT,0,1],et=this.calculateFogTileMatrix(Ke.tileID.toUnwrapped());o.transformMat4$1(it,it,et),o.transformMat4$1(rt,rt,et);const ut=o.getAABBPointSquareDist(it,rt);if(ut===0)return!0;let Ct=!1;const Dt=this._elevation;if(Dt&&ut>De&&ft!==0){const vt=this.calculateProjMatrix(Ke.tileID.toUnwrapped());let Pt;t.isTerrainDEM||(Pt=Dt.getMinMaxForTile(Ke.tileID)),Pt||(Pt={min:ne,max:V});const ci=o.furthestTileCorner(this.rotation),_i=[ci[0]*o.EXTENT,ci[1]*o.EXTENT,Pt.max];o.transformMat4(_i,_i,vt),Ct=(1-_i[1])*this.height*.5<ft}return ut<De||Ct})}return Ae.sort((De,ft)=>De.distanceSq-ft.distanceSq).map(De=>De.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=o.clamp(t.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),u=this.projection.project(t.lng,a);return new o.pointGeometry(u.x*this.worldSize,u.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(t,a){let u,p;const f=this.centerPoint;if(this.projection.name==="globe"){const v=this.worldSize;u=(a.x-f.x)/v,p=(a.y-f.y)/v}else{const v=this.pointCoordinate(a),w=this.pointCoordinate(f);u=v.x-w.x,p=v.y-w.y}const y=this.locationCoordinate(t);this.setLocation(new o.MercatorCoordinate(y.x-u,y.y-p))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,a){const u=a?o.mercatorZfromAltitude(a,t.lat):void 0,p=this.projection.project(t.lng,t.lat);return new o.MercatorCoordinate(p.x,p.y,u)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,a){const u=a!=null?a:this._centerAltitude,p=[t.x,t.y,0,1],f=[t.x,t.y,1,1];o.transformMat4$1(p,p,this.pixelMatrixInverse),o.transformMat4$1(f,f,this.pixelMatrixInverse);const y=f[3];o.scale$1(p,p,1/p[3]),o.scale$1(f,f,1/y);const v=p[2],w=f[2];return{p0:p,p1:f,t:v===w?0:(u-v)/(w-v)}}screenPointToMercatorRay(t){const a=[t.x,t.y,0,1],u=[t.x,t.y,1,1];return o.transformMat4$1(a,a,this.pixelMatrixInverse),o.transformMat4$1(u,u,this.pixelMatrixInverse),o.scale$1(a,a,1/a[3]),o.scale$1(u,u,1/u[3]),a[2]=o.mercatorZfromAltitude(a[2],this._center.lat)*this.worldSize,u[2]=o.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,o.scale$1(a,a,1/this.worldSize),o.scale$1(u,u,1/this.worldSize),new o.Ray([a[0],a[1],a[2]],o.normalize([],o.sub([],u,a)))}rayIntersectionCoordinate(t){const{p0:a,p1:u,t:p}=t,f=o.mercatorZfromAltitude(a[2],this._center.lat),y=o.mercatorZfromAltitude(u[2],this._center.lat);return new o.MercatorCoordinate(o.number(a[0],u[0],p)/this.worldSize,o.number(a[1],u[1],p)/this.worldSize,o.number(f,y,p))}pointCoordinate(t,a=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,a)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let a=this.projection.pointCoordinate3D(this,t.x,t.y);if(a)return new o.MercatorCoordinate(a[0],a[1],a[2]);let u=0,p=this.horizonLineFromTop();if(t.y>p)return this.pointCoordinate(t);const f=.02*p,y=t.clone();for(let v=0;v<10&&p-u>f;v++){y.y=o.number(u,p,.66);const w=this.projection.pointCoordinate3D(this,y.x,y.y);w?(p=y.y,a=w):u=y.y}return a?new o.MercatorCoordinate(a[0],a[1],a[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}_coordinatePoint(t,a){const u=a&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,p=[t.x*this.worldSize,t.y*this.worldSize,u+t.toAltitude(),1];return o.transformMat4$1(p,p,this.pixelMatrix),p[3]>0?new o.pointGeometry(p[0]/p[3],p[1]/p[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(t,a){const u=new o.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),p=new o.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),f=new o.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),y=new o.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let v=this.pointCoordinate(u,t),w=this.pointCoordinate(p,t);const A=this.pointCoordinate(f,a),C=this.pointCoordinate(y,a),P=(O,U)=>(U.y-O.y)/(U.x-O.x);return v.y>1&&w.y>=0?v=new o.MercatorCoordinate((1-C.y)/P(C,v)+C.x,1):v.y<0&&w.y<=1&&(v=new o.MercatorCoordinate(-C.y/P(C,v)+C.x,0)),w.y>1&&v.y>=0?w=new o.MercatorCoordinate((1-A.y)/P(A,w)+A.x,1):w.y<0&&v.y<=1&&(w=new o.MercatorCoordinate(-A.y/P(A,w)+A.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(v)).extend(this.coordinateLocation(w)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(A))}_getBounds3D(){const t=this.elevation;if(!t.visibleDemTiles.length)return this._getBounds(0,0);const a=t.visibleDemTiles.reduce((u,p)=>{if(p.dem){const f=p.dem.tree;u.min=Math.min(u.min,f.minimums[0]),u.max=Math.max(u.max,f.maximums[0])}return u},{min:Number.MAX_VALUE,max:0});return this._getBounds(a.min*t.exaggeration(),a.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const a=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,u=this.height/2-a*(1-this._horizonShift);return t?Math.max(0,u):u}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,a){return this.projection.createTileMatrix(this,a,t)}calculateDistanceTileData(t){const a=t.key,u=this._distanceTileDataCache;if(u[a])return u[a];const p=t.canonical,f=1/this.height,y=this.cameraWorldSize/this.zoomScale(p.z),v=(p.x+Math.pow(2,p.z)*t.wrap)*y,w=p.y*y,A=this.point,C=this.angle,P=Math.sin(-C),O=-Math.cos(-C);return u[a]={bearing:[P,O],center:[(A.x-v)*f,(A.y-w)*f],scale:y/o.EXTENT*f},u[a]}calculateFogTileMatrix(t){const a=t.key,u=this._fogTileMatrixCache;if(u[a])return u[a];const p=this.projection.createTileMatrix(this,this.cameraWorldSize,t);return o.multiply(p,this.worldToFogMatrix,p),u[a]=new Float32Array(p),u[a]}calculateProjMatrix(t,a=!1){const u=t.key,p=a?this._alignedProjMatrixCache:this._projMatrixCache;if(p[u])return p[u];const f=this.calculatePosMatrix(t,this.worldSize);return o.multiply(f,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:a?this.alignedProjMatrix:this.projMatrix,f),p[u]=new Float32Array(f),p[u]}calculatePixelsToTileUnitsMatrix(t){const a=t.tileID.key,u=this._pixelsToTileUnitsCache;if(u[a])return u[a];const p=function(f,y){const{scale:v}=f.tileTransform,w=v*o.EXTENT/(f.tileSize*Math.pow(2,y.zoom-f.tileID.overscaledZ+f.tileID.canonical.z));return A=new Float32Array(4),O=(C=y.inverseAdjustmentMatrix)[1],U=C[2],j=C[3],Q=(P=[w,w])[1],A[0]=C[0]*(G=P[0]),A[1]=O*G,A[2]=U*Q,A[3]=j*Q,A;var A,C,P,O,U,j,G,Q}(t,this);return u[a]=p,u[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const a=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(a),p=this._camera.forward(),f=o.mercatorZfromAltitude(1,this._center.lat);u[2]/=f,p[2]/=f,o.normalize(p,p);const y=t.raycast(u,p,t.exaggeration());if(y){const v=o.scaleAndAdd([],u,p,y),w=new o.MercatorCoordinate(v[0],v[1],o.mercatorZfromAltitude(v[2],o.latFromMercatorY(v[1]))),A=(w.z+o.length([w.x-u[0],w.y-u[1],w.z-u[2]*f]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(A),this._centerAltitude=w.toAltitude(),this._center=this.coordinateLocation(w),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const a=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(a),p=t.getAtPointOrZero(new o.MercatorCoordinate(...u)),f=this._minimumHeightOverTerrain()*Math.cos(o.degToRad(this._maxPitch)),y=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*p;if(y<f){const v=this.locationCoordinate(this._center,this._centerAltitude),w=[v.x-u[0],v.y-u[1],v.z-u[2]],A=o.length(w);w[2]-=(f-y)/this._projectionScaler;const C=o.length(w);if(C===0)return;o.scale$2(w,w,A/C*this._projectionScaler),this._camera.position=[v.x-w[0],v.y-w[1],v.z*this._projectionScaler-w[2]],this._camera.orientation=Ns(w,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const P=this.center;return P.lat=o.clamp(P.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(P.lng=o.clamp(P.lng,this.minLng,this.maxLng)),this.center=P,void(this._constraining=!1)}const t=this._unmodified,{x:a,y:u}=this.point;let p=0,f=a,y=u;const v=this.width/2,w=this.height/2,A=this.worldMinY*this.scale,C=this.worldMaxY*this.scale;if(u-w<A&&(y=A+w),u+w>C&&(y=C-w),C-A<this.height&&(p=Math.max(p,this.height/(C-A)),y=(C+A)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const P=this.worldMinX*this.scale,O=this.worldMaxX*this.scale,U=this.worldSize/2-(P+O)/2;f=(a+U+this.worldSize)%this.worldSize-U,f-v<P&&(f=P+v),f+v>O&&(f=O-v),O-P<this.width&&(p=Math.max(p,this.width/(O-P)),f=(O+P)/2)}f===a&&y===u||(this.center=this.unproject(new o.pointGeometry(f,y))),p&&(this.zoom+=this.scaleZoom(p)),this._constrainCameraAltitude(),this._unmodified=t,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.pixelsPerMeter;if(this.projection.name==="globe"){const Y=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,ee=o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE)*this.worldSize;this._mercatorScaleRatio=Y/ee}const u=Oa(this.projection,this.zoom,this.width,this.height,1024);this._projectionScaler=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,u),this.cameraToCenterDistance=this.getCameraToCenterDistance(this.projection),this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const p=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?a:1),f=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);f[8]=2*-t.x/this.width,f[9]=2*t.y/this.height;let y=o.mul([],f,p);if(this.projection.isReprojectedInTileSpace){const Y=this.locationCoordinate(this.center),ee=o.identity([]);o.translate(ee,ee,[Y.x*this.worldSize,Y.y*this.worldSize,0]),o.multiply(ee,ee,lt(this)),o.translate(ee,ee,[-Y.x*this.worldSize,-Y.y*this.worldSize,0]),o.multiply(y,y,ee),this.inverseAdjustmentMatrix=function(ce){const Ie=lt(ce,!0);return wt([],[Ie[0],Ie[1],Ie[4],Ie[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],y,[this.worldSize,this.worldSize,this.worldSize/a,1]),this.projMatrix=y,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const v=o.invert([],f);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(v,this.horizonLineFromTop(),this.height);const w=new Float32Array(16);o.identity(w),o.scale(w,w,[1,-1,1]),o.rotateX(w,w,this._pitch),o.rotateZ(w,w,this.angle);const A=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),C=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;A[8]=2*-t.x/this.width,A[9]=2*(t.y+C)/this.height,this.skyboxMatrix=o.multiply(w,A,w);const P=this.point,O=P.x,U=P.y,j=this.width%2/2,G=this.height%2/2,Q=Math.cos(this.angle),$=Math.sin(this.angle),J=O-Math.round(O)+Q*j+$*G,V=U-Math.round(U)+Q*G+$*j,ne=new Float64Array(y);if(o.translate(ne,ne,[J>.5?J-1:J,V>.5?V-1:V,0]),this.alignedProjMatrix=ne,y=o.create(),o.scale(y,y,[this.width/2,-this.height/2,1]),o.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=o.create(),o.scale(y,y,[1,-1,1]),o.translate(y,y,[-1,-1,0]),o.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},y=o.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const Y=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(Y,Y,p),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSize,a=this.cameraPixelsPerMeter,u=this._camera.position,p=1/this.height/this._projectionScaler,f=[t,t,a];o.scale$2(f,f,p),o.scale$2(u,u,-1),o.multiply$2(u,u,f);const y=o.create();o.translate(y,y,u),o.scale(y,y,f),this.mercatorFogMatrix=y,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,a,p)}_computeCameraPosition(t){const a=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,u=this._camera.forward(),p=this.point,f=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*a-t/this.worldSize*this._centerAltitude;return[p.x/this.worldSize-u[0]*f,p.y/this.worldSize-u[1]*f,t/this.worldSize*this._centerAltitude-u[2]*f]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const a=this._maxCameraBoundsDistance()*Math.cos(this._pitch),u=t[2];let p=1;u>0&&(p=Math.min((a-this._camera.position[2])/u,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,t,p),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const t=this._camera.position,a=this._camera.forward(),{pitch:u,bearing:p}=this._camera.getPitchBearing(),f=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,y=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),v=Math.max((t[2]-f)/Math.cos(u),y),w=this._zoomFromMercatorZ(v);o.scaleAndAdd(t,t,a,v),this._pitch=o.clamp(u,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(p,-Math.PI,Math.PI),this._setZoom(o.clamp(w,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,a){const u=Math.min(t.x,a.x),p=Math.max(t.x,a.x),f=Math.min(t.y,a.y),y=Math.max(t.y,a.y);if(f<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const v=[new o.pointGeometry(u,f),new o.pointGeometry(p,y),new o.pointGeometry(u,y),new o.pointGeometry(p,f)],w=this.renderWorldCopies?-3:0,A=this.renderWorldCopies?4:1;for(const C of v){const P=this.pointRayIntersection(C);if(P.t<0)return!0;const O=this.rayIntersectionCoordinate(P);if(O.x<w||O.y<0||O.x>A||O.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,a){const u=o.length(o.sub([],this._camera.position,t)),p=this._zoomFromMercatorZ(u)+a;return u-this._mercatorZfromZoom(p)}getCameraPoint(){if(this.projection.name==="globe"){const t=function(a,u){const p=[a[0],a[1],a[2],1];o.transformMat4$1(p,p,u);const f=Math.max(p[3],1e-6);return[p[0]/f,p[1]/f,p[2]/f,f]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.pointGeometry(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,t))}}getCameraToCenterDistance(t){const a=Oa(t,this.zoom,this.width,this.height,1024),u=t.pixelSpaceConversion(this.center.lat,this.worldSize,a);return .5/Math.tan(.5*this._fov)*this.height*u}}function Fa(l,t){let a=!1,u=null;const p=()=>{u=null,a&&(l(),u=setTimeout(p,t),a=!1)};return()=>(a=!0,u||p(),u)}class K1{constructor(t){this._hashName=t&&encodeURIComponent(t),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Fa(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,o.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(t){const a=this._map;if(!a)return"";const u=a.getCenter(),p=Math.round(100*a.getZoom())/100,f=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),v=Math.round(u.lng*y)/y,w=Math.round(u.lat*y)/y,A=a.getBearing(),C=a.getPitch();let P="";if(P+=t?`/${v}/${w}/${p}`:`${p}/${w}/${v}`,(A||C)&&(P+="/"+Math.round(10*A)/10),C&&(P+=`/${Math.round(C)}`),this._hashName){const O=this._hashName;let U=!1;const j=o.window.location.hash.slice(1).split("&").map(G=>{const Q=G.split("=")[0];return Q===O?(U=!0,`${Q}=${P}`):G}).filter(G=>G);return U||j.push(`${O}=${P}`),`#${j.join("&")}`}return`#${P}`}_getCurrentHash(){const t=o.window.location.hash.replace("#","");if(this._hashName){let a;return t.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(a=u)}),(a&&a[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const a=this._getCurrentHash();if(a.length>=3&&!a.some(u=>isNaN(u))){const u=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(a[3]||0):t.getBearing();return t.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:u,pitch:+(a[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,t)}}const go={linearity:.3,easing:o.bezier(0,0,.3,1)},yc=o.extend({deceleration:2500,maxSpeed:1400},go),xc=o.extend({deceleration:20,maxSpeed:1400},go),Wo=o.extend({deceleration:1e3,maxSpeed:360},go),x3=o.extend({deceleration:1e3,maxSpeed:90},go);class v3{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=o.exported.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)a.zoom+=f.zoomDelta||0,a.bearing+=f.bearingDelta||0,a.pitch+=f.pitchDelta||0,f.panDelta&&a.pan._add(f.panDelta),f.around&&(a.around=f.around),f.pinchAround&&(a.pinchAround=f.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(a.pan.mag()){const f=yo(a.pan.mag(),u,o.extend({},yc,t||{}));p.offset=a.pan.mult(f.amount/a.pan.mag()),p.center=this._map.transform.center,Na(p,f)}if(a.zoom){const f=yo(a.zoom,u,xc);p.zoom=this._map.transform.zoom+f.amount,Na(p,f)}if(a.bearing){const f=yo(a.bearing,u,Wo);p.bearing=this._map.transform.bearing+o.clamp(f.amount,-179,179),Na(p,f)}if(a.pitch){const f=yo(a.pitch,u,x3);p.pitch=this._map.transform.pitch+f.amount,Na(p,f)}if(p.zoom||p.bearing){const f=a.pinchAround===void 0?a.around:a.pinchAround;p.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),p.noMoveStart=!0,p}}function Na(l,t){(!l.duration||l.duration<t.duration)&&(l.duration=t.duration,l.easing=t.easing)}function yo(l,t,a){const{maxSpeed:u,linearity:p,deceleration:f}=a,y=o.clamp(l*p/(t/1e3),-u,u),v=Math.abs(y)/(f*p);return{easing:a.easing,duration:1e3*v,amount:y*(v/2)}}class xr extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,u,p={}){const f=xe(a.getCanvasContainer(),u),y=a.unproject(f);super(t,o.extend({point:f,lngLat:y,originalEvent:u},p)),this._defaultPrevented=!1,this.target=a}}class Ga extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,u){const p=t==="touchend"?u.changedTouches:u.touches,f=dt(a.getCanvasContainer(),p),y=f.map(w=>a.unproject(w)),v=f.reduce((w,A,C,P)=>w.add(A.div(P.length)),new o.pointGeometry(0,0));super(t,{points:f,point:v,lngLats:y,lngLat:a.unproject(v),originalEvent:u}),this._defaultPrevented=!1}}class vc extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,u){super(t,{originalEvent:u}),this._defaultPrevented=!1}}class Us{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new vc(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new xr(t.type,this._map,t))}mouseup(t){this._map.fire(new xr(t.type,this._map,t))}preclick(t){const a=o.extend({},t);a.type="preclick",this._map.fire(new xr(a.type,this._map,a))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||(this.preclick(t),this._map.fire(new xr(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new xr(t.type,this._map,t))}mouseover(t){this._map.fire(new xr(t.type,this._map,t))}mouseout(t){this._map.fire(new xr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Ga(t.type,this._map,t))}touchmove(t){this._map.fire(new Ga(t.type,this._map,t))}touchend(t){this._map.fire(new Ga(t.type,this._map,t))}touchcancel(t){this._map.fire(new Ga(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Q1{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new xr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new xr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bc{constructor(t,a){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(Qe(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const u=a;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=u,this._box||(this._box=K("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const f=Math.min(p.x,u.x),y=Math.max(p.x,u.x),v=Math.min(p.y,u.y),w=Math.max(p.y,u.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${f}px,${v}px)`,this._box.style.width=y-f+"px",this._box.style.height=w-v+"px")})}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const u=this._startPos,p=a;if(this.reset(),$e(),u.x!==p.x||u.y!==p.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:f=>f.fitScreenCoordinates(u,p,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ve(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new o.Event(t,{originalEvent:a}))}}function Vs(l,t){const a={};for(let u=0;u<l.length;u++)a[l[u].identifier]=t[u];return a}class wc{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,a,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),u.length===this.numTouches&&(this.centroid=function(p){const f=new o.pointGeometry(0,0);for(const y of p)f._add(y);return f.div(p.length)}(a),this.touches=Vs(u,a)))}touchmove(t,a,u){if(this.aborted||!this.centroid)return;const p=Vs(u,a);for(const f in this.touches){const y=this.touches[f],v=p[f];(!v||v.dist(y)>30)&&(this.aborted=!0)}}touchend(t,a,u){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class js{constructor(t){this.singleTap=new wc(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,a,u){this.singleTap.touchstart(t,a,u)}touchmove(t,a,u){this.singleTap.touchmove(t,a,u)}touchend(t,a,u){const p=this.singleTap.touchend(t,a,u);if(p){const f=t.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(p)<30;if(f&&y||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Tc{constructor(){this._zoomIn=new js({numTouches:1,numTaps:2}),this._zoomOut=new js({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,u){this._zoomIn.touchstart(t,a,u),this._zoomOut.touchstart(t,a,u)}touchmove(t,a,u){this._zoomIn.touchmove(t,a,u),this._zoomOut.touchmove(t,a,u)}touchend(t,a,u){const p=this._zoomIn.touchend(t,a,u),f=this._zoomOut.touchend(t,a,u);return p?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:y=>y.easeTo({duration:300,zoom:y.getZoom()+1,around:y.unproject(p)},{originalEvent:t})}):f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:y=>y.easeTo({duration:300,zoom:y.getZoom()-1,around:y.unproject(f)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Xo={0:1,2:2};class $s{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,a){return!1}_move(t,a){return{}}mousedown(t,a){if(this._lastPoint)return;const u=We(t);this._correctButton(t,u)&&(this._lastPoint=a,this._eventButton=u)}mousemoveWindow(t,a){const u=this._lastPoint;if(u){if(t.preventDefault(),this._eventButton!=null&&function(p,f){const y=Xo[f];return p.buttons===void 0||(p.buttons&y)!==y}(t,this._eventButton))this.reset();else if(this._moved||!(a.dist(u)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(u,a)}}mouseupWindow(t){this._lastPoint&&We(t)===this._eventButton&&(this._moved&&$e(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ic extends $s{mousedown(t,a){super.mousedown(t,a),this._lastPoint&&(this._active=!0)}_correctButton(t,a){return a===0&&!t.ctrlKey}_move(t,a){return{around:a,panDelta:a.sub(t)}}}class el extends $s{_correctButton(t,a){return a===0&&t.ctrlKey||a===2}_move(t,a){const u=.8*(a.x-t.x);if(u)return this._active=!0,{bearingDelta:u}}contextmenu(t){t.preventDefault()}}class tl extends $s{_correctButton(t,a){return a===0&&t.ctrlKey||a===2}_move(t,a){const u=-.5*(a.y-t.y);if(u)return this._active=!0,{pitchDelta:u}}contextmenu(t){t.preventDefault()}}class Sc{constructor(t,a){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(t,a,u){return this._calculateTransform(t,a,u)}touchmove(t,a,u){if(this._active&&!(u.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(u.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.preventDefault(),this._calculateTransform(t,a,u)}}touchend(t,a,u){this._calculateTransform(t,a,u),this._active&&u.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,u){u.length>0&&(this._active=!0);const p=Vs(u,a),f=new o.pointGeometry(0,0),y=new o.pointGeometry(0,0);let v=0;for(const A in p){const C=p[A],P=this._touches[A];P&&(f._add(C),y._add(C.sub(P)),v++,p[A]=C)}if(this._touches=p,v<this._minTouches||!y.mag())return;const w=y.div(v);return this._sum._add(w),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(v),panDelta:w}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=K("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Zs{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,a,u){return{}}touchstart(t,a,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,u){const p=this._firstTwoTouches;if(!p)return;t.preventDefault();const[f,y]=p,v=tr(u,a,f),w=tr(u,a,y);if(!v||!w)return;const A=this._aroundCenter?null:v.add(w).div(2);return this._move([v,w],A,t)}touchend(t,a,u){if(!this._firstTwoTouches)return;const[p,f]=this._firstTwoTouches,y=tr(u,a,p),v=tr(u,a,f);y&&v||(this._active&&$e(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function tr(l,t,a){for(let u=0;u<l.length;u++)if(l[u].identifier===a)return t[u]}function Ec(l,t){return Math.log(l/t)/Math.LN2}class Ac extends Zs{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const u=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ec(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ec(this._distance,u),pinchAround:a}}}function kc(l,t){return 180*l.angleWith(t)/Math.PI}class b3 extends Zs{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a){const u=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:kc(this._vector,u),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,u=kc(t,this._startVector);return Math.abs(u)<a}}function nn(l){return Math.abs(l.y)>Math.abs(l.x)}class Mc extends Zs{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,nn(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,u){const p=this._lastPoints;if(!p)return;const f=t[0].sub(p[0]),y=t[1].sub(p[1]);return this._map._cooperativeGestures&&u.touches.length<3||(this._valid=this.gestureBeginsVertically(f,y,u.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5})}gestureBeginsVertically(t,a,u){if(this._valid!==void 0)return this._valid;const p=t.mag()>=2,f=a.mag()>=2;if(!p&&!f)return;if(!p||!f)return this._firstMove==null&&(this._firstMove=u),u-this._firstMove<100&&void 0;const y=t.y>0==a.y>0;return nn(t)&&nn(a)&&y}}const Jo={panStep:100,bearingStep:15,pitchStep:10};class pn{constructor(){const t=Jo;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,u=0,p=0,f=0,y=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?u=-1:(t.preventDefault(),f=-1);break;case 39:t.shiftKey?u=1:(t.preventDefault(),f=1);break;case 38:t.shiftKey?p=1:(t.preventDefault(),y=-1);break;case 40:t.shiftKey?p=-1:(t.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(u=0,p=0),{cameraAnimation:v=>{const w=v.getZoom();v.easeTo({duration:300,easeId:"keyboardHandler",easing:qs,zoom:a?Math.round(w)+a*(t.shiftKey?2:1):w,bearing:v.getBearing()+u*this._bearingStep,pitch:v.getPitch()+p*this._pitchStep,offset:[-f*this._panStep,-y*this._panStep],center:v.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qs(l){return l*(2-l)}const ct=4.000244140625;class Cc{constructor(t,a){this._map=t,this._el=t.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let a=t.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const u=o.exported.now(),p=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,a!==0&&a%ct==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(p*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=xe(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:a,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform,a=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>ct?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&A!==0&&(A=1/A);const C=a(),P=Math.pow(2,C),O=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):P;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(O*A))),this._type==="wheel"&&(this._startZoom=a(),this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:a(),p=this._startZoom,f=this._easing;let y,v=!1;if(this._type==="wheel"&&p&&f){const w=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),A=f(w);y=o.number(p,u,A),w<1?this._frameId||(this._frameId=!0):v=!0}else y=u,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:y-a(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=o.ease;if(this._prevEase){const u=this._prevEase,p=(o.exported.now()-u.start)/u.duration,f=u.easing(p+.01)-u.easing(p),y=.27/Math.sqrt(f*f+1e-4)*.01,v=Math.sqrt(.0729-y*y);a=o.bezier(y,v,.25,1)}return this._prevEase={start:o.exported.now(),duration:t,easing:a},a}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=K("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!o.window.document.fullscreenElement||!!o.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class zc{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ua{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,a){return t.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:u.getZoom()+(t.shiftKey?-1:1),around:u.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Va{constructor(){this._tap=new js({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,a,u){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?u.length>0&&(this._swipePoint=a[0],this._swipeTouch=u[0].identifier):this._tap.touchstart(t,a,u))}touchmove(t,a,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const p=a[0],f=p.y-this._swipePoint.y;return this._swipePoint=p,t.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(t,a,u)}touchend(t,a,u){this._tapTime?this._swipePoint&&u.length===0&&this.reset():this._tap.touchend(t,a,u)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pc{constructor(t,a,u){this._el=t,this._mousePan=a,this._touchPan=u}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Dc{constructor(t,a,u){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Lc{constructor(t,a,u,p){this._el=t,this._touchZoom=a,this._touchRotate=u,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ja=l=>l.zoom||l.drag||l.pitch||l.rotate;class Rc extends o.Event{}class Bc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,a){const u=o.sub([],a,t);this.radius=o.length(u[2]<0?o.div([],u,this.constants):[u[0],u[1],0])}projectRay(t){o.div(t,t,this.constants),o.normalize(t,t),o.mul$1(t,t,this.constants);const a=o.scale$2([],t,this.radius);if(a[2]>0){const u=o.scale$2([],[0,0,1],o.dot(a,[0,0,1])),p=o.scale$2([],o.normalize([],[a[0],a[1],0]),this.radius),f=o.add([],a,o.scale$2([],o.sub([],o.add([],p,u),a),2));a[0]=f[0],a[1]=f[1]}return a}}function $a(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}class Ws{constructor(t,a){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new v3(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Bc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(a),o.bindAll(["handleEvent","handleWindowEvent"],this);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[p,f,y]of this._listeners)p.addEventListener(f,p===o.window.document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[t,a,u]of this._listeners)t.removeEventListener(a,t===o.window.document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(t){const a=this._map,u=a.getCanvasContainer();this._add("mapEvent",new Us(a,t));const p=a.boxZoom=new bc(a,t);this._add("boxZoom",p);const f=new Tc,y=new Ua;a.doubleClickZoom=new zc(y,f),this._add("tapZoom",f),this._add("clickZoom",y);const v=new Va;this._add("tapDragZoom",v);const w=a.touchPitch=new Mc(a);this._add("touchPitch",w);const A=new el(t),C=new tl(t);a.dragRotate=new Dc(t,A,C),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",C,["mouseRotate"]);const P=new Ic(t),O=new Sc(a,t);a.dragPan=new Pc(u,P,O),this._add("mousePan",P),this._add("touchPan",O,["touchZoom","touchRotate"]);const U=new b3,j=new Ac;a.touchZoomRotate=new Lc(u,j,U,v),this._add("touchRotate",U,["touchPan","touchZoom"]),this._add("touchZoom",j,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Q1(a));const G=a.scrollZoom=new Cc(a,this);this._add("scrollZoom",G,["mousePan"]);const Q=a.keyboard=new pn;this._add("keyboard",Q);for(const $ of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[$]&&a[$].enable(t[$])}_add(t,a,u){this._handlers.push({handlerName:t,handler:a,allowed:u}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ja(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,u){for(const p in t)if(p!==u&&(!a||a.indexOf(p)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const a=[];for(const u of t)this._el.contains(u.target)&&a.push(u);return a}handleEvent(t,a){this._updatingCamera=!0;const u=t.type==="renderFrame",p=u?void 0:t,f={needsRenderFrame:!1},y={},v={},w=t.touches?this._getMapTouches(t.touches):void 0,A=w?dt(this._el,w):u?void 0:xe(this._el,t);for(const{handlerName:O,handler:U,allowed:j}of this._handlers){if(!U.isEnabled())continue;let G;this._blockedByActive(v,j,O)?U.reset():U[a||t.type]&&(G=U[a||t.type](t,A,w),this.mergeHandlerResult(f,y,G,O,p),G&&G.needsRenderFrame&&this._triggerRenderFrame()),(G||U.isActive())&&(v[O]=U)}const C={};for(const O in this._previousActiveHandlers)v[O]||(C[O]=p);this._previousActiveHandlers=v,(Object.keys(C).length||$a(f))&&(this._changes.push([f,y,C]),this._triggerRenderFrame()),(Object.keys(v).length||$a(f))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:P}=f;P&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],P(this._map))}mergeHandlerResult(t,a,u,p,f){if(!u)return;o.extend(t,u);const y={handlerName:p,originalEvent:u.originalEvent||f};u.zoomDelta!==void 0&&(a.zoom=y),u.panDelta!==void 0&&(a.drag=y),u.pitchDelta!==void 0&&(a.pitch=y),u.bearingDelta!==void 0&&(a.rotate=y)}_applyChanges(){const t={},a={},u={};for(const[p,f,y]of this._changes)p.panDelta&&(t.panDelta=(t.panDelta||new o.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(t.around=p.around),p.aroundCoord!==void 0&&(t.aroundCoord=p.aroundCoord),p.pinchAround!==void 0&&(t.pinchAround=p.pinchAround),p.noInertia&&(t.noInertia=p.noInertia),o.extend(a,f),o.extend(u,y);this._updateMapTransform(t,a,u),this._changes=[]}_updateMapTransform(t,a,u){const p=this._map,f=p.transform,y=J=>[J.x,J.y,J.z];if((J=>{const V=this._eventsInProgress.drag;return V&&!this._handlersById[V.handlerName].isActive()})()&&!$a(t)){const J=f.zoom;f.cameraElevationReference="sea",f.recenterOnTerrain(),f.cameraElevationReference="ground",J!==f.zoom&&this._map._update(!0)}if(!$a(t))return void this._fireEvents(a,u,!0);let{panDelta:v,zoomDelta:w,bearingDelta:A,pitchDelta:C,around:P,aroundCoord:O,pinchAround:U}=t;U!==void 0&&(P=U),(J=>a.drag&&!this._eventsInProgress.drag)()&&P&&(this._dragOrigin=y(f.pointCoordinate3D(P)),this._trackingEllipsoid.setup(f._camera.position,this._dragOrigin)),f.cameraElevationReference="sea",p._stop(!0),P=P||p.transform.centerPoint,A&&(f.bearing+=A),C&&(f.pitch+=C),f._updateCameraState();const j=[0,0,0];if(v){const J=f.pointCoordinate(P);if(f.projection.name==="globe"){const V=o.latFromMercatorY(J.y),ne=f.center.lat,Y=Math.min(o.mercatorZfromAltitude(1,V)/o.mercatorZfromAltitude(1,ne),2);v=v.rotate(-f.angle),j[0]=-v.x/f.worldSize*Y,j[1]=-v.y/f.worldSize*Y}else{const V=f.pointCoordinate(P.sub(v));J&&V&&(j[0]=V.x-J.x,j[1]=V.y-J.y)}}const G=f.zoom,Q=[0,0,0];if(w){const J=y(O||f.pointCoordinate3D(P)),V={dir:o.normalize([],o.sub([],J,f._camera.position))};if(V.dir[2]<0){const ne=f.zoomDeltaToMovement(J,w);o.scale$2(Q,V.dir,ne)}}const $=o.add(j,j,Q);f._translateCameraConstrained($),w&&Math.abs(f.zoom-G)>1e-4&&f.recenterOnTerrain(),f.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,u,!0)}_fireEvents(t,a,u){const p=ja(this._eventsInProgress),f=ja(t),y={};for(const C in t){const{originalEvent:P}=t[C];this._eventsInProgress[C]||(y[`${C}start`]=P),this._eventsInProgress[C]=t[C]}!p&&f&&this._fireEvent("movestart",f.originalEvent);for(const C in y)this._fireEvent(C,y[C]);f&&this._fireEvent("move",f.originalEvent);for(const C in t){const{originalEvent:P}=t[C];this._fireEvent(C,P)}const v={};let w;for(const C in this._eventsInProgress){const{handlerName:P,originalEvent:O}=this._eventsInProgress[C];this._handlersById[P].isActive()||(delete this._eventsInProgress[C],w=a[P]||O,v[`${C}end`]=w)}for(const C in v)this._fireEvent(C,v[C]);const A=ja(this._eventsInProgress);if(u&&(p||f)&&!A){this._updatingCamera=!0;const C=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=O=>O!==0&&-this._bearingSnap<O&&O<this._bearingSnap;C?(P(C.bearing||this._map.getBearing())&&(C.bearing=0),this._map.easeTo(C,{originalEvent:w})):(this._map.fire(new o.Event("moveend",{originalEvent:w})),P(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new o.Event(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Rc("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Xs="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Js extends o.Evented{constructor(t,a){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,u){return t=o.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,o.extend({offset:t},a),u)}panTo(t,a,u){return this.easeTo(o.extend({center:t},a),u)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,u){return this.easeTo(o.extend({zoom:t},a),u)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,u){return this.easeTo(o.extend({bearing:t},a),u)}resetNorth(t,a){return this.rotateTo(0,o.extend({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){this.transform.projection.name==="globe"&&o.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),t=o.LngLatBounds.convert(t);const u=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),u,a)}_extendCameraOptions(t){const a={top:0,bottom:0,right:0,left:0};if(typeof(t=o.extend({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const u=t.padding;t.padding={top:u,bottom:u,right:u,left:u}}return t.padding=o.extend(a,t.padding),t}_cameraForBoxAndBearing(t,a,u,p){const f=this._extendCameraOptions(p),y=this.transform,v=y.padding,w=y.project(o.LngLat.convert(t)),A=y.project(o.LngLat.convert(a)),C=new o.pointGeometry(w.x,A.y),P=new o.pointGeometry(A.x,w.y),O=-o.degToRad(u),U=w.rotate(O),j=A.rotate(O),G=C.rotate(O),Q=P.rotate(O),$=new o.pointGeometry(Math.max(U.x,j.x,G.x,Q.x),Math.max(U.y,j.y,G.y,Q.y)),J=new o.pointGeometry(Math.min(U.x,j.x,G.x,Q.x),Math.min(U.y,j.y,G.y,Q.y)),V=$.sub(J),ne=(y.width-((v.left||0)+(v.right||0)+f.padding.left+f.padding.right))/V.x,Y=(y.height-((v.top||0)+(v.bottom||0)+f.padding.top+f.padding.bottom))/V.y;if(Y<0||ne<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ee=Math.min(y.scaleZoom(y.scale*Math.min(ne,Y)),f.maxZoom),ce=typeof f.offset.x=="number"&&typeof f.offset.y=="number"?new o.pointGeometry(f.offset.x,f.offset.y):o.pointGeometry.convert(f.offset),Ie=new o.pointGeometry((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(u*Math.PI/180),Ae=ce.add(Ie).mult(y.scale/y.zoomScale(ee));return{center:y.unproject(w.add(A).div(2).sub(Ae)),zoom:ee,bearing:u}}_cameraForBox(t,a,u,p,f){const y=this._extendCameraOptions(f);u=u||0,p=p||0,t=o.LngLat.convert(t),a=o.LngLat.convert(a);const v=this.transform.clone();v.padding=y.padding;const w=this.getFreeCameraOptions(),A=new o.LngLat(.5*(t.lng+a.lng),.5*(t.lat+a.lat)),C=.5*(u+p);if(v._camera.position[2]<o.mercatorZfromAltitude(C,A.lat))return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");w.lookAtPoint(A),v.setFreeCameraOptions(w);const P=o.MercatorCoordinate.fromLngLat(t),O=o.MercatorCoordinate.fromLngLat(a),U=v.pointRayIntersection(v.centerPoint,C),j=[(G=v.rayIntersectionCoordinate(U)).x,G.y,G.z];var G;const Q=v.screenPointToMercatorRay(v.centerPoint),$=v.projection.name!=="globe";let J,V=0;do{const ne=Math.floor(v.zoom),Y=1<<ne,ee=Math.min(Y*P.x,Y*O.x),ce=Math.min(Y*P.y,Y*O.y),Ie=Math.max(Y*P.x,Y*O.x),Ae=Math.max(Y*P.y,Y*O.y),we=new o.Aabb([ee,ce,u],[Ie,Ae,p]),Ze=o.Frustum.fromInvProjectionMatrix(v.invProjMatrix,v.worldSize,ne,$);if(we.intersects(Ze)!==2){J&&(v._camera.position=o.scaleAndAdd([],v._camera.position,Q.dir,-J),v._updateStateFromCamera());break}const re=o.sub([],v._camera.position,j);J=.5*o.length(re),v._camera.position=o.scaleAndAdd([],v._camera.position,Q.dir,J);try{v._updateStateFromCamera()}catch{return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++V<10);return{center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}}fitBounds(t,a,u){return this.transform.projection.name==="globe"&&o.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(t,a),a,u)}_raycastElevationBox(t,a){const u=this.transform.elevation;if(!u)return;const p=new o.pointGeometry(t.x,a.y),f=new o.pointGeometry(a.x,t.y),y=u.pointCoordinate(t);if(!y)return;const v=u.pointCoordinate(a);if(!v)return;const w=u.pointCoordinate(p);if(!w)return;const A=u.pointCoordinate(f);if(!A)return;const C=new o.MercatorCoordinate(y[0],y[1]).toLngLat(),P=new o.MercatorCoordinate(v[0],v[1]).toLngLat(),O=new o.MercatorCoordinate(w[0],w[1]).toLngLat(),U=new o.MercatorCoordinate(A[0],A[1]).toLngLat(),j=Math.min(C.lng,Math.min(P.lng,Math.min(O.lng,U.lng))),G=Math.min(C.lat,Math.min(P.lat,Math.min(O.lat,U.lat))),Q=Math.max(C.lng,Math.max(P.lng,Math.max(O.lng,U.lng))),$=Math.max(C.lat,Math.max(P.lat,Math.max(O.lat,U.lat))),J=Math.min(y[3],Math.min(v[3],Math.min(w[3],A[3]))),V=Math.max(y[3],Math.max(v[3],Math.max(w[3],A[3])));return{minLngLat:new o.LngLat(j,G),maxLngLat:new o.LngLat(Q,$),minAltitude:J,maxAltitude:V}}fitScreenCoordinates(t,a,u,p,f){let y,v,w,A;this.transform.projection.name==="globe"&&o.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const C=o.pointGeometry.convert(t),P=o.pointGeometry.convert(a),O=this._raycastElevationBox(C,P);if(O)y=O.minLngLat,v=O.maxLngLat,w=O.minAltitude,A=O.maxAltitude;else{if(this.transform.anyCornerOffEdge(C,P))return this;y=this.transform.pointLocation(C),v=this.transform.pointLocation(P)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(t)),this.transform.pointLocation(o.pointGeometry.convert(a)),u,p):this._cameraForBox(y,v,w,A,p),p,f)}_fitInternal(t,a,u){return t?(delete(a=o.extend(t,a)).padding,a.linear?this.easeTo(a,u):this.flyTo(a,u)):this}jumpTo(t,a){this.stop();const u=t.preloadOnly?this.transform.clone():this.transform;let p=!1,f=!1,y=!1;return"zoom"in t&&u.zoom!==+t.zoom&&(p=!0,u.zoom=+t.zoom),t.center!==void 0&&(u.center=o.LngLat.convert(t.center)),"bearing"in t&&u.bearing!==+t.bearing&&(f=!0,u.bearing=+t.bearing),"pitch"in t&&u.pitch!==+t.pitch&&(y=!0,u.pitch=+t.pitch),t.padding==null||u.isPaddingEqual(t.padding)||(u.padding=t.padding),t.preloadOnly?(this._preloadTiles(u),this):(this.fire(new o.Event("movestart",a)).fire(new o.Event("move",a)),p&&this.fire(new o.Event("zoomstart",a)).fire(new o.Event("zoom",a)).fire(new o.Event("zoomend",a)),f&&this.fire(new o.Event("rotatestart",a)).fire(new o.Event("rotate",a)).fire(new o.Event("rotateend",a)),y&&this.fire(new o.Event("pitchstart",a)).fire(new o.Event("pitch",a)).fire(new o.Event("pitchend",a)),this.fire(new o.Event("moveend",a)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Xs),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,a){const u=this.transform;if(!u.projection.supportsFreeCamera)return o.warnOnce(Xs),this;this.stop();const p=u.zoom,f=u.pitch,y=u.bearing;u.setFreeCameraOptions(t);const v=p!==u.zoom,w=f!==u.pitch,A=y!==u.bearing;return this.fire(new o.Event("movestart",a)).fire(new o.Event("move",a)),v&&this.fire(new o.Event("zoomstart",a)).fire(new o.Event("zoom",a)).fire(new o.Event("zoomend",a)),A&&this.fire(new o.Event("rotatestart",a)).fire(new o.Event("rotate",a)).fire(new o.Event("rotateend",a)),w&&this.fire(new o.Event("pitchstart",a)).fire(new o.Event("pitch",a)).fire(new o.Event("pitchend",a)),this.fire(new o.Event("moveend",a)),this}easeTo(t,a){this._stop(!1,t.easeId),((t=o.extend({offset:[0,0],duration:500,easing:o.ease},t)).animate===!1||!t.essential&&o.exported.prefersReducedMotion)&&(t.duration=0);const u=this.transform,p=this.getZoom(),f=this.getBearing(),y=this.getPitch(),v=this.getPadding(),w="zoom"in t?+t.zoom:p,A="bearing"in t?this._normalizeBearing(t.bearing,f):f,C="pitch"in t?+t.pitch:y,P="padding"in t?t.padding:u.padding,O=o.pointGeometry.convert(t.offset);let U,j,G;if(u.projection.name==="globe"){const Ae=o.MercatorCoordinate.fromLngLat(u.center),we=O.rotate(-u.angle);Ae.x+=we.x/u.worldSize,Ae.y+=we.y/u.worldSize;const Ze=Ae.toLngLat(),re=o.LngLat.convert(t.center||Ze);this._normalizeCenter(re),U=u.centerPoint.add(we),j=new o.pointGeometry(Ae.x,Ae.y).mult(u.worldSize),G=new o.pointGeometry(o.mercatorXfromLng(re.lng),o.mercatorYfromLat(re.lat)).mult(u.worldSize).sub(j)}else{U=u.centerPoint.add(O);const Ae=u.pointLocation(U),we=o.LngLat.convert(t.center||Ae);this._normalizeCenter(we),j=u.project(Ae),G=u.project(we).sub(j)}const Q=u.zoomScale(w-p);let $,J;t.around&&($=o.LngLat.convert(t.around),J=u.locationPoint($));const V=this._zooming||w!==p,ne=this._rotating||f!==A,Y=this._pitching||C!==y,ee=!u.isPaddingEqual(P),ce=Ae=>we=>{if(V&&(Ae.zoom=o.number(p,w,we)),ne&&(Ae.bearing=o.number(f,A,we)),Y&&(Ae.pitch=o.number(y,C,we)),ee&&(Ae.interpolatePadding(v,P,we),U=Ae.centerPoint.add(O)),$)Ae.setLocationAtPoint($,J);else{const Ze=Ae.zoomScale(Ae.zoom-p),re=w>p?Math.min(2,Q):Math.max(.5,Q),ye=Math.pow(re,1-we),Le=Ae.unproject(j.add(G.mult(we*ye)).mult(Ze));Ae.setLocationAtPoint(Ae.renderWorldCopies?Le.wrap():Le,U)}return t.preloadOnly||this._fireMoveEvents(a),Ae};if(t.preloadOnly){const Ae=this._emulate(ce,t.duration,u);return this._preloadTiles(Ae),this}const Ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=V,this._rotating=ne,this._pitching=Y,this._padding=ee,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,Ie),this._ease(ce(u),Ae=>{u.recenterOnTerrain(),this._afterEase(a,Ae)},t),this}_prepareEase(t,a,u={}){this._moving=!0,this.transform.cameraElevationReference="sea",a||u.moving||this.fire(new o.Event("movestart",t)),this._zooming&&!u.zooming&&this.fire(new o.Event("zoomstart",t)),this._rotating&&!u.rotating&&this.fire(new o.Event("rotatestart",t)),this._pitching&&!u.pitching&&this.fire(new o.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new o.Event("move",t)),this._zooming&&this.fire(new o.Event("zoom",t)),this._rotating&&this.fire(new o.Event("rotate",t)),this._pitching&&this.fire(new o.Event("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const u=this._zooming,p=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new o.Event("zoomend",t)),p&&this.fire(new o.Event("rotateend",t)),f&&this.fire(new o.Event("pitchend",t)),this.fire(new o.Event("moveend",t))}flyTo(t,a){if(!t.essential&&o.exported.prefersReducedMotion){const it=o.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(it,a)}this.stop(),t=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},t);const u=this.transform,p=this.getZoom(),f=this.getBearing(),y=this.getPitch(),v=this.getPadding(),w="zoom"in t?o.clamp(+t.zoom,u.minZoom,u.maxZoom):p,A="bearing"in t?this._normalizeBearing(t.bearing,f):f,C="pitch"in t?+t.pitch:y,P="padding"in t?t.padding:u.padding,O=u.zoomScale(w-p),U=o.pointGeometry.convert(t.offset);let j=u.centerPoint.add(U);const G=u.pointLocation(j),Q=o.LngLat.convert(t.center||G);this._normalizeCenter(Q);const $=u.project(G),J=u.project(Q).sub($);let V=t.curve;const ne=Math.max(u.width,u.height),Y=ne/O,ee=J.mag();if("minZoom"in t){const it=o.clamp(Math.min(t.minZoom,p,w),u.minZoom,u.maxZoom),rt=ne/u.zoomScale(it-p);V=Math.sqrt(rt/ee*2)}const ce=V*V;function Ie(it){const rt=(Y*Y-ne*ne+(it?-1:1)*ce*ce*ee*ee)/(2*(it?Y:ne)*ce*ee);return Math.log(Math.sqrt(rt*rt+1)-rt)}function Ae(it){return(Math.exp(it)-Math.exp(-it))/2}function we(it){return(Math.exp(it)+Math.exp(-it))/2}const Ze=Ie(0);let re=function(it){return we(Ze)/we(Ze+V*it)},ye=function(it){return ne*((we(Ze)*(Ae(rt=Ze+V*it)/we(rt))-Ae(Ze))/ce)/ee;var rt},Le=(Ie(1)-Ze)/V;if(Math.abs(ee)<1e-6||!isFinite(Le)){if(Math.abs(ne-Y)<1e-6)return this.easeTo(t,a);const it=Y<ne?-1:1;Le=Math.abs(Math.log(Y/ne))/V,ye=function(){return 0},re=function(rt){return Math.exp(it*V*rt)}}t.duration="duration"in t?+t.duration:1e3*Le/("screenSpeed"in t?+t.screenSpeed/V:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const tt=f!==A,De=C!==y,ft=!u.isPaddingEqual(P),Ke=it=>rt=>{const et=rt*Le,ut=1/re(et);it.zoom=rt===1?w:p+it.scaleZoom(ut),tt&&(it.bearing=o.number(f,A,rt)),De&&(it.pitch=o.number(y,C,rt)),ft&&(it.interpolatePadding(v,P,rt),j=it.centerPoint.add(U));const Ct=rt===1?Q:it.unproject($.add(J.mult(ye(et))).mult(ut));return it.setLocationAtPoint(it.renderWorldCopies?Ct.wrap():Ct,j),it._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(a),it};if(t.preloadOnly){const it=this._emulate(Ke,t.duration,u);return this._preloadTiles(it),this}return this._zooming=!0,this._rotating=tt,this._pitching=De,this._padding=ft,this._prepareEase(a,!1),this._ease(Ke(u),()=>this._afterEase(a),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const u=this._onEaseEnd;this._onEaseEnd=void 0,u.call(this,a)}if(!t){const u=this.handlers;u&&u.stop(!1)}return this}_ease(t,a,u){u.animate===!1||u.duration===0?(t(1),a()):(this._easeStart=o.exported.now(),this._easeOptions=u,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),a=this._onEaseFrame;a&&a(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,a){t=o.wrap(t,-180,180);const u=Math.abs(t-a);return Math.abs(t-360-a)<u&&(t-=360),Math.abs(t+360-a)<u&&(t+=360),t}_normalizeCenter(t){const a=this.transform;if(!a.renderWorldCopies||a.maxBounds)return;const u=t.lng-a.center.lng;t.lng+=u>180?-360:u<-180?360:0}_emulate(t,a,u){const p=Math.ceil(15*a/1e3),f=[],y=t(u.clone());for(let v=0;v<=p;v++){const w=y(v/p);f.push(w.clone())}return f}}class il{constructor(t={}){this.options=t,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const a=this.options&&this.options.compact;return this._map=t,this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K("button","mapboxgl-ctrl-attrib-button",this._container),K("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const u=this._map._getUIString(`AttributionControl.${a}`);t.setAttribute("aria-label",u),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",u)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(t){const u=a.reduce((p,f,y)=>(f.value&&(p+=`${f.key}=${f.value}${y<a.length-1?"&":""}`),p),"?");t.href=`${o.config.FEEDBACK_URL}/${u}${this._map._hash?this._map._hash.getHashString(!0):""}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const a=this._map.style._sourceCaches;for(const p in a){const f=a[p];if(f.used){const y=f.getSource();y.attribution&&t.indexOf(y.attribution)<0&&t.push(y.attribution)}}t.sort((p,f)=>p.length-f.length),t=t.filter((p,f)=>{for(let y=f+1;y<t.length;y++)if(t[y].indexOf(p)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const u=t.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,t.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class rl{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=K("div","mapboxgl-ctrl");const a=K("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const a in t){const u=t[a].getSource();if(u.hasOwnProperty("mapbox_logo")&&!u.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const a=t[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}}}class nl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,u=a?this._queue.concat(a):this._queue;for(const p of u)if(p.id===t)return void(p.cancelled=!0)}run(t=0){const a=this._currentlyRunning=this._queue;this._queue=[];for(const u of a)if(!u.cancelled&&(u.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ol(l,t,a){if(l=new o.LngLat(l.lng,l.lat),t){const u=new o.LngLat(l.lng-360,l.lat),p=new o.LngLat(l.lng+360,l.lat),f=360*Math.ceil(Math.abs(l.lng-a.center.lng)/360),y=a.locationPoint(l).distSqr(t),v=t.x<0||t.y<0||t.x>a.width||t.y>a.height;a.locationPoint(u).distSqr(t)<y&&(v||Math.abs(u.lng-a.center.lng)<f)?l=u:a.locationPoint(p).distSqr(t)<y&&(v||Math.abs(p.lng-a.center.lng)<f)&&(l=p)}for(;Math.abs(l.lng-a.center.lng)>180;){const u=a.locationPoint(l);if(u.x>=0&&u.y>=0&&u.x<=a.width&&u.y<=a.height)break;l.lng>a.center.lng?l.lng-=360:l.lng+=360}return l}const Hs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ys extends o.Evented{constructor(t,a){if(super(),(t instanceof o.window.HTMLElement||a)&&(t=o.extend({element:t},a)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),t&&t.element)this._element=t.element,this._offset=o.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=K("div");const p=41,f=27,y=fe("svg",{display:"block",height:p*this._scale+"px",width:f*this._scale+"px",viewBox:`0 0 ${f} ${p}`},this._element),v=fe("radialGradient",{id:"shadowGradient"},fe("defs",{},y));fe("stop",{offset:"10%","stop-opacity":.4},v),fe("stop",{offset:"100%","stop-opacity":.05},v),fe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},y),fe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},y),fe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},y),fe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},y),this._offset=o.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",p=>{p.preventDefault()}),this._element.addEventListener("mousedown",p=>{p.preventDefault()});const u=this._element.classList;for(const p in Hs)u.remove(`mapboxgl-marker-anchor-${p}`);u.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=o.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const a=t.code,u=t.charCode||t.keyCode;a!=="Space"&&a!=="Enter"&&u!==32&&u!==13||this.togglePopup()}_onMapClick(t){const a=t.originalEvent.target,u=this._element;this._popup&&(a===u||u.contains(a))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map;if(!t)return!1;const a=t.unproject(this._pos),u=t.getFreeCameraOptions();if(!u.position)return!1;const p=u.position.toLngLat();return p.distanceTo(a)<.9*p.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const a=this._pos;if(!a||a.x<0||a.x>t.transform.width||a.y<0||a.y>t.transform.height)return void this._clearFadeTimer();const u=t.unproject(a);let p;t._usingGlobe()&&o.isLngLatBehindGlobe(t.transform,this._lngLat)?p=0:(p=1-t._queryFogOpacity(u),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(p*=.2)),this._element.style.opacity=`${p}`,this._element.style.pointerEvents=p>0?"auto":"none",this._popup&&this._popup._setOpacity(p),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const a=this._calculateXYTransform()+this._calculateZTransform(),u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px) ${Hs[this._anchor]}
            ${a}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const t=this._pos,a=this._map;if(this.getPitchAlignment()!=="map"||!a||!t)return"";if(!a._usingGlobe()){const w=a.getPitch();return w?`rotateX(${w}deg)`:""}const u=o.radToDeg(o.globeTiltAtLngLat(a.transform,this._lngLat)),p=t.sub(o.globeCenterToScreenPoint(a.transform)),f=u/(Math.abs(p.x)+Math.abs(p.y)),y=p.x*f,v=-p.y*f;return v||y?`rotateX(${v}deg) rotateY(${y}deg)`:""}_calculateZTransform(){const t=this._calculateRotation();return t?`rotateZ(${t}deg)`:""}_calculateRotation(){if(this._rotationAlignment==="viewport"||this._rotationAlignment==="auto")return this._rotation;if(this._map&&this._rotationAlignment==="map"){const t=this._map;if(this._pos&&t&&t._usingGlobe()){const a=t.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),u=t.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(a);return this._rotation+o.radToDeg(Math.atan2(u.y,u.x))-90}return this._rotation-this._map.getBearing()}return 0}_update(t){o.window.cancelAnimationFrame(this._updateFrameId);const a=this._map;a&&(a.transform.renderWorldCopies&&(this._lngLat=ol(this._lngLat,this._pos,a.transform)),this._pos=a.project(this._lngLat),t===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),a._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(a._usingGlobe()||a.getTerrain()||a.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=o.pointGeometry.convert(t),this._update(),this}_onMove(t){const a=this._map;if(a){if(!this._isDragging){const u=this._clickTolerance||a._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=a.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(t){const a=this._map;a&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos),this._pointerdownPos=t.point,this._state="pending",a.on("mousemove",this._onMove),a.on("touchmove",this._onMove),a.once("mouseup",this._onUp),a.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const a=this._map;return a&&(t?(a.on("mousedown",this._addDragHandler),a.on("touchstart",this._addDragHandler)):(a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}}class Oc{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const a=o.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-a)+this._end*a}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,a,u){this._start=this.getValue(a),this._end=t,this._startTime=a,this._endTime=a+u}}const al={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Fc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ks(l){l.parentNode&&l.parentNode.removeChild(l)}const Nc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gc{constructor(t,a,u=!1){this._clickTolerance=10,this.element=a,this.mouseRotate=new el({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,u&&(this.mousePitch=new tl({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),a.addEventListener("mousedown",this.mousedown),a.addEventListener("touchstart",this.touchstart,{passive:!1}),a.addEventListener("touchmove",this.touchmove),a.addEventListener("touchend",this.touchend),a.addEventListener("touchcancel",this.reset)}down(t,a){this.mouseRotate.mousedown(t,a),this.mousePitch&&this.mousePitch.mousedown(t,a),Qe()}move(t,a){const u=this.map,p=this.mouseRotate.mousemoveWindow(t,a),f=p&&p.bearingDelta;if(f&&u.setBearing(u.getBearing()+f),this.mousePitch){const y=this.mousePitch.mousemoveWindow(t,a),v=y&&y.pitchDelta;v&&u.setPitch(u.getPitch()+v)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ve(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(o.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),xe(this.element,t)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,xe(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=dt(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=dt(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const sl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Uc={maxWidth:100,unit:"metric"};function xo(l,t,a,u,p,f){const y=function(w){const A=Math.pow(10,`${Math.floor(w)}`.length-1);let C=w/A;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(P){const O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(C),A*C}(a),v=y/a;f._requestDomTask(()=>{l.style.width=t*v+"px",l.innerHTML=p!=="nautical-mile"?new Intl.NumberFormat(u,{style:"unit",unitDisplay:"narrow",unit:p}).format(y):`${y}&nbsp;nm`})}const Vc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ll=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Qs(l=new o.pointGeometry(0,0),t="bottom"){if(typeof l=="number"){const a=Math.round(Math.sqrt(.5*Math.pow(l,2)));switch(t){case"top":return new o.pointGeometry(0,l);case"top-left":return new o.pointGeometry(a,a);case"top-right":return new o.pointGeometry(-a,a);case"bottom":return new o.pointGeometry(0,-l);case"bottom-left":return new o.pointGeometry(a,-a);case"bottom-right":return new o.pointGeometry(-a,-a);case"left":return new o.pointGeometry(l,0);case"right":return new o.pointGeometry(-l,0)}return new o.pointGeometry(0,0)}return l instanceof o.pointGeometry||Array.isArray(l)?o.pointGeometry.convert(l):o.pointGeometry.convert(l[t]||[0,0])}const Ho={version:o.version,supported:ae,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Js{constructor(l){if((l=o.extend({},Fc,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(l.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(l.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Gs(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies),l),this._interactive=l.interactive,this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._optimizeForTerrain=l.optimizeForTerrain,this._language=l.language==="auto"?o.window.navigator.language:l.language,this._worldview=l.worldview,this._renderTaskQueue=new nl,this._domRenderTaskQueue=new nl,this._controls=[],this._markers=[],this._mapId=o.uniqueId(),this._locale=o.extend({},al,l.locale),this._clickTolerance=l.clickTolerance,this._cooperativeGestures=l.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Oc(0),this._explicitProjection=null,this._requestManager=new o.RequestManager(l.transformRequest,l.accessToken,l.testMode),this._silenceAuthErrors=!!l.testMode,typeof l.container=="string"){if(this._container=o.window.document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),l.maxBounds&&this.setMaxBounds(l.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Ws(this,l),this._localFontFamily=l.localFontFamily,this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),l.projection&&this.setProjection(l.projection),this._hash=l.hash&&new K1(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),l.attributionControl&&this.addControl(new il({customAttribution:l.customAttribution})),this._logoControl=new rl,this.addControl(this._logoControl,l.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new o.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new o.Event(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(l,t){if(t===void 0&&(t=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=l.onAdd(this);this._controls.push(l);const u=this._controlPositions[t];return t.indexOf("bottom")!==-1?u.insertBefore(a,u.firstChild):u.appendChild(a),this}removeControl(l){if(!l||!l.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(l);return t>-1&&this._controls.splice(t,1),l.onRemove(this),this}hasControl(l){return this._controls.indexOf(l)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(l){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l)),this.fire(new o.Event("resize",l)),t&&this.fire(new o.Event("moveend",l)),this}getBounds(){return this.transform.projection.name==="globe"&&o.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(l){return this.transform.setMaxBounds(o.LngLatBounds.convert(l)),this._update()}setMinZoom(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l?this.setZoom(l):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l?this.setZoom(l):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l?this.setPitch(l):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(l){if((l=l==null?85:l)>85)throw new Error("maxPitch must be less than or equal to 85");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l?this.setPitch(l):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(l){return this.transform.renderWorldCopies=l,this._update()}getLanguage(){return this._language}setLanguage(l){if(this._language=l==="auto"?o.window.navigator.language:l,this.style)for(const t in this.style._sourceCaches){const a=this.style._sourceCaches[t]._source;a._setLanguage&&a._setLanguage(this._language)}for(const t of this._controls)t._setLanguage&&t._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(l){if(this._worldview=l,this.style)for(const t in this.style._sourceCaches){const a=this.style._sourceCaches[t]._source;a._setWorldview&&a._setWorldview(l)}return this}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}_usingGlobe(){return this.transform.projection.name==="globe"}setProjection(l){return this._lazyInitEmptyStyle(),l?typeof l=="string"&&(l={name:l}):l=null,this._updateProjection(l)}_updateProjection(l){const t=this.getProjection();l===null&&(this._explicitProjection=null);const a=l||this.getProjection();let u;if(a&&a.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(u=this.transform.setProjection({name:"mercator"}),this.transform.mercatorFromTransition=!0):(u=this.transform.setProjection(a),this.transform.mercatorFromTransition=!1),l&&(this._explicitProjection=l.name==="globe"?{name:"globe",center:[0,0]}:this.transform.getProjection()),this.style.applyProjectionUpdate(),u){if(t.name==="globe"&&this.getProjection().name==="globe")this.style._forceSymbolLayerUpdate();else{this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles()}this._update(!0)}return this}project(l){return this.transform.locationPoint3D(o.LngLat.convert(l))}unproject(l){return this.transform.pointLocation3D(o.pointGeometry.convert(l))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(l,t,a){if(l==="mouseenter"||l==="mouseover"){let u=!1;const p=y=>{const v=t.filter(A=>this.getLayer(A)),w=v.length?this.queryRenderedFeatures(y.point,{layers:v}):[];w.length?u||(u=!0,a.call(this,new xr(l,this,y.originalEvent,{features:w}))):u=!1},f=()=>{u=!1};return{layers:new Set(t),listener:a,delegates:{mousemove:p,mouseout:f}}}if(l==="mouseleave"||l==="mouseout"){let u=!1;const p=y=>{const v=t.filter(w=>this.getLayer(w));(v.length?this.queryRenderedFeatures(y.point,{layers:v}):[]).length?u=!0:u&&(u=!1,a.call(this,new xr(l,this,y.originalEvent)))},f=y=>{u&&(u=!1,a.call(this,new xr(l,this,y.originalEvent)))};return{layers:new Set(t),listener:a,delegates:{mousemove:p,mouseout:f}}}{const u=p=>{const f=t.filter(v=>this.getLayer(v)),y=f.length?this.queryRenderedFeatures(p.point,{layers:f}):[];y.length&&(p.features=y,a.call(this,p),delete p.features)};return{layers:new Set(t),listener:a,delegates:{[l]:u}}}}on(l,t,a){if(a===void 0)return super.on(l,t);Array.isArray(t)||(t=[t]);const u=this._createDelegatedListener(l,t,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(u);for(const p in u.delegates)this.on(p,u.delegates[p]);return this}once(l,t,a){if(a===void 0)return super.once(l,t);Array.isArray(t)||(t=[t]);const u=this._createDelegatedListener(l,t,a);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(l,t,a){if(a===void 0)return super.off(l,t);t=new Set(Array.isArray(t)?t:[t]);const u=(f,y)=>{if(f.size!==y.size)return!1;for(const v of f)if(!y.has(v))return!1;return!0},p=this._delegatedListeners?this._delegatedListeners[l]:void 0;return p&&(f=>{for(let y=0;y<f.length;y++){const v=f[y];if(v.listener===a&&u(v.layers,t)){for(const w in v.delegates)this.off(w,v.delegates[w]);return f.splice(y,1),this}}})(p),this}queryRenderedFeatures(l,t){return this.style?(t!==void 0||l===void 0||l instanceof o.pointGeometry||Array.isArray(l)||(t=l,l=void 0),this.style.queryRenderedFeatures(l=l||[[0,0],[this.transform.width,this.transform.height]],t=t||{},this.transform)):[]}querySourceFeatures(l,t){return this.style.querySourceFeatures(l,t)}queryTerrainElevation(l,t){const a=this.transform.elevation;return a?(t=o.extend({},{exaggerated:!0},t),a.getAtPoint(o.MercatorCoordinate.fromLngLat(l),null,t.exaggerated)):null}setStyle(l,t){return(t=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&l?(this._diffStyle(l,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(l,t))}_getUIString(l){const t=this._locale[l];if(t==null)throw new Error(`Missing UI string '${l}'`);return t}_updateStyle(l,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),l&&(this.style=new rn(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new rn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(l,t){if(typeof l=="string"){const a=this._requestManager.normalizeStyleURL(l),u=this._requestManager.transformRequest(a,o.ResourceType.Style);o.getJSON(u,(p,f)=>{p?this.fire(new o.ErrorEvent(p)):f&&this._updateDiff(f,t)})}else typeof l=="object"&&this._updateDiff(l,t)}_updateDiff(l,t){try{this.style.setState(l)&&this._update(!0)}catch(a){o.warnOnce(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(l,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(l,t){return this._lazyInitEmptyStyle(),this.style.addSource(l,t),this._update(!0)}isSourceLoaded(l){return!!this.style&&this.style._isSourceCacheLoaded(l)}areTilesLoaded(){const l=this.style&&this.style._sourceCaches;for(const t in l){const a=l[t]._tiles;for(const u in a){const p=a[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(l,t,a){this._lazyInitEmptyStyle(),this.style.addSourceType(l,t,a)}removeSource(l){return this.style.removeSource(l),this._updateTerrain(),this._update(!0)}getSource(l){return this.style.getSource(l)}addImage(l,t,{pixelRatio:a=1,sdf:u=!1,stretchX:p,stretchY:f,content:y}={}){if(this._lazyInitEmptyStyle(),t instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&t instanceof o.window.ImageBitmap){const{width:v,height:w,data:A}=o.exported.getImageData(t);this.style.addImage(l,{data:new o.RGBAImage({width:v,height:w},A),pixelRatio:a,stretchX:p,stretchY:f,content:y,sdf:u,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:v,height:w}=t,A=t;this.style.addImage(l,{data:new o.RGBAImage({width:v,height:w},new Uint8Array(A.data)),pixelRatio:a,stretchX:p,stretchY:f,content:y,sdf:u,version:0,userImage:A}),A.onAdd&&A.onAdd(this,l)}}updateImage(l,t){const a=this.style.getImage(l);if(!a)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=t instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&t instanceof o.window.ImageBitmap?o.exported.getImageData(t):t,{width:p,height:f}=u;p!==void 0&&f!==void 0?p===a.data.width&&f===a.data.height?(a.data.replace(u.data,!(t instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&t instanceof o.window.ImageBitmap)),this.style.updateImage(l,a)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${p}, ${f})
                must be that same as the previous version of the image
                (${a.data.width}, ${a.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(l){return l?!!this.style.getImage(l):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(l){this.style.removeImage(l)}loadImage(l,t){o.getImage(this._requestManager.transformRequest(l,o.ResourceType.Image),(a,u)=>{t(a,u instanceof o.window.HTMLImageElement?o.exported.getImageData(u):u)})}listImages(){return this.style.listImages()}addLayer(l,t){return this._lazyInitEmptyStyle(),this.style.addLayer(l,t),this._update(!0)}moveLayer(l,t){return this.style.moveLayer(l,t),this._update(!0)}removeLayer(l){return this.style.removeLayer(l),this._update(!0)}getLayer(l){return this.style.getLayer(l)}setLayerZoomRange(l,t,a){return this.style.setLayerZoomRange(l,t,a),this._update(!0)}setFilter(l,t,a={}){return this.style.setFilter(l,t,a),this._update(!0)}getFilter(l){return this.style.getFilter(l)}setPaintProperty(l,t,a,u={}){return this.style.setPaintProperty(l,t,a,u),this._update(!0)}getPaintProperty(l,t){return this.style.getPaintProperty(l,t)}setLayoutProperty(l,t,a,u={}){return this.style.setLayoutProperty(l,t,a,u),this._update(!0)}getLayoutProperty(l,t){return this.style.getLayoutProperty(l,t)}setLight(l,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(l,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(l){return this._lazyInitEmptyStyle(),!l&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(l),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(l){return this._lazyInitEmptyStyle(),this.style.setFog(l),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(l){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(l),this.transform):0}setFeatureState(l,t){return this.style.setFeatureState(l,t),this._update()}removeFeatureState(l,t){return this.style.removeFeatureState(l,t),this._update()}getFeatureState(l){return this.style.getFeatureState(l)}_updateContainerDimensions(){if(!this._container)return;const l=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let a,u,p,f=this._container;for(;f&&(!u||!p);){const y=o.window.getComputedStyle(f).transform;y&&y!=="none"&&(a=y.match(/matrix.*\((.+)\)/)[1].split(", "),a[0]&&a[0]!=="0"&&a[0]!=="1"&&(u=a[0]),a[3]&&a[3]!=="0"&&a[3]!=="1"&&(p=a[3])),f=f.parentElement}this._containerWidth=u?Math.abs(l/u):l,this._containerHeight=p?Math.abs(t/p):t}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=K("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=K("div","mapboxgl-canvas-container",l);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=K("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const a=this._controlContainer=K("div","mapboxgl-control-container",l),u=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(p=>{u[p]=K("div",`mapboxgl-ctrl-${p}`,a)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(l,t){const a=o.exported.devicePixelRatio||1;this._canvas.width=a*Math.ceil(l),this._canvas.height=a*Math.ceil(t),this._canvas.style.width=`${l}px`,this._canvas.style.height=`${t}px`}_addMarker(l){this._markers.push(l)}_removeMarker(l){const t=this._markers.indexOf(l);t!==-1&&this._markers.splice(t,1)}_setupPainter(){const l=o.extend({},ae.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);t?(o.storeAuthState(t,!0),this.painter=new Os(t,this.transform),this.on("data",a=>{a.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(t)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:l}))}_contextRestored(l){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:l}))}_onMapScroll(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(l){return this._update(),this._renderTaskQueue.add(l)}_cancelRenderFrame(l){this._renderTaskQueue.remove(l)}_requestDomTask(l){!this.loaded()||this.loaded()&&!this.isMoving()?l():this._domRenderTaskQueue.add(l)}_render(l){let t;const a=this.painter.context.extTimerQuery,u=o.exported.now();if(this.listens("gpu-timing-frame")&&(t=a.createQueryEXT(),a.beginQueryEXT(a.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),this._domRenderTaskQueue.run(l),this._removed)return;this.getProjection().name==="globe"&&(this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.projection.name==="globe"&&this._updateProjection():this.transform.projection.name==="mercator"&&this._updateProjection());let p=!1;const f=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const w=this.transform.zoom,A=this.transform.pitch,C=o.exported.now();this.style.zoomHistory.update(w,C);const P=new o.EvaluationParameters(w,{now:C,fadeDuration:f,pitch:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=P.crossFadingFactor();O===1&&O===this._crossFadingFactor||(p=!0,this._crossFadingFactor=O),this.style.update(P)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let y=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),y=this._updateAverageElevation(u),this.style._updateSources(this.transform),this._forceMarkerUpdate()):y=this._updateAverageElevation(u),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,f,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:f,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const w=o.exported.now()-u;a.endQueryEXT(a.TIME_ELAPSED_EXT,t),setTimeout(()=>{const A=a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(t),this.fire(new o.Event("gpu-timing-frame",{cpuTime:w,gpuTime:A})),o.window.performance.mark("frame-gpu",{startTime:u,detail:{gpuTime:A}})},50)}if(this.listens("gpu-timing-layer")){const w=this.painter.collectGpuTimers();setTimeout(()=>{const A=this.painter.queryGpuTimers(w);this.fire(new o.Event("gpu-timing-layer",{layerTimes:A}))},50)}if(this.listens("gpu-timing-deferred-render")){const w=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const A=this.painter.queryGpuTimeDeferredRender(w);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:A}))},50)}const v=this._sourcesDirty||this._styleDirty||this._placementDirty||y;if(v||this._repaint)this.triggerRepaint();else{const w=!this.isMoving()&&this.loaded();if(w&&(y=this._updateAverageElevation(u,!0)),y)this.triggerRepaint();else if(this._triggerFrame(!1),w&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const A=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:A})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||v||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const l of this._markers)l._update()}_updateAverageElevation(l,t=!1){const a=u=>(this.transform.averageElevation=u,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&a(0);if((t||l-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(l)){const u=this.transform.averageElevation;let p=this.transform.sampleAverageElevation(),f=!1;this.transform.elevation&&(f=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(p)?p=0:this._averageElevationLastSampledAt=l;const y=Math.abs(u-p);if(y>1){if(this._isInitialLoad||f)return this._averageElevation.jumpTo(p),a(p);this._averageElevation.easeTo(p,l,300)}else if(y>1e-4)return this._averageElevation.jumpTo(p),a(p)}return!!this._averageElevation.isEasing(l)&&a(this._averageElevation.getValue(l))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,l=>{if(l&&(l.message===o.AUTH_ERR_MSG||l.status===401)){const t=this.painter.context.gl;o.storeAuthState(t,!1),this._logoControl instanceof rl&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const l=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const a=this.painter.context.gl,u=a.createFramebuffer();function p(f){a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,f,0);const y=new Uint8Array(a.drawingBufferWidth*a.drawingBufferHeight*4);return a.readPixels(0,0,a.drawingBufferWidth,a.drawingBufferHeight,a.RGBA,a.UNSIGNED_BYTE,y),y}return a.bindFramebuffer(a.FRAMEBUFFER,u),this._canvasPixelComparison(p(l),t.canvasCopies.map(p),t.timeStamps)}_canvasPixelComparison(l,t,a){let u=a[1]-a[0];const p=l.length/4;for(let f=0;f<t.length;f++){const y=t[f];let v=0;for(let w=0;w<y.length;w+=4)y[w]===l[w]&&y[w+1]===l[w+1]&&y[w+2]===l[w+2]&&y[w+3]===l[w+3]&&(v+=1);u+=(a[f+2]-a[f+1])*(1-v/p)}return u}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),Ks(this._canvasContainer),Ks(this._controlContainer),Ks(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(l){this._renderNextFrame=this._renderNextFrame||l,this.style&&!this._frame&&(this._frame=o.exported.frame(t=>{const a=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,a&&this._render(t)}))}_preloadTiles(l){const t=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(t,(a,u)=>a._preloadTiles(l,u),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(l){this._trackResize&&this.resize({originalEvent:l})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(l){this._showTerrainWireframe!==l&&(this._showTerrainWireframe=l,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(l){this._speedIndexTiming!==l&&(this._speedIndexTiming=l,this._update())}get showPadding(){return!!this._showPadding}set showPadding(l){this._showPadding!==l&&(this._showPadding=l,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())}get repaint(){return!!this._repaint}set repaint(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(l){this._vertices=l,this._update()}_setCacheLimits(l,t){o.setCacheLimits(l,t)}get version(){return o.version}},NavigationControl:class{constructor(l){this.options=o.extend({},Nc,l),this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),K("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),K("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const a=this._map;a&&(this.options.visualizePitch?a.resetNorthPitch({},{originalEvent:t}):a.resetNorth({},{originalEvent:t}))}),this._compassIcon=K("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const l=this._map;if(!l)return;const t=l.getZoom(),a=t===l.getMaxZoom(),u=t===l.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const l=this._map;if(!l)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(l.transform.pitch*(Math.PI/180)),.5)}) rotateX(${l.transform.pitch}deg) rotateZ(${l.transform.angle*(180/Math.PI)}deg)`:`rotate(${l.transform.angle*(180/Math.PI)}deg)`;l._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),l.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&l.on("pitch",this._rotateCompassArrow),l.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gc(l,this._compass,this.options.visualizePitch)),this._container}onRemove(){const l=this._map;l&&(this._container.remove(),this.options.showZoom&&l.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&l.off("pitch",this._rotateCompassArrow),l.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(l,t){const a=K("button",l,this._container);return a.type="button",a.addEventListener("click",t),a}_setButtonTitle(l,t){if(!this._map)return;const a=this._map._getUIString(`NavigationControl.${t}`);l.setAttribute("aria-label",a),l.firstElementChild&&l.firstElementChild.setAttribute("title",a)}},GeolocateControl:class extends o.Evented{constructor(l){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},sl,l),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Fa(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(l){return this._map=l,this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(l){this._supportsGeolocation!==void 0?l(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(t=>{this._supportsGeolocation=t.state!=="denied",l(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.geolocation,l(this._supportsGeolocation))}_isOutOfMapMaxBounds(l){const t=this._map.getMaxBounds(),a=l.coords;return!!t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",l)),this._finish()}}_updateCamera(l){const t=new o.LngLat(l.coords.longitude,l.coords.latitude),a=l.coords.accuracy,u=this._map.getBearing(),p=o.extend({bearing:u},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(a),p,{geolocateSource:!0})}_updateMarker(l){if(l){const t=new o.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const l=this._map.transform,t=o.mercatorZfromAltitude(1,l._center.lat)*l.worldSize,a=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(l){if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",l)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(l){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=K("button","mapboxgl-ctrl-geolocate",this._container),K("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K("div","mapboxgl-user-location"),this._dotElement.appendChild(K("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(K("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ys({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=K("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ys({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}_onDeviceOrientation(l){this._userLocationDotMarker&&(l.webkitCompassHeading?this._heading=l.webkitCompassHeading:l.absolute===!0&&(this._heading=-1*l.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(l={maximumAge:6e5,timeout:0},this._noTimeout=!0):(l=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,l),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const l=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&l()}).catch(console.error):l()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:il,ScaleControl:class{constructor(l){this.options=o.extend({},Uc,l),o.bindAll(["_update","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){(function(l,t,a,u){const p=u&&u.maxWidth||100,f=l._containerHeight/2,y=l._containerWidth/2-p/2,v=l.unproject([y,f]),w=l.unproject([y+p,f]),A=v.distanceTo(w);if(u&&u.unit==="imperial"){const C=3.2808*A;C>5280?xo(t,p,C/5280,a,"mile",l):xo(t,p,C,a,"foot",l)}else u&&u.unit==="nautical"?xo(t,p,A/1852,a,"nautical-mile",l):A>=1e3?xo(t,p,A/1e3,a,"kilometer",l):xo(t,p,A,a,"meter",l)})(this._map,this._container,this._language,this.options)}onAdd(l){return this._map=l,this._language=l.getLanguage(),this._container=K("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(l){this._language=l,this._update()}setUnit(l){this.options.unit=l,this._update()}},FullscreenControl:class{constructor(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof o.window.HTMLElement?this._container=l.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=K("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const l=this._fullscreenButton=K("button","mapboxgl-ctrl-fullscreen",this._controlContainer);K("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden","true"),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",l)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(l){super(),this.options=o.extend(Object.create(Vc),l),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(l&&l.className?l.className.trim().split(/\s+/):[])}addTo(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&l.on("preclick",this._onClose),this.options.closeOnMove&&l.on("move",this._onClose),l.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(l.on("mousemove",this._onMouseEvent),l.on("mouseup",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")):l.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const l=this._map;return l&&(l.off("move",this._update),l.off("move",this._onClose),l.off("preclick",this._onClose),l.off("click",this._onClose),l.off("remove",this.remove),l.off("mousemove",this._onMouseEvent),l.off("mouseup",this._onMouseEvent),l.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(l){this._lngLat=o.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const l=this._map;return l&&(l.off("move",this._update),l.on("mousemove",this._onMouseEvent),l.on("drag",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(l){return this.setDOMContent(o.window.document.createTextNode(l))}setHTML(l){const t=o.window.document.createDocumentFragment(),a=o.window.document.createElement("body");let u;for(a.innerHTML=l;u=a.firstChild,u;)t.appendChild(u);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(l){return this.options.maxWidth=l,this._update(),this}setDOMContent(l){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=K("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(l),this.options.closeButton){const a=this._closeButton=K("button","mapboxgl-popup-close-button",t);a.type="button",a.setAttribute("aria-label","Close popup"),a.setAttribute("aria-hidden","true"),a.innerHTML="&#215;",a.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(l){return this._classList.add(l),this._updateClassList(),this}removeClassName(l){return this._classList.delete(l),this._updateClassList(),this}setOffset(l){return this.options.offset=l,this._update(),this}toggleClassName(l){let t;return this._classList.delete(l)?t=!1:(this._classList.add(l),t=!0),this._updateClassList(),t}_onMouseEvent(l){this._update(l.point)}_getAnchor(l){if(this.options.anchor)return this.options.anchor;const t=this._map,a=this._container,u=this._pos;if(!t||!a||!u)return"bottom";const p=a.offsetWidth,f=a.offsetHeight,y=u.x<p/2,v=u.x>t.transform.width-p/2;if(u.y+l<f)return y?"top-left":v?"top-right":"top";if(u.y>t.transform.height-f){if(y)return"bottom-left";if(v)return"bottom-right"}return y?"left":v?"right":"bottom"}_updateClassList(){const l=this._container;if(!l)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),l.className=t.join(" ")}_update(l){const t=this._map,a=this._content;if(!t||!this._lngLat&&!this._trackPointer||!a)return;let u=this._container;if(u||(u=this._container=K("div","mapboxgl-popup",t.getContainer()),this._tip=K("div","mapboxgl-popup-tip",u),u.appendChild(a)),this.options.maxWidth&&u.style.maxWidth!==this.options.maxWidth&&(u.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ol(this._lngLat,this._pos,t.transform)),!this._trackPointer||l){const p=this._pos=this._trackPointer&&l?l:t.project(this._lngLat),f=Qs(this.options.offset),y=this._anchor=this._getAnchor(f.y),v=Qs(this.options.offset,y),w=p.add(v).round();t._requestDomTask(()=>{this._container&&y&&(this._container.style.transform=`${Hs[y]} translate(${w.x}px,${w.y}px)`)})}if(!this._marker&&t._usingGlobe()){const p=o.isLngLatBehindGlobe(t.transform,this._lngLat)?0:1;this._setOpacity(p)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const l=this._container.querySelector(ll);l&&l.focus()}_onClose(){this.remove()}_setOpacity(l){this._container&&(this._container.style.opacity=`${l}`),this._content&&(this._content.style.pointerEvents=l?"auto":"none")}},Marker:Ys,Style:rn,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:Ba,Evented:o.Evented,config:o.config,prewarm:function(){ti().acquire(It)},clearPrewarmedResources:function(){const l=Vt;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(It),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(l){o.config.ACCESS_TOKEN=l},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(l){o.config.API_URL=l},get workerCount(){return Mt.workerCount},set workerCount(l){Mt.workerCount=l},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){o.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage(l){o.clearTileCache(l)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Ho});var F=k;return F})})(G8);var S0=G8.exports,V8={exports:{}};(function(g,x){(function(){var E=Math.PI,I=Math.sin,k=Math.cos,L=Math.tan,F=Math.asin,o=Math.atan2,Z=Math.acos,ae=E/180,te=1e3*60*60*24,N=2440588,K=2451545;function fe(mt){return mt.valueOf()/te-.5+N}function Te(mt){return new Date((mt+.5-N)*te)}function Ce(mt){return fe(mt)-K}var ke=ae*23.4397;function Qe(mt,_t){return o(I(mt)*k(ke)-L(_t)*I(ke),k(mt))}function Ve(mt,_t){return F(I(_t)*k(ke)+k(_t)*I(ke)*I(mt))}function Oe(mt,_t,xt){return o(I(mt),k(mt)*I(_t)-L(xt)*k(_t))}function $e(mt,_t,xt){return F(I(_t)*I(xt)+k(_t)*k(xt)*k(mt))}function xe(mt,_t){return ae*(280.16+360.9856235*mt)-_t}function dt(mt){return mt<0&&(mt=0),2967e-7/Math.tan(mt+.00312536/(mt+.08901179))}function We(mt){return ae*(357.5291+.98560028*mt)}function gt(mt){var _t=ae*(1.9148*I(mt)+.02*I(2*mt)+3e-4*I(3*mt)),xt=ae*102.9372;return mt+_t+xt+E}function wt(mt){var _t=We(mt),xt=gt(_t);return{dec:Ve(xt,0),ra:Qe(xt,0)}}var He={};He.getPosition=function(mt,_t,xt){var Ht=ae*-xt,Bt=ae*_t,fi=Ce(mt),ni=wt(fi),wi=xe(fi,Ht)-ni.ra;return{azimuth:Oe(wi,Bt,ni.dec),altitude:$e(wi,Bt,ni.dec)}};var Je=He.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];He.addTime=function(mt,_t,xt){Je.push([mt,_t,xt])};var Ye=9e-4;function qe(mt,_t){return Math.round(mt-Ye-_t/(2*E))}function Xe(mt,_t,xt){return Ye+(mt+_t)/(2*E)+xt}function ze(mt,_t,xt){return K+mt+.0053*I(_t)-.0069*I(2*xt)}function St(mt,_t,xt){return Z((I(mt)-I(_t)*I(xt))/(k(_t)*k(xt)))}function zt(mt){return-2.076*Math.sqrt(mt)/60}function ei(mt,_t,xt,Ht,Bt,fi,ni){var wi=St(mt,xt,Ht),Ji=Xe(wi,_t,Bt);return ze(Ji,fi,ni)}He.getTimes=function(mt,_t,xt,Ht){Ht=Ht||0;var Bt=ae*-xt,fi=ae*_t,ni=zt(Ht),wi=Ce(mt),Ji=qe(wi,Bt),ji=Xe(0,Bt,Ji),gr=We(ji),or=gt(gr),yr=Ve(or,0),Lt=ze(ji,gr,or),er,br,$i,zi,ur,Ut,Zi={solarNoon:Te(Lt),nadir:Te(Lt-.5)};for(er=0,br=Je.length;er<br;er+=1)$i=Je[er],zi=($i[0]+ni)*ae,ur=ei(zi,Bt,fi,yr,Ji,gr,or),Ut=Lt-(ur-Lt),Zi[$i[1]]=Te(Ut),Zi[$i[2]]=Te(ur);return Zi};function si(mt){var _t=ae*(218.316+13.176396*mt),xt=ae*(134.963+13.064993*mt),Ht=ae*(93.272+13.22935*mt),Bt=_t+ae*6.289*I(xt),fi=ae*5.128*I(Ht),ni=385001-20905*k(xt);return{ra:Qe(Bt,fi),dec:Ve(Bt,fi),dist:ni}}He.getMoonPosition=function(mt,_t,xt){var Ht=ae*-xt,Bt=ae*_t,fi=Ce(mt),ni=si(fi),wi=xe(fi,Ht)-ni.ra,Ji=$e(wi,Bt,ni.dec),ji=o(I(wi),L(Bt)*k(ni.dec)-I(ni.dec)*k(wi));return Ji=Ji+dt(Ji),{azimuth:Oe(wi,Bt,ni.dec),altitude:Ji,distance:ni.dist,parallacticAngle:ji}},He.getMoonIllumination=function(mt){var _t=Ce(mt||new Date),xt=wt(_t),Ht=si(_t),Bt=149598e3,fi=Z(I(xt.dec)*I(Ht.dec)+k(xt.dec)*k(Ht.dec)*k(xt.ra-Ht.ra)),ni=o(Bt*I(fi),Ht.dist-Bt*k(fi)),wi=o(k(xt.dec)*I(xt.ra-Ht.ra),I(xt.dec)*k(Ht.dec)-k(xt.dec)*I(Ht.dec)*k(xt.ra-Ht.ra));return{fraction:(1+k(ni))/2,phase:.5+.5*ni*(wi<0?-1:1)/Math.PI,angle:wi}};function Ri(mt,_t){return new Date(mt.valueOf()+_t*te/24)}He.getMoonTimes=function(mt,_t,xt,Ht){var Bt=new Date(mt);Ht?Bt.setUTCHours(0,0,0,0):Bt.setHours(0,0,0,0);for(var fi=.133*ae,ni=He.getMoonPosition(Bt,_t,xt).altitude-fi,wi,Ji,ji,gr,or,yr,Lt,er,br,$i,zi,ur,Ut,Zi=1;Zi<=24&&(wi=He.getMoonPosition(Ri(Bt,Zi),_t,xt).altitude-fi,Ji=He.getMoonPosition(Ri(Bt,Zi+1),_t,xt).altitude-fi,or=(ni+Ji)/2-wi,yr=(Ji-ni)/2,Lt=-yr/(2*or),er=(or*Lt+yr)*Lt+wi,br=yr*yr-4*or*wi,$i=0,br>=0&&(Ut=Math.sqrt(br)/(Math.abs(or)*2),zi=Lt-Ut,ur=Lt+Ut,Math.abs(zi)<=1&&$i++,Math.abs(ur)<=1&&$i++,zi<-1&&(zi=ur)),$i===1?ni<0?ji=Zi+zi:gr=Zi+zi:$i===2&&(ji=Zi+(er<0?ur:zi),gr=Zi+(er<0?zi:ur)),!(ji&&gr));Zi+=2)ni=Ji;var wr={};return ji&&(wr.rise=Ri(Bt,ji)),gr&&(wr.set=Ri(Bt,gr)),!ji&&!gr&&(wr[er>0?"alwaysUp":"alwaysDown"]=!0),wr},g.exports=He})()})(V8);var b_=V8.exports;function w_(g){let x,E,I,k,L;return{c(){x=Nt("link"),E=vn(),I=Nt("div"),this.h()},l(F){const o=R8('[data-svelte="svelte-1eqgqk6"]',document.head);x=Gt(o,"LINK",{rel:!0,href:!0}),o.forEach(ht),E=bn(F),I=Gt(F,"DIV",{class:!0}),Jt(I).forEach(ht),this.h()},h(){Me(x,"rel","stylesheet"),Me(x,"href","https://unpkg.com/mapbox-gl/dist/mapbox-gl.css"),Me(I,"class","w-full h-screen relative z-0")},m(F,o){At(document.head,x),ir(F,E,o),ir(F,I,o),g[3](I),k||(L=Vf(x,"load",g[1]),k=!0)},p:Dr,i:Dr,o:Dr,d(F){ht(x),F&&ht(E),F&&ht(I),g[3](null),k=!1,L()}}}function T_(g,x,E){let{index:I=void 0}=x,k,L;const F=new Map;F.set("default",{center:[-122.257426,37.829682],zoom:10,pitch:0}),F.set("gardena",{center:[-118.2998,33.8818],zoom:11,pitch:40}),F.set("sandel",{center:[-118.270405,33.8899148],zoom:18,pitch:50}),F.set("smog",{center:[-118.270405,33.8899148],zoom:16,pitch:80}),F.set("playa-del-rey",{center:[-118.43411,33.95663],zoom:14,pitch:80}),F.set("fremont",{center:[-122.001,37.5306],zoom:11,pitch:0}),F.set("transition",{center:[-121.969,37.562],zoom:16,pitch:80});function o(te){const N=L.getCenter(),K=b_.getPosition(te||Date.now(),N.lat,N.lng),fe=180+K.azimuth*180/Math.PI,Te=90-K.altitude*180/Math.PI;return[fe,Te]}const Z=()=>{L=new S0.Map({container:k,style:"mapbox://styles/aboutaaron/cl3157ite000a15pn86mr94gv",...F.get("default")});const te=Math.max(...[...F.values()].map(N=>N==null?void 0:N.zoom).filter(N=>N));L.addControl(new S0.NavigationControl({showZoom:!1})),L.scrollZoom.disable(),L.dragRotate.disable(),L.touchZoomRotate.disableRotation(),L.on("load",()=>{L.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:te}),L.setTerrain({source:"mapbox-dem",exaggeration:1.5}),L.addLayer({id:"sky",type:"sky",paint:{"sky-opacity":["interpolate",["linear"],["zoom"],0,0,5,.3,8,1],"sky-type":"atmosphere","sky-atmosphere-sun":o(),"sky-atmosphere-sun-intensity":50}}),L.addSource("los-angeles",{type:"geojson",data:g_}),L.addSource("fremont",{type:"geojson",data:v_}),L.addLayer({id:"neighborhoods",type:"fill",source:"los-angeles",paint:{"fill-opacity":0,"fill-outline-color":"transparent"},filter:["==","$type","Polygon"]}),L.addLayer({id:"fremontN",type:"fill",source:"fremont",paint:{"fill-opacity":0,"fill-outline-color":"transparent"},filter:["==","$type","Polygon"]}),L.addLayer({id:"neighborhoods-highlighted",type:"fill",source:"los-angeles",paint:{"fill-color":"#D9AE5F","fill-opacity":.25,"fill-outline-color":"#D9AE5F"},filter:["in","Name",""]}),L.addLayer({id:"fremontN-highlighted",type:"fill",source:"fremont",paint:{"fill-color":"#D9AE5F","fill-opacity":.25,"fill-outline-color":"#D9AE5F"},filter:["in","NAME",""]})})};nu(()=>{S0.accessToken="pk.eyJ1IjoiYWJvdXRhYXJvbiIsImEiOiJsRTRpMGJnIn0.aprlJ6wE1JQqBx4EH1lkMQ",Z()}),jf(()=>{const te=Vn.slides[I!=null?I:0];if(!Object.prototype.hasOwnProperty.call(te,"id")||I===void 0)return null;L.flyTo(F.get(te.id)),L.once("moveend",()=>{te.id==="gardena"?(L.rotateTo(0,{duration:2500}),L.setFilter("neighborhoods-highlighted",["any",["in","Name","Gardena"],["in","Name","West Compton"]])):te.id==="sandel"?(L.setFilter("neighborhoods-highlighted",["in","Name",""]),L.rotateTo(80,{duration:6500}),L.setFog({color:"transparent","horizon-blend":.1})):te.id==="smog"?L.setFog({color:"rgba(194, 189, 158, 1.0)","horizon-blend":.1}):te.id==="playa-del-rey"?(L.setFilter("fremontN-highlighted",["in","NAME",""]),L.setFilter("neighborhoods-highlighted",["in","Name","Playa del Rey"]),L.rotateTo(-120,{duration:6500}),L.setFog({color:"transparent","horizon-blend":.1})):te.id==="fremont"?(L.setFilter("fremontN-highlighted",["!=","NAME",""]),L.rotateTo(0,{duration:2500})):te.id==="transition"?(L.setFilter("fremontN-highlighted",["in","NAME",""]),L.rotateTo(280,{duration:6500})):(L.setFilter("neighborhoods-highlighted",["in","Name",""]),L.rotateTo(0,{duration:2500}))})});function ae(te){Vl[te?"unshift":"push"](()=>{k=te,E(0,k)})}return g.$$set=te=>{"index"in te&&E(2,I=te.index)},[k,Z,I,ae]}class j8 extends Sn{constructor(x){super(),En(this,x,T_,w_,An,{index:2})}}function I_(g){let x,E;const I=g[1].default,k=eu(I,g,g[0],null);return{c(){x=Nt("div"),k&&k.c(),this.h()},l(L){x=Gt(L,"DIV",{class:!0});var F=Jt(x);k&&k.l(F),F.forEach(ht),this.h()},h(){Me(x,"class","w-full flex justify-center mb-6 items-center relative z-50 h-screen")},m(L,F){ir(L,x,F),k&&k.m(x,null),E=!0},p(L,[F]){k&&k.p&&(!E||F&1)&&tu(k,I,L,L[0],E?ru(I,L[0],F,null):iu(L[0]),null)},i(L){E||(Qi(k,L),E=!0)},o(L){nr(k,L),E=!1},d(L){L&&ht(x),k&&k.d(L)}}}function S_(g,x,E){let{$$slots:I={},$$scope:k}=x;return g.$$set=L=>{"$$scope"in L&&E(0,k=L.$$scope)},[k,I]}class $8 extends Sn{constructor(x){super(),En(this,x,S_,I_,An,{})}}function F9(g,x){return g==null||x==null?NaN:g<x?-1:g>x?1:g>=x?0:NaN}function E_(g,x){return g==null||x==null?NaN:x<g?-1:x>g?1:x>=g?0:NaN}function Z8(g){let x,E,I;g.length!==2?(x=F9,E=(o,Z)=>F9(g(o),Z),I=(o,Z)=>g(o)-Z):(x=g===F9||g===E_?g:A_,E=g,I=g);function k(o,Z,ae=0,te=o.length){if(ae<te){if(x(Z,Z)!==0)return te;do{const N=ae+te>>>1;E(o[N],Z)<0?ae=N+1:te=N}while(ae<te)}return ae}function L(o,Z,ae=0,te=o.length){if(ae<te){if(x(Z,Z)!==0)return te;do{const N=ae+te>>>1;E(o[N],Z)<=0?ae=N+1:te=N}while(ae<te)}return ae}function F(o,Z,ae=0,te=o.length){const N=k(o,Z,ae,te-1);return N>ae&&I(o[N-1],Z)>-I(o[N],Z)?N-1:N}return{left:k,center:F,right:L}}function A_(){return 0}function k_(g){return g===null?NaN:+g}const M_=Z8(F9),C_=M_.right;Z8(k_).center;var z_=C_;function P_(g,x){let E,I;if(x===void 0)for(const k of g)k!=null&&(E===void 0?k>=k&&(E=I=k):(E>k&&(E=k),I<k&&(I=k)));else{let k=-1;for(let L of g)(L=x(L,++k,g))!=null&&(E===void 0?L>=L&&(E=I=L):(E>L&&(E=L),I<L&&(I=L)))}return[E,I]}class as{constructor(){this._partials=new Float64Array(32),this._n=0}add(x){const E=this._partials;let I=0;for(let k=0;k<this._n&&k<32;k++){const L=E[k],F=x+L,o=Math.abs(x)<Math.abs(L)?x-(F-L):L-(F-x);o&&(E[I++]=o),x=F}return E[I]=x,this._n=I+1,this}valueOf(){const x=this._partials;let E=this._n,I,k,L,F=0;if(E>0){for(F=x[--E];E>0&&(I=F,k=x[--E],F=I+k,L=k-(F-I),!L););E>0&&(L<0&&x[E-1]<0||L>0&&x[E-1]>0)&&(k=L*2,I=F+k,k==I-F&&(F=I))}return F}}var D0=Math.sqrt(50),L0=Math.sqrt(10),R0=Math.sqrt(2);function D_(g,x,E){var I,k=-1,L,F,o;if(x=+x,g=+g,E=+E,g===x&&E>0)return[g];if((I=x<g)&&(L=g,g=x,x=L),(o=q8(g,x,E))===0||!isFinite(o))return[];if(o>0){let Z=Math.round(g/o),ae=Math.round(x/o);for(Z*o<g&&++Z,ae*o>x&&--ae,F=new Array(L=ae-Z+1);++k<L;)F[k]=(Z+k)*o}else{o=-o;let Z=Math.round(g*o),ae=Math.round(x*o);for(Z/o<g&&++Z,ae/o>x&&--ae,F=new Array(L=ae-Z+1);++k<L;)F[k]=(Z+k)/o}return I&&F.reverse(),F}function q8(g,x,E){var I=(x-g)/Math.max(0,E),k=Math.floor(Math.log(I)/Math.LN10),L=I/Math.pow(10,k);return k>=0?(L>=D0?10:L>=L0?5:L>=R0?2:1)*Math.pow(10,k):-Math.pow(10,-k)/(L>=D0?10:L>=L0?5:L>=R0?2:1)}function L_(g,x,E){var I=Math.abs(x-g)/Math.max(0,E),k=Math.pow(10,Math.floor(Math.log(I)/Math.LN10)),L=I/k;return L>=D0?k*=10:L>=L0?k*=5:L>=R0&&(k*=2),x<g?-k:k}function*R_(g){for(const x of g)yield*x}function W8(g){return Array.from(R_(g))}function au(g,x,E){g.prototype=x.prototype=E,E.constructor=g}function X8(g,x){var E=Object.create(g.prototype);for(var I in x)E[I]=x[I];return E}function Xl(){}var $l=.7,U9=1/$l,x1="\\s*([+-]?\\d+)\\s*",Zl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",B_=/^#([0-9a-f]{3,8})$/,O_=new RegExp(`^rgb\\(${x1},${x1},${x1}\\)$`),F_=new RegExp(`^rgb\\(${oo},${oo},${oo}\\)$`),N_=new RegExp(`^rgba\\(${x1},${x1},${x1},${Zl}\\)$`),G_=new RegExp(`^rgba\\(${oo},${oo},${oo},${Zl}\\)$`),U_=new RegExp(`^hsl\\(${Zl},${oo},${oo}\\)$`),V_=new RegExp(`^hsla\\(${Zl},${oo},${oo},${Zl}\\)$`),$2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};au(Xl,ql,{copy(g){return Object.assign(new this.constructor,this,g)},displayable(){return this.rgb().displayable()},hex:Z2,formatHex:Z2,formatHex8:j_,formatHsl:$_,formatRgb:q2,toString:q2});function Z2(){return this.rgb().formatHex()}function j_(){return this.rgb().formatHex8()}function $_(){return J8(this).formatHsl()}function q2(){return this.rgb().formatRgb()}function ql(g){var x,E;return g=(g+"").trim().toLowerCase(),(x=B_.exec(g))?(E=x[1].length,x=parseInt(x[1],16),E===6?W2(x):E===3?new en(x>>8&15|x>>4&240,x>>4&15|x&240,(x&15)<<4|x&15,1):E===8?z9(x>>24&255,x>>16&255,x>>8&255,(x&255)/255):E===4?z9(x>>12&15|x>>8&240,x>>8&15|x>>4&240,x>>4&15|x&240,((x&15)<<4|x&15)/255):null):(x=O_.exec(g))?new en(x[1],x[2],x[3],1):(x=F_.exec(g))?new en(x[1]*255/100,x[2]*255/100,x[3]*255/100,1):(x=N_.exec(g))?z9(x[1],x[2],x[3],x[4]):(x=G_.exec(g))?z9(x[1]*255/100,x[2]*255/100,x[3]*255/100,x[4]):(x=U_.exec(g))?H2(x[1],x[2]/100,x[3]/100,1):(x=V_.exec(g))?H2(x[1],x[2]/100,x[3]/100,x[4]):$2.hasOwnProperty(g)?W2($2[g]):g==="transparent"?new en(NaN,NaN,NaN,0):null}function W2(g){return new en(g>>16&255,g>>8&255,g&255,1)}function z9(g,x,E,I){return I<=0&&(g=x=E=NaN),new en(g,x,E,I)}function Z_(g){return g instanceof Xl||(g=ql(g)),g?(g=g.rgb(),new en(g.r,g.g,g.b,g.opacity)):new en}function B0(g,x,E,I){return arguments.length===1?Z_(g):new en(g,x,E,I==null?1:I)}function en(g,x,E,I){this.r=+g,this.g=+x,this.b=+E,this.opacity=+I}au(en,B0,X8(Xl,{brighter(g){return g=g==null?U9:Math.pow(U9,g),new en(this.r*g,this.g*g,this.b*g,this.opacity)},darker(g){return g=g==null?$l:Math.pow($l,g),new en(this.r*g,this.g*g,this.b*g,this.opacity)},rgb(){return this},clamp(){return new en(os(this.r),os(this.g),os(this.b),V9(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:X2,formatHex:X2,formatHex8:q_,formatRgb:J2,toString:J2}));function X2(){return`#${ns(this.r)}${ns(this.g)}${ns(this.b)}`}function q_(){return`#${ns(this.r)}${ns(this.g)}${ns(this.b)}${ns((isNaN(this.opacity)?1:this.opacity)*255)}`}function J2(){const g=V9(this.opacity);return`${g===1?"rgb(":"rgba("}${os(this.r)}, ${os(this.g)}, ${os(this.b)}${g===1?")":`, ${g})`}`}function V9(g){return isNaN(g)?1:Math.max(0,Math.min(1,g))}function os(g){return Math.max(0,Math.min(255,Math.round(g)||0))}function ns(g){return g=os(g),(g<16?"0":"")+g.toString(16)}function H2(g,x,E,I){return I<=0?g=x=E=NaN:E<=0||E>=1?g=x=NaN:x<=0&&(g=NaN),new Gn(g,x,E,I)}function J8(g){if(g instanceof Gn)return new Gn(g.h,g.s,g.l,g.opacity);if(g instanceof Xl||(g=ql(g)),!g)return new Gn;if(g instanceof Gn)return g;g=g.rgb();var x=g.r/255,E=g.g/255,I=g.b/255,k=Math.min(x,E,I),L=Math.max(x,E,I),F=NaN,o=L-k,Z=(L+k)/2;return o?(x===L?F=(E-I)/o+(E<I)*6:E===L?F=(I-x)/o+2:F=(x-E)/o+4,o/=Z<.5?L+k:2-L-k,F*=60):o=Z>0&&Z<1?0:F,new Gn(F,o,Z,g.opacity)}function W_(g,x,E,I){return arguments.length===1?J8(g):new Gn(g,x,E,I==null?1:I)}function Gn(g,x,E,I){this.h=+g,this.s=+x,this.l=+E,this.opacity=+I}au(Gn,W_,X8(Xl,{brighter(g){return g=g==null?U9:Math.pow(U9,g),new Gn(this.h,this.s,this.l*g,this.opacity)},darker(g){return g=g==null?$l:Math.pow($l,g),new Gn(this.h,this.s,this.l*g,this.opacity)},rgb(){var g=this.h%360+(this.h<0)*360,x=isNaN(g)||isNaN(this.s)?0:this.s,E=this.l,I=E+(E<.5?E:1-E)*x,k=2*E-I;return new en(E0(g>=240?g-240:g+120,k,I),E0(g,k,I),E0(g<120?g+240:g-120,k,I),this.opacity)},clamp(){return new Gn(Y2(this.h),P9(this.s),P9(this.l),V9(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const g=V9(this.opacity);return`${g===1?"hsl(":"hsla("}${Y2(this.h)}, ${P9(this.s)*100}%, ${P9(this.l)*100}%${g===1?")":`, ${g})`}`}}));function Y2(g){return g=(g||0)%360,g<0?g+360:g}function P9(g){return Math.max(0,Math.min(1,g||0))}function E0(g,x,E){return(g<60?x+(E-x)*g/60:g<180?E:g<240?x+(E-x)*(240-g)/60:x)*255}var su=g=>()=>g;function X_(g,x){return function(E){return g+E*x}}function J_(g,x,E){return g=Math.pow(g,E),x=Math.pow(x,E)-g,E=1/E,function(I){return Math.pow(g+I*x,E)}}function H_(g){return(g=+g)==1?H8:function(x,E){return E-x?J_(x,E,g):su(isNaN(x)?E:x)}}function H8(g,x){var E=x-g;return E?X_(g,E):su(isNaN(g)?x:g)}var K2=function g(x){var E=H_(x);function I(k,L){var F=E((k=B0(k)).r,(L=B0(L)).r),o=E(k.g,L.g),Z=E(k.b,L.b),ae=H8(k.opacity,L.opacity);return function(te){return k.r=F(te),k.g=o(te),k.b=Z(te),k.opacity=ae(te),k+""}}return I.gamma=g,I}(1);function Y_(g,x){x||(x=[]);var E=g?Math.min(x.length,g.length):0,I=x.slice(),k;return function(L){for(k=0;k<E;++k)I[k]=g[k]*(1-L)+x[k]*L;return I}}function K_(g){return ArrayBuffer.isView(g)&&!(g instanceof DataView)}function Q_(g,x){var E=x?x.length:0,I=g?Math.min(E,g.length):0,k=new Array(I),L=new Array(E),F;for(F=0;F<I;++F)k[F]=lu(g[F],x[F]);for(;F<E;++F)L[F]=x[F];return function(o){for(F=0;F<I;++F)L[F]=k[F](o);return L}}function e5(g,x){var E=new Date;return g=+g,x=+x,function(I){return E.setTime(g*(1-I)+x*I),E}}function j9(g,x){return g=+g,x=+x,function(E){return g*(1-E)+x*E}}function t5(g,x){var E={},I={},k;(g===null||typeof g!="object")&&(g={}),(x===null||typeof x!="object")&&(x={});for(k in x)k in g?E[k]=lu(g[k],x[k]):I[k]=x[k];return function(L){for(k in E)I[k]=E[k](L);return I}}var O0=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,A0=new RegExp(O0.source,"g");function i5(g){return function(){return g}}function r5(g){return function(x){return g(x)+""}}function n5(g,x){var E=O0.lastIndex=A0.lastIndex=0,I,k,L,F=-1,o=[],Z=[];for(g=g+"",x=x+"";(I=O0.exec(g))&&(k=A0.exec(x));)(L=k.index)>E&&(L=x.slice(E,L),o[F]?o[F]+=L:o[++F]=L),(I=I[0])===(k=k[0])?o[F]?o[F]+=k:o[++F]=k:(o[++F]=null,Z.push({i:F,x:j9(I,k)})),E=A0.lastIndex;return E<x.length&&(L=x.slice(E),o[F]?o[F]+=L:o[++F]=L),o.length<2?Z[0]?r5(Z[0].x):i5(x):(x=Z.length,function(ae){for(var te=0,N;te<x;++te)o[(N=Z[te]).i]=N.x(ae);return o.join("")})}function lu(g,x){var E=typeof x,I;return x==null||E==="boolean"?su(x):(E==="number"?j9:E==="string"?(I=ql(x))?(x=I,K2):n5:x instanceof ql?K2:x instanceof Date?e5:K_(x)?Y_:Array.isArray(x)?Q_:typeof x.valueOf!="function"&&typeof x.toString!="function"||isNaN(x)?t5:j9)(g,x)}function o5(g,x){return g=+g,x=+x,function(E){return Math.round(g*(1-E)+x*E)}}function a5(g){return Math.abs(g=Math.round(g))>=1e21?g.toLocaleString("en").replace(/,/g,""):g.toString(10)}function $9(g,x){if((E=(g=x?g.toExponential(x-1):g.toExponential()).indexOf("e"))<0)return null;var E,I=g.slice(0,E);return[I.length>1?I[0]+I.slice(2):I,+g.slice(E+1)]}function b1(g){return g=$9(Math.abs(g)),g?g[1]:NaN}function s5(g,x){return function(E,I){for(var k=E.length,L=[],F=0,o=g[0],Z=0;k>0&&o>0&&(Z+o+1>I&&(o=Math.max(1,I-Z)),L.push(E.substring(k-=o,k+o)),!((Z+=o+1)>I));)o=g[F=(F+1)%g.length];return L.reverse().join(x)}}function l5(g){return function(x){return x.replace(/[0-9]/g,function(E){return g[+E]})}}var c5=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Z9(g){if(!(x=c5.exec(g)))throw new Error("invalid format: "+g);var x;return new cu({fill:x[1],align:x[2],sign:x[3],symbol:x[4],zero:x[5],width:x[6],comma:x[7],precision:x[8]&&x[8].slice(1),trim:x[9],type:x[10]})}Z9.prototype=cu.prototype;function cu(g){this.fill=g.fill===void 0?" ":g.fill+"",this.align=g.align===void 0?">":g.align+"",this.sign=g.sign===void 0?"-":g.sign+"",this.symbol=g.symbol===void 0?"":g.symbol+"",this.zero=!!g.zero,this.width=g.width===void 0?void 0:+g.width,this.comma=!!g.comma,this.precision=g.precision===void 0?void 0:+g.precision,this.trim=!!g.trim,this.type=g.type===void 0?"":g.type+""}cu.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function u5(g){e:for(var x=g.length,E=1,I=-1,k;E<x;++E)switch(g[E]){case".":I=k=E;break;case"0":I===0&&(I=E),k=E;break;default:if(!+g[E])break e;I>0&&(I=0);break}return I>0?g.slice(0,I)+g.slice(k+1):g}var Y8;function h5(g,x){var E=$9(g,x);if(!E)return g+"";var I=E[0],k=E[1],L=k-(Y8=Math.max(-8,Math.min(8,Math.floor(k/3)))*3)+1,F=I.length;return L===F?I:L>F?I+new Array(L-F+1).join("0"):L>0?I.slice(0,L)+"."+I.slice(L):"0."+new Array(1-L).join("0")+$9(g,Math.max(0,x+L-1))[0]}function Q2(g,x){var E=$9(g,x);if(!E)return g+"";var I=E[0],k=E[1];return k<0?"0."+new Array(-k).join("0")+I:I.length>k+1?I.slice(0,k+1)+"."+I.slice(k+1):I+new Array(k-I.length+2).join("0")}var e8={"%":(g,x)=>(g*100).toFixed(x),b:g=>Math.round(g).toString(2),c:g=>g+"",d:a5,e:(g,x)=>g.toExponential(x),f:(g,x)=>g.toFixed(x),g:(g,x)=>g.toPrecision(x),o:g=>Math.round(g).toString(8),p:(g,x)=>Q2(g*100,x),r:Q2,s:h5,X:g=>Math.round(g).toString(16).toUpperCase(),x:g=>Math.round(g).toString(16)};function t8(g){return g}var i8=Array.prototype.map,r8=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function p5(g){var x=g.grouping===void 0||g.thousands===void 0?t8:s5(i8.call(g.grouping,Number),g.thousands+""),E=g.currency===void 0?"":g.currency[0]+"",I=g.currency===void 0?"":g.currency[1]+"",k=g.decimal===void 0?".":g.decimal+"",L=g.numerals===void 0?t8:l5(i8.call(g.numerals,String)),F=g.percent===void 0?"%":g.percent+"",o=g.minus===void 0?"\u2212":g.minus+"",Z=g.nan===void 0?"NaN":g.nan+"";function ae(N){N=Z9(N);var K=N.fill,fe=N.align,Te=N.sign,Ce=N.symbol,ke=N.zero,Qe=N.width,Ve=N.comma,Oe=N.precision,$e=N.trim,xe=N.type;xe==="n"?(Ve=!0,xe="g"):e8[xe]||(Oe===void 0&&(Oe=12),$e=!0,xe="g"),(ke||K==="0"&&fe==="=")&&(ke=!0,K="0",fe="=");var dt=Ce==="$"?E:Ce==="#"&&/[boxX]/.test(xe)?"0"+xe.toLowerCase():"",We=Ce==="$"?I:/[%p]/.test(xe)?F:"",gt=e8[xe],wt=/[defgprs%]/.test(xe);Oe=Oe===void 0?6:/[gprs]/.test(xe)?Math.max(1,Math.min(21,Oe)):Math.max(0,Math.min(20,Oe));function He(Je){var Ye=dt,qe=We,Xe,ze,St;if(xe==="c")qe=gt(Je)+qe,Je="";else{Je=+Je;var zt=Je<0||1/Je<0;if(Je=isNaN(Je)?Z:gt(Math.abs(Je),Oe),$e&&(Je=u5(Je)),zt&&+Je==0&&Te!=="+"&&(zt=!1),Ye=(zt?Te==="("?Te:o:Te==="-"||Te==="("?"":Te)+Ye,qe=(xe==="s"?r8[8+Y8/3]:"")+qe+(zt&&Te==="("?")":""),wt){for(Xe=-1,ze=Je.length;++Xe<ze;)if(St=Je.charCodeAt(Xe),48>St||St>57){qe=(St===46?k+Je.slice(Xe+1):Je.slice(Xe))+qe,Je=Je.slice(0,Xe);break}}}Ve&&!ke&&(Je=x(Je,1/0));var ei=Ye.length+Je.length+qe.length,si=ei<Qe?new Array(Qe-ei+1).join(K):"";switch(Ve&&ke&&(Je=x(si+Je,si.length?Qe-qe.length:1/0),si=""),fe){case"<":Je=Ye+Je+qe+si;break;case"=":Je=Ye+si+Je+qe;break;case"^":Je=si.slice(0,ei=si.length>>1)+Ye+Je+qe+si.slice(ei);break;default:Je=si+Ye+Je+qe;break}return L(Je)}return He.toString=function(){return N+""},He}function te(N,K){var fe=ae((N=Z9(N),N.type="f",N)),Te=Math.max(-8,Math.min(8,Math.floor(b1(K)/3)))*3,Ce=Math.pow(10,-Te),ke=r8[8+Te/3];return function(Qe){return fe(Ce*Qe)+ke}}return{format:ae,formatPrefix:te}}var D9,K8,Q8;d5({thousands:",",grouping:[3],currency:["$",""]});function d5(g){return D9=p5(g),K8=D9.format,Q8=D9.formatPrefix,D9}function f5(g){return Math.max(0,-b1(Math.abs(g)))}function _5(g,x){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(b1(x)/3)))*3-b1(Math.abs(g)))}function m5(g,x){return g=Math.abs(g),x=Math.abs(x)-g,Math.max(0,b1(x)-b1(g))+1}var Ci=1e-6,g5=1e-12,ai=Math.PI,wn=ai/2,n8=ai/4,In=ai*2,Nn=180/ai,Gr=ai/180,Vi=Math.abs,y5=Math.atan,w1=Math.atan2,Xi=Math.cos,Li=Math.sin,N9=Math.sign||function(g){return g>0?1:g<0?-1:0},Co=Math.sqrt;function x5(g){return g>1?0:g<-1?ai:Math.acos(g)}function ss(g){return g>1?wn:g<-1?-wn:Math.asin(g)}function Tn(){}function q9(g,x){g&&a8.hasOwnProperty(g.type)&&a8[g.type](g,x)}var o8={Feature:function(g,x){q9(g.geometry,x)},FeatureCollection:function(g,x){for(var E=g.features,I=-1,k=E.length;++I<k;)q9(E[I].geometry,x)}},a8={Sphere:function(g,x){x.sphere()},Point:function(g,x){g=g.coordinates,x.point(g[0],g[1],g[2])},MultiPoint:function(g,x){for(var E=g.coordinates,I=-1,k=E.length;++I<k;)g=E[I],x.point(g[0],g[1],g[2])},LineString:function(g,x){F0(g.coordinates,x,0)},MultiLineString:function(g,x){for(var E=g.coordinates,I=-1,k=E.length;++I<k;)F0(E[I],x,0)},Polygon:function(g,x){s8(g.coordinates,x)},MultiPolygon:function(g,x){for(var E=g.coordinates,I=-1,k=E.length;++I<k;)s8(E[I],x)},GeometryCollection:function(g,x){for(var E=g.geometries,I=-1,k=E.length;++I<k;)q9(E[I],x)}};function F0(g,x,E){var I=-1,k=g.length-E,L;for(x.lineStart();++I<k;)L=g[I],x.point(L[0],L[1],L[2]);x.lineEnd()}function s8(g,x){var E=-1,I=g.length;for(x.polygonStart();++E<I;)F0(g[E],x,1);x.polygonEnd()}function m1(g,x){g&&o8.hasOwnProperty(g.type)?o8[g.type](g,x):q9(g,x)}function N0(g){return[w1(g[1],g[0]),ss(g[2])]}function T1(g){var x=g[0],E=g[1],I=Xi(E);return[I*Xi(x),I*Li(x),Li(E)]}function L9(g,x){return g[0]*x[0]+g[1]*x[1]+g[2]*x[2]}function W9(g,x){return[g[1]*x[2]-g[2]*x[1],g[2]*x[0]-g[0]*x[2],g[0]*x[1]-g[1]*x[0]]}function k0(g,x){g[0]+=x[0],g[1]+=x[1],g[2]+=x[2]}function R9(g,x){return[g[0]*x,g[1]*x,g[2]*x]}function G0(g){var x=Co(g[0]*g[0]+g[1]*g[1]+g[2]*g[2]);g[0]/=x,g[1]/=x,g[2]/=x}function U0(g,x){function E(I,k){return I=g(I,k),x(I[0],I[1])}return g.invert&&x.invert&&(E.invert=function(I,k){return I=x.invert(I,k),I&&g.invert(I[0],I[1])}),E}function V0(g,x){return[Vi(g)>ai?g+Math.round(-g/In)*In:g,x]}V0.invert=V0;function v5(g,x,E){return(g%=In)?x||E?U0(c8(g),u8(x,E)):c8(g):x||E?u8(x,E):V0}function l8(g){return function(x,E){return x+=g,[x>ai?x-In:x<-ai?x+In:x,E]}}function c8(g){var x=l8(g);return x.invert=l8(-g),x}function u8(g,x){var E=Xi(g),I=Li(g),k=Xi(x),L=Li(x);function F(o,Z){var ae=Xi(Z),te=Xi(o)*ae,N=Li(o)*ae,K=Li(Z),fe=K*E+te*I;return[w1(N*k-fe*L,te*E-K*I),ss(fe*k+N*L)]}return F.invert=function(o,Z){var ae=Xi(Z),te=Xi(o)*ae,N=Li(o)*ae,K=Li(Z),fe=K*k-N*L;return[w1(N*k+K*L,te*E+fe*I),ss(fe*E-te*I)]},F}function b5(g,x,E,I,k,L){if(!!E){var F=Xi(x),o=Li(x),Z=I*E;k==null?(k=x+I*In,L=x-Z/2):(k=h8(F,k),L=h8(F,L),(I>0?k<L:k>L)&&(k+=I*In));for(var ae,te=k;I>0?te>L:te<L;te-=Z)ae=N0([F,-o*Xi(te),-o*Li(te)]),g.point(ae[0],ae[1])}}function h8(g,x){x=T1(x),x[0]-=g,G0(x);var E=x5(-x[1]);return((-x[2]<0?-E:E)+In-Ci)%In}function ep(){var g=[],x;return{point:function(E,I,k){x.push([E,I,k])},lineStart:function(){g.push(x=[])},lineEnd:Tn,rejoin:function(){g.length>1&&g.push(g.pop().concat(g.shift()))},result:function(){var E=g;return g=[],x=null,E}}}function G9(g,x){return Vi(g[0]-x[0])<Ci&&Vi(g[1]-x[1])<Ci}function B9(g,x,E,I){this.x=g,this.z=x,this.o=E,this.e=I,this.v=!1,this.n=this.p=null}function tp(g,x,E,I,k){var L=[],F=[],o,Z;if(g.forEach(function(Te){if(!((Ce=Te.length-1)<=0)){var Ce,ke=Te[0],Qe=Te[Ce],Ve;if(G9(ke,Qe)){if(!ke[2]&&!Qe[2]){for(k.lineStart(),o=0;o<Ce;++o)k.point((ke=Te[o])[0],ke[1]);k.lineEnd();return}Qe[0]+=2*Ci}L.push(Ve=new B9(ke,Te,null,!0)),F.push(Ve.o=new B9(ke,null,Ve,!1)),L.push(Ve=new B9(Qe,Te,null,!1)),F.push(Ve.o=new B9(Qe,null,Ve,!0))}}),!!L.length){for(F.sort(x),p8(L),p8(F),o=0,Z=F.length;o<Z;++o)F[o].e=E=!E;for(var ae=L[0],te,N;;){for(var K=ae,fe=!0;K.v;)if((K=K.n)===ae)return;te=K.z,k.lineStart();do{if(K.v=K.o.v=!0,K.e){if(fe)for(o=0,Z=te.length;o<Z;++o)k.point((N=te[o])[0],N[1]);else I(K.x,K.n.x,1,k);K=K.n}else{if(fe)for(te=K.p.z,o=te.length-1;o>=0;--o)k.point((N=te[o])[0],N[1]);else I(K.x,K.p.x,-1,k);K=K.p}K=K.o,te=K.z,fe=!fe}while(!K.v);k.lineEnd()}}}function p8(g){if(!!(x=g.length)){for(var x,E=0,I=g[0],k;++E<x;)I.n=k=g[E],k.p=I,I=k;I.n=k=g[0],k.p=I}}function M0(g){return Vi(g[0])<=ai?g[0]:N9(g[0])*((Vi(g[0])+ai)%In-ai)}function w5(g,x){var E=M0(x),I=x[1],k=Li(I),L=[Li(E),-Xi(E),0],F=0,o=0,Z=new as;k===1?I=wn+Ci:k===-1&&(I=-wn-Ci);for(var ae=0,te=g.length;ae<te;++ae)if(!!(K=(N=g[ae]).length))for(var N,K,fe=N[K-1],Te=M0(fe),Ce=fe[1]/2+n8,ke=Li(Ce),Qe=Xi(Ce),Ve=0;Ve<K;++Ve,Te=$e,ke=dt,Qe=We,fe=Oe){var Oe=N[Ve],$e=M0(Oe),xe=Oe[1]/2+n8,dt=Li(xe),We=Xi(xe),gt=$e-Te,wt=gt>=0?1:-1,He=wt*gt,Je=He>ai,Ye=ke*dt;if(Z.add(w1(Ye*wt*Li(He),Qe*We+Ye*Xi(He))),F+=Je?gt+wt*In:gt,Je^Te>=E^$e>=E){var qe=W9(T1(fe),T1(Oe));G0(qe);var Xe=W9(L,qe);G0(Xe);var ze=(Je^gt>=0?-1:1)*ss(Xe[2]);(I>ze||I===ze&&(qe[0]||qe[1]))&&(o+=Je^gt>=0?1:-1)}}return(F<-Ci||F<Ci&&Z<-g5)^o&1}function ip(g,x,E,I){return function(k){var L=x(k),F=ep(),o=x(F),Z=!1,ae,te,N,K={point:fe,lineStart:Ce,lineEnd:ke,polygonStart:function(){K.point=Qe,K.lineStart=Ve,K.lineEnd=Oe,te=[],ae=[]},polygonEnd:function(){K.point=fe,K.lineStart=Ce,K.lineEnd=ke,te=W8(te);var $e=w5(ae,I);te.length?(Z||(k.polygonStart(),Z=!0),tp(te,I5,$e,E,k)):$e&&(Z||(k.polygonStart(),Z=!0),k.lineStart(),E(null,null,1,k),k.lineEnd()),Z&&(k.polygonEnd(),Z=!1),te=ae=null},sphere:function(){k.polygonStart(),k.lineStart(),E(null,null,1,k),k.lineEnd(),k.polygonEnd()}};function fe($e,xe){g($e,xe)&&k.point($e,xe)}function Te($e,xe){L.point($e,xe)}function Ce(){K.point=Te,L.lineStart()}function ke(){K.point=fe,L.lineEnd()}function Qe($e,xe){N.push([$e,xe]),o.point($e,xe)}function Ve(){o.lineStart(),N=[]}function Oe(){Qe(N[0][0],N[0][1]),o.lineEnd();var $e=o.clean(),xe=F.result(),dt,We=xe.length,gt,wt,He;if(N.pop(),ae.push(N),N=null,!!We){if($e&1){if(wt=xe[0],(gt=wt.length-1)>0){for(Z||(k.polygonStart(),Z=!0),k.lineStart(),dt=0;dt<gt;++dt)k.point((He=wt[dt])[0],He[1]);k.lineEnd()}return}We>1&&$e&2&&xe.push(xe.pop().concat(xe.shift())),te.push(xe.filter(T5))}}return K}}function T5(g){return g.length>1}function I5(g,x){return((g=g.x)[0]<0?g[1]-wn-Ci:wn-g[1])-((x=x.x)[0]<0?x[1]-wn-Ci:wn-x[1])}var d8=ip(function(){return!0},S5,A5,[-ai,-wn]);function S5(g){var x=NaN,E=NaN,I=NaN,k;return{lineStart:function(){g.lineStart(),k=1},point:function(L,F){var o=L>0?ai:-ai,Z=Vi(L-x);Vi(Z-ai)<Ci?(g.point(x,E=(E+F)/2>0?wn:-wn),g.point(I,E),g.lineEnd(),g.lineStart(),g.point(o,E),g.point(L,E),k=0):I!==o&&Z>=ai&&(Vi(x-I)<Ci&&(x-=I*Ci),Vi(L-o)<Ci&&(L-=o*Ci),E=E5(x,E,L,F),g.point(I,E),g.lineEnd(),g.lineStart(),g.point(o,E),k=0),g.point(x=L,E=F),I=o},lineEnd:function(){g.lineEnd(),x=E=NaN},clean:function(){return 2-k}}}function E5(g,x,E,I){var k,L,F=Li(g-E);return Vi(F)>Ci?y5((Li(x)*(L=Xi(I))*Li(E)-Li(I)*(k=Xi(x))*Li(g))/(k*L*F)):(x+I)/2}function A5(g,x,E,I){var k;if(g==null)k=E*wn,I.point(-ai,k),I.point(0,k),I.point(ai,k),I.point(ai,0),I.point(ai,-k),I.point(0,-k),I.point(-ai,-k),I.point(-ai,0),I.point(-ai,k);else if(Vi(g[0]-x[0])>Ci){var L=g[0]<x[0]?ai:-ai;k=E*L/2,I.point(-L,k),I.point(0,k),I.point(L,k)}else I.point(x[0],x[1])}function k5(g){var x=Xi(g),E=6*Gr,I=x>0,k=Vi(x)>Ci;function L(te,N,K,fe){b5(fe,g,E,K,te,N)}function F(te,N){return Xi(te)*Xi(N)>x}function o(te){var N,K,fe,Te,Ce;return{lineStart:function(){Te=fe=!1,Ce=1},point:function(ke,Qe){var Ve=[ke,Qe],Oe,$e=F(ke,Qe),xe=I?$e?0:ae(ke,Qe):$e?ae(ke+(ke<0?ai:-ai),Qe):0;if(!N&&(Te=fe=$e)&&te.lineStart(),$e!==fe&&(Oe=Z(N,Ve),(!Oe||G9(N,Oe)||G9(Ve,Oe))&&(Ve[2]=1)),$e!==fe)Ce=0,$e?(te.lineStart(),Oe=Z(Ve,N),te.point(Oe[0],Oe[1])):(Oe=Z(N,Ve),te.point(Oe[0],Oe[1],2),te.lineEnd()),N=Oe;else if(k&&N&&I^$e){var dt;!(xe&K)&&(dt=Z(Ve,N,!0))&&(Ce=0,I?(te.lineStart(),te.point(dt[0][0],dt[0][1]),te.point(dt[1][0],dt[1][1]),te.lineEnd()):(te.point(dt[1][0],dt[1][1]),te.lineEnd(),te.lineStart(),te.point(dt[0][0],dt[0][1],3)))}$e&&(!N||!G9(N,Ve))&&te.point(Ve[0],Ve[1]),N=Ve,fe=$e,K=xe},lineEnd:function(){fe&&te.lineEnd(),N=null},clean:function(){return Ce|(Te&&fe)<<1}}}function Z(te,N,K){var fe=T1(te),Te=T1(N),Ce=[1,0,0],ke=W9(fe,Te),Qe=L9(ke,ke),Ve=ke[0],Oe=Qe-Ve*Ve;if(!Oe)return!K&&te;var $e=x*Qe/Oe,xe=-x*Ve/Oe,dt=W9(Ce,ke),We=R9(Ce,$e),gt=R9(ke,xe);k0(We,gt);var wt=dt,He=L9(We,wt),Je=L9(wt,wt),Ye=He*He-Je*(L9(We,We)-1);if(!(Ye<0)){var qe=Co(Ye),Xe=R9(wt,(-He-qe)/Je);if(k0(Xe,We),Xe=N0(Xe),!K)return Xe;var ze=te[0],St=N[0],zt=te[1],ei=N[1],si;St<ze&&(si=ze,ze=St,St=si);var Ri=St-ze,mt=Vi(Ri-ai)<Ci,_t=mt||Ri<Ci;if(!mt&&ei<zt&&(si=zt,zt=ei,ei=si),_t?mt?zt+ei>0^Xe[1]<(Vi(Xe[0]-ze)<Ci?zt:ei):zt<=Xe[1]&&Xe[1]<=ei:Ri>ai^(ze<=Xe[0]&&Xe[0]<=St)){var xt=R9(wt,(-He+qe)/Je);return k0(xt,We),[Xe,N0(xt)]}}}function ae(te,N){var K=I?g:ai-g,fe=0;return te<-K?fe|=1:te>K&&(fe|=2),N<-K?fe|=4:N>K&&(fe|=8),fe}return ip(F,o,L,I?[0,-g]:[-ai,g-ai])}function M5(g,x,E,I,k,L){var F=g[0],o=g[1],Z=x[0],ae=x[1],te=0,N=1,K=Z-F,fe=ae-o,Te;if(Te=E-F,!(!K&&Te>0)){if(Te/=K,K<0){if(Te<te)return;Te<N&&(N=Te)}else if(K>0){if(Te>N)return;Te>te&&(te=Te)}if(Te=k-F,!(!K&&Te<0)){if(Te/=K,K<0){if(Te>N)return;Te>te&&(te=Te)}else if(K>0){if(Te<te)return;Te<N&&(N=Te)}if(Te=I-o,!(!fe&&Te>0)){if(Te/=fe,fe<0){if(Te<te)return;Te<N&&(N=Te)}else if(fe>0){if(Te>N)return;Te>te&&(te=Te)}if(Te=L-o,!(!fe&&Te<0)){if(Te/=fe,fe<0){if(Te>N)return;Te>te&&(te=Te)}else if(fe>0){if(Te<te)return;Te<N&&(N=Te)}return te>0&&(g[0]=F+te*K,g[1]=o+te*fe),N<1&&(x[0]=F+N*K,x[1]=o+N*fe),!0}}}}}var Ol=1e9,O9=-Ol;function C5(g,x,E,I){function k(ae,te){return g<=ae&&ae<=E&&x<=te&&te<=I}function L(ae,te,N,K){var fe=0,Te=0;if(ae==null||(fe=F(ae,N))!==(Te=F(te,N))||Z(ae,te)<0^N>0)do K.point(fe===0||fe===3?g:E,fe>1?I:x);while((fe=(fe+N+4)%4)!==Te);else K.point(te[0],te[1])}function F(ae,te){return Vi(ae[0]-g)<Ci?te>0?0:3:Vi(ae[0]-E)<Ci?te>0?2:1:Vi(ae[1]-x)<Ci?te>0?1:0:te>0?3:2}function o(ae,te){return Z(ae.x,te.x)}function Z(ae,te){var N=F(ae,1),K=F(te,1);return N!==K?N-K:N===0?te[1]-ae[1]:N===1?ae[0]-te[0]:N===2?ae[1]-te[1]:te[0]-ae[0]}return function(ae){var te=ae,N=ep(),K,fe,Te,Ce,ke,Qe,Ve,Oe,$e,xe,dt,We={point:gt,lineStart:Ye,lineEnd:qe,polygonStart:He,polygonEnd:Je};function gt(ze,St){k(ze,St)&&te.point(ze,St)}function wt(){for(var ze=0,St=0,zt=fe.length;St<zt;++St)for(var ei=fe[St],si=1,Ri=ei.length,mt=ei[0],_t,xt,Ht=mt[0],Bt=mt[1];si<Ri;++si)_t=Ht,xt=Bt,mt=ei[si],Ht=mt[0],Bt=mt[1],xt<=I?Bt>I&&(Ht-_t)*(I-xt)>(Bt-xt)*(g-_t)&&++ze:Bt<=I&&(Ht-_t)*(I-xt)<(Bt-xt)*(g-_t)&&--ze;return ze}function He(){te=N,K=[],fe=[],dt=!0}function Je(){var ze=wt(),St=dt&&ze,zt=(K=W8(K)).length;(St||zt)&&(ae.polygonStart(),St&&(ae.lineStart(),L(null,null,1,ae),ae.lineEnd()),zt&&tp(K,o,ze,L,ae),ae.polygonEnd()),te=ae,K=fe=Te=null}function Ye(){We.point=Xe,fe&&fe.push(Te=[]),xe=!0,$e=!1,Ve=Oe=NaN}function qe(){K&&(Xe(Ce,ke),Qe&&$e&&N.rejoin(),K.push(N.result())),We.point=gt,$e&&te.lineEnd()}function Xe(ze,St){var zt=k(ze,St);if(fe&&Te.push([ze,St]),xe)Ce=ze,ke=St,Qe=zt,xe=!1,zt&&(te.lineStart(),te.point(ze,St));else if(zt&&$e)te.point(ze,St);else{var ei=[Ve=Math.max(O9,Math.min(Ol,Ve)),Oe=Math.max(O9,Math.min(Ol,Oe))],si=[ze=Math.max(O9,Math.min(Ol,ze)),St=Math.max(O9,Math.min(Ol,St))];M5(ei,si,g,x,E,I)?($e||(te.lineStart(),te.point(ei[0],ei[1])),te.point(si[0],si[1]),zt||te.lineEnd(),dt=!1):zt&&(te.lineStart(),te.point(ze,St),dt=!1)}Ve=ze,Oe=St,$e=zt}return We}}var j0=g=>g,C0=new as,$0=new as,rp,np,Z0,q0,ha={point:Tn,lineStart:Tn,lineEnd:Tn,polygonStart:function(){ha.lineStart=z5,ha.lineEnd=D5},polygonEnd:function(){ha.lineStart=ha.lineEnd=ha.point=Tn,C0.add(Vi($0)),$0=new as},result:function(){var g=C0/2;return C0=new as,g}};function z5(){ha.point=P5}function P5(g,x){ha.point=op,rp=Z0=g,np=q0=x}function op(g,x){$0.add(q0*g-Z0*x),Z0=g,q0=x}function D5(){op(rp,np)}var f8=ha,I1=1/0,X9=I1,Wl=-I1,J9=Wl,L5={point:R5,lineStart:Tn,lineEnd:Tn,polygonStart:Tn,polygonEnd:Tn,result:function(){var g=[[I1,X9],[Wl,J9]];return Wl=J9=-(X9=I1=1/0),g}};function R5(g,x){g<I1&&(I1=g),g>Wl&&(Wl=g),x<X9&&(X9=x),x>J9&&(J9=x)}var H9=L5,W0=0,X0=0,Fl=0,Y9=0,K9=0,g1=0,J0=0,H0=0,Nl=0,ap,sp,ro,no,Un={point:ls,lineStart:_8,lineEnd:m8,polygonStart:function(){Un.lineStart=F5,Un.lineEnd=N5},polygonEnd:function(){Un.point=ls,Un.lineStart=_8,Un.lineEnd=m8},result:function(){var g=Nl?[J0/Nl,H0/Nl]:g1?[Y9/g1,K9/g1]:Fl?[W0/Fl,X0/Fl]:[NaN,NaN];return W0=X0=Fl=Y9=K9=g1=J0=H0=Nl=0,g}};function ls(g,x){W0+=g,X0+=x,++Fl}function _8(){Un.point=B5}function B5(g,x){Un.point=O5,ls(ro=g,no=x)}function O5(g,x){var E=g-ro,I=x-no,k=Co(E*E+I*I);Y9+=k*(ro+g)/2,K9+=k*(no+x)/2,g1+=k,ls(ro=g,no=x)}function m8(){Un.point=ls}function F5(){Un.point=G5}function N5(){lp(ap,sp)}function G5(g,x){Un.point=lp,ls(ap=ro=g,sp=no=x)}function lp(g,x){var E=g-ro,I=x-no,k=Co(E*E+I*I);Y9+=k*(ro+g)/2,K9+=k*(no+x)/2,g1+=k,k=no*g-ro*x,J0+=k*(ro+g),H0+=k*(no+x),Nl+=k*3,ls(ro=g,no=x)}var g8=Un;function cp(g){this._context=g}cp.prototype={_radius:4.5,pointRadius:function(g){return this._radius=g,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(g,x){switch(this._point){case 0:{this._context.moveTo(g,x),this._point=1;break}case 1:{this._context.lineTo(g,x);break}default:{this._context.moveTo(g+this._radius,x),this._context.arc(g,x,this._radius,0,In);break}}},result:Tn};var Y0=new as,z0,up,hp,Gl,Ul,Q9={point:Tn,lineStart:function(){Q9.point=U5},lineEnd:function(){z0&&pp(up,hp),Q9.point=Tn},polygonStart:function(){z0=!0},polygonEnd:function(){z0=null},result:function(){var g=+Y0;return Y0=new as,g}};function U5(g,x){Q9.point=pp,up=Gl=g,hp=Ul=x}function pp(g,x){Gl-=g,Ul-=x,Y0.add(Co(Gl*Gl+Ul*Ul)),Gl=g,Ul=x}var y8=Q9;function dp(){this._string=[]}dp.prototype={_radius:4.5,_circle:x8(4.5),pointRadius:function(g){return(g=+g)!==this._radius&&(this._radius=g,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(g,x){switch(this._point){case 0:{this._string.push("M",g,",",x),this._point=1;break}case 1:{this._string.push("L",g,",",x);break}default:{this._circle==null&&(this._circle=x8(this._radius)),this._string.push("M",g,",",x,this._circle);break}}},result:function(){if(this._string.length){var g=this._string.join("");return this._string=[],g}else return null}};function x8(g){return"m0,"+g+"a"+g+","+g+" 0 1,1 0,"+-2*g+"a"+g+","+g+" 0 1,1 0,"+2*g+"z"}function V5(g,x){var E=4.5,I,k;function L(F){return F&&(typeof E=="function"&&k.pointRadius(+E.apply(this,arguments)),m1(F,I(k))),k.result()}return L.area=function(F){return m1(F,I(f8)),f8.result()},L.measure=function(F){return m1(F,I(y8)),y8.result()},L.bounds=function(F){return m1(F,I(H9)),H9.result()},L.centroid=function(F){return m1(F,I(g8)),g8.result()},L.projection=function(F){return arguments.length?(I=F==null?(g=null,j0):(g=F).stream,L):g},L.context=function(F){return arguments.length?(k=F==null?(x=null,new dp):new cp(x=F),typeof E!="function"&&k.pointRadius(E),L):x},L.pointRadius=function(F){return arguments.length?(E=typeof F=="function"?F:(k.pointRadius(+F),+F),L):E},L.projection(g).context(x)}function uu(g){return function(x){var E=new K0;for(var I in g)E[I]=g[I];return E.stream=x,E}}function K0(){}K0.prototype={constructor:K0,point:function(g,x){this.stream.point(g,x)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function hu(g,x,E){var I=g.clipExtent&&g.clipExtent();return g.scale(150).translate([0,0]),I!=null&&g.clipExtent(null),m1(E,g.stream(H9)),x(H9.result()),I!=null&&g.clipExtent(I),g}function fp(g,x,E){return hu(g,function(I){var k=x[1][0]-x[0][0],L=x[1][1]-x[0][1],F=Math.min(k/(I[1][0]-I[0][0]),L/(I[1][1]-I[0][1])),o=+x[0][0]+(k-F*(I[1][0]+I[0][0]))/2,Z=+x[0][1]+(L-F*(I[1][1]+I[0][1]))/2;g.scale(150*F).translate([o,Z])},E)}function j5(g,x,E){return fp(g,[[0,0],x],E)}function $5(g,x,E){return hu(g,function(I){var k=+x,L=k/(I[1][0]-I[0][0]),F=(k-L*(I[1][0]+I[0][0]))/2,o=-L*I[0][1];g.scale(150*L).translate([F,o])},E)}function Z5(g,x,E){return hu(g,function(I){var k=+x,L=k/(I[1][1]-I[0][1]),F=-L*I[0][0],o=(k-L*(I[1][1]+I[0][1]))/2;g.scale(150*L).translate([F,o])},E)}var v8=16,q5=Xi(30*Gr);function b8(g,x){return+x?X5(g,x):W5(g)}function W5(g){return uu({point:function(x,E){x=g(x,E),this.stream.point(x[0],x[1])}})}function X5(g,x){function E(I,k,L,F,o,Z,ae,te,N,K,fe,Te,Ce,ke){var Qe=ae-I,Ve=te-k,Oe=Qe*Qe+Ve*Ve;if(Oe>4*x&&Ce--){var $e=F+K,xe=o+fe,dt=Z+Te,We=Co($e*$e+xe*xe+dt*dt),gt=ss(dt/=We),wt=Vi(Vi(dt)-1)<Ci||Vi(L-N)<Ci?(L+N)/2:w1(xe,$e),He=g(wt,gt),Je=He[0],Ye=He[1],qe=Je-I,Xe=Ye-k,ze=Ve*qe-Qe*Xe;(ze*ze/Oe>x||Vi((Qe*qe+Ve*Xe)/Oe-.5)>.3||F*K+o*fe+Z*Te<q5)&&(E(I,k,L,F,o,Z,Je,Ye,wt,$e/=We,xe/=We,dt,Ce,ke),ke.point(Je,Ye),E(Je,Ye,wt,$e,xe,dt,ae,te,N,K,fe,Te,Ce,ke))}}return function(I){var k,L,F,o,Z,ae,te,N,K,fe,Te,Ce,ke={point:Qe,lineStart:Ve,lineEnd:$e,polygonStart:function(){I.polygonStart(),ke.lineStart=xe},polygonEnd:function(){I.polygonEnd(),ke.lineStart=Ve}};function Qe(gt,wt){gt=g(gt,wt),I.point(gt[0],gt[1])}function Ve(){N=NaN,ke.point=Oe,I.lineStart()}function Oe(gt,wt){var He=T1([gt,wt]),Je=g(gt,wt);E(N,K,te,fe,Te,Ce,N=Je[0],K=Je[1],te=gt,fe=He[0],Te=He[1],Ce=He[2],v8,I),I.point(N,K)}function $e(){ke.point=Qe,I.lineEnd()}function xe(){Ve(),ke.point=dt,ke.lineEnd=We}function dt(gt,wt){Oe(k=gt,wt),L=N,F=K,o=fe,Z=Te,ae=Ce,ke.point=Oe}function We(){E(N,K,te,fe,Te,Ce,L,F,k,o,Z,ae,v8,I),ke.lineEnd=$e,$e()}return ke}}var J5=uu({point:function(g,x){this.stream.point(g*Gr,x*Gr)}});function H5(g){return uu({point:function(x,E){var I=g(x,E);return this.stream.point(I[0],I[1])}})}function Y5(g,x,E,I,k){function L(F,o){return F*=I,o*=k,[x+g*F,E-g*o]}return L.invert=function(F,o){return[(F-x)/g*I,(E-o)/g*k]},L}function w8(g,x,E,I,k,L){if(!L)return Y5(g,x,E,I,k);var F=Xi(L),o=Li(L),Z=F*g,ae=o*g,te=F/g,N=o/g,K=(o*E-F*x)/g,fe=(o*x+F*E)/g;function Te(Ce,ke){return Ce*=I,ke*=k,[Z*Ce-ae*ke+x,E-ae*Ce-Z*ke]}return Te.invert=function(Ce,ke){return[I*(te*Ce-N*ke+K),k*(fe-N*Ce-te*ke)]},Te}function K5(g){var x,E=150,I=480,k=250,L=0,F=0,o=0,Z=0,ae=0,te,N=0,K=1,fe=1,Te=null,Ce=d8,ke=null,Qe,Ve,Oe,$e=j0,xe=.5,dt,We,gt,wt,He;function Je(ze){return gt(ze[0]*Gr,ze[1]*Gr)}function Ye(ze){return ze=gt.invert(ze[0],ze[1]),ze&&[ze[0]*Nn,ze[1]*Nn]}Je.stream=function(ze){return wt&&He===ze?wt:wt=J5(H5(te)(Ce(dt($e(He=ze)))))},Je.preclip=function(ze){return arguments.length?(Ce=ze,Te=void 0,Xe()):Ce},Je.postclip=function(ze){return arguments.length?($e=ze,ke=Qe=Ve=Oe=null,Xe()):$e},Je.clipAngle=function(ze){return arguments.length?(Ce=+ze?k5(Te=ze*Gr):(Te=null,d8),Xe()):Te*Nn},Je.clipExtent=function(ze){return arguments.length?($e=ze==null?(ke=Qe=Ve=Oe=null,j0):C5(ke=+ze[0][0],Qe=+ze[0][1],Ve=+ze[1][0],Oe=+ze[1][1]),Xe()):ke==null?null:[[ke,Qe],[Ve,Oe]]},Je.scale=function(ze){return arguments.length?(E=+ze,qe()):E},Je.translate=function(ze){return arguments.length?(I=+ze[0],k=+ze[1],qe()):[I,k]},Je.center=function(ze){return arguments.length?(L=ze[0]%360*Gr,F=ze[1]%360*Gr,qe()):[L*Nn,F*Nn]},Je.rotate=function(ze){return arguments.length?(o=ze[0]%360*Gr,Z=ze[1]%360*Gr,ae=ze.length>2?ze[2]%360*Gr:0,qe()):[o*Nn,Z*Nn,ae*Nn]},Je.angle=function(ze){return arguments.length?(N=ze%360*Gr,qe()):N*Nn},Je.reflectX=function(ze){return arguments.length?(K=ze?-1:1,qe()):K<0},Je.reflectY=function(ze){return arguments.length?(fe=ze?-1:1,qe()):fe<0},Je.precision=function(ze){return arguments.length?(dt=b8(We,xe=ze*ze),Xe()):Co(xe)},Je.fitExtent=function(ze,St){return fp(Je,ze,St)},Je.fitSize=function(ze,St){return j5(Je,ze,St)},Je.fitWidth=function(ze,St){return $5(Je,ze,St)},Je.fitHeight=function(ze,St){return Z5(Je,ze,St)};function qe(){var ze=w8(E,0,0,K,fe,N).apply(null,x(L,F)),St=w8(E,I-ze[0],k-ze[1],K,fe,N);return te=v5(o,Z,ae),We=U0(x,St),gt=U0(te,We),dt=b8(We,xe),Xe()}function Xe(){return wt=He=null,Je}return function(){return x=g.apply(this,arguments),Je.invert=x.invert&&Ye,qe()}}function Q5(g){var x=0,E=ai/3,I=K5(g),k=I(x,E);return k.parallels=function(L){return arguments.length?I(x=L[0]*Gr,E=L[1]*Gr):[x*Nn,E*Nn]},k}function em(g){var x=Xi(g);function E(I,k){return[I*x,Li(k)/x]}return E.invert=function(I,k){return[I/x,ss(k*x)]},E}function tm(g,x){var E=Li(g),I=(E+Li(x))/2;if(Vi(I)<Ci)return em(g);var k=1+E*(2*I-E),L=Co(k)/I;function F(o,Z){var ae=Co(k-2*I*Li(Z))/I;return[ae*Li(o*=I),L-ae*Xi(o)]}return F.invert=function(o,Z){var ae=L-Z,te=w1(o,Vi(ae))*N9(ae);return ae*I<0&&(te-=ai*N9(o)*N9(ae)),[te/I,ss((k-(o*o+ae*ae)*I*I)/(2*I))]},F}function im(){return Q5(tm).scale(155.424).center([0,33.6442])}function rm(){return im().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function nm(g,x){switch(arguments.length){case 0:break;case 1:this.range(g);break;default:this.range(x).domain(g);break}return this}function om(g){return function(){return g}}function am(g){return+g}var T8=[0,1];function pa(g){return g}function Q0(g,x){return(x-=g=+g)?function(E){return(E-g)/x}:om(isNaN(x)?NaN:.5)}function sm(g,x){var E;return g>x&&(E=g,g=x,x=E),function(I){return Math.max(g,Math.min(x,I))}}function lm(g,x,E){var I=g[0],k=g[1],L=x[0],F=x[1];return k<I?(I=Q0(k,I),L=E(F,L)):(I=Q0(I,k),L=E(L,F)),function(o){return L(I(o))}}function cm(g,x,E){var I=Math.min(g.length,x.length)-1,k=new Array(I),L=new Array(I),F=-1;for(g[I]<g[0]&&(g=g.slice().reverse(),x=x.slice().reverse());++F<I;)k[F]=Q0(g[F],g[F+1]),L[F]=E(x[F],x[F+1]);return function(o){var Z=z_(g,o,1,I)-1;return L[Z](k[Z](o))}}function um(g,x){return x.domain(g.domain()).range(g.range()).interpolate(g.interpolate()).clamp(g.clamp()).unknown(g.unknown())}function hm(){var g=T8,x=T8,E=lu,I,k,L,F=pa,o,Z,ae;function te(){var K=Math.min(g.length,x.length);return F!==pa&&(F=sm(g[0],g[K-1])),o=K>2?cm:lm,Z=ae=null,N}function N(K){return K==null||isNaN(K=+K)?L:(Z||(Z=o(g.map(I),x,E)))(I(F(K)))}return N.invert=function(K){return F(k((ae||(ae=o(x,g.map(I),j9)))(K)))},N.domain=function(K){return arguments.length?(g=Array.from(K,am),te()):g.slice()},N.range=function(K){return arguments.length?(x=Array.from(K),te()):x.slice()},N.rangeRound=function(K){return x=Array.from(K),E=o5,te()},N.clamp=function(K){return arguments.length?(F=K?!0:pa,te()):F!==pa},N.interpolate=function(K){return arguments.length?(E=K,te()):E},N.unknown=function(K){return arguments.length?(L=K,N):L},function(K,fe){return I=K,k=fe,te()}}function pm(g,x,E,I){var k=L_(g,x,E),L;switch(I=Z9(I==null?",f":I),I.type){case"s":{var F=Math.max(Math.abs(g),Math.abs(x));return I.precision==null&&!isNaN(L=_5(k,F))&&(I.precision=L),Q8(I,F)}case"":case"e":case"g":case"p":case"r":{I.precision==null&&!isNaN(L=m5(k,Math.max(Math.abs(g),Math.abs(x))))&&(I.precision=L-(I.type==="e"));break}case"f":case"%":{I.precision==null&&!isNaN(L=f5(k))&&(I.precision=L-(I.type==="%")*2);break}}return K8(I)}function dm(g){var x=g.domain;return g.ticks=function(E){var I=x();return D_(I[0],I[I.length-1],E==null?10:E)},g.tickFormat=function(E,I){var k=x();return pm(k[0],k[k.length-1],E==null?10:E,I)},g.nice=function(E){E==null&&(E=10);var I=x(),k=0,L=I.length-1,F=I[k],o=I[L],Z,ae,te=10;for(o<F&&(ae=F,F=o,o=ae,ae=k,k=L,L=ae);te-- >0;){if(ae=q8(F,o,E),ae===Z)return I[k]=F,I[L]=o,x(I);if(ae>0)F=Math.floor(F/ae)*ae,o=Math.ceil(o/ae)*ae;else if(ae<0)F=Math.ceil(F*ae)/ae,o=Math.floor(o*ae)/ae;else break;Z=ae}return g},g}function I8(g){return function(x){return x<0?-Math.pow(-x,g):Math.pow(x,g)}}function fm(g){return g<0?-Math.sqrt(-g):Math.sqrt(g)}function _m(g){return g<0?-g*g:g*g}function mm(g){var x=g(pa,pa),E=1;function I(){return E===1?g(pa,pa):E===.5?g(fm,_m):g(I8(E),I8(1/E))}return x.exponent=function(k){return arguments.length?(E=+k,I()):E},dm(x)}function _p(){var g=mm(hm());return g.copy=function(){return um(g,_p()).exponent(g.exponent())},nm.apply(g,arguments),g}function y1(g,x,E){this.k=g,this.x=x,this.y=E}y1.prototype={constructor:y1,scale:function(g){return g===1?this:new y1(this.k*g,this.x,this.y)},translate:function(g,x){return g===0&x===0?this:new y1(this.k,this.x+this.k*g,this.y+this.k*x)},apply:function(g){return[g[0]*this.k+this.x,g[1]*this.k+this.y]},applyX:function(g){return g*this.k+this.x},applyY:function(g){return g*this.k+this.y},invert:function(g){return[(g[0]-this.x)/this.k,(g[1]-this.y)/this.k]},invertX:function(g){return(g-this.x)/this.k},invertY:function(g){return(g-this.y)/this.k},rescaleX:function(g){return g.copy().domain(g.range().map(this.invertX,this).map(g.invert,g))},rescaleY:function(g){return g.copy().domain(g.range().map(this.invertY,this).map(g.invert,g))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new y1(1,0,0);y1.prototype;function gm(g){return g}function ym(g){if(g==null)return gm;var x,E,I=g.scale[0],k=g.scale[1],L=g.translate[0],F=g.translate[1];return function(o,Z){Z||(x=E=0);var ae=2,te=o.length,N=new Array(te);for(N[0]=(x+=o[0])*I+L,N[1]=(E+=o[1])*k+F;ae<te;)N[ae]=o[ae],++ae;return N}}function xm(g,x){for(var E,I=g.length,k=I-x;k<--I;)E=g[k],g[k++]=g[I],g[I]=E}function P0(g,x){return typeof x=="string"&&(x=g.objects[x]),x.type==="GeometryCollection"?{type:"FeatureCollection",features:x.geometries.map(function(E){return S8(g,E)})}:S8(g,x)}function S8(g,x){var E=x.id,I=x.bbox,k=x.properties==null?{}:x.properties,L=vm(g,x);return E==null&&I==null?{type:"Feature",properties:k,geometry:L}:I==null?{type:"Feature",id:E,properties:k,geometry:L}:{type:"Feature",id:E,bbox:I,properties:k,geometry:L}}function vm(g,x){var E=ym(g.transform),I=g.arcs;function k(te,N){N.length&&N.pop();for(var K=I[te<0?~te:te],fe=0,Te=K.length;fe<Te;++fe)N.push(E(K[fe],fe));te<0&&xm(N,Te)}function L(te){return E(te)}function F(te){for(var N=[],K=0,fe=te.length;K<fe;++K)k(te[K],N);return N.length<2&&N.push(N[0]),N}function o(te){for(var N=F(te);N.length<4;)N.push(N[0]);return N}function Z(te){return te.map(o)}function ae(te){var N=te.type,K;switch(N){case"GeometryCollection":return{type:N,geometries:te.geometries.map(ae)};case"Point":K=L(te.coordinates);break;case"MultiPoint":K=te.coordinates.map(L);break;case"LineString":K=F(te.arcs);break;case"MultiLineString":K=te.arcs.map(F);break;case"Polygon":K=Z(te.arcs);break;case"MultiPolygon":K=te.arcs.map(Z);break;default:return null}return{type:N,coordinates:K}}return ae(x)}var mp={exports:{}};(function(g,x){(function(E,I){g.exports=I()})(N8,function(){var E={};E.states={},E.STATES=[],E.TERRITORIES=[],E.STATES_AND_TERRITORIES=[],E.State=function(o){for(var Z in o)o.hasOwnProperty(Z)&&(this[Z]=o[Z])},E.State.prototype.toString=function(){return this.name},E.State.prototype.shapefile_urls=function(o){var Z="http://www2.census.gov/geo/tiger/TIGER2010",ae={tract:Z+"/TRACT/2010/tl_2010_"+this.fips.toString()+"_tract10.zip",cd:Z+"/CD/111/tl_2010_"+this.fips.toString()+"_cd111.zip",county:Z+"/COUNTY/2010/tl_2010_"+this.fips.toString()+"_county10.zip",state:Z+"/STATE/2010/tl_2010_"+this.fips.toString()+"_state10.zip",zcta:Z+"/ZCTA5/2010/tl_2010_"+this.fips.toString()+"_zcta510.zip",block:Z+"/TABBLOCK/2010/tl_2010_"+this.fips.toString()+"_tabblock10.zip",blockgroup:Z+"/BG/2010/tl_2010_"+this.fips.toString()+"_bg10.zip"};return o&&o in ae?ae[o]:ae};var I=/^\d{2}$/,k=/^[a-zA-Z]{2}$/,L={};E.lookup=function(o,Z,ae){Z==null&&(o.match(I)?Z="fips":o.match(k)?(o=o.toUpperCase(),Z="abbr"):(o=E._metaphone(o),Z="metaphones"));var te=Z+":"+o;if(!ae&&te in L)return L[te];for(var N=0;N<E.STATES_AND_TERRITORIES.length;N++){var K=E.STATES_AND_TERRITORIES[N];if(Array.isArray(K[Z])){if(K[Z].indexOf(o)!==-1)return L[te]=K,K}else if(o===K[Z])return L[te]=K,K}},E.mapping=function(o,Z,ae){(typeof ae=="undefined"||ae==null)&&(ae=E.STATES_AND_TERRITORIES);for(var te={},N=0;N<ae.length;N++){var K=ae[N];te[K[o]]=K[Z]}return te},E._metaphone=function(o,Z){o=(o==null?"":o+"").toUpperCase();function ae(Ve){return"AEIOU".indexOf(Ve)!==-1}function te(Ve){for(var Oe=Ve.length,$e=Ve.charAt(0),xe,dt=$e,We=1;We<Oe;We++)xe=Ve.charAt(We),(xe!==$e||xe==="C"||xe==="G")&&(dt+=xe),$e=xe;return dt}o=te(o);var N=o.length,K=0,fe="";o.substr(0,2)==="WH"&&(o="W"+o.substr(2));var Te=o.charAt(0),Ce="",ke=o.charAt(1),Qe="";if(1<=N)switch(Te){case"A":ke==="E"?fe+="E":fe+="A",K+=1;break;case"E":case"I":case"O":case"U":fe+=Te,K+=1;break;case"G":case"K":case"P":ke==="N"&&(K+=1);break;case"W":ke==="R"&&(K+=1);break}for(;K<N;K++)if(Te=o.charAt(K),Ce=o.charAt(K-1),ke=o.charAt(K+1),Qe=o.charAt(K+2),!ae(Te))switch(Te){case"B":Ce!=="M"&&(fe+="B");break;case"C":K+1<=N?o.substr(K-1,3)!=="SCH"?K===0&&K+2<=N&&ae(Qe)?fe+="K":fe+="X":o.substr(K+1,2)==="IA"?fe+="X":"IEY".indexOf(ke)!==-1?K>0?Ce!=="S"&&(fe+="S"):fe+="S":fe+="K":fe+="K";break;case"D":K+2<=N&&ke==="G"&&"EIY".indexOf(Qe)!==-1?(fe+="J",K+=2):fe+="T";break;case"F":fe+="F";break;case"G":if(K<N){if(ke==="N"&&K+1===N-1||ke==="N"&&Qe==="S"&&K+2===N-1||o.substr(K+1,3)==="NED"&&K+3===N-1||o.substr(K-2,3)==="ING"&&K===N-1)break;if(K+1<=N-1&&o.substr(K-2,4)==="OUGH"){fe+="F";break}ke==="H"&&K+2<=N?ae(Qe)&&(fe+="K"):K+1===N?ke!=="N"&&(fe+="K"):K+3===N?o.substr(K+1,3)!=="NED"&&(fe+="K"):K+1<=N?"EIY".indexOf(ke)!==-1?Ce!=="G"&&(fe+="J"):(K===0||Ce!=="D"||"EIY".indexOf(ke)===-1)&&(fe+="K"):fe+="K"}else fe+="K";break;case"M":case"J":case"N":case"R":case"L":fe+=Te;break;case"Q":fe+="K";break;case"V":fe+="F";break;case"Z":fe+="S";break;case"X":fe+=K===0?"S":"KS";break;case"K":(K===0||Ce!=="C")&&(fe+="K");break;case"P":K+1<=N&&ke==="H"?fe+="F":fe+="P";break;case"Y":(K+1>N||ae(ke))&&(fe+="Y");break;case"H":(K===0||"CSPTG".indexOf(Ce)===-1)&&ae(ke)===!0&&(fe+="H");break;case"S":K+1<=N&&(ke==="H"||K+2<=N&&ke==="I"&&"AO".indexOf(Qe)!==-1)?fe+="X":fe+="S";break;case"T":K+1<=N?ke==="H"?fe+="0":K+2<=N&&ke==="I"&&"AO".indexOf(Qe)!==-1?fe+="X":fe+="T":fe+="T";break;case"W":K+1<=N&&ae(ke)&&(fe+="W");break}return Z=parseInt(Z,10),fe.length>Z?fe.substr(0,Z):fe};var F=function(){for(var o=0;o<F.DATA.length;o++){var Z=F.DATA[o],ae=new E.State(Z);ae.is_territory?E.TERRITORIES.push(ae):E.STATES.push(ae),E.STATES_AND_TERRITORIES.push(ae),E.states[ae.abbr]=ae}};return F.DATA=[{name:"Alabama",metaphones:["ALBM"],statehood_year:1819,ap_abbr:"Ala.",is_territory:!1,fips:"01",abbr:"AL",capital:"Montgomery",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Alaska",metaphones:["ALSK"],statehood_year:1959,ap_abbr:"Alaska",is_territory:!1,fips:"02",abbr:"AK",capital:"Juneau",capital_tz:"America/Anchorage",time_zones:["America/Anchorage","America/Adak"]},{name:"American Samoa",metaphones:["AMRXNSM"],statehood_year:null,ap_abbr:null,is_territory:!0,fips:"60",abbr:"AS",capital:"Pago Pago",capital_tz:"Pacific/Samoa",time_zones:["Pacific/Samoa"]},{name:"Arizona",metaphones:["ARSN"],statehood_year:1912,ap_abbr:"Ariz.",is_territory:!1,fips:"04",abbr:"AZ",capital:"Phoenix",capital_tz:"America/Denver",time_zones:["America/Denver"]},{name:"Arkansas",metaphones:["ARKNSS"],statehood_year:1836,ap_abbr:"Ark.",is_territory:!1,fips:"05",abbr:"AR",capital:"Little Rock",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"California",metaphones:["XLFRN"],statehood_year:1850,ap_abbr:"Calif.",is_territory:!1,fips:"06",abbr:"CA",capital:"Sacramento",capital_tz:"America/Los_Angeles",time_zones:["America/Los_Angeles"]},{name:"Colorado",metaphones:["XLRT"],statehood_year:1876,ap_abbr:"Colo.",is_territory:!1,fips:"08",abbr:"CO",capital:"Denver",capital_tz:"America/Denver",time_zones:["America/Denver"]},{name:"Connecticut",metaphones:["XNTXT","XNXTXT"],statehood_year:1788,ap_abbr:"Conn.",is_territory:!1,fips:"09",abbr:"CT",capital:"Hartford",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Delaware",metaphones:["TLWR"],statehood_year:1787,ap_abbr:"Del.",is_territory:!1,fips:"10",abbr:"DE",capital:"Dover",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"District of Columbia",metaphones:["TSTRXTFXLM"],statehood_year:null,ap_abbr:"D.C.",is_territory:!1,fips:"11",abbr:"DC",capital:null,capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Florida",metaphones:["FLRT","FLRTS"],statehood_year:1845,ap_abbr:"Fla.",is_territory:!1,fips:"12",abbr:"FL",capital:"Tallahassee",capital_tz:"America/New_York",time_zones:["America/New_York","America/Chicago"]},{name:"Georgia",metaphones:["JRJ","JRK"],statehood_year:1788,ap_abbr:"Ga.",is_territory:!1,fips:"13",abbr:"GA",capital:"Atlanta",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Guam",metaphones:["KM"],statehood_year:null,ap_abbr:null,is_territory:!0,fips:"66",abbr:"GU",capital:"Hag\\u00e5t\\u00f1a",capital_tz:"Pacific/Guam",time_zones:["Pacific/Guam"]},{name:"Hawaii",metaphones:["HW"],statehood_year:1959,ap_abbr:"Hawaii",is_territory:!1,fips:"15",abbr:"HI",capital:"Honolulu",capital_tz:"Pacific/Honolulu",time_zones:["Pacific/Honolulu"]},{name:"Idaho",metaphones:["ITH"],statehood_year:1890,ap_abbr:"Idaho",is_territory:!1,fips:"16",abbr:"ID",capital:"Boise",capital_tz:"America/Denver",time_zones:["America/Denver","America/Los_Angeles"]},{name:"Illinois",metaphones:["ILNS"],statehood_year:1818,ap_abbr:"Ill.",is_territory:!1,fips:"17",abbr:"IL",capital:"Springfield",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Indiana",metaphones:["INTN"],statehood_year:1816,ap_abbr:"Ind.",is_territory:!1,fips:"18",abbr:"IN",capital:"Indianapolis",capital_tz:"America/Indiana/Indianapolis",time_zones:["America/Indiana/Indianapolis","America/Indianapolis","America/Indiana/Winamac","America/Indiana/Vincennes","America/Indiana/Vevay","America/Indiana/Tell_City","America/Indiana/Petersburg","America/Indiana/Marengo","America/Indiana/Knox","America/Knox_IN"]},{name:"Iowa",metaphones:["IW","IH"],statehood_year:1846,ap_abbr:"Iowa",is_territory:!1,fips:"19",abbr:"IA",capital:"Des Moines",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Kansas",metaphones:["KNSS"],statehood_year:1861,ap_abbr:"Kan.",is_territory:!1,fips:"20",abbr:"KS",capital:"Topeka",capital_tz:"America/Chicago",time_zones:["America/Chicago","America/Denver"]},{name:"Kentucky",metaphones:["KNTXY","KNTKY"],statehood_year:1792,ap_abbr:"Ky.",is_territory:!1,fips:"21",abbr:"KY",capital:"Frankfort",capital_tz:"America/New_York",time_zones:["America/New_York","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Louisville"]},{name:"Louisiana",metaphones:["LXN","LSN"],statehood_year:1812,ap_abbr:"La.",is_territory:!1,fips:"22",abbr:"LA",capital:"Baton Rouge",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Maine",metaphones:["MN"],statehood_year:1820,ap_abbr:"Maine",is_territory:!1,fips:"23",abbr:"ME",capital:"Augusta",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Maryland",metaphones:["MRLNT"],statehood_year:1788,ap_abbr:"Md.",is_territory:!1,fips:"24",abbr:"MD",capital:"Annapolis",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Massachusetts",metaphones:["MSXSTS"],statehood_year:1788,ap_abbr:"Mass.",is_territory:!1,fips:"25",abbr:"MA",capital:"Boston",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Michigan",metaphones:["MXKN"],statehood_year:1837,ap_abbr:"Mich.",is_territory:!1,fips:"26",abbr:"MI",capital:"Lansing",capital_tz:"America/New_York",time_zones:["America/New_York","America/Chicago"]},{name:"Minnesota",metaphones:["MNST"],statehood_year:1858,ap_abbr:"Minn.",is_territory:!1,fips:"27",abbr:"MN",capital:"Saint Paul",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Mississippi",metaphones:["MSSP"],statehood_year:1817,ap_abbr:"Miss.",is_territory:!1,fips:"28",abbr:"MS",capital:"Jackson",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Missouri",metaphones:["MSR","MSRY"],statehood_year:1821,ap_abbr:"Mo.",is_territory:!1,fips:"29",abbr:"MO",capital:"Jefferson City",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Montana",metaphones:["MNTN"],statehood_year:1889,ap_abbr:"Mont.",is_territory:!1,fips:"30",abbr:"MT",capital:"Helena",capital_tz:"America/Denver",time_zones:["America/Denver"]},{name:"Nebraska",metaphones:["NBRSK","NBRSX"],statehood_year:1867,ap_abbr:"Neb.",is_territory:!1,fips:"31",abbr:"NE",capital:"Lincoln",capital_tz:"America/Chicago",time_zones:["America/Chicago","America/Denver"]},{name:"Nevada",metaphones:["NFT"],statehood_year:1864,ap_abbr:"Nev.",is_territory:!1,fips:"32",abbr:"NV",capital:"Carson City",capital_tz:"America/Los_Angeles",time_zones:["America/Los_Angeles","America/Denver"]},{name:"New Hampshire",metaphones:["NHMPXR"],statehood_year:1788,ap_abbr:"N.H.",is_territory:!1,fips:"33",abbr:"NH",capital:"Concord",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"New Jersey",metaphones:["NJRSY"],statehood_year:1787,ap_abbr:"N.J.",is_territory:!1,fips:"34",abbr:"NJ",capital:"Trenton",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"New Mexico",metaphones:["NMKSX"],statehood_year:1912,ap_abbr:"N.M.",is_territory:!1,fips:"35",abbr:"NM",capital:"Santa Fe",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"New York",metaphones:["NYRK"],statehood_year:1788,ap_abbr:"N.Y.",is_territory:!1,fips:"36",abbr:"NY",capital:"Albany",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"North Carolina",metaphones:["NR0XRLN"],statehood_year:1789,ap_abbr:"N.C.",is_territory:!1,fips:"37",abbr:"NC",capital:"Raleigh",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"North Dakota",metaphones:["NR0TKT","NTK"],statehood_year:1889,ap_abbr:"N.D.",is_territory:!1,fips:"38",abbr:"ND",capital:"Bismarck",capital_tz:"America/North_Dakota/Center",time_zones:["America/North_Dakota/Center","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem"]},{name:"Northern Mariana Islands",metaphones:["NR0RNMRNSLNTS"],statehood_year:null,ap_abbr:null,is_territory:!0,fips:"69",abbr:"MP",capital:"Saipan",capital_tz:"Pacific/Guam",time_zones:["Pacific/Guam"]},{name:"Ohio",metaphones:["OH"],statehood_year:1803,ap_abbr:"Ohio",is_territory:!1,fips:"39",abbr:"OH",capital:"Columbus",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Oklahoma",metaphones:["OKLHM"],statehood_year:1907,ap_abbr:"Okla.",is_territory:!1,fips:"40",abbr:"OK",capital:"Oklahoma City",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Oregon",metaphones:["ORKN"],statehood_year:1859,ap_abbr:"Ore.",is_territory:!1,fips:"41",abbr:"OR",capital:"Salem",capital_tz:"America/Los_Angeles",time_zones:["America/Los_Angeles","America/Boise"]},{name:"Pennsylvania",metaphones:["PNSLFN"],statehood_year:1787,ap_abbr:"Pa.",is_territory:!1,fips:"42",abbr:"PA",capital:"Harrisburg",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Puerto Rico",metaphones:["PRTRX"],statehood_year:null,ap_abbr:null,is_territory:!0,fips:"72",abbr:"PR",capital:"San Juan",capital_tz:"America/Puerto_Rico",time_zones:["America/Puerto_Rico"]},{name:"Rhode Island",metaphones:["RHTSLNT","RTSLNT"],statehood_year:1790,ap_abbr:"R.I.",is_territory:!1,fips:"44",abbr:"RI",capital:"Providence",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"South Carolina",metaphones:["S0XRLN","STXRLN","SXRL"],statehood_year:1788,ap_abbr:"S.C.",is_territory:!1,fips:"45",abbr:"SC",capital:"Columbia",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"South Dakota",metaphones:["S0TKT"],statehood_year:1889,ap_abbr:"S.D.",is_territory:!1,fips:"46",abbr:"SD",capital:"Pierre",capital_tz:"America/Chicago",time_zones:["America/Chicago","America/Denver"]},{name:"Tennessee",metaphones:["TNS"],statehood_year:1796,ap_abbr:"Tenn.",is_territory:!1,fips:"47",abbr:"TN",capital:"Nashville",capital_tz:"America/Chicago",time_zones:["America/Chicago","America/New_York"]},{name:"Texas",metaphones:["TKSS"],statehood_year:1845,ap_abbr:"Texas",is_territory:!1,fips:"48",abbr:"TX",capital:"Austin",capital_tz:"America/Chicago",time_zones:["America/Chicago","America/Denver"]},{name:"Utah",metaphones:["UTH","UTS","UTR"],statehood_year:1896,ap_abbr:"Utah",is_territory:!1,fips:"49",abbr:"UT",capital:"Salt Lake City",capital_tz:"America/Denver",time_zones:["America/Denver"]},{name:"Vermont",metaphones:["FRMNT"],statehood_year:1791,ap_abbr:"Vt.",is_territory:!1,fips:"50",abbr:"VT",capital:"Montpelier",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Virgin Islands",metaphones:["FRJNSLNTS"],statehood_year:null,ap_abbr:null,is_territory:!0,fips:"78",abbr:"VI",capital:"Charlotte Amalie",capital_tz:"America/Puerto_Rico",time_zones:["America/Puerto_Rico"]},{name:"Virginia",metaphones:["FRJN"],statehood_year:1788,ap_abbr:"Va.",is_territory:!1,fips:"51",abbr:"VA",capital:"Richmond",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Washington",metaphones:["WXNKTN"],statehood_year:1889,ap_abbr:"Wash.",is_territory:!1,fips:"53",abbr:"WA",capital:"Olympia",capital_tz:"America/Los_Angeles",time_zones:["America/Los_Angeles"]},{name:"West Virginia",metaphones:["WSTFRJN","WSTFRKN"],statehood_year:1863,ap_abbr:"W.Va.",is_territory:!1,fips:"54",abbr:"WV",capital:"Charleston",capital_tz:"America/New_York",time_zones:["America/New_York"]},{name:"Wisconsin",metaphones:["WSXNSN"],statehood_year:1848,ap_abbr:"Wis.",is_territory:!1,fips:"55",abbr:"WI",capital:"Madison",capital_tz:"America/Chicago",time_zones:["America/Chicago"]},{name:"Wyoming",metaphones:["YMN","YMNJ","WMN"],statehood_year:1890,ap_abbr:"Wyo.",is_territory:!1,fips:"56",abbr:"WY",capital:"Cheyenne",capital_tz:"America/Denver",time_zones:["America/Denver"]}],F(),E})})(mp);const bm="Topology",wm=[],Tm={points:{type:"GeometryCollection",geometries:[{type:"Point",coordinates:[-98.48648290006305,45.4646985002391],properties:{city_and_state:"Aberdeen, SD",black_pop_pct_chg_1940_1970:-.005,black_pop_pct_chg_1910_1940:0,city:"Aberdeen",state:"SD",state_fips:"46",GISJOIN:"G46000100",state_full:"South Dakota",place:"Aberdeen city"}},{type:"Point",coordinates:[-99.73314389961433,32.44873639987648],properties:{city_and_state:"Abilene, TX",black_pop_pct_chg_1940_1970:-.008,black_pop_pct_chg_1910_1940:.001,city:"Abilene",state:"TX",state_fips:"48",GISJOIN:"G48001000",state_full:"Texas",place:"Abilene city"}},{type:"Point",coordinates:[-81.51900529979908,41.08144469990571],properties:{city_and_state:"Akron, OH",black_pop_pct_chg_1940_1970:.041,black_pop_pct_chg_1910_1940:.125,city:"Akron",state:"OH",state_fips:"39",GISJOIN:"G39001000",state_full:"Ohio",place:"Akron city"}},{type:"Point",coordinates:[-73.75623170000904,42.652579300165456],properties:{city_and_state:"Albany, NY",black_pop_pct_chg_1940_1970:.012,black_pop_pct_chg_1910_1940:.1,city:"Albany",state:"NY",state_fips:"36",GISJOIN:"G36001000",state_full:"New York",place:"Albany city"}},{type:"Point",coordinates:[-106.6511367003071,35.08449090005196],properties:{city_and_state:"Albuquerque, NM",black_pop_pct_chg_1940_1970:-.007,black_pop_pct_chg_1910_1940:.007,city:"Albuquerque",state:"NM",state_fips:"35",GISJOIN:"G35002000",state_full:"New Mexico",place:"Albuquerque city"}},{type:"Point",coordinates:[-77.04692139950983,38.80483560027435],properties:{city_and_state:"Alexandria, VA",black_pop_pct_chg_1940_1970:-.116,black_pop_pct_chg_1910_1940:-.017,city:"Alexandria",state:"VA",state_fips:"51",GISJOIN:"G51001000",state_full:"Virginia",place:"Alexandria city"}},{type:"Point",coordinates:[-75.49018329988678,40.60843049995508],properties:{city_and_state:"Allentown, PA",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.014,city:"Allentown",state:"PA",state_fips:"42",GISJOIN:"G42002000",state_full:"Pennsylvania",place:"Allentown city"}},{type:"Point",coordinates:[-101.83129689995306,35.22199709992267],properties:{city_and_state:"Amarillo, TX",black_pop_pct_chg_1940_1970:.041,black_pop_pct_chg_1910_1940:-.001,city:"Amarillo",state:"TX",state_fips:"48",GISJOIN:"G48003000",state_full:"Texas",place:"Amarillo city"}},{type:"Point",coordinates:[-117.91450359988842,33.83529319979097],properties:{city_and_state:"Anaheim, CA",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:0,city:"Anaheim",state:"CA",state_fips:"06",GISJOIN:"G06002000",state_full:"California",place:"Anaheim city"}},{type:null,properties:{city_and_state:null,black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:null,city:null,state:null,state_fips:null,GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-83.7263294000787,42.270871599987466],properties:{city_and_state:"Ann Arbor, MI",black_pop_pct_chg_1940_1970:.006,black_pop_pct_chg_1910_1940:.026,city:"Ann Arbor",state:"MI",state_fips:"26",GISJOIN:"G26003000",state_full:"Michigan",place:"Ann Arbor city"}},{type:"Point",coordinates:[-123.83125339932391,46.187884099869315],properties:{city_and_state:"Astoria, OR",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.005,city:"Astoria",state:"OR",state_fips:"41",GISJOIN:"G41003150",state_full:"Oregon",place:"Astoria city"}},{type:"Point",coordinates:[-84.38798239965413,33.7489954002034],properties:{city_and_state:"Atlanta, GA",black_pop_pct_chg_1940_1970:.011,black_pop_pct_chg_1910_1940:.167,city:"Atlanta",state:"GA",state_fips:"13",GISJOIN:"G13004000",state_full:"Georgia",place:"Atlanta city"}},{type:null,properties:{city_and_state:"Augusta, GA",black_pop_pct_chg_1940_1970:-.037,black_pop_pct_chg_1910_1940:.089,city:"Augusta",state:"GA",state_fips:"13",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-104.83191949993684,39.72943189963251],properties:{city_and_state:"Aurora, CO",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:.01,city:"Aurora",state:"CO",state_fips:"08",GISJOIN:"G08004000",state_full:"Colorado",place:"Aurora city"}},{type:"Point",coordinates:[-97.74306080035102,30.267153000249184],properties:{city_and_state:"Austin, TX",black_pop_pct_chg_1940_1970:-.081,black_pop_pct_chg_1910_1940:-.051,city:"Austin",state:"TX",state_fips:"48",GISJOIN:"G48005000",state_full:"Texas",place:"Austin city"}},{type:"Point",coordinates:[-119.01871249972038,35.373292100060574],properties:{city_and_state:"Bakersfield, CA",black_pop_pct_chg_1940_1970:.014,black_pop_pct_chg_1910_1940:.098,city:"Bakersfield",state:"CA",state_fips:"06",GISJOIN:"G06003526",state_full:"California",place:"Bakersfield city"}},{type:"Point",coordinates:[-76.61218930012839,39.29038480039019],properties:{city_and_state:"Baltimore, MD",black_pop_pct_chg_1940_1970:.041,black_pop_pct_chg_1910_1940:.271,city:"Baltimore",state:"MD",state_fips:"24",GISJOIN:"G24004000",state_full:"Maryland",place:"Baltimore city"}},{type:"Point",coordinates:[-68.77781379947247,44.80118209971405],properties:{city_and_state:"Bangor, ME",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:.002,city:"Bangor",state:"ME",state_fips:"23",GISJOIN:"G23002795",state_full:"Maine",place:"Bangor city"}},{type:"Point",coordinates:[-72.50204939952327,44.19700550004752],properties:{city_and_state:"Barre, VT",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:0,city:"Barre",state:"VT",state_fips:"50",GISJOIN:"G50003175",state_full:"Vermont",place:"Barre city"}},{type:"Point",coordinates:[-91.15455099990108,30.450746200021953],properties:{city_and_state:"Baton Rouge, LA",black_pop_pct_chg_1940_1970:-.195,black_pop_pct_chg_1910_1940:-.056,city:"Baton Rouge",state:"LA",state_fips:"22",GISJOIN:"G22005000",state_full:"Louisiana",place:"Baton Rouge city"}},{type:"Point",coordinates:[-94.10184610035982,30.086045899852547],properties:{city_and_state:"Beaumont, TX",black_pop_pct_chg_1940_1970:-.014,black_pop_pct_chg_1910_1940:-.014,city:"Beaumont",state:"TX",state_fips:"48",GISJOIN:"G48007000",state_full:"Texas",place:"Beaumont city"}},{type:"Point",coordinates:[-122.27274699990076,37.87159260028686],properties:{city_and_state:"Berkeley, CA",black_pop_pct_chg_1940_1970:.034,black_pop_pct_chg_1910_1940:.195,city:"Berkeley",state:"CA",state_fips:"06",GISJOIN:"G06006000",state_full:"California",place:"Berkeley city"}},{type:"Point",coordinates:[-108.50069039957482,45.78328559995504],properties:{city_and_state:"Billings, MT",black_pop_pct_chg_1940_1970:-.008,black_pop_pct_chg_1910_1940:-.003,city:"Billings",state:"MT",state_fips:"30",GISJOIN:"G30006550",state_full:"Montana",place:"Billings city"}},{type:"Point",coordinates:[-88.88530779989486,30.396031799601058],properties:{city_and_state:"Biloxi, MS",black_pop_pct_chg_1940_1970:-.031,black_pop_pct_chg_1910_1940:-.012,city:"Biloxi",state:"MS",state_fips:"28",GISJOIN:"G28006220",state_full:"Mississippi",place:"Biloxi city"}},{type:"Point",coordinates:[-86.80248999946456,33.52066080029142],properties:{city_and_state:"Birmingham, AL",black_pop_pct_chg_1940_1970:.013,black_pop_pct_chg_1910_1940:.013,city:"Birmingham",state:"AL",state_fips:"01",GISJOIN:"G01007000",state_full:"Alabama",place:"Birmingham city"}},{type:null,properties:{city_and_state:"Boise, ID",black_pop_pct_chg_1940_1970:-.004,black_pop_pct_chg_1910_1940:0,city:"Boise",state:"ID",state_fips:"16",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-71.05977319934854,42.35843080010432],properties:{city_and_state:"Boston, MA",black_pop_pct_chg_1940_1970:.01,black_pop_pct_chg_1910_1940:.133,city:"Boston",state:"MA",state_fips:"25",GISJOIN:"G25007000",state_full:"Massachusetts",place:"Boston city"}},{type:"Point",coordinates:[-73.2048348005092,41.167041200070656],properties:{city_and_state:"Bridgeport, CT",black_pop_pct_chg_1940_1970:.013,black_pop_pct_chg_1910_1940:.138,city:"Bridgeport",state:"CT",state_fips:"09",GISJOIN:"G09008000",state_full:"Connecticut",place:"Bridgeport city"}},{type:"Point",coordinates:[-78.87836890034004,42.88644680019668],properties:{city_and_state:"Buffalo, NY",black_pop_pct_chg_1940_1970:.027,black_pop_pct_chg_1910_1940:.173,city:"Buffalo",state:"NY",state_fips:"36",GISJOIN:"G36011000",state_full:"New York",place:"Buffalo city"}},{type:"Point",coordinates:[-73.2120719997798,44.475882499679166],properties:{city_and_state:"Burlington, VT",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:.001,city:"Burlington",state:"VT",state_fips:"50",GISJOIN:"G50010675",state_full:"Vermont",place:"Burlington city"}},{type:null,properties:{city_and_state:"Butte, MT",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:-.003,city:"Butte",state:"MT",state_fips:"30",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-71.1056079003837,42.37509699967844],properties:{city_and_state:"Cambridge, MA",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:.024,city:"Cambridge",state:"MA",state_fips:"25",GISJOIN:"G25011000",state_full:"Massachusetts",place:"Cambridge city"}},{type:"Point",coordinates:[-75.11961990027497,39.92594630036961],properties:{city_and_state:"Camden, NJ",black_pop_pct_chg_1940_1970:.042,black_pop_pct_chg_1910_1940:.285,city:"Camden",state:"NJ",state_fips:"34",GISJOIN:"G34010000",state_full:"New Jersey",place:"Camden city"}},{type:"Point",coordinates:[-81.3784469998428,40.79894730025078],properties:{city_and_state:"Canton, OH",black_pop_pct_chg_1940_1970:.031,black_pop_pct_chg_1910_1940:.088,city:"Canton",state:"OH",state_fips:"39",GISJOIN:"G39012000",state_full:"Ohio",place:"Canton city"}},{type:"Point",coordinates:[-106.31308100054738,42.866631999525396],properties:{city_and_state:"Casper, WY",black_pop_pct_chg_1940_1970:.002,black_pop_pct_chg_1910_1940:.002,city:"Casper",state:"WY",state_fips:"56",GISJOIN:"G56013150",state_full:"Wyoming",place:"Casper city"}},{type:"Point",coordinates:[-91.64406830047207,42.008332799978334],properties:{city_and_state:"Cedar Rapids, IA",black_pop_pct_chg_1940_1970:.004,black_pop_pct_chg_1910_1940:.005,city:"Cedar Rapids",state:"IA",state_fips:"19",GISJOIN:"G19012000",state_full:"Iowa",place:"Cedar Rapids city"}},{type:"Point",coordinates:[-79.93092160040172,32.77656559977502],properties:{city_and_state:"Charleston, SC",black_pop_pct_chg_1940_1970:-.082,black_pop_pct_chg_1910_1940:.006,city:"Charleston",state:"SC",state_fips:"45",GISJOIN:"G45013330",state_full:"South Carolina",place:"Charleston city"}},{type:"Point",coordinates:[-81.63262350022212,38.349819500465436],properties:{city_and_state:"Charleston, WV",black_pop_pct_chg_1940_1970:-.031,black_pop_pct_chg_1910_1940:0,city:"Charleston",state:"WV",state_fips:"54",GISJOIN:"G54014600",state_full:"West Virginia",place:"Charleston city"}},{type:"Point",coordinates:[-80.84312680054953,35.22708689991263],properties:{city_and_state:"Charlotte, NC",black_pop_pct_chg_1940_1970:-.034,black_pop_pct_chg_1910_1940:-.009,city:"Charlotte",state:"NC",state_fips:"37",GISJOIN:"G37012000",state_full:"North Carolina",place:"Charlotte city"}},{type:"Point",coordinates:[-85.30968009960532,35.04562969969149],properties:{city_and_state:"Chattanooga, TN",black_pop_pct_chg_1940_1970:-.118,black_pop_pct_chg_1910_1940:.074,city:"Chattanooga",state:"TN",state_fips:"47",GISJOIN:"G47014000",state_full:"Tennessee",place:"Chattanooga city"}},{type:"Point",coordinates:[-104.82024620041976,41.139981399968654],properties:{city_and_state:"Cheyenne, WY",black_pop_pct_chg_1940_1970:-.046,black_pop_pct_chg_1910_1940:.013,city:"Cheyenne",state:"WY",state_fips:"56",GISJOIN:"G56013900",state_full:"Wyoming",place:"Cheyenne city"}},{type:"Point",coordinates:[-87.6500523003823,41.85003300044082],properties:{city_and_state:"Chicago, IL",black_pop_pct_chg_1940_1970:.062,black_pop_pct_chg_1910_1940:.246,city:"Chicago",state:"IL",state_fips:"17",GISJOIN:"G17014000",state_full:"Illinois",place:"Chicago city"}},{type:"Point",coordinates:[-84.45688630015772,39.16200360000773],properties:{city_and_state:"Cincinnati, OH",black_pop_pct_chg_1940_1970:.068,black_pop_pct_chg_1910_1940:.154,city:"Cincinnati",state:"OH",state_fips:"39",GISJOIN:"G39015000",state_full:"Ohio",place:"Cincinnati city"}},{type:"Point",coordinates:[-81.69540880058501,41.49949540000102],properties:{city_and_state:"Cleveland, OH",black_pop_pct_chg_1940_1970:.081,black_pop_pct_chg_1910_1940:.287,city:"Cleveland",state:"OH",state_fips:"39",GISJOIN:"G39016000",state_full:"Ohio",place:"Cleveland city"}},{type:"Point",coordinates:[-104.82136340057117,38.833881600305574],properties:{city_and_state:"Colorado Springs, CO",black_pop_pct_chg_1940_1970:-.009,black_pop_pct_chg_1910_1940:.023,city:"Colorado Springs",state:"CO",state_fips:"08",GISJOIN:"G08016000",state_full:"Colorado",place:"Colorado Springs city"}},{type:"Point",coordinates:[-81.03481439989321,34.00071040014469],properties:{city_and_state:"Columbia, SC",black_pop_pct_chg_1940_1970:-.083,black_pop_pct_chg_1910_1940:-.056,city:"Columbia",state:"SC",state_fips:"45",GISJOIN:"G45016000",state_full:"South Carolina",place:"Columbia city"}},{type:"Point",coordinates:[-84.98770939971628,32.46097639977416],properties:{city_and_state:"Columbus, GA",black_pop_pct_chg_1940_1970:-.044,black_pop_pct_chg_1910_1940:-.065,city:"Columbus",state:"GA",state_fips:"13",GISJOIN:"G13019000",state_full:"Georgia",place:"Columbus city"}},{type:"Point",coordinates:[-82.9987942002034,39.961175499798976],properties:{city_and_state:"Columbus, OH",black_pop_pct_chg_1940_1970:.047,black_pop_pct_chg_1910_1940:.068,city:"Columbus",state:"OH",state_fips:"39",GISJOIN:"G39018000",state_full:"Ohio",place:"Columbus city"}},{type:"Point",coordinates:[-71.53757180029716,43.208136599895305],properties:{city_and_state:"Concord, NH",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:0,city:"Concord",state:"NH",state_fips:"33",GISJOIN:"G33014200",state_full:"New Hampshire",place:"Concord city"}},{type:"Point",coordinates:[-97.39638099967338,27.80058279982731],properties:{city_and_state:"Corpus Christi, TX",black_pop_pct_chg_1940_1970:.026,black_pop_pct_chg_1910_1940:-.028,city:"Corpus Christi",state:"TX",state_fips:"48",GISJOIN:"G48017000",state_full:"Texas",place:"Corpus Christi city"}},{type:"Point",coordinates:[-84.50855369995051,39.083671199581126],properties:{city_and_state:"Covington, KY",black_pop_pct_chg_1940_1970:-.004,black_pop_pct_chg_1910_1940:.013,city:"Covington",state:"KY",state_fips:"21",GISJOIN:"G21017848",state_full:"Kentucky",place:"Covington city"}},{type:"Point",coordinates:[-78.76251850020468,39.6528653997853],properties:{city_and_state:"Cumberland, MD",black_pop_pct_chg_1940_1970:-.021,black_pop_pct_chg_1910_1940:.001,city:"Cumberland",state:"MD",state_fips:"24",GISJOIN:"G24021325",state_full:"Maryland",place:"Cumberland city"}},{type:"Point",coordinates:[-96.80666670048609,32.783055600052634],properties:{city_and_state:"Dallas, TX",black_pop_pct_chg_1940_1970:-.025,black_pop_pct_chg_1910_1940:.078,city:"Dallas",state:"TX",state_fips:"48",GISJOIN:"G48019000",state_full:"Texas",place:"Dallas city"}},{type:"Point",coordinates:[-90.57763670048966,41.52364369970414],properties:{city_and_state:"Davenport, IA",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:.029,city:"Davenport",state:"IA",state_fips:"19",GISJOIN:"G19019000",state_full:"Iowa",place:"Davenport city"}},{type:"Point",coordinates:[-84.19160689971807,39.75894779980241],properties:{city_and_state:"Dayton, OH",black_pop_pct_chg_1940_1970:.055,black_pop_pct_chg_1910_1940:.209,city:"Dayton",state:"OH",state_fips:"39",GISJOIN:"G39021000",state_full:"Ohio",place:"Dayton city"}},{type:"Point",coordinates:[-104.9847033997117,39.73915359965694],properties:{city_and_state:"Denver, CO",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:.067,city:"Denver",state:"CO",state_fips:"08",GISJOIN:"G08020000",state_full:"Colorado",place:"Denver city"}},{type:"Point",coordinates:[-93.60910640005655,41.60054480003607],properties:{city_and_state:"Des Moines, IA",black_pop_pct_chg_1940_1970:.006,black_pop_pct_chg_1910_1940:.017,city:"Des Moines",state:"IA",state_fips:"19",GISJOIN:"G19021000",state_full:"Iowa",place:"Des Moines city"}},{type:"Point",coordinates:[-83.04575379960238,42.331426999565444],properties:{city_and_state:"Detroit, MI",black_pop_pct_chg_1940_1970:.08,black_pop_pct_chg_1910_1940:.345,city:"Detroit",state:"MI",state_fips:"26",GISJOIN:"G26022000",state_full:"Michigan",place:"Detroit city"}},{type:"Point",coordinates:[-75.52436820039217,39.15816799987987],properties:{city_and_state:"Dover, DE",black_pop_pct_chg_1940_1970:-.03,black_pop_pct_chg_1910_1940:-.01,city:"Dover",state:"DE",state_fips:"10",GISJOIN:"G10021200",state_full:"Delaware",place:"Dover city"}},{type:"Point",coordinates:[-90.66457180061215,42.50055829976601],properties:{city_and_state:"Dubuque, IA",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:0,city:"Dubuque",state:"IA",state_fips:"19",GISJOIN:"G19022395",state_full:"Iowa",place:"Dubuque city"}},{type:"Point",coordinates:[-92.1065786999428,46.78327309988393],properties:{city_and_state:"Duluth, MN",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.005,city:"Duluth",state:"MN",state_fips:"27",GISJOIN:"G27017000",state_full:"Minnesota",place:"Duluth city"}},{type:"Point",coordinates:[-78.89861899946176,35.994032900368204],properties:{city_and_state:"Durham, NC",black_pop_pct_chg_1940_1970:.011,black_pop_pct_chg_1910_1940:0,city:"Durham",state:"NC",state_fips:"37",GISJOIN:"G37019000",state_full:"North Carolina",place:"Durham city"}},{type:"Point",coordinates:[-106.48693140017363,31.758719800239952],properties:{city_and_state:"El Paso, TX",black_pop_pct_chg_1940_1970:-.014,black_pop_pct_chg_1910_1940:0,city:"El Paso",state:"TX",state_fips:"48",GISJOIN:"G48024000",state_full:"Texas",place:"El Paso city"}},{type:"Point",coordinates:[-74.21070059989351,40.66399160004813],properties:{city_and_state:"Elizabeth, NJ",black_pop_pct_chg_1940_1970:.026,black_pop_pct_chg_1910_1940:.11,city:"Elizabeth",state:"NJ",state_fips:"34",GISJOIN:"G34021000",state_full:"New Jersey",place:"Elizabeth city"}},{type:"Point",coordinates:[-80.08505900048013,42.129224100403185],properties:{city_and_state:"Erie, PA",black_pop_pct_chg_1940_1970:.007,black_pop_pct_chg_1910_1940:.055,city:"Erie",state:"PA",state_fips:"42",GISJOIN:"G42024000",state_full:"Pennsylvania",place:"Erie city"}},{type:"Point",coordinates:[-123.08675360005738,44.052069100366836],properties:{city_and_state:"Eugene, OR",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.008,city:"Eugene",state:"OR",state_fips:"41",GISJOIN:"G41023850",state_full:"Oregon",place:"Eugene city"}},{type:"Point",coordinates:[-87.55584819953145,37.974764400158136],properties:{city_and_state:"Evansville, IN",black_pop_pct_chg_1940_1970:-.019,black_pop_pct_chg_1910_1940:.002,city:"Evansville",state:"IN",state_fips:"18",GISJOIN:"G18022000",state_full:"Indiana",place:"Evansville city"}},{type:null,properties:{city_and_state:null,black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:null,city:null,state:null,state_fips:null,GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-71.15504510052133,41.70149119979171],properties:{city_and_state:"Fall River, MA",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.001,city:"Fall River",state:"MA",state_fips:"25",GISJOIN:"G25023000",state_full:"Massachusetts",place:"Fall River city"}},{type:"Point",coordinates:[-96.78980340014375,46.87718630025178],properties:{city_and_state:"Fargo, ND",black_pop_pct_chg_1940_1970:-.006,black_pop_pct_chg_1910_1940:0,city:"Fargo",state:"ND",state_fips:"38",GISJOIN:"G38025700",state_full:"North Dakota",place:"Fargo city"}},{type:"Point",coordinates:[-78.87835849967165,35.05266409997919],properties:{city_and_state:"Fayetteville, NC",black_pop_pct_chg_1940_1970:-.069,black_pop_pct_chg_1910_1940:-.016,city:"Fayetteville",state:"NC",state_fips:"37",GISJOIN:"G37022920",state_full:"North Carolina",place:"Fayetteville city"}},{type:"Point",coordinates:[-83.6874562004047,43.01252739994307],properties:{city_and_state:"Flint, MI",black_pop_pct_chg_1940_1970:.033,black_pop_pct_chg_1910_1940:.237,city:"Flint",state:"MI",state_fips:"26",GISJOIN:"G26029000",state_full:"Michigan",place:"Flint city"}},{type:"Point",coordinates:[-94.39854749999405,35.38592420017764],properties:{city_and_state:"Fort Smith, AR",black_pop_pct_chg_1940_1970:-.071,black_pop_pct_chg_1910_1940:-.046,city:"Fort Smith",state:"AR",state_fips:"05",GISJOIN:"G05024550",state_full:"Arkansas",place:"Fort Smith city"}},{type:"Point",coordinates:[-85.128859700302,41.130604100295315],properties:{city_and_state:"Fort Wayne, IN",black_pop_pct_chg_1940_1970:.012,black_pop_pct_chg_1910_1940:.085,city:"Fort Wayne",state:"IN",state_fips:"18",GISJOIN:"G18025000",state_full:"Indiana",place:"Fort Wayne city"}},{type:"Point",coordinates:[-97.32084959974999,32.725409000374746],properties:{city_and_state:"Fort Worth, TX",black_pop_pct_chg_1940_1970:-.039,black_pop_pct_chg_1910_1940:.057,city:"Fort Worth",state:"TX",state_fips:"48",GISJOIN:"G48027000",state_full:"Texas",place:"Fort Worth city"}},{type:"Point",coordinates:[-77.41054090009911,39.414268800195224],properties:{city_and_state:"Frederick, MD",black_pop_pct_chg_1940_1970:-.026,black_pop_pct_chg_1910_1940:.009,city:"Frederick",state:"MD",state_fips:"24",GISJOIN:"G24030325",state_full:"Maryland",place:"Frederick city"}},{type:"Point",coordinates:[-119.77236610002299,36.74772720038402],properties:{city_and_state:"Fresno, CA",black_pop_pct_chg_1940_1970:.023,black_pop_pct_chg_1910_1940:.063,city:"Fresno",state:"CA",state_fips:"06",GISJOIN:"G06027000",state_full:"California",place:"Fresno city"}},{type:"Point",coordinates:[-94.79777779954169,29.301388900444746],properties:{city_and_state:"Galveston, TX",black_pop_pct_chg_1940_1970:.036,black_pop_pct_chg_1910_1940:.04,city:"Galveston",state:"TX",state_fips:"48",GISJOIN:"G48028068",state_full:"Texas",place:"Galveston city"}},{type:"Point",coordinates:[-87.34642709953506,41.59336959958527],properties:{city_and_state:"Gary, IN",black_pop_pct_chg_1940_1970:.16,black_pop_pct_chg_1910_1940:.346,city:"Gary",state:"IN",state_fips:"18",GISJOIN:"G18027000",state_full:"Indiana",place:"Gary city"}},{type:"Point",coordinates:[-112.1859866001324,33.5386523003832],properties:{city_and_state:"Glendale, AZ",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:-.003,city:"Glendale",state:"AZ",state_fips:"04",GISJOIN:"G04027820",state_full:"Arizona",place:"Glendale city"}},{type:"Point",coordinates:[-118.25507499990047,34.14250779958445],properties:{city_and_state:"Glendale, CA",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:0,city:"Glendale",state:"CA",state_fips:"06",GISJOIN:"G06030000",state_full:"California",place:"Glendale city"}},{type:"Point",coordinates:[-97.03285469992355,47.925256800311224],properties:{city_and_state:"Grand Forks, ND",black_pop_pct_chg_1940_1970:-.004,black_pop_pct_chg_1910_1940:.002,city:"Grand Forks",state:"ND",state_fips:"38",GISJOIN:"G38032060",state_full:"North Dakota",place:"Grand Forks city"}},{type:"Point",coordinates:[-98.34200679974825,40.925012299660956],properties:{city_and_state:"Grand Island, NE",black_pop_pct_chg_1940_1970:-.007,black_pop_pct_chg_1910_1940:-.002,city:"Grand Island",state:"NE",state_fips:"31",GISJOIN:"G31019595",state_full:"Nebraska",place:"Grand Island city"}},{type:"Point",coordinates:[-85.66808629955909,42.96335989955681],properties:{city_and_state:"Grand Rapids, MI",black_pop_pct_chg_1940_1970:.01,black_pop_pct_chg_1910_1940:.097,city:"Grand Rapids",state:"MI",state_fips:"26",GISJOIN:"G26034000",state_full:"Michigan",place:"Grand Rapids city"}},{type:"Point",coordinates:[-111.30080830037252,47.500235399770844],properties:{city_and_state:"Great Falls, MT",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:0,city:"Great Falls",state:"MT",state_fips:"30",GISJOIN:"G30032800",state_full:"Montana",place:"Great Falls city"}},{type:"Point",coordinates:[-79.79197540032686,36.072635500004644],properties:{city_and_state:"Greensboro, NC",black_pop_pct_chg_1940_1970:-.084,black_pop_pct_chg_1910_1940:.007,city:"Greensboro",state:"NC",state_fips:"37",GISJOIN:"G37028000",state_full:"North Carolina",place:"Greensboro city"}},{type:"Point",coordinates:[-82.39401050050778,34.85261760009098],properties:{city_and_state:"Greenville, SC",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:-.09,city:"Greenville",state:"SC",state_fips:"45",GISJOIN:"G45030850",state_full:"South Carolina",place:"Greenville city"}},{type:"Point",coordinates:[-77.71999320031937,39.64176289972501],properties:{city_and_state:"Hagerstown, MD",black_pop_pct_chg_1940_1970:-.029,black_pop_pct_chg_1910_1940:.008,city:"Hagerstown",state:"MD",state_fips:"24",GISJOIN:"G24036075",state_full:"Maryland",place:"Hagerstown city"}},{type:"Point",coordinates:[-87.50004119979842,41.58336879982356],properties:{city_and_state:"Hammond, IN",black_pop_pct_chg_1940_1970:.007,black_pop_pct_chg_1910_1940:.034,city:"Hammond",state:"IN",state_fips:"18",GISJOIN:"G18031000",state_full:"Indiana",place:"Hammond city"}},{type:"Point",coordinates:[-76.34522180047595,37.029868699798655],properties:{city_and_state:"Hampton, VA",black_pop_pct_chg_1940_1970:-.099,black_pop_pct_chg_1910_1940:-.044,city:"Hampton",state:"VA",state_fips:"51",GISJOIN:"G51035000",state_full:"Virginia",place:"Hampton city"}},{type:"Point",coordinates:[-72.68509319963445,41.76371110029288],properties:{city_and_state:"Hartford, CT",black_pop_pct_chg_1940_1970:.025,black_pop_pct_chg_1910_1940:.236,city:"Hartford",state:"CT",state_fips:"09",GISJOIN:"G09037000",state_full:"Connecticut",place:"Hartford city"}},{type:"Point",coordinates:[-112.0361090005933,46.59271220028887],properties:{city_and_state:"Helena, MT",black_pop_pct_chg_1940_1970:-.024,black_pop_pct_chg_1910_1940:-.008,city:"Helena",state:"MT",state_fips:"30",GISJOIN:"G30035600",state_full:"Montana",place:"Helena city"}},{type:null,properties:{city_and_state:"Hilo, HI",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:null,city:"Hilo",state:"HI",state_fips:"15",GISJOIN:null,state_full:null,place:null}},{type:null,properties:{city_and_state:"Honolulu, HI",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:null,city:"Honolulu",state:"HI",state_fips:"15",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-95.36327149987046,29.76328360038158],properties:{city_and_state:"Houston, TX",black_pop_pct_chg_1940_1970:-.079,black_pop_pct_chg_1910_1940:.032,city:"Houston",state:"TX",state_fips:"48",GISJOIN:"G48035000",state_full:"Texas",place:"Houston city"}},{type:"Point",coordinates:[-117.99922650008284,33.660296999925286],properties:{city_and_state:"Huntington Beach, CA",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:null,city:"Huntington Beach",state:"CA",state_fips:"06",GISJOIN:"G06036000",state_full:"California",place:"Huntington Beach city"}},{type:"Point",coordinates:[-82.44515400036299,38.41924960003442],properties:{city_and_state:"Huntington, WV",black_pop_pct_chg_1940_1970:-.012,black_pop_pct_chg_1910_1940:.002,city:"Huntington",state:"WV",state_fips:"54",GISJOIN:"G54039460",state_full:"West Virginia",place:"Huntington city"}},{type:"Point",coordinates:[-86.58610369944435,34.73036880026566],properties:{city_and_state:"Huntsville, AL",black_pop_pct_chg_1940_1970:-.074,black_pop_pct_chg_1910_1940:-.24,city:"Huntsville",state:"AL",state_fips:"01",GISJOIN:"G01037000",state_full:"Alabama",place:"Huntsville city"}},{type:"Point",coordinates:[-112.03413739975281,43.46658089964619],properties:{city_and_state:"Idaho Falls, ID",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:-.003,city:"Idaho Falls",state:"ID",state_fips:"16",GISJOIN:"G16039700",state_full:"Idaho",place:"Idaho Falls city"}},{type:"Point",coordinates:[-94.41550679996325,39.09111609995986],properties:{city_and_state:"Independence, MO",black_pop_pct_chg_1940_1970:-.058,black_pop_pct_chg_1910_1940:-.041,city:"Independence",state:"MO",state_fips:"29",GISJOIN:"G29035000",state_full:"Missouri",place:"Independence city"}},{type:"Point",coordinates:[-86.15804229957205,39.76837649995398],properties:{city_and_state:"Indianapolis, IN",black_pop_pct_chg_1940_1970:.039,black_pop_pct_chg_1910_1940:.048,city:"Indianapolis",state:"IN",state_fips:"18",GISJOIN:"G18036003",state_full:"Indiana",place:"Indianapolis city (balance)"}},{type:"Point",coordinates:[-90.18481029966587,32.29875729963551],properties:{city_and_state:"Jackson, MS",black_pop_pct_chg_1940_1970:-.106,black_pop_pct_chg_1910_1940:.006,city:"Jackson",state:"MS",state_fips:"28",GISJOIN:"G28036000",state_full:"Mississippi",place:"Jackson city"}},{type:"Point",coordinates:[-81.6556510001309,30.332183799750013],properties:{city_and_state:"Jacksonville, FL",black_pop_pct_chg_1940_1970:-.151,black_pop_pct_chg_1910_1940:-.134,city:"Jacksonville",state:"FL",state_fips:"12",GISJOIN:"G12035000",state_full:"Florida",place:"Jacksonville city"}},{type:"Point",coordinates:[-74.07764169977472,40.728157500293754],properties:{city_and_state:"Jersey City, NJ",black_pop_pct_chg_1940_1970:.022,black_pop_pct_chg_1910_1940:.165,city:"Jersey City",state:"NJ",state_fips:"34",GISJOIN:"G34036000",state_full:"New Jersey",place:"Jersey City city"}},{type:null,properties:{city_and_state:null,black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:null,city:null,state:null,state_fips:null,GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-94.62745700030868,39.11417079989172],properties:{city_and_state:"Kansas City, KS",black_pop_pct_chg_1940_1970:.06,black_pop_pct_chg_1910_1940:.031,city:"Kansas City",state:"KS",state_fips:"20",GISJOIN:"G20036000",state_full:"Kansas",place:"Kansas City city"}},{type:"Point",coordinates:[-94.57856669948173,39.099726599713094],properties:{city_and_state:"Kansas City, MO",black_pop_pct_chg_1940_1970:.009,black_pop_pct_chg_1910_1940:.117,city:"Kansas City",state:"MO",state_fips:"29",GISJOIN:"G29038000",state_full:"Missouri",place:"Kansas City city"}},{type:"Point",coordinates:[-81.7825913998808,24.555702500379365],properties:{city_and_state:"Key West, FL",black_pop_pct_chg_1940_1970:-.095,black_pop_pct_chg_1910_1940:-.065,city:"Key West",state:"FL",state_fips:"12",GISJOIN:"G12036550",state_full:"Florida",place:"Key West city"}},{type:"Point",coordinates:[-83.92073920034885,35.96063840026583],properties:{city_and_state:"Knoxville, TN",black_pop_pct_chg_1940_1970:-.066,black_pop_pct_chg_1910_1940:-.017,city:"Knoxville",state:"TN",state_fips:"47",GISJOIN:"G47040000",state_full:"Tennessee",place:"Knoxville city"}},{type:"Point",coordinates:[-84.55553469999349,42.732535000409605],properties:{city_and_state:"Lansing, MI",black_pop_pct_chg_1940_1970:.009,black_pop_pct_chg_1910_1940:.072,city:"Lansing",state:"MI",state_fips:"26",GISJOIN:"G26046000",state_full:"Michigan",place:"Lansing city"}},{type:"Point",coordinates:[-105.59110070047178,41.31136689993138],properties:{city_and_state:"Laramie, WY",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.002,city:"Laramie",state:"WY",state_fips:"56",GISJOIN:"G56045050",state_full:"Wyoming",place:"Laramie city"}},{type:"Point",coordinates:[-99.50754209979141,27.506407000129997],properties:{city_and_state:"Laredo, TX",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.002,city:"Laredo",state:"TX",state_fips:"48",GISJOIN:"G48041464",state_full:"Texas",place:"Laredo city"}},{type:"Point",coordinates:[-115.13722300001774,36.174970500209795],properties:{city_and_state:"Las Vegas, NV",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:.092,city:"Las Vegas",state:"NV",state_fips:"32",GISJOIN:"G32040000",state_full:"Nevada",place:"Las Vegas city"}},{type:"Point",coordinates:[-94.92246370010407,39.311111200129574],properties:{city_and_state:"Leavenworth, KS",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:-.018,city:"Leavenworth",state:"KS",state_fips:"20",GISJOIN:"G20039000",state_full:"Kansas",place:"Leavenworth city"}},{type:"Point",coordinates:[-70.21477640066361,44.10035099994181],properties:{city_and_state:"Lewiston, ME",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.001,city:"Lewiston",state:"ME",state_fips:"23",GISJOIN:"G23038740",state_full:"Maine",place:"Lewiston city"}},{type:null,properties:{city_and_state:"Lexington, KY",black_pop_pct_chg_1940_1970:-.052,black_pop_pct_chg_1910_1940:-.092,city:"Lexington",state:"KY",state_fips:"21",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-96.6669599002381,40.800001099801875],properties:{city_and_state:"Lincoln, NE",black_pop_pct_chg_1940_1970:-.007,black_pop_pct_chg_1910_1940:.005,city:"Lincoln",state:"NE",state_fips:"31",GISJOIN:"G31028000",state_full:"Nebraska",place:"Lincoln city"}},{type:"Point",coordinates:[-92.28959480001096,34.74648089955628],properties:{city_and_state:"Little Rock, AR",black_pop_pct_chg_1940_1970:-.066,black_pop_pct_chg_1910_1940:-.001,city:"Little Rock",state:"AR",state_fips:"05",GISJOIN:"G05041000",state_full:"Arkansas",place:"Little Rock city"}},{type:"Point",coordinates:[-118.18923480026183,33.76696229949795],properties:{city_and_state:"Long Beach, CA",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.049,city:"Long Beach",state:"CA",state_fips:"06",GISJOIN:"G06043000",state_full:"California",place:"Long Beach city"}},{type:"Point",coordinates:[-118.24368489980526,34.05223420037571],properties:{city_and_state:"Los Angeles, CA",black_pop_pct_chg_1940_1970:.019,black_pop_pct_chg_1910_1940:.136,city:"Los Angeles",state:"CA",state_fips:"06",GISJOIN:"G06044000",state_full:"California",place:"Los Angeles city"}},{type:null,properties:{city_and_state:"Louisville, KY",black_pop_pct_chg_1940_1970:-.033,black_pop_pct_chg_1910_1940:.09,city:"Louisville",state:"KY",state_fips:"21",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-71.31617179977187,42.633424699918734],properties:{city_and_state:"Lowell, MA",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.007,city:"Lowell",state:"MA",state_fips:"25",GISJOIN:"G25037000",state_full:"Massachusetts",place:"Lowell city"}},{type:"Point",coordinates:[-70.94949390022472,42.466763000406715],properties:{city_and_state:"Lynn, MA",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.019,city:"Lynn",state:"MA",state_fips:"25",GISJOIN:"G25037490",state_full:"Massachusetts",place:"Lynn city"}},{type:"Point",coordinates:[-83.63240219961511,32.84069459951623],properties:{city_and_state:"Macon, GA",black_pop_pct_chg_1940_1970:-.004,black_pop_pct_chg_1910_1940:-.069,city:"Macon",state:"GA",state_fips:"13",GISJOIN:"G13049000",state_full:"Georgia",place:"Macon city"}},{type:"Point",coordinates:[-89.4012301996261,43.073051699758395],properties:{city_and_state:"Madison, WI",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.01,city:"Madison",state:"WI",state_fips:"55",GISJOIN:"G55048000",state_full:"Wisconsin",place:"Madison city"}},{type:"Point",coordinates:[-71.45478910040937,42.995639699723455],properties:{city_and_state:"Manchester, NH",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.002,city:"Manchester",state:"NH",state_fips:"33",GISJOIN:"G33045140",state_full:"New Hampshire",place:"Manchester city"}},{type:"Point",coordinates:[-90.04898009991041,35.1495343000196],properties:{city_and_state:"Memphis, TN",black_pop_pct_chg_1940_1970:.015,black_pop_pct_chg_1910_1940:-.026,city:"Memphis",state:"TN",state_fips:"47",GISJOIN:"G47048000",state_full:"Tennessee",place:"Memphis city"}},{type:"Point",coordinates:[-88.70365599989383,32.364309799607554],properties:{city_and_state:"Meridian, MS",black_pop_pct_chg_1940_1970:-.038,black_pop_pct_chg_1910_1940:-.027,city:"Meridian",state:"MS",state_fips:"28",GISJOIN:"G28046640",state_full:"Mississippi",place:"Meridian city"}},{type:"Point",coordinates:[-111.82264020024914,33.422268500116836],properties:{city_and_state:"Mesa, AZ",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:-.033,city:"Mesa",state:"AZ",state_fips:"04",GISJOIN:"G04046000",state_full:"Arizona",place:"Mesa city"}},{type:"Point",coordinates:[-80.19365890029974,25.774265800207697],properties:{city_and_state:"Miami, FL",black_pop_pct_chg_1940_1970:-.199,black_pop_pct_chg_1910_1940:.013,city:"Miami",state:"FL",state_fips:"12",GISJOIN:"G12045000",state_full:"Florida",place:"Miami city"}},{type:"Point",coordinates:[-87.90647360033249,43.03890250030673],properties:{city_and_state:"Milwaukee, WI",black_pop_pct_chg_1940_1970:.012,black_pop_pct_chg_1910_1940:.132,city:"Milwaukee",state:"WI",state_fips:"55",GISJOIN:"G55053000",state_full:"Wisconsin",place:"Milwaukee city"}},{type:"Point",coordinates:[-93.26383609969962,44.97996540024502],properties:{city_and_state:"Minneapolis, MN",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.034,city:"Minneapolis",state:"MN",state_fips:"27",GISJOIN:"G27043000",state_full:"Minnesota",place:"Minneapolis city"}},{type:"Point",coordinates:[-101.29627319949284,48.23250949965678],properties:{city_and_state:"Minot, ND",black_pop_pct_chg_1940_1970:-.007,black_pop_pct_chg_1910_1940:.002,city:"Minot",state:"ND",state_fips:"38",GISJOIN:"G38053380",state_full:"North Dakota",place:"Minot city"}},{type:"Point",coordinates:[-88.04305410010838,30.694356599783085],properties:{city_and_state:"Mobile, AL",black_pop_pct_chg_1940_1970:-.073,black_pop_pct_chg_1910_1940:-.015,city:"Mobile",state:"AL",state_fips:"01",GISJOIN:"G01050000",state_full:"Alabama",place:"Mobile city"}},{type:"Point",coordinates:[-86.29996889964885,32.36680520014407],properties:{city_and_state:"Montgomery, AL",black_pop_pct_chg_1940_1970:-.064,black_pop_pct_chg_1910_1940:-.108,city:"Montgomery",state:"AL",state_fips:"01",GISJOIN:"G01051000",state_full:"Alabama",place:"Montgomery city"}},{type:null,properties:{city_and_state:"Muscogee, OK",black_pop_pct_chg_1940_1970:-.106,black_pop_pct_chg_1910_1940:-.018,city:"Muscogee",state:"OK",state_fips:"40",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-71.46756600034908,42.76536619994491],properties:{city_and_state:"Nashua, NH",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.003,city:"Nashua",state:"NH",state_fips:"33",GISJOIN:"G33050260",state_full:"New Hampshire",place:"Nashua city"}},{type:null,properties:{city_and_state:"Nashville, TN",black_pop_pct_chg_1940_1970:-.048,black_pop_pct_chg_1910_1940:-.087,city:"Nashville",state:"TN",state_fips:"47",GISJOIN:null,state_full:null,place:null}},{type:"Point",coordinates:[-91.40317100014178,31.560444199772295],properties:{city_and_state:"Natchez, MS",black_pop_pct_chg_1940_1970:-.045,black_pop_pct_chg_1910_1940:-.018,city:"Natchez",state:"MS",state_fips:"28",GISJOIN:"G28050440",state_full:"Mississippi",place:"Natchez city"}},{type:"Point",coordinates:[-85.82413119996956,38.28562469970414],properties:{city_and_state:"New Albany, IN",black_pop_pct_chg_1940_1970:-.028,black_pop_pct_chg_1910_1940:0,city:"New Albany",state:"IN",state_fips:"18",GISJOIN:"G18052326",state_full:"Indiana",place:"New Albany city"}},{type:"Point",coordinates:[-70.93420499981326,41.63621520025218],properties:{city_and_state:"New Bedford, MA",black_pop_pct_chg_1940_1970:.009,black_pop_pct_chg_1910_1940:-.004,city:"New Bedford",state:"MA",state_fips:"25",GISJOIN:"G25045000",state_full:"Massachusetts",place:"New Bedford city"}},{type:"Point",coordinates:[-77.04411429973398,35.10849309991927],properties:{city_and_state:"New Bern, NC",black_pop_pct_chg_1940_1970:-.073,black_pop_pct_chg_1910_1940:-.109,city:"New Bern",state:"NC",state_fips:"37",GISJOIN:"G37046340",state_full:"North Carolina",place:"New Bern city"}},{type:"Point",coordinates:[-75.56631319955808,39.66205720001086],properties:{city_and_state:"New Castle, DE",black_pop_pct_chg_1940_1970:-.02,black_pop_pct_chg_1910_1940:-.032,city:"New Castle",state:"DE",state_fips:"10",GISJOIN:"G10050800",state_full:"Delaware",place:"New Castle city"}},{type:"Point",coordinates:[-72.92815780031138,41.30815269978038],properties:{city_and_state:"New Haven, CT",black_pop_pct_chg_1940_1970:.012,black_pop_pct_chg_1910_1940:.224,city:"New Haven",state:"CT",state_fips:"09",GISJOIN:"G09052000",state_full:"Connecticut",place:"New Haven city"}},{type:"Point",coordinates:[-72.09952090018804,41.35565390033247],properties:{city_and_state:"New London, CT",black_pop_pct_chg_1940_1970:.01,black_pop_pct_chg_1910_1940:.082,city:"New London",state:"CT",state_fips:"09",GISJOIN:"G09052280",state_full:"Connecticut",place:"New London city"}},{type:"Point",coordinates:[-90.07507200024284,29.954648199764463],properties:{city_and_state:"New Orleans, LA",black_pop_pct_chg_1940_1970:.038,black_pop_pct_chg_1910_1940:.149,city:"New Orleans",state:"LA",state_fips:"22",GISJOIN:"G22055000",state_full:"Louisiana",place:"New Orleans city"}},{type:"Point",coordinates:[-74.00597289990519,40.71426909956248],properties:{city_and_state:"New York, NY",black_pop_pct_chg_1940_1970:.042,black_pop_pct_chg_1910_1940:.15,city:"New York",state:"NY",state_fips:"36",GISJOIN:"G36051000",state_full:"New York",place:"New York city"}},{type:"Point",coordinates:[-75.74965719959923,39.68372259960044],properties:{city_and_state:"Newark, DE",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:-.084,city:"Newark",state:"DE",state_fips:"10",GISJOIN:"G10050670",state_full:"Delaware",place:"Newark city"}},{type:"Point",coordinates:[-74.17236669997881,40.735656999944766],properties:{city_and_state:"Newark, NJ",black_pop_pct_chg_1940_1970:.079,black_pop_pct_chg_1910_1940:.436,city:"Newark",state:"NJ",state_fips:"34",GISJOIN:"G34051000",state_full:"New Jersey",place:"Newark city"}},{type:"Point",coordinates:[-76.42800299955995,36.97875879954145],properties:{city_and_state:"Newport News, VA",black_pop_pct_chg_1940_1970:.053,black_pop_pct_chg_1910_1940:-.129,city:"Newport News",state:"VA",state_fips:"51",GISJOIN:"G51056000",state_full:"Virginia",place:"Newport News city"}},{type:"Point",coordinates:[-84.49577570024915,39.09144900004308],properties:{city_and_state:"Newport, KY",black_pop_pct_chg_1940_1970:.014,black_pop_pct_chg_1910_1940:-.003,city:"Newport",state:"KY",state_fips:"21",GISJOIN:"G21055884",state_full:"Kentucky",place:"Newport city"}},{type:"Point",coordinates:[-71.31282849979704,41.49010239990838],properties:{city_and_state:"Newport, RI",black_pop_pct_chg_1940_1970:-.004,black_pop_pct_chg_1910_1940:.018,city:"Newport",state:"RI",state_fips:"44",GISJOIN:"G44049960",state_full:"Rhode Island",place:"Newport city"}},{type:"Point",coordinates:[-79.05671110054698,43.09449990013969],properties:{city_and_state:"Niagara Falls, NY",black_pop_pct_chg_1940_1970:.004,black_pop_pct_chg_1910_1940:.081,city:"Niagara Falls",state:"NY",state_fips:"36",GISJOIN:"G36051055",state_full:"New York",place:"Niagara Falls city"}},{type:"Point",coordinates:[-76.28521829965004,36.84681460011176],properties:{city_and_state:"Norfolk, VA",black_pop_pct_chg_1940_1970:-.053,black_pop_pct_chg_1910_1940:-.035,city:"Norfolk",state:"VA",state_fips:"51",GISJOIN:"G51057000",state_full:"Virginia",place:"Norfolk city"}},{type:"Point",coordinates:[-92.26709409995642,34.76953600019999],properties:{city_and_state:"North Little Rock, AR",black_pop_pct_chg_1940_1970:-.081,black_pop_pct_chg_1910_1940:-.136,city:"North Little Rock",state:"AR",state_fips:"05",GISJOIN:"G05050450",state_full:"Arkansas",place:"North Little Rock city"}},{type:"Point",coordinates:[-122.27080260018242,37.80437220029567],properties:{city_and_state:"Oakland, CA",black_pop_pct_chg_1940_1970:.008,black_pop_pct_chg_1910_1940:.317,city:"Oakland",state:"CA",state_fips:"06",GISJOIN:"G06053000",state_full:"California",place:"Oakland city"}},{type:"Point",coordinates:[-111.97383040051609,41.22299999996728],properties:{city_and_state:"Ogden, UT",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.019,city:"Ogden",state:"UT",state_fips:"49",GISJOIN:"G49055980",state_full:"Utah",place:"Ogden city"}},{type:"Point",coordinates:[-97.51642759947879,35.4675602000056],properties:{city_and_state:"Oklahoma City, OK",black_pop_pct_chg_1940_1970:-.007,black_pop_pct_chg_1910_1940:.042,city:"Oklahoma City",state:"OK",state_fips:"40",GISJOIN:"G40055000",state_full:"Oklahoma",place:"Oklahoma City city"}},{type:"Point",coordinates:[-95.93779200002379,41.25860960023016],properties:{city_and_state:"Omaha, NE",black_pop_pct_chg_1940_1970:.018,black_pop_pct_chg_1910_1940:.045,city:"Omaha",state:"NE",state_fips:"31",GISJOIN:"G31037000",state_full:"Nebraska",place:"Omaha city"}},{type:"Point",coordinates:[-81.37923650017997,28.53833549968837],properties:{city_and_state:"Orlando, FL",black_pop_pct_chg_1940_1970:-.079,black_pop_pct_chg_1910_1940:.01,city:"Orlando",state:"FL",state_fips:"12",GISJOIN:"G12053000",state_full:"Florida",place:"Orlando city"}},{type:"Point",coordinates:[-74.17181100049439,40.91676540030537],properties:{city_and_state:"Paterson, NJ",black_pop_pct_chg_1940_1970:.018,black_pop_pct_chg_1910_1940:.238,city:"Paterson",state:"NJ",state_fips:"34",GISJOIN:"G34057000",state_full:"New Jersey",place:"Paterson city"}},{type:"Point",coordinates:[-71.38255580014302,41.878710999682575],properties:{city_and_state:"Pawtucket, RI",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:.001,city:"Pawtucket",state:"RI",state_fips:"44",GISJOIN:"G44054640",state_full:"Rhode Island",place:"Pawtucket city"}},{type:"Point",coordinates:[-87.21691490034209,30.42130899984587],properties:{city_and_state:"Pensacola, FL",black_pop_pct_chg_1940_1970:-.115,black_pop_pct_chg_1910_1940:.002,city:"Pensacola",state:"FL",state_fips:"12",GISJOIN:"G12055925",state_full:"Florida",place:"Pensacola city"}},{type:"Point",coordinates:[-89.58898640000353,40.693648800152765],properties:{city_and_state:"Peoria, IL",black_pop_pct_chg_1940_1970:.003,black_pop_pct_chg_1910_1940:.088,city:"Peoria",state:"IL",state_fips:"17",GISJOIN:"G17059000",state_full:"Illinois",place:"Peoria city"}},{type:"Point",coordinates:[-77.40192670044219,37.22792790039998],properties:{city_and_state:"Petersburg, VA",black_pop_pct_chg_1940_1970:-.016,black_pop_pct_chg_1910_1940:.111,city:"Petersburg",state:"VA",state_fips:"51",GISJOIN:"G51061832",state_full:"Virginia",place:"Petersburg city"}},{type:"Point",coordinates:[-75.16378899961612,39.95233500001659],properties:{city_and_state:"Philadelphia, PA",black_pop_pct_chg_1940_1970:.075,black_pop_pct_chg_1910_1940:.206,city:"Philadelphia",state:"PA",state_fips:"42",GISJOIN:"G42060000",state_full:"Pennsylvania",place:"Philadelphia city"}},{type:"Point",coordinates:[-112.07403729979889,33.44837710029488],properties:{city_and_state:"Phoenix, AZ",black_pop_pct_chg_1940_1970:.036,black_pop_pct_chg_1910_1940:-.017,city:"Phoenix",state:"AZ",state_fips:"04",GISJOIN:"G04055000",state_full:"Arizona",place:"Phoenix city"}},{type:"Point",coordinates:[-92.00319550050365,34.22843120041944],properties:{city_and_state:"Pine Bluff, AR",black_pop_pct_chg_1940_1970:-.077,black_pop_pct_chg_1910_1940:.08,city:"Pine Bluff",state:"AR",state_fips:"05",GISJOIN:"G05055310",state_full:"Arkansas",place:"Pine Bluff city"}},{type:"Point",coordinates:[-79.99588639951065,40.44062479957565],properties:{city_and_state:"Pittsburgh, PA",black_pop_pct_chg_1940_1970:.045,black_pop_pct_chg_1910_1940:.109,city:"Pittsburgh",state:"PA",state_fips:"42",GISJOIN:"G42061000",state_full:"Pennsylvania",place:"Pittsburgh city"}},{type:"Point",coordinates:[-112.445534400342,42.87130319979778],properties:{city_and_state:"Pocatello, ID",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:0,city:"Pocatello",state:"ID",state_fips:"16",GISJOIN:"G16064090",state_full:"Idaho",place:"Pocatello city"}},{type:"Point",coordinates:[-70.25532590013513,43.661470999623376],properties:{city_and_state:"Portland, ME",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.002,city:"Portland",state:"ME",state_fips:"23",GISJOIN:"G23060545",state_full:"Maine",place:"Portland city"}},{type:"Point",coordinates:[-122.67620710075518,45.52345150027337],properties:{city_and_state:"Portland, OR",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.05,city:"Portland",state:"OR",state_fips:"41",GISJOIN:"G41059000",state_full:"Oregon",place:"Portland city"}},{type:"Point",coordinates:[-70.76255319932112,43.07175520021901],properties:{city_and_state:"Portsmouth, NH",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:.036,city:"Portsmouth",state:"NH",state_fips:"33",GISJOIN:"G33062900",state_full:"New Hampshire",place:"Portsmouth city"}},{type:"Point",coordinates:[-76.29827419993278,36.8354257996283],properties:{city_and_state:"Portsmouth, VA",black_pop_pct_chg_1940_1970:.031,black_pop_pct_chg_1910_1940:.018,city:"Portsmouth",state:"VA",state_fips:"51",GISJOIN:"G51064000",state_full:"Virginia",place:"Portsmouth city"}},{type:"Point",coordinates:[-71.41283429997613,41.82398909985966],properties:{city_and_state:"Providence, RI",black_pop_pct_chg_1940_1970:.002,black_pop_pct_chg_1910_1940:.063,city:"Providence",state:"RI",state_fips:"44",GISJOIN:"G44059000",state_full:"Rhode Island",place:"Providence city"}},{type:"Point",coordinates:[-111.65853369994427,40.23384379996386],properties:{city_and_state:"Provo, UT",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:0,city:"Provo",state:"UT",state_fips:"49",GISJOIN:"G49062470",state_full:"Utah",place:"Provo city"}},{type:"Point",coordinates:[-104.60914100013684,38.25444719962828],properties:{city_and_state:"Pueblo, CO",black_pop_pct_chg_1940_1970:-.007,black_pop_pct_chg_1910_1940:-.005,city:"Pueblo",state:"CO",state_fips:"08",GISJOIN:"G08062000",state_full:"Colorado",place:"Pueblo city"}},{type:"Point",coordinates:[-91.40987269949876,39.93560159973975],properties:{city_and_state:"Quincy, IL",black_pop_pct_chg_1940_1970:-.015,black_pop_pct_chg_1910_1940:.004,city:"Quincy",state:"IL",state_fips:"17",GISJOIN:"G17062367",state_full:"Illinois",place:"Quincy city"}},{type:"Point",coordinates:[-87.78285229939225,42.72613090034506],properties:{city_and_state:"Racine, WI",black_pop_pct_chg_1940_1970:.003,black_pop_pct_chg_1910_1940:.099,city:"Racine",state:"WI",state_fips:"55",GISJOIN:"G55066000",state_full:"Wisconsin",place:"Racine city"}},{type:"Point",coordinates:[-78.63861449954756,35.77209600022866],properties:{city_and_state:"Raleigh, NC",black_pop_pct_chg_1940_1970:-.046,black_pop_pct_chg_1910_1940:-.11,city:"Raleigh",state:"NC",state_fips:"37",GISJOIN:"G37055000",state_full:"North Carolina",place:"Raleigh city"}},{type:"Point",coordinates:[-103.23101489986601,44.08054339973973],properties:{city_and_state:"Rapid City, SD",black_pop_pct_chg_1940_1970:-.006,black_pop_pct_chg_1910_1940:.003,city:"Rapid City",state:"SD",state_fips:"46",GISJOIN:"G46052980",state_full:"South Dakota",place:"Rapid City city"}},{type:"Point",coordinates:[-75.92687470013684,40.33564829969682],properties:{city_and_state:"Reading, PA",black_pop_pct_chg_1940_1970:.009,black_pop_pct_chg_1910_1940:.048,city:"Reading",state:"PA",state_fips:"42",GISJOIN:"G42063624",state_full:"Pennsylvania",place:"Reading city"}},{type:"Point",coordinates:[-119.8138026995805,39.529632899767435],properties:{city_and_state:"Reno, NV",black_pop_pct_chg_1940_1970:.002,black_pop_pct_chg_1910_1940:.012,city:"Reno",state:"NV",state_fips:"32",GISJOIN:"G32060600",state_full:"Nevada",place:"Reno city"}},{type:"Point",coordinates:[-77.46026169992527,37.55375750011416],properties:{city_and_state:"Richmond, VA",black_pop_pct_chg_1940_1970:-.049,black_pop_pct_chg_1910_1940:.102,city:"Richmond",state:"VA",state_fips:"51",GISJOIN:"G51067000",state_full:"Virginia",place:"Richmond city"}},{type:"Point",coordinates:[-117.39615639999786,33.95334869978204],properties:{city_and_state:"Riverside, CA",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.026,city:"Riverside",state:"CA",state_fips:"06",GISJOIN:"G06062000",state_full:"California",place:"Riverside city"}},{type:"Point",coordinates:[-79.94142670001561,37.270970400109505],properties:{city_and_state:"Roanoke, VA",black_pop_pct_chg_1940_1970:-.042,black_pop_pct_chg_1910_1940:.008,city:"Roanoke",state:"VA",state_fips:"51",GISJOIN:"G51068000",state_full:"Virginia",place:"Roanoke city"}},{type:"Point",coordinates:[-77.61555679963833,43.15478450036887],properties:{city_and_state:"Rochester, NY",black_pop_pct_chg_1940_1970:.006,black_pop_pct_chg_1910_1940:.158,city:"Rochester",state:"NY",state_fips:"36",GISJOIN:"G36063000",state_full:"New York",place:"Rochester city"}},{type:"Point",coordinates:[-89.09399520039483,42.271131099992424],properties:{city_and_state:"Rockford, IL",black_pop_pct_chg_1940_1970:.01,black_pop_pct_chg_1910_1940:.069,city:"Rockford",state:"IL",state_fips:"17",GISJOIN:"G17065000",state_full:"Illinois",place:"Rockford city"}},{type:"Point",coordinates:[-104.52302419948302,33.39426549979343],properties:{city_and_state:"Roswell, NM",black_pop_pct_chg_1940_1970:.008,black_pop_pct_chg_1910_1940:.005,city:"Roswell",state:"NM",state_fips:"35",GISJOIN:"G35064930",state_full:"New Mexico",place:"Roswell city"}},{type:"Point",coordinates:[-72.97260650028848,43.61062369986252],properties:{city_and_state:"Rutland, VT",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:0,city:"Rutland",state:"VT",state_fips:"50",GISJOIN:"G50061225",state_full:"Vermont",place:"Rutland city"}},{type:"Point",coordinates:[-121.49439960063033,38.58157190011201],properties:{city_and_state:"Sacramento, CA",black_pop_pct_chg_1940_1970:.003,black_pop_pct_chg_1910_1940:.093,city:"Sacramento",state:"CA",state_fips:"06",GISJOIN:"G06064000",state_full:"California",place:"Sacramento city"}},{type:"Point",coordinates:[-70.89671549981428,42.51953999971779],properties:{city_and_state:"Salem, MA",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:.002,city:"Salem",state:"MA",state_fips:"25",GISJOIN:"G25059105",state_full:"Massachusetts",place:"Salem city"}},{type:"Point",coordinates:[-123.03509629992031,44.94289749980932],properties:{city_and_state:"Salem, OR",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.003,city:"Salem",state:"OR",state_fips:"41",GISJOIN:"G41064900",state_full:"Oregon",place:"Salem city"}},{type:"Point",coordinates:[-111.89104739943666,40.760779399988635],properties:{city_and_state:"Salt Lake City, UT",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:.008,city:"Salt Lake City",state:"UT",state_fips:"49",GISJOIN:"G49067000",state_full:"Utah",place:"Salt Lake City city"}},{type:"Point",coordinates:[-98.49362820026316,29.424121900054846],properties:{city_and_state:"San Antonio, TX",black_pop_pct_chg_1940_1970:-.035,black_pop_pct_chg_1910_1940:.001,city:"San Antonio",state:"TX",state_fips:"48",GISJOIN:"G48065000",state_full:"Texas",place:"San Antonio city"}},{type:"Point",coordinates:[-117.15725510012142,32.715329199896836],properties:{city_and_state:"San Diego, CA",black_pop_pct_chg_1940_1970:.005,black_pop_pct_chg_1910_1940:.056,city:"San Diego",state:"CA",state_fips:"06",GISJOIN:"G06066000",state_full:"California",place:"San Diego city"}},{type:"Point",coordinates:[-122.41941550003507,37.774929499597334],properties:{city_and_state:"San Francisco, CA",black_pop_pct_chg_1940_1970:.004,black_pop_pct_chg_1910_1940:.127,city:"San Francisco",state:"CA",state_fips:"06",GISJOIN:"G06067000",state_full:"California",place:"San Francisco city"}},{type:"Point",coordinates:[-121.89495550035758,37.33938570009281],properties:{city_and_state:"San Jose, CA",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.02,city:"San Jose",state:"CA",state_fips:"06",GISJOIN:"G06068000",state_full:"California",place:"San Jose city"}},{type:"Point",coordinates:[-117.86783379988843,33.74557310017004],properties:{city_and_state:"Santa Ana, CA",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.038,city:"Santa Ana",state:"CA",state_fips:"06",GISJOIN:"G06069000",state_full:"California",place:"Santa Ana city"}},{type:"Point",coordinates:[-105.93779900009413,35.686975199803],properties:{city_and_state:"Santa Fe, NM",black_pop_pct_chg_1940_1970:-.005,black_pop_pct_chg_1910_1940:-.005,city:"Santa Fe",state:"NM",state_fips:"35",GISJOIN:"G35070500",state_full:"New Mexico",place:"Santa Fe city"}},{type:"Point",coordinates:[-81.09983420043838,32.08354070020572],properties:{city_and_state:"Savannah, GA",black_pop_pct_chg_1940_1970:-.061,black_pop_pct_chg_1910_1940:-.002,city:"Savannah",state:"GA",state_fips:"13",GISJOIN:"G13069000",state_full:"Georgia",place:"Savannah city"}},{type:"Point",coordinates:[-75.66241219968101,41.408968999904275],properties:{city_and_state:"Scranton, PA",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.003,city:"Scranton",state:"PA",state_fips:"42",GISJOIN:"G42069000",state_full:"Pennsylvania",place:"Scranton city"}},{type:"Point",coordinates:[-122.33207079945824,47.606209499678464],properties:{city_and_state:"Seattle, WA",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.061,city:"Seattle",state:"WA",state_fips:"53",GISJOIN:"G53063000",state_full:"Washington",place:"Seattle city"}},{type:"Point",coordinates:[-93.75017890021148,32.525151599922914],properties:{city_and_state:"Shreveport, LA",black_pop_pct_chg_1940_1970:-.13,black_pop_pct_chg_1910_1940:-.025,city:"Shreveport",state:"LA",state_fips:"22",GISJOIN:"G22070000",state_full:"Louisiana",place:"Shreveport city"}},{type:"Point",coordinates:[-96.40030689954665,42.49999419976105],properties:{city_and_state:"Sioux City, IA",black_pop_pct_chg_1940_1970:.004,black_pop_pct_chg_1910_1940:.001,city:"Sioux City",state:"IA",state_fips:"19",GISJOIN:"G19073335",state_full:"Iowa",place:"Sioux City city"}},{type:"Point",coordinates:[-96.70032700049654,43.54997489975253],properties:{city_and_state:"Sioux Falls, SD",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:-.001,city:"Sioux Falls",state:"SD",state_fips:"46",GISJOIN:"G46059020",state_full:"South Dakota",place:"Sioux Falls city"}},{type:"Point",coordinates:[-71.09949680040687,42.38759679992794],properties:{city_and_state:"Somerville, MA",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.005,city:"Somerville",state:"MA",state_fips:"25",GISJOIN:"G25062535",state_full:"Massachusetts",place:"Somerville city"}},{type:"Point",coordinates:[-86.250006600142,41.683381299936656],properties:{city_and_state:"South Bend, IN",black_pop_pct_chg_1940_1970:.024,black_pop_pct_chg_1910_1940:.106,city:"South Bend",state:"IN",state_fips:"18",GISJOIN:"G18071000",state_full:"Indiana",place:"South Bend city"}},{type:"Point",coordinates:[-119.7526885996547,39.53491120006836],properties:{city_and_state:"Sparks, NV",black_pop_pct_chg_1940_1970:.002,black_pop_pct_chg_1910_1940:.002,city:"Sparks",state:"NV",state_fips:"32",GISJOIN:"G32068400",state_full:"Nevada",place:"Sparks city"}},{type:"Point",coordinates:[-117.42604660013411,47.658780300313865],properties:{city_and_state:"Spokane, WA",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.007,city:"Spokane",state:"WA",state_fips:"53",GISJOIN:"G53067000",state_full:"Washington",place:"Spokane city"}},{type:"Point",coordinates:[-89.64371070040737,39.801717100382625],properties:{city_and_state:"Springfield, IL",black_pop_pct_chg_1940_1970:-.013,black_pop_pct_chg_1910_1940:.037,city:"Springfield",state:"IL",state_fips:"17",GISJOIN:"G17072000",state_full:"Illinois",place:"Springfield city"}},{type:"Point",coordinates:[-72.58981099997135,42.101483100416445],properties:{city_and_state:"Springfield, MA",black_pop_pct_chg_1940_1970:.004,black_pop_pct_chg_1910_1940:.105,city:"Springfield",state:"MA",state_fips:"25",GISJOIN:"G25067000",state_full:"Massachusetts",place:"Springfield city"}},{type:"Point",coordinates:[-93.29824359960674,37.215325999734084],properties:{city_and_state:"Springfield, MO",black_pop_pct_chg_1940_1970:-.027,black_pop_pct_chg_1910_1940:-.01,city:"Springfield",state:"MO",state_fips:"29",GISJOIN:"G29070000",state_full:"Missouri",place:"Springfield city"}},{type:"Point",coordinates:[-94.8466322001594,39.76860549972905],properties:{city_and_state:"St. Joseph, MO",black_pop_pct_chg_1940_1970:-.015,black_pop_pct_chg_1910_1940:-.006,city:"St. Joseph",state:"MO",state_fips:"29",GISJOIN:"G29064550",state_full:"Missouri",place:"St. Joseph city"}},{type:"Point",coordinates:[-90.19788889949763,38.627273299702345],properties:{city_and_state:"St. Louis, MO",black_pop_pct_chg_1940_1970:.069,black_pop_pct_chg_1910_1940:.275,city:"St. Louis",state:"MO",state_fips:"29",GISJOIN:"G29065000",state_full:"Missouri",place:"St. Louis city"}},{type:"Point",coordinates:[-93.09327420029724,44.94441009979305],properties:{city_and_state:"St. Paul, MN",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.021,city:"St. Paul",state:"MN",state_fips:"27",GISJOIN:"G27058000",state_full:"Minnesota",place:"St. Paul city"}},{type:"Point",coordinates:[-82.67926609999537,27.770860600033757],properties:{city_and_state:"St. Petersburg, FL",black_pop_pct_chg_1940_1970:-.07,black_pop_pct_chg_1910_1940:-.049,city:"St. Petersburg",state:"FL",state_fips:"12",GISJOIN:"G12063000",state_full:"Florida",place:"St. Petersburg city"}},{type:"Point",coordinates:[-73.53873409947629,41.0534302000197],properties:{city_and_state:"Stamford, CT",black_pop_pct_chg_1940_1970:.027,black_pop_pct_chg_1910_1940:.084,city:"Stamford",state:"CT",state_fips:"09",GISJOIN:"G09073000",state_full:"Connecticut",place:"Stamford city"}},{type:"Point",coordinates:[-121.2907796000872,37.957701599726136],properties:{city_and_state:"Stockton, CA",black_pop_pct_chg_1940_1970:.008,black_pop_pct_chg_1910_1940:.094,city:"Stockton",state:"CA",state_fips:"06",GISJOIN:"G06075000",state_full:"California",place:"Stockton city"}},{type:"Point",coordinates:[-76.14742440001359,43.04812209977538],properties:{city_and_state:"Syracuse, NY",black_pop_pct_chg_1940_1970:.002,black_pop_pct_chg_1910_1940:.098,city:"Syracuse",state:"NY",state_fips:"36",GISJOIN:"G36073000",state_full:"New York",place:"Syracuse city"}},{type:"Point",coordinates:[-122.44429060032205,47.25287689991967],properties:{city_and_state:"Tacoma, WA",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:.062,city:"Tacoma",state:"WA",state_fips:"53",GISJOIN:"G53070000",state_full:"Washington",place:"Tacoma city"}},{type:"Point",coordinates:[-84.2807329001602,30.43825590010699],properties:{city_and_state:"Tallahassee, FL",black_pop_pct_chg_1940_1970:-.246,black_pop_pct_chg_1910_1940:-.146,city:"Tallahassee",state:"FL",state_fips:"12",GISJOIN:"G12070600",state_full:"Florida",place:"Tallahassee city"}},{type:"Point",coordinates:[-82.45842790019395,27.94752160042977],properties:{city_and_state:"Tampa, FL",black_pop_pct_chg_1940_1970:-.022,black_pop_pct_chg_1910_1940:-.018,city:"Tampa",state:"FL",state_fips:"12",GISJOIN:"G12071000",state_full:"Florida",place:"Tampa city"}},{type:"Point",coordinates:[-111.9093095004455,33.41476799959376],properties:{city_and_state:"Tempe, AZ",black_pop_pct_chg_1940_1970:null,black_pop_pct_chg_1910_1940:.007,city:"Tempe",state:"AZ",state_fips:"04",GISJOIN:"G04073000",state_full:"Arizona",place:"Tempe city"}},{type:"Point",coordinates:[-83.55521200058928,41.66393829999446],properties:{city_and_state:"Toledo, OH",black_pop_pct_chg_1940_1970:.041,black_pop_pct_chg_1910_1940:.086,city:"Toledo",state:"OH",state_fips:"39",GISJOIN:"G39077000",state_full:"Ohio",place:"Toledo city"}},{type:"Point",coordinates:[-95.67803710004111,39.04833360001171],properties:{city_and_state:"Topeka, KS",black_pop_pct_chg_1940_1970:-.02,black_pop_pct_chg_1910_1940:0,city:"Topeka",state:"KS",state_fips:"20",GISJOIN:"G20071000",state_full:"Kansas",place:"Topeka city"}},{type:"Point",coordinates:[-74.74293849960969,40.21705340026122],properties:{city_and_state:"Trenton, NJ",black_pop_pct_chg_1940_1970:.048,black_pop_pct_chg_1910_1940:.304,city:"Trenton",state:"NJ",state_fips:"34",GISJOIN:"G34074000",state_full:"New Jersey",place:"Trenton city"}},{type:"Point",coordinates:[-110.92647899963703,32.22174289981097],properties:{city_and_state:"Tucson, AZ",black_pop_pct_chg_1940_1970:.029,black_pop_pct_chg_1910_1940:-.011,city:"Tucson",state:"AZ",state_fips:"04",GISJOIN:"G04077000",state_full:"Arizona",place:"Tucson city"}},{type:"Point",coordinates:[-95.99277500021387,36.15398159967538],properties:{city_and_state:"Tulsa, OK",black_pop_pct_chg_1940_1970:-.001,black_pop_pct_chg_1910_1940:0,city:"Tulsa",state:"OK",state_fips:"40",GISJOIN:"G40075000",state_full:"Oklahoma",place:"Tulsa city"}},{type:"Point",coordinates:[-75.23266409996062,43.100903099780844],properties:{city_and_state:"Utica, NY",black_pop_pct_chg_1940_1970:0,black_pop_pct_chg_1910_1940:.051,city:"Utica",state:"NY",state_fips:"36",GISJOIN:"G36076540",state_full:"New York",place:"Utica city"}},{type:"Point",coordinates:[-90.87788210030479,32.3526457003536],properties:{city_and_state:"Vicksburg, MS",black_pop_pct_chg_1940_1970:-.067,black_pop_pct_chg_1910_1940:-.018,city:"Vicksburg",state:"MS",state_fips:"28",GISJOIN:"G28076720",state_full:"Mississippi",place:"Vicksburg city"}},{type:"Point",coordinates:[-97.14666950004288,31.549332999720015],properties:{city_and_state:"Waco, TX",black_pop_pct_chg_1940_1970:-.033,black_pop_pct_chg_1910_1940:.002,city:"Waco",state:"TX",state_fips:"48",GISJOIN:"G48076000",state_full:"Texas",place:"Waco city"}},{type:"Point",coordinates:[-71.4161670994043,41.70010100026204],properties:{city_and_state:"Warwick, RI",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:-.004,city:"Warwick",state:"RI",state_fips:"44",GISJOIN:"G44074300",state_full:"Rhode Island",place:"Warwick city"}},{type:"Point",coordinates:[-77.03636580023291,38.89511180007364],properties:{city_and_state:"Washington, DC",black_pop_pct_chg_1940_1970:-.003,black_pop_pct_chg_1910_1940:.428,city:"Washington",state:"DC",state_fips:"11",GISJOIN:"G11050000",state_full:"District Of Columbia",place:"Washington city"}},{type:"Point",coordinates:[-73.05149660044067,41.55815250007961],properties:{city_and_state:"Waterbury, CT",black_pop_pct_chg_1940_1970:.01,black_pop_pct_chg_1910_1940:.081,city:"Waterbury",state:"CT",state_fips:"09",GISJOIN:"G09080000",state_full:"Connecticut",place:"Waterbury city"}},{type:"Point",coordinates:[-80.72091490042727,40.063961599990705],properties:{city_and_state:"Wheeling, WV",black_pop_pct_chg_1940_1970:.002,black_pop_pct_chg_1910_1940:.006,city:"Wheeling",state:"WV",state_fips:"54",GISJOIN:"G54086452",state_full:"West Virginia",place:"Wheeling city"}},{type:"Point",coordinates:[-98.49338729965716,33.91370849973947],properties:{city_and_state:"Wichita Falls, TX",black_pop_pct_chg_1940_1970:.019,black_pop_pct_chg_1910_1940:.005,city:"Wichita Falls",state:"TX",state_fips:"48",GISJOIN:"G48079000",state_full:"Texas",place:"Wichita Falls city"}},{type:"Point",coordinates:[-97.33754479980686,37.69223610021975],properties:{city_and_state:"Wichita, KS",black_pop_pct_chg_1940_1970:.003,black_pop_pct_chg_1910_1940:.048,city:"Wichita",state:"KS",state_fips:"20",GISJOIN:"G20079000",state_full:"Kansas",place:"Wichita city"}},{type:"Point",coordinates:[-75.54658889969443,39.74594669957648],properties:{city_and_state:"Wilmington, DE",black_pop_pct_chg_1940_1970:.023,black_pop_pct_chg_1910_1940:.31,city:"Wilmington",state:"DE",state_fips:"10",GISJOIN:"G10077580",state_full:"Delaware",place:"Wilmington city"}},{type:"Point",coordinates:[-77.94471019973014,34.22572560018339],properties:{city_and_state:"Wilmington, NC",black_pop_pct_chg_1940_1970:-.066,black_pop_pct_chg_1910_1940:-.061,city:"Wilmington",state:"NC",state_fips:"37",GISJOIN:"G37074440",state_full:"North Carolina",place:"Wilmington city"}},{type:"Point",coordinates:[-80.24421599974468,36.09985959987532],properties:{city_and_state:"Winston-Salem, NC",black_pop_pct_chg_1940_1970:.051,black_pop_pct_chg_1910_1940:-.109,city:"Winston-Salem",state:"NC",state_fips:"37",GISJOIN:"G37075000",state_full:"North Carolina",place:"Winston-Salem city"}},{type:"Point",coordinates:[-71.51478389935258,42.00287610026967],properties:{city_and_state:"Woonsocket, RI",black_pop_pct_chg_1940_1970:.001,black_pop_pct_chg_1910_1940:.012,city:"Woonsocket",state:"RI",state_fips:"44",GISJOIN:"G44080780",state_full:"Rhode Island",place:"Woonsocket city"}},{type:"Point",coordinates:[-71.80229340044711,42.26259320019197],properties:{city_and_state:"Worcester, MA",black_pop_pct_chg_1940_1970:-.002,black_pop_pct_chg_1910_1940:.012,city:"Worcester",state:"MA",state_fips:"25",GISJOIN:"G25082000",state_full:"Massachusetts",place:"Worcester city"}},{type:"Point",coordinates:[-73.89874690005506,40.931209899631234],properties:{city_and_state:"Yonkers, NY",black_pop_pct_chg_1940_1970:.009,black_pop_pct_chg_1910_1940:.035,city:"Yonkers",state:"NY",state_fips:"36",GISJOIN:"G36084000",state_full:"New York",place:"Yonkers city"}},{type:"Point",coordinates:[-80.64951939987759,41.09978030042738],properties:{city_and_state:"Youngstown, OH",black_pop_pct_chg_1940_1970:.063,black_pop_pct_chg_1910_1940:.165,city:"Youngstown",state:"OH",state_fips:"39",GISJOIN:"G39088000",state_full:"Ohio",place:"Youngstown city"}}]}};var E8={type:bm,arcs:wm,objects:Tm};function A8(g,x,E){const I=g.slice();return I[12]=x[E],I}function k8(g,x,E){const I=g.slice();return I[15]=x[E],I}function M8(g){let x,E,I,k,L;return{c(){x=zr("path"),this.h()},l(F){x=Pr(F,"path",{d:!0,class:!0,fill:!0,width:!0,height:!0,"stroke-width":!0}),Jt(x).forEach(ht),this.h()},h(){Me(x,"d",E=g[7](g[15])),Me(x,"class","stroke-slate-100"),Me(x,"fill","lightgray"),Me(x,"width",I=1),Me(x,"height",k=1),Me(x,"stroke-width",L=2)},m(F,o){ir(F,x,o)},p(F,o){o&2&&E!==(E=F[7](F[15]))&&Me(x,"d",E)},d(F){F&&ht(x)}}}function C8(g){let x,E,I,k,L;return{c(){x=zr("path"),this.h()},l(F){x=Pr(F,"path",{transform:!0,d:!0,stroke:!0,fill:!0}),Jt(x).forEach(ht),this.h()},h(){Me(x,"transform",E=g[8](g[12],"black_pop_pct_chg_1910_1940")),Me(x,"d",I=g[5](g[12],"black_pop_pct_chg_1910_1940")),Me(x,"stroke",k=g[6](g[12],"black_pop_pct_chg_1910_1940")<0?"hotpink":"green"),Me(x,"fill",L=g[6](g[12],"black_pop_pct_chg_1910_1940")<0?"hotpink":"green")},m(F,o){ir(F,x,o)},p(F,o){o&4&&E!==(E=F[8](F[12],"black_pop_pct_chg_1910_1940"))&&Me(x,"transform",E),o&36&&I!==(I=F[5](F[12],"black_pop_pct_chg_1910_1940"))&&Me(x,"d",I),o&4&&k!==(k=F[6](F[12],"black_pop_pct_chg_1910_1940")<0?"hotpink":"green")&&Me(x,"stroke",k),o&4&&L!==(L=F[6](F[12],"black_pop_pct_chg_1910_1940")<0?"hotpink":"green")&&Me(x,"fill",L)},d(F){F&&ht(x)}}}function Im(g){let x,E,I,k,L,F,o,Z,ae,te,N,K,fe,Te,Ce,ke,Qe=g[1],Ve=[];for(let xe=0;xe<Qe.length;xe+=1)Ve[xe]=M8(k8(g,Qe,xe));let Oe=g[2],$e=[];for(let xe=0;xe<Oe.length;xe+=1)$e[xe]=C8(A8(g,Oe,xe));return{c(){x=Nt("div"),E=zr("svg"),I=zr("defs"),k=zr("filter"),L=zr("feGaussianBlur"),F=zr("filter"),o=zr("feMorphology"),Z=zr("feColorMatrix"),ae=zr("feMerge"),te=zr("feMergeNode"),N=zr("feMergeNode"),K=zr("g"),fe=zr("g");for(let xe=0;xe<Ve.length;xe+=1)Ve[xe].c();Te=zr("path"),ke=zr("g");for(let xe=0;xe<$e.length;xe+=1)$e[xe].c();this.h()},l(xe){x=Gt(xe,"DIV",{id:!0,class:!0});var dt=Jt(x);E=Pr(dt,"svg",{class:!0,width:!0,height:!0,viewBox:!0});var We=Jt(E);I=Pr(We,"defs",{});var gt=Jt(I);k=Pr(gt,"filter",{id:!0,x:!0,y:!0,width:!0,height:!0});var wt=Jt(k);L=Pr(wt,"feGaussianBlur",{in:!0,result:!0,stdDeviation:!0}),Jt(L).forEach(ht),wt.forEach(ht),F=Pr(gt,"filter",{id:!0,"color-interpolation-filters":!0});var He=Jt(F);o=Pr(He,"feMorphology",{in:!0,result:!0,operator:!0,radius:!0}),Jt(o).forEach(ht),Z=Pr(He,"feColorMatrix",{in:!0,result:!0,type:!0,values:!0}),Jt(Z).forEach(ht),ae=Pr(He,"feMerge",{});var Je=Jt(ae);te=Pr(Je,"feMergeNode",{in:!0}),Jt(te).forEach(ht),N=Pr(Je,"feMergeNode",{in:!0}),Jt(N).forEach(ht),Je.forEach(ht),He.forEach(ht),gt.forEach(ht),K=Pr(We,"g",{id:!0});var Ye=Jt(K);fe=Pr(Ye,"g",{});var qe=Jt(fe);for(let ze=0;ze<Ve.length;ze+=1)Ve[ze].l(qe);qe.forEach(ht),Te=Pr(Ye,"path",{d:!0,fill:!0}),Jt(Te).forEach(ht),Ye.forEach(ht),ke=Pr(We,"g",{id:!0,"stroke-opacity":!0,"fill-opacity":!0});var Xe=Jt(ke);for(let ze=0;ze<$e.length;ze+=1)$e[ze].l(Xe);Xe.forEach(ht),We.forEach(ht),dt.forEach(ht),this.h()},h(){Me(L,"in","SourceAlpha"),Me(L,"result","blurOut"),Me(L,"stdDeviation","3"),Me(k,"id","map-shadow"),Me(k,"x","0"),Me(k,"y","0"),Me(k,"width","100%"),Me(k,"height","100%"),Me(o,"in","SourceAlpha"),Me(o,"result","MORPH"),Me(o,"operator","dilate"),Me(o,"radius","2"),Me(Z,"in","MORPH"),Me(Z,"result","WHITENED"),Me(Z,"type","matrix"),Me(Z,"values","-1 0 0 0 1, 0 -1 0 0 1, 0 0 -1 0 1, 0 0 0 1 0"),Me(te,"in","WHITENED"),Me(N,"in","SourceGraphic"),Me(F,"id","whiteOutlineEffect"),Me(F,"color-interpolation-filters","sRGB"),Me(Te,"d",Ce=g[7](g[3])),Me(Te,"fill","transparent"),Me(K,"id","geography"),Me(ke,"id","cities"),Me(ke,"stroke-opacity","0.5"),Me(ke,"fill-opacity","0.3"),Me(E,"class","w-full h-auto"),Me(E,"width","960"),Me(E,"height","500"),Me(E,"viewBox","0 0 960 500"),Me(x,"id",g[0]),Me(x,"class","w-full mx-auto flex justify-center my-12")},m(xe,dt){ir(xe,x,dt),At(x,E),At(E,I),At(I,k),At(k,L),At(I,F),At(F,o),At(F,Z),At(F,ae),At(ae,te),At(ae,N),At(E,K),At(K,fe);for(let We=0;We<Ve.length;We+=1)Ve[We].m(fe,null);At(K,Te),At(E,ke);for(let We=0;We<$e.length;We+=1)$e[We].m(ke,null);g[9](E)},p(xe,[dt]){if(dt&130){Qe=xe[1];let We;for(We=0;We<Qe.length;We+=1){const gt=k8(xe,Qe,We);Ve[We]?Ve[We].p(gt,dt):(Ve[We]=M8(gt),Ve[We].c(),Ve[We].m(fe,null))}for(;We<Ve.length;We+=1)Ve[We].d(1);Ve.length=Qe.length}if(dt&8&&Ce!==(Ce=xe[7](xe[3]))&&Me(Te,"d",Ce),dt&356){Oe=xe[2];let We;for(We=0;We<Oe.length;We+=1){const gt=A8(xe,Oe,We);$e[We]?$e[We].p(gt,dt):($e[We]=C8(gt),$e[We].c(),$e[We].m(ke,null))}for(;We<$e.length;We+=1)$e[We].d(1);$e.length=Oe.length}dt&1&&Me(x,"id",xe[0])},i:Dr,o:Dr,d(xe){xe&&ht(x),v1(Ve,xe),v1($e,xe),g[9](null)}}}function Sm(g,x,E){let I=[],k=[],L,F,o=(Te,Ce)=>Te.properties[Ce],Z=Te=>"";const ae=rm();let te=V5().projection(ae),N=(Te,Ce)=>{const ke=`translate(${ae(Te.geometry.coordinates)})`;return o(Te,Ce)>=0?ke:`${ke} rotate(180)`};nu(async()=>{const Ce=await(await fetch("https://gist.githubusercontent.com/rveciana/a2a1c21ca1c71cd3ec116cc911e5fce9/raw/79564dfa2c56745ebd62f5655a6cc19d2cffa1ea/us.json")).json();E(3,L=P0(Ce,Ce.objects.land)),E(2,k=P0(E8,E8.objects.points).features.filter(ke=>ke.geometry)),E(1,I=P0(Ce,Ce.objects.states).features.map(ke=>{var Ve;const Qe=(Ve=mp.exports.STATES.find(Oe=>Oe.fips===`${ke.id<10?`0${ke.id}`:ke.id}`))!=null?Ve:{};return{...ke,properties:{...Qe}}}).filter(ke=>{var Qe;return((Qe=ke.properties)==null?void 0:Qe.name)!==void 0})),E(5,Z=(ke,Qe)=>{const xe=P_(Array(["black_pop_pct_chg_1910_1940","black_pop_pct_chg_1940_1970"].map(gt=>k.map(wt=>wt.properties[gt]))).flat(2)),We=_p().exponent(2).domain(xe).range([0,80])(ke.properties[Qe]);return`M${-7/2},0L0,${-We}L${7/2},0`})});let{id:K}=x;function fe(Te){Vl[Te?"unshift":"push"](()=>{F=Te,E(4,F)})}return g.$$set=Te=>{"id"in Te&&E(0,K=Te.id)},[K,I,k,L,F,Z,o,te,N,fe]}class Em extends Sn{constructor(x){super(),En(this,x,Sm,Im,An,{id:0})}}function Am(g){let x,E;const I=g[7].default,k=eu(I,g,g[6],null);return{c(){x=Nt("div"),k&&k.c(),this.h()},l(L){x=Gt(L,"DIV",{class:!0});var F=Jt(x);k&&k.l(F),F.forEach(ht),this.h()},h(){Me(x,"class","relative z-50")},m(L,F){ir(L,x,F),k&&k.m(x,null),g[8](x),E=!0},p(L,[F]){k&&k.p&&(!E||F&64)&&tu(k,I,L,L[6],E?ru(I,L[6],F,null):iu(L[6]),null)},i(L){E||(Qi(k,L),E=!0)},o(L){nr(k,L),E=!1},d(L){L&&ht(x),k&&k.d(L),g[8](null)}}}function km(g,x,E){let{$$slots:I={},$$scope:k}=x,{root:L=null}=x,{top:F=0}=x,{bottom:o=0}=x,{increments:Z=100}=x,{value:ae=void 0}=x;const te=[],N=[];let K=[],fe=[],Te;const Ce=()=>{!K.length||K.forEach(Qe)},ke=()=>{let Oe=0,$e=0;for(let xe=0;xe<te.length;xe++)te[xe]>Oe&&(Oe=te[xe],$e=xe);Oe>0?E(1,ae=$e):E(1,ae=void 0)},Qe=(Oe,$e)=>{const xe=Je=>{Je[0].isIntersecting;const Ye=Je[0].intersectionRatio;te[$e]=Ye,ke()},dt=F?F*-1:0,We=o?o*-1:0,gt=`${dt}px 0px ${We}px 0px`,wt={root:L,rootMargin:gt,threshold:N};fe[$e]&&fe[$e].disconnect();const He=new IntersectionObserver(xe,wt);He.observe(Oe),fe[$e]=He};nu(()=>{for(let Oe=0;Oe<Z+1;Oe++)N.push(Oe/Z);K=Te.querySelectorAll(":scope > *"),Ce()});function Ve(Oe){Vl[Oe?"unshift":"push"](()=>{Te=Oe,E(0,Te)})}return g.$$set=Oe=>{"root"in Oe&&E(2,L=Oe.root),"top"in Oe&&E(3,F=Oe.top),"bottom"in Oe&&E(4,o=Oe.bottom),"increments"in Oe&&E(5,Z=Oe.increments),"value"in Oe&&E(1,ae=Oe.value),"$$scope"in Oe&&E(6,k=Oe.$$scope)},g.$$.update=()=>{g.$$.dirty&24&&Ce()},[Te,ae,L,F,o,Z,k,I,Ve]}class Mm extends Sn{constructor(x){super(),En(this,x,km,Am,An,{root:2,top:3,bottom:4,increments:5,value:1})}}function Cm(g){let x,E,I;return{c(){x=Nt("header"),E=Nt("div"),I=Nt("a"),this.h()},l(k){x=Gt(k,"HEADER",{class:!0});var L=Jt(x);E=Gt(L,"DIV",{class:!0});var F=Jt(E);I=Gt(F,"A",{href:!0,"aria-label":!0,class:!0});var o=Jt(I);o.forEach(ht),F.forEach(ht),L.forEach(ht),this.h()},h(){Me(I,"href","https://pudding.cool"),Me(I,"aria-label","The Pudding"),Me(I,"class","svelte-ewkfb5"),Me(E,"class","wordmark svelte-ewkfb5"),Me(x,"class","mb-8")},m(k,L){ir(k,x,L),At(x,E),At(E,I),I.innerHTML=Zf},p:Dr,i:Dr,o:Dr,d(k){k&&ht(x)}}}class zm extends Sn{constructor(x){super(),En(this,x,null,Cm,An,{})}}function z8(g,x,E){const I=g.slice();return I[5]=x[E],I[7]=E,I}function P8(g,x,E){const I=g.slice();return I[8]=x[E],I[7]=E,I}function Pm(g){let x,E,I,k,L=Vn.title+"",F,o,Z,ae=Vn.description+"",te,N,K,fe,Te,Ce=Vn.byline+"",ke,Qe;return E=new zm({}),{c(){x=Nt("div"),sn(E.$$.fragment),I=vn(),k=Nt("h1"),F=M9(L),o=vn(),Z=Nt("p"),te=M9(ae),N=vn(),K=Nt("p"),fe=M9("By "),Te=Nt("a"),ke=M9(Ce),this.h()},l(Ve){x=Gt(Ve,"DIV",{class:!0});var Oe=Jt(x);jn(E.$$.fragment,Oe),I=bn(Oe),k=Gt(Oe,"H1",{class:!0});var $e=Jt(k);F=C9($e,L),$e.forEach(ht),o=bn(Oe),Z=Gt(Oe,"P",{class:!0});var xe=Jt(Z);te=C9(xe,ae),xe.forEach(ht),N=bn(Oe),K=Gt(Oe,"P",{class:!0});var dt=Jt(K);fe=C9(dt,"By "),Te=Gt(dt,"A",{class:!0,href:!0,title:!0});var We=Jt(Te);ke=C9(We,Ce),We.forEach(ht),dt.forEach(ht),Oe.forEach(ht),this.h()},h(){Me(k,"class","text-5xl mb-4"),Me(Z,"class","text-2xl mb-2"),Me(Te,"class","underline"),Me(Te,"href","https://pudding.cool"),Me(Te,"title",Vn.byline),Me(K,"class","text-base"),Me(x,"class","flex flex-col")},m(Ve,Oe){ir(Ve,x,Oe),ln(E,x,null),At(x,I),At(x,k),At(k,F),At(x,o),At(x,Z),At(Z,te),At(x,N),At(x,K),At(K,fe),At(K,Te),At(Te,ke),Qe=!0},p:Dr,i(Ve){Qe||(Qi(E.$$.fragment,Ve),Qe=!0)},o(Ve){nr(E.$$.fragment,Ve),Qe=!1},d(Ve){Ve&&ht(x),cn(E)}}}function Dm(g){return{c:Dr,l:Dr,m:Dr,d:Dr}}function Lm(g){let x;return{c(){x=Nt("div"),this.h()},l(E){x=Gt(E,"DIV",{id:!0,class:!0}),Jt(x).forEach(ht),this.h()},h(){Me(x,"id","intro"),Me(x,"class","bg-black text-white h-screen")},m(E,I){ir(E,x,I)},d(E){E&&ht(x)}}}function D8(g){var ae,te;let x,E,I,k,L;const F=[{id:(ae=g[8].id)!=null?ae:`slide-${g[7]}`},g[8]];var o=(te=g[2][g[8].block])!=null?te:jl;function Z(N){let K={};for(let fe=0;fe<F.length;fe+=1)K=F8(K,F[fe]);return{props:K}}return o&&(I=new o(Z())),{c(){x=Nt("div"),E=Nt("div"),I&&sn(I.$$.fragment),k=vn(),this.h()},l(N){x=Gt(N,"DIV",{class:!0});var K=Jt(x);E=Gt(K,"DIV",{class:!0});var fe=Jt(E);I&&jn(I.$$.fragment,fe),fe.forEach(ht),k=bn(K),K.forEach(ht),this.h()},h(){Me(E,"class","bg-slate-100 mx-auto px-4 py-2 border-2 border-slate-100 rounded md:w-7/12 sm:w-11/12 text-lg"),Me(x,"class","step svelte-vd349r"),N2(x,"active",g[0]===g[7])},m(N,K){ir(N,x,K),At(x,E),I&&ln(I,E,null),At(x,k),L=!0},p(N,K){var Te,Ce;const fe=K&0?B8(F,[{id:(Te=N[8].id)!=null?Te:`slide-${N[7]}`},O8(N[8])]):{};if(o!==(o=(Ce=N[2][N[8].block])!=null?Ce:jl)){if(I){e3();const ke=I;nr(ke.$$.fragment,1,0,()=>{cn(ke,1)}),t3()}o?(I=new o(Z()),sn(I.$$.fragment),Qi(I.$$.fragment,1),ln(I,E,null)):I=null}else o&&I.$set(fe);K&1&&N2(x,"active",N[0]===N[7])},i(N){L||(I&&Qi(I.$$.fragment,N),L=!0)},o(N){I&&nr(I.$$.fragment,N),L=!1},d(N){N&&ht(x),I&&cn(I)}}}function Rm(g){let x,E,I=Vn.slides,k=[];for(let F=0;F<I.length;F+=1)k[F]=D8(P8(g,I,F));const L=F=>nr(k[F],1,1,()=>{k[F]=null});return{c(){for(let F=0;F<k.length;F+=1)k[F].c();x=da()},l(F){for(let o=0;o<k.length;o+=1)k[o].l(F);x=da()},m(F,o){for(let Z=0;Z<k.length;Z+=1)k[Z].m(F,o);ir(F,x,o),E=!0},p(F,o){if(o&5){I=Vn.slides;let Z;for(Z=0;Z<I.length;Z+=1){const ae=P8(F,I,Z);k[Z]?(k[Z].p(ae,o),Qi(k[Z],1)):(k[Z]=D8(ae),k[Z].c(),Qi(k[Z],1),k[Z].m(x.parentNode,x))}for(e3(),Z=I.length;Z<k.length;Z+=1)L(Z);t3()}},i(F){if(!E){for(let o=0;o<I.length;o+=1)Qi(k[o]);E=!0}},o(F){k=k.filter(Boolean);for(let o=0;o<k.length;o+=1)nr(k[o]);E=!1},d(F){v1(k,F),F&&ht(x)}}}function L8(g){var o,Z;let x,E,I;const k=[{id:(o=g[5].id)!=null?o:`graf-${g[7]}`},g[5]];var L=(Z=g[2][g[5].block])!=null?Z:jl;function F(ae){let te={};for(let N=0;N<k.length;N+=1)te=F8(te,k[N]);return{props:te}}return L&&(x=new L(F())),{c(){x&&sn(x.$$.fragment),E=da()},l(ae){x&&jn(x.$$.fragment,ae),E=da()},m(ae,te){x&&ln(x,ae,te),ir(ae,E,te),I=!0},p(ae,te){var K,fe;const N=te&0?B8(k,[{id:(K=ae[5].id)!=null?K:`graf-${ae[7]}`},O8(ae[5])]):{};if(L!==(L=(fe=ae[2][ae[5].block])!=null?fe:jl)){if(x){e3();const Te=x;nr(Te.$$.fragment,1,0,()=>{cn(Te,1)}),t3()}L?(x=new L(F()),sn(x.$$.fragment),Qi(x.$$.fragment,1),ln(x,E.parentNode,E)):x=null}else L&&x.$set(N)},i(ae){I||(x&&Qi(x.$$.fragment,ae),I=!0)},o(ae){x&&nr(x.$$.fragment,ae),I=!1},d(ae){ae&&ht(E),x&&cn(x,ae)}}}function Bm(g){let x,E,I,k,L,F,o,Z,ae,te,N,K,fe,Te,Ce,ke,Qe,Ve;E=new $8({props:{$$slots:{default:[Pm]},$$scope:{ctx:g}}});function Oe(Ye,qe){return Ye[0]===void 0||Ye[0]<2?Lm:Dm}let $e=Oe(g),xe=$e(g);o=new j8({props:{index:g[0]}});function dt(Ye){g[3](Ye)}function We(Ye){g[4](Ye)}let gt={$$slots:{default:[Rm]},$$scope:{ctx:g}};g[0]!==void 0&&(gt.value=g[0]),g[1]!==void 0&&(gt.id=g[1]),N=new Mm({props:gt}),Vl.push(()=>O2(N,"value",dt)),Vl.push(()=>O2(N,"id",We));let wt=Vn.blocks,He=[];for(let Ye=0;Ye<wt.length;Ye+=1)He[Ye]=L8(z8(g,wt,Ye));const Je=Ye=>nr(He[Ye],1,1,()=>{He[Ye]=null});return{c(){x=Nt("article"),sn(E.$$.fragment),I=vn(),k=Nt("section"),L=Nt("div"),xe.c(),F=vn(),sn(o.$$.fragment),Z=vn(),ae=Nt("div"),te=vn(),sn(N.$$.fragment),Te=vn(),Ce=Nt("div"),ke=vn(),Qe=Nt("section");for(let Ye=0;Ye<He.length;Ye+=1)He[Ye].c();this.h()},l(Ye){x=Gt(Ye,"ARTICLE",{});var qe=Jt(x);jn(E.$$.fragment,qe),I=bn(qe),k=Gt(qe,"SECTION",{id:!0,class:!0});var Xe=Jt(k);L=Gt(Xe,"DIV",{id:!0,class:!0});var ze=Jt(L);xe.l(ze),F=bn(ze),jn(o.$$.fragment,ze),ze.forEach(ht),Z=bn(Xe),ae=Gt(Xe,"DIV",{class:!0}),Jt(ae).forEach(ht),te=bn(Xe),jn(N.$$.fragment,Xe),Te=bn(Xe),Ce=Gt(Xe,"DIV",{class:!0}),Jt(Ce).forEach(ht),Xe.forEach(ht),ke=bn(qe),Qe=Gt(qe,"SECTION",{id:!0,class:!0});var St=Jt(Qe);for(let zt=0;zt<He.length;zt+=1)He[zt].l(St);St.forEach(ht),qe.forEach(ht),this.h()},h(){Me(L,"id","map"),Me(L,"class","sticky top-0"),Me(ae,"class","spacer svelte-vd349r"),Me(Ce,"class","spacer svelte-vd349r"),Me(k,"id","scrolly"),Me(k,"class","relative"),Me(Qe,"id","text"),Me(Qe,"class","px-4")},m(Ye,qe){ir(Ye,x,qe),ln(E,x,null),At(x,I),At(x,k),At(k,L),xe.m(L,null),At(L,F),ln(o,L,null),At(k,Z),At(k,ae),At(k,te),ln(N,k,null),At(k,Te),At(k,Ce),At(x,ke),At(x,Qe);for(let Xe=0;Xe<He.length;Xe+=1)He[Xe].m(Qe,null);Ve=!0},p(Ye,[qe]){const Xe={};qe&1024&&(Xe.$$scope={dirty:qe,ctx:Ye}),E.$set(Xe),$e!==($e=Oe(Ye))&&(xe.d(1),xe=$e(Ye),xe&&(xe.c(),xe.m(L,F)));const ze={};qe&1&&(ze.index=Ye[0]),o.$set(ze);const St={};if(qe&1025&&(St.$$scope={dirty:qe,ctx:Ye}),!K&&qe&1&&(K=!0,St.value=Ye[0],F2(()=>K=!1)),!fe&&qe&2&&(fe=!0,St.id=Ye[1],F2(()=>fe=!1)),N.$set(St),qe&4){wt=Vn.blocks;let zt;for(zt=0;zt<wt.length;zt+=1){const ei=z8(Ye,wt,zt);He[zt]?(He[zt].p(ei,qe),Qi(He[zt],1)):(He[zt]=L8(ei),He[zt].c(),Qi(He[zt],1),He[zt].m(Qe,null))}for(e3(),zt=wt.length;zt<He.length;zt+=1)Je(zt);t3()}},i(Ye){if(!Ve){Qi(E.$$.fragment,Ye),Qi(o.$$.fragment,Ye),Qi(N.$$.fragment,Ye);for(let qe=0;qe<wt.length;qe+=1)Qi(He[qe]);Ve=!0}},o(Ye){nr(E.$$.fragment,Ye),nr(o.$$.fragment,Ye),nr(N.$$.fragment,Ye),He=He.filter(Boolean);for(let qe=0;qe<He.length;qe+=1)nr(He[qe]);Ve=!1},d(Ye){Ye&&ht(x),cn(E),xe.d(),cn(o),cn(N),v1(He,Ye)}}}function Om(g,x,E){const I={text:jl,image:f_,subhead:u_,mapbox:j8,map:Em,hero:$8};let{scrollValue:k}=x,{id:L}=x;function F(Z){k=Z,E(0,k)}function o(Z){L=Z,E(1,L)}return g.$$set=Z=>{"scrollValue"in Z&&E(0,k=Z.scrollValue),"id"in Z&&E(1,L=Z.id)},[k,L,I,F,o]}class Fm extends Sn{constructor(x){super(),En(this,x,Om,Bm,An,{scrollValue:0,id:1})}}function Nm(g){let x,E,I,k;return x=new Xf({props:{title:g[0]}}),I=new Fm({}),{c(){sn(x.$$.fragment),E=vn(),sn(I.$$.fragment)},l(L){jn(x.$$.fragment,L),E=bn(L),jn(I.$$.fragment,L)},m(L,F){ln(x,L,F),ir(L,E,F),ln(I,L,F),k=!0},p:Dr,i(L){k||(Qi(x.$$.fragment,L),Qi(I.$$.fragment,L),k=!0)},o(L){nr(x.$$.fragment,L),nr(I.$$.fragment,L),k=!1},d(L){cn(x,L),L&&ht(E),cn(I,L)}}}const jm=!0;function Gm(g){const{title:x}=Vn;return $f("copy",Vn),[x]}class $m extends Sn{constructor(x){super(),En(this,x,Gm,Nm,An,{})}}export{$m as default,jm as prerender};
